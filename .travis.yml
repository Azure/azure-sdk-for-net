language: csharp
sudo: required
dist: trusty
addons:
  apt:
    sources:
    packages:
    # CoreCLR packages required for manual installation. Should be removed once we move to apt-det
    - gettext
    - libcurl4-openssl-dev
    - libicu-dev
    - libssl-dev
    - libunwind8
    - zlib1g
install:
  # CoreCLR RC2
  # due to bug in apt-get we need to use curl to download dotnet-install.sh. Commenting apt-get installation steps till the bug will be fixed. 
  # - sudo sh -c 'echo "deb [arch=amd64] https://apt-mo.trafficmanager.net/repos/dotnet/ trusty main" > /etc/apt/sources.list.d/dotnetdev.list' 
  # - sudo apt-key adv --keyserver apt-mo.trafficmanager.net --recv-keys 417A0893
  # - sudo apt-get update
  # - sudo apt-get install dotnet-dev-1.0.0-preview1-002702 -y
  - mkdir dotnet
  - curl -sSL https://raw.githubusercontent.com/dotnet/cli/rel/1.0.0-preview1/scripts/obtain/dotnet-install.sh | bash /dev/stdin --version 1.0.0-preview1-002702 --install-dir ./dotnet
  - export PATH=`pwd`/dotnet:$PATH  
script: 
  - ./test_on_linux.sh
after_script:
  - echo "========== Server log: ============"
  - pwd
  - ls -al
  - ls -al TestResults
  - cat TestResults/*.log
notifications:
  slack:
    secure: d0PFVLcyqcMxNtmZ8JaEpIBzXbUbZCgKs8QtBB5qEIXDnxflSR3AhczlILNhTBKtMEBlwVzsz65yP09XcmvB6xpAfJbHqSRzk2frKa5viPcAD8Wr/NYamt9/UiTCsnql8MqzjVy0tLdMscXKRmsUey4YF570zl0b7gAbq7XTqxM=
