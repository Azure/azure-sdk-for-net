parameters:
  - name: Daily
    type: boolean
    default: true
  - name: Artifact
    type: object
    default: {}
  - name: ArtifactName
    type: string
    default: ""
  - name: TimeoutInMinutes
    type: number
    default: 60

jobs:
  - job: SmokeTest
    steps:
      - template: /eng/pipelines/templates/steps/install-dotnet.yml
      - ${{ if eq(parameters.Daily, true) }}:
        - task: PowerShell@2
          displayName: Building Package Info
          inputs:
            targetType: filePath
            filePath: ./eng/scripts/smoketest/Get-Package-Version.ps1
            workingDirectory: common/SmokeTests/SmokeTest
            pwsh: true

      - ${{ if eq(parameters.Daily, false) }}:
        - download: current
          artifact: ${{ parameters.ArtifactName }}
          timeoutInMinutes: 5
        - task: PowerShell@2
          displayName: Use latest GA/Beta package versions
          inputs:
            targetType: filePath
            filePath: ./common/SmokeTests/SmokeTest/Update-Dependencies.ps1
            arguments: -CI -ArtifactsPath "$(Pipeline.Workspace)/${{ parameters.ArtifactName }}"
            workingDirectory: common/SmokeTests/SmokeTest
            pwsh: true
    timeoutInMinutes: ${{ parameters.TimeoutInMinutes }}
