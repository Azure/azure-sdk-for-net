parameters:
  - name: Artifacts
    type: object
    default: []
  - name: ArtifactName
    type: string
    default: packages
  - name: ArtifactPath
    type: string
    default: $(Pipeline.Workspace)
  - name: DependsOn
    type: string
    default: Build
jobs:
  - job: APIViewJob
    displayName: 'API View Tasks'
    dependsOn: ${{parameters.DependsOn}}
    pool:
      name: $(LINUXPOOL)
      image: $(LINUXVMIMAGE)
      os: linux

    steps:
      - checkout: self
        fetchDepth: 0

      - template: /eng/common/pipelines/templates/steps/set-default-branch.yml

      - template: /eng/common/pipelines/templates/steps/create-apireview.yml
        parameters:
          Artifacts: ${{parameters.Artifacts}}
          ArtifactPath: ${{parameters.ArtifactPath}}

      - template: /eng/common/pipelines/templates/steps/detect-api-changes.yml
        parameters:
          Artifacts: ${{ parameters.Artifacts }}
          ArtifactPath: ${{parameters.ArtifactPath}}

      - template: /eng/common/pipelines/templates/steps/validate-all-packages.yml
        parameters:
          Artifacts: ${{ parameters.Artifacts }}
          ArtifactPath: ${{parameters.ArtifactPath}}