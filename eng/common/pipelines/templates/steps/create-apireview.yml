parameters:
- name: PackageName
  type: string
  default: ''

steps:
  - task: Powershell@2
    inputs:
      filePath: $(Build.SourcesDirectory)/eng/common/scripts/Create-APIReview.ps1
      arguments: >
        -ArtifactPath $(Pipeline.Workspace)
        -APIViewUri "https://apiviewstaging.azurewebsites.net/AutoReview/UploadAutoReview"
        -APIKey $(azuresdk-apiview-apikey)
        -APILabel $(Build.SourceVersion)
        -PackageName ${{ parameters.PackageName }}
      pwsh: true
      workingDirectory: $(Pipeline.Workspace)
    displayName: Create API Review ${{ parameters.PackageName }}
    condition: and(succeededOrFailed(), ne(variables['Build.Reason'],'PullRequest'))
    continueOnError: true