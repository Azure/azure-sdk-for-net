{{- include "stress-test-addons.deploy-job-template.from-pod" (list . "kasobol-test.kasobol-net-chaos") -}}
{{- define "kasobol-test.kasobol-net-chaos" -}}
metadata:
  labels:
    testInstance: "kasobol-net-chaos-{{ .Release.Name }}-{{ .Release.Revision }}"
    testName: kasobol-net-chaos
    chaos: "true"
spec:
  nodeSelector:
    sku: 'storage'
  containers:
    - name: kasobol-net-chaos
      resources:
        requests:
          memory: "10Gi"
        limits:
          memory: "15Gi"
      image: stresstestregistry.azurecr.io/kasobol/net-chaos:24
      command: ["bash", "run.sh", "1", "30"]
      {{- include "stress-test-addons.container-env" . | nindent 6 }}
{{- end -}}