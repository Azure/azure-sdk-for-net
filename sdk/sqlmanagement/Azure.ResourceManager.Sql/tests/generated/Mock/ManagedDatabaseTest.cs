// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

// <auto-generated/>

#nullable disable

using System.Collections.Generic;
using System.Net;
using System.Threading.Tasks;
using Azure.Core.TestFramework;
using Azure.ResourceManager.Resources;
using Azure.ResourceManager.Sql;
using Azure.ResourceManager.Sql.Models;
using Azure.ResourceManager.TestFramework;

namespace Azure.ResourceManager.Sql.Tests.Mock
{
    /// <summary> Test for ManagedDatabase. </summary>
    public partial class ManagedDatabaseMockTests : MockTestBase
    {
        public ManagedDatabaseMockTests(bool isAsync) : base(isAsync, RecordedTestMode.Record)
        {
            ServicePointManager.ServerCertificateValidationCallback += (sender, cert, chain, sslPolicyErrors) => true;
        }

        public ManagedDatabaseMockTests() : this(false)
        {
        }

        private async Task<Sql.ManagedDatabaseCollection> GetManagedDatabaseCollectionAsync(string resourceGroupName, string managedInstanceName)
        {
            ResourceGroup resourceGroup = await TestHelper.CreateResourceGroupAsync(resourceGroupName, GetArmClient());
            ManagedInstanceCollection managedInstanceCollection = resourceGroup.GetManagedInstances();
            var managedInstanceOperation = await TestHelper.CreateOrUpdateExampleInstanceAsync(managedInstanceCollection, managedInstanceName);
            ManagedInstance managedInstance = managedInstanceOperation.Value;
            ManagedDatabaseCollection managedDatabaseCollection = managedInstance.GetManagedDatabases();
            return managedDatabaseCollection;
        }

        private async Task<Sql.ManagedDatabase> GetManagedDatabaseAsync()
        {
            var collection = await GetManagedDatabaseCollectionAsync("Default-SQL-SouthEastAsia", "managedInstance");
            var createOperation = await TestHelper.CreateOrUpdateExampleInstanceAsync(collection, "managedDatabase");
            return createOperation.Value;
        }

        [RecordedTest]
        public async Task GetAsync()
        {
            // Example: Gets a managed database
            var resource = await GetManagedDatabaseAsync();

            await resource.GetAsync();
        }

        [RecordedTest]
        public async Task DeleteAsync()
        {
            // Example: Delete managed database
            var resource = await GetManagedDatabaseAsync();

            await resource.DeleteAsync();
        }

        [RecordedTest]
        public async Task UpdateAsync()
        {
            // Example: Updates a managed database with maximal properties
            var resource = await GetManagedDatabaseAsync();
            var parameters = new Sql.Models.ManagedDatabaseUpdate();

            await resource.UpdateAsync(parameters);
        }

        [RecordedTest]
        public async Task GetByDatabaseManagedDatabaseColumnsAsync()
        {
            // Example: Filter managed database columns
            var resource = await GetManagedDatabaseAsync();
            var schema = new List<string>()
{
"dbo",};
            var table = new List<string>()
{
"customer","address",};
            var column = new List<string>()
{
"username",};
            var orderBy = new List<string>()
{
"schema asc","table","column desc",};
            string skiptoken = null;

            resource.GetByDatabaseManagedDatabaseColumnsAsync(schema, table, column, orderBy, skiptoken);
        }

        [RecordedTest]
        public async Task CompleteRestoreAsync()
        {
            // Example: Completes a managed database external backup restore.
            var resource = await GetManagedDatabaseAsync();
            var parameters = new Sql.Models.CompleteDatabaseRestoreDefinition("testdb1_log4");

            await resource.CompleteRestoreAsync(parameters);
        }

        [RecordedTest]
        public async Task GetByDatabaseManagedDatabaseSecurityEventsAsync()
        {
            // Example: Get the managed database's security events with maximal parameters
            var resource = await GetManagedDatabaseAsync();
            var filter = "ShowServerRecords eq true";
            var skip = 0;
            var top = 1;
            var skiptoken = "eyJCbG9iTmFtZURhdGVUaW1lIjoiXC9EYXRlKDE1MTIyODg4MTIwMTArMDIwMClcLyIsIkJsb2JOYW1lUm9sbG92ZXJJbmRleCI6IjAiLCJFbmREYXRlIjoiXC9EYXRlKDE1MTI0NjYyMDA1MjkpXC8iLCJJc1NraXBUb2tlblNldCI6ZmFsc2UsIklzVjJCbG9iVGltZUZvcm1hdCI6dHJ1ZSwiU2hvd1NlcnZlclJlY29yZHMiOmZhbHNlLCJTa2lwVmFsdWUiOjAsIlRha2VWYWx1ZSI6MTB9";

            resource.GetByDatabaseManagedDatabaseSecurityEventsAsync(filter, skip, top, skiptoken);
        }

        [RecordedTest]
        public async Task GetCurrentByDatabaseManagedDatabaseSensitivityLabelsAsync()
        {
            // Example: Gets the current sensitivity labels of a given database in a managed database
            var resource = await GetManagedDatabaseAsync();
            string skipToken = null;
            bool? count = null;
            string filter = null;

            resource.GetCurrentByDatabaseManagedDatabaseSensitivityLabelsAsync(skipToken, count, filter);
        }

        [RecordedTest]
        public async Task UpdateManagedDatabaseSensitivityLabelAsync()
        {
            // Example: Update sensitivity labels of a given database using an operations batch.
            var resource = await GetManagedDatabaseAsync();
            var parameters = new Sql.Models.SensitivityLabelUpdateList();

            await resource.UpdateManagedDatabaseSensitivityLabelAsync(parameters);
        }

        [RecordedTest]
        public async Task GetRecommendedByDatabaseManagedDatabaseSensitivityLabelsAsync()
        {
            // Example: Gets the recommended sensitivity labels of a given database in a managed database
            var resource = await GetManagedDatabaseAsync();
            string skipToken = null;
            bool? includeDisabledRecommendations = null;
            string filter = null;

            resource.GetRecommendedByDatabaseManagedDatabaseSensitivityLabelsAsync(skipToken, includeDisabledRecommendations, filter);
        }

        [RecordedTest]
        public async Task UpdateRecommendedManagedDatabaseSensitivityLabelAsync()
        {
            // Example: Update recommended sensitivity labels of a given database using an operations batch.
            var resource = await GetManagedDatabaseAsync();
            var parameters = new Sql.Models.RecommendedSensitivityLabelUpdateList();

            await resource.UpdateRecommendedManagedDatabaseSensitivityLabelAsync(parameters);
        }
    }
}
