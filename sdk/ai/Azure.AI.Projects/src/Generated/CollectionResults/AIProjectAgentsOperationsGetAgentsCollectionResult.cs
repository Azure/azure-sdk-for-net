// <auto-generated/>

#nullable disable

using System;
using System.ClientModel;
using System.ClientModel.Primitives;
using System.Collections.Generic;

namespace Azure.AI.Projects
{
    internal partial class AIProjectAgentsOperationsGetAgentsCollectionResult : CollectionResult
    {
        private readonly AIProjectAgentsOperations _client;
        private readonly string _kind;
        private readonly int? _limit;
        private readonly string _order;
        private readonly string _after;
        private readonly string _before;
        private readonly RequestOptions _options;

        /// <summary> Initializes a new instance of AIProjectAgentsOperationsGetAgentsCollectionResult, which is used to iterate over the pages of a collection. </summary>
        /// <param name="client"> The AIProjectAgentsOperations client used to send requests. </param>
        /// <param name="kind"> Filter agents by kind. If not provided, all agents are returned. </param>
        /// <param name="limit">
        /// A limit on the number of objects to be returned. Limit can range between 1 and 100, and the
        /// default is 20.
        /// </param>
        /// <param name="order">
        /// Sort order by the `created_at` timestamp of the objects. `asc` for ascending order and`desc`
        /// for descending order.
        /// </param>
        /// <param name="after">
        /// A cursor for use in pagination. `after` is an object ID that defines your place in the list.
        /// For instance, if you make a list request and receive 100 objects, ending with obj_foo, your
        /// subsequent call can include after=obj_foo in order to fetch the next page of the list.
        /// </param>
        /// <param name="before">
        /// A cursor for use in pagination. `before` is an object ID that defines your place in the list.
        /// For instance, if you make a list request and receive 100 objects, ending with obj_foo, your
        /// subsequent call can include before=obj_foo in order to fetch the previous page of the list.
        /// </param>
        /// <param name="options"> The request options, which can override default behaviors of the client pipeline on a per-call basis. </param>
        public AIProjectAgentsOperationsGetAgentsCollectionResult(AIProjectAgentsOperations client, string kind, int? limit, string order, string after, string before, RequestOptions options)
        {
            _client = client;
            _kind = kind;
            _limit = limit;
            _order = order;
            _after = after;
            _before = before;
            _options = options;
        }

        /// <summary> Gets the raw pages of the collection. </summary>
        /// <returns> The raw pages of the collection. </returns>
        public override IEnumerable<ClientResult> GetRawPages()
        {
            PipelineMessage message = _client.CreateGetAgentsRequest(_kind, _limit, _order, _after, _before, _options);
            string nextToken = null;
            while (true)
            {
                ClientResult result = ClientResult.FromResponse(_client.Pipeline.ProcessMessage(message, _options));
                yield return result;

                nextToken = ((AgentsPagedResultAgentObject)result).LastId;
                if (string.IsNullOrEmpty(nextToken))
                {
                    yield break;
                }
                message = _client.CreateGetAgentsRequest(_kind, _limit, _order, nextToken, _before, _options);
            }
        }

        /// <summary> Gets the continuation token from the specified page. </summary>
        /// <param name="page"></param>
        /// <returns> The continuation token for the specified page. </returns>
        public override ContinuationToken GetContinuationToken(ClientResult page)
        {
            string nextPage = ((AgentsPagedResultAgentObject)page).LastId;
            if (!string.IsNullOrEmpty(nextPage))
            {
                return ContinuationToken.FromBytes(BinaryData.FromString(nextPage));
            }
            else
            {
                return null;
            }
        }
    }
}
