{
  "Entries": [
    {
      "RequestUri": "/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952?api-version=2020-09-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZjY3Y2M5MTgtZjY0Zi00YzNmLWFhMjQtYTg1NTQ2NWY5ZDQxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0ODk1Mj9hcGktdmVyc2lvbj0yMDIwLTA5LTAx",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignment Policy Definition $[Auto Test]\",\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  }\r\n}",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "41c77e3c-f9e5-415e-a836-c8f9761f1c1b"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "335"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:3fca578a-7da5-4ae5-8c22-51cea699b132"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1199"
        ],
        "x-ms-correlation-request-id": [
          "9ed91668-1ad1-4de5-a7dc-8e5d651a1fed"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194739Z:9ed91668-1ad1-4de5-a7dc-8e5d651a1fed"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:39 GMT"
        ],
        "Content-Length": [
          "612"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignment Policy Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"Indexed\",\r\n    \"metadata\": {\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:39.5196097Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"azsmnet8952\"\r\n}",
      "StatusCode": 201
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDUwODg/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\"\r\n  }\r\n}",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "8d18753a-fd7a-4e31-b39c-d0bdd7c118fa"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "251"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:b0a93ea3-2100-44e1-935f-d8b0be83f4fb"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1198"
        ],
        "x-ms-correlation-request-id": [
          "b7507d35-0ff4-4bed-9725-e44d4db4f458"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194739Z:b7507d35-0ff4-4bed-9725-e44d4db4f458"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:39 GMT"
        ],
        "Content-Length": [
          "652"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n    \"metadata\": {\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:39.7096539Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"enforcementMode\": \"Default\"\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet5088\"\r\n}",
      "StatusCode": 201
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDUwODg/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\"\r\n    },\r\n    \"enforcementMode\": \"DoNotEnforce\"\r\n  },\r\n  \"location\": \"eastus\",\r\n  \"identity\": {\r\n    \"type\": \"SystemAssigned\"\r\n  }\r\n}",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "3c8f20b2-6fea-48f4-90ed-344c8db144bf"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "474"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:bd577b7d-1fa8-423b-9eee-b54c90dec842"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1197"
        ],
        "x-ms-correlation-request-id": [
          "a9807609-d6e5-4379-8c06-16fb8bd00355"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194741Z:a9807609-d6e5-4379-8c06-16fb8bd00355"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:40 GMT"
        ],
        "Content-Length": [
          "940"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\",\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:39.7096539Z\",\r\n      \"updatedBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"updatedOn\": \"2021-01-27T19:47:41.2171763Z\"\r\n    },\r\n    \"enforcementMode\": \"DoNotEnforce\"\r\n  },\r\n  \"identity\": {\r\n    \"principalId\": \"1f3ac475-4f76-4fac-b317-4af1293e4a66\",\r\n    \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n    \"type\": \"SystemAssigned\"\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet5088\",\r\n  \"location\": \"eastus\"\r\n}",
      "StatusCode": 201
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDUwODg/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "db77fa91-14ef-4536-9c81-ea1935b75766"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:f5b8f9ae-2836-431a-be05-c5b4ecf8bc9f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "0931bc4e-45f1-4e3e-9cc4-67480df90642"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194739Z:0931bc4e-45f1-4e3e-9cc4-67480df90642"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:39 GMT"
        ],
        "Content-Length": [
          "652"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n    \"metadata\": {\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:39.7096539Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"enforcementMode\": \"Default\"\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet5088\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDUwODg/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "7b867aaf-23f2-49c1-b270-6dcd1231e633"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:167644a8-df45-43d2-9b06-851c9ef6a961"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11996"
        ],
        "x-ms-correlation-request-id": [
          "3b949bf4-6b1d-4c78-96a8-b5179c34bd4b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194741Z:3b949bf4-6b1d-4c78-96a8-b5179c34bd4b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:41 GMT"
        ],
        "Content-Length": [
          "940"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\",\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:39.7096539Z\",\r\n      \"updatedBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"updatedOn\": \"2021-01-27T19:47:41.2171763Z\"\r\n    },\r\n    \"enforcementMode\": \"DoNotEnforce\"\r\n  },\r\n  \"identity\": {\r\n    \"principalId\": \"1f3ac475-4f76-4fac-b317-4af1293e4a66\",\r\n    \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n    \"type\": \"SystemAssigned\"\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet5088\",\r\n  \"location\": \"eastus\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDUwODg/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "54b902c9-434a-45db-b48a-cbae2e509d18"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:8247f4c7-87f1-48e6-b52b-e7ee80403373"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11995"
        ],
        "x-ms-correlation-request-id": [
          "68280408-edd5-45db-88b7-bf05c8bfe3d8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194742Z:68280408-edd5-45db-88b7-bf05c8bfe3d8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:42 GMT"
        ],
        "Content-Length": [
          "107"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyAssignmentNotFound\",\r\n    \"message\": \"The policy assignment 'azsmnet5088' is not found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments?api-version=2020-09-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZjY3Y2M5MTgtZjY0Zi00YzNmLWFhMjQtYTg1NTQ2NWY5ZDQxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lBc3NpZ25tZW50cz9hcGktdmVyc2lvbj0yMDIwLTA5LTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "338ce781-d38d-44cb-a312-efffd7a1c4fc"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:6dd1b91f-26fb-4d58-b49f-2af10ae15083"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "648743fa-ac1b-4778-9b20-087769a90a0e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194739Z:648743fa-ac1b-4778-9b20-087769a90a0e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:39 GMT"
        ],
        "Content-Length": [
          "23343"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"PUX Testing\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/b755afb5-655c-4ebd-b231-ed2ea62788da\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [\r\n          \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\",\r\n          \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg\"\r\n        ],\r\n        \"parameters\": {},\r\n        \"description\": \"asdf\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-08-24T19:55:15.037589Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-12-08T23:32:56.5545843Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": [\r\n          {\r\n            \"message\": \"general msg\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13123074483967204561\",\r\n            \"message\": \"asdf\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3854513742587939697\",\r\n            \"message\": \"asdf\"\r\n          }\r\n        ]\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"93a1325f-d061-40d9-a5dc-ac1c1964b8c5\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/4d0340753bef49b2a49e3b24\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"4d0340753bef49b2a49e3b24\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"delegated test\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cd3aa116-8754-49c9-a813-ad46512ece54\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"value\": \"inheritThis\"\r\n          }\r\n        },\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-10-27T20:42:49.4800137Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-12-08T23:51:32.0323505Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": []\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"cc514f81-616b-428d-ad5d-5edf6eda6123\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/6cdf02569df44e97ac1207d8\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"6cdf02569df44e97ac1207d8\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Auditing on SQL servers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"retentionDays\": {\r\n            \"value\": \"365\"\r\n          },\r\n          \"storageAccountsResourceGroup\": {\r\n            \"value\": \"fasdf\"\r\n          }\r\n        },\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"62cf80f1-18ad-45ab-9f4a-31351e915e7a\",\r\n          \"createdOn\": \"2020-07-07T18:07:30.491332Z\",\r\n          \"updatedBy\": \"44b5ad13-adfa-4496-9ddf-e12eaf49394c\",\r\n          \"updatedOn\": \"2020-07-07T18:10:47.7361423Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"dee5ebd7-7c42-488f-9337-1e13990a5f0f\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3\",\r\n      \"location\": \"westus2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy SQL DB transparent data encryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"62cf80f1-18ad-45ab-9f4a-31351e915e7a\",\r\n          \"createdOn\": \"2020-07-07T18:07:24.6983719Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-09-04T17:44:25.5203202Z\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"c6cc2129-0f3b-4411-bf01-204c836e4254\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09\",\r\n      \"location\": \"westus2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-27T19:47:39.7096539Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet5088\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet8609\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:29:28.8023541Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet6267\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet6267\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet542\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:42:07.4355399Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet7026\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet7026\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3520\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:40:46.6549504Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet924\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet924\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"VM Name\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/da148ce0-ba04-4b51-a529-289596d09d45\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-08-24T18:41:08.8973923Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/be606eef328541f195fddc74\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"be606eef328541f195fddc74\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enable Monitoring in Azure Security Center\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-03-31T22:09:50.4969437Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/c0921b86d1db4b8c9ac90f9f\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c0921b86d1db4b8c9ac90f9f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit NIST SP 800-53 R4 controls and deploy specific VM Extensions to support audit requirements\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"logAnalyticsWorkspaceIdforVMReporting\": {\r\n            \"value\": \"fasdff1\"\r\n          },\r\n          \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n            \"value\": [\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ]\r\n          },\r\n          \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": {\r\n            \"value\": \"cheggert\"\r\n          },\r\n          \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": {\r\n            \"value\": \"rohitbh\"\r\n          }\r\n        },\r\n        \"description\": \"This initiative includes audit and VM Extension deployment policies that address a subset of NIST SP 800-53 R4 controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/nist80053-blueprint.\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-20T22:11:26.047177Z\",\r\n          \"updatedBy\": \"0dc80135-ae53-4da3-8695-220a2d93aad8\",\r\n          \"updatedOn\": \"2021-01-11T09:52:35.5703801Z\"\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"c7519ca7-0d79-4b0f-af0b-0a4cfe3402d0\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/d17bc2764dae4ec1be07d178\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"d17bc2764dae4ec1be07d178\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"chegg: Replace tag without becoming compliant\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/270f0d11-af30-4c15-95f7-28ba884518f0\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-21T00:28:49.7568462Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"8b9d526a-9e43-4d1b-8bfe-cfe4d90f3b58\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/ee5909f9ee3f4c12bbed6efc\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"ee5909f9ee3f4c12bbed6efc\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Empty deployment on each KeyVault resource (SUB)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/78a38c70-5549-49bd-8a16-fe3619e5d2cf\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"Deploys an empty deployment (with one output) on each KeyVault vault.  Used for some PolicyInsights SDK tests.\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-21T17:43:53.4694168Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-01-08T19:53:50.7651317Z\"\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"dfd2385a-7700-420f-b164-bd9ffb52285b\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/fcddeb6113ec43798567dce2\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"fcddeb6113ec43798567dce2\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Access through Internet facing endpoint should be restricted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-07-07T19:45:25.2890242Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg/providers/Microsoft.Authorization/policyAssignments/427d0a75ba554b00a988a7b5\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"427d0a75ba554b00a988a7b5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"chegg NO KV\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"value\": [\r\n              \"microsoft.keyvault/vaults\"\r\n            ]\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {\r\n            \"listOfResourceTypesNotAllowed\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\"\r\n          },\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-09-21T21:40:09.2911762Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1/providers/Microsoft.Authorization/policyAssignments/c4fd18ae56ec4c5d9eb1d805\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c4fd18ae56ec4c5d9eb1d805\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CSEO Block WVD resource creation\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47/providers/Microsoft.Authorization/policyDefinitions/Deny WVD creation\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"notScopes\": [\r\n          \"/providers/Microsoft.Management/managementGroups/MSFT-DSRE-ISO-IAM\",\r\n          \"/providers/Microsoft.Management/managementGroups/9ce3369a-545b-cfba-c329-3631400b552f\",\r\n          \"/providers/Microsoft.Management/managementGroups/WVDSelfhost\",\r\n          \"/subscriptions/3ae2e9a4-54bd-459f-8211-6f920ecd52c4\",\r\n          \"/providers/Microsoft.Management/managementGroups/595d008b-0e4c-41f8-af09-254420fd7571\",\r\n          \"/providers/Microsoft.Management/managementGroups/CloudPCMSFTSubscriptions\"\r\n        ],\r\n        \"description\": \"IAMAADENG@microsoft.com\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"7f1579a6-c648-43a1-ac1e-0c3020dd9b8e\",\r\n          \"createdOn\": \"2020-11-17T19:41:36.3082667Z\",\r\n          \"updatedBy\": \"7f1579a6-c648-43a1-ac1e-0c3020dd9b8e\",\r\n          \"updatedOn\": \"2020-12-08T00:12:36.8374178Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47/providers/Microsoft.Authorization/policyAssignments/Block WVD creation\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"Block WVD creation\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Manual Policy Initiative\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policySetDefinitions/648898cb915947e68e67f582\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:12.4535246Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2021-01-21T19:02:48.9589454Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Subscription Manual Policy (parameterized effect)_1\",\r\n            \"message\": \"These subscriptions have been manually set to non-compliant\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Subscription Manual Policy (parameterized default)_1\",\r\n            \"message\": \"These subscriptions have been manually set to non-compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/4347209461a74f558795177c\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"4347209461a74f558795177c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription Manual Policy (parameterized effect)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14faf94\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"manual\"\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:47.6246297Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/6b90de548ea0486e925fcbad\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"6b90de548ea0486e925fcbad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription Manual Policy (parameterized default)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14faf8a\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"defaultState\": {\r\n            \"value\": \"NonCompliant\"\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:36.5851095Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/75aacc60963a4146a2e87f3e\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"75aacc60963a4146a2e87f3e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Multi-type Manual Policy (parameterized effect)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/d4094db5-f5c0-45d4-8540-67f60ba1b923\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"manual\"\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:58.1343344Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/92216833e0dd4e1793da2eb7\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"92216833e0dd4e1793da2eb7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription Manual Policy (unknown default)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14fa603\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:26.2531867Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/c210fc4598ea42358daa72d0\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c210fc4598ea42358daa72d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Empty deployment on each KeyVault resource (MG)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/78a38c70-5549-49bd-8a16-fe3619e5d2cf\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"Deploys an empty deployment (with one output) on each KeyVault vault.  Used for some PolicyInsights SDK tests.\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-21T17:44:17.3643721Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-09-04T17:44:00.7898442Z\"\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"067c1aa0-c425-4ad5-80fe-41d4639b1d42\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/d80d743b97874fd3bfd1d539\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"d80d743b97874fd3bfd1d539\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit tag at MG\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/03ae6c12-b46a-43f1-9f3d-c20620473106\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [\r\n          \"/subscriptions/086aecf4-23d6-4dfd-99a8-a5c6299f0322\"\r\n        ],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"327c26bf-bf3e-4128-9b75-fbbd99e98739\",\r\n          \"createdOn\": \"2019-09-19T21:02:48.2629834Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2019-10-01T17:50:28.4254014Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/ef26e8bbc3da423ebf7fcb80\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"ef26e8bbc3da423ebf7fcb80\"\r\n    }\r\n  ]\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments?api-version=2020-09-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZjY3Y2M5MTgtZjY0Zi00YzNmLWFhMjQtYTg1NTQ2NWY5ZDQxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lBc3NpZ25tZW50cz9hcGktdmVyc2lvbj0yMDIwLTA5LTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "a5d071b9-2454-4af0-ab8e-17ec292f59c8"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:92a214f1-e8e6-4ed0-822f-a4504e0db268"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11994"
        ],
        "x-ms-correlation-request-id": [
          "488fcfb8-af63-40fe-8b0f-542411886e90"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194742Z:488fcfb8-af63-40fe-8b0f-542411886e90"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:42 GMT"
        ],
        "Content-Length": [
          "22690"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"PUX Testing\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/b755afb5-655c-4ebd-b231-ed2ea62788da\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [\r\n          \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\",\r\n          \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg\"\r\n        ],\r\n        \"parameters\": {},\r\n        \"description\": \"asdf\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-08-24T19:55:15.037589Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-12-08T23:32:56.5545843Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": [\r\n          {\r\n            \"message\": \"general msg\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13123074483967204561\",\r\n            \"message\": \"asdf\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3854513742587939697\",\r\n            \"message\": \"asdf\"\r\n          }\r\n        ]\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"93a1325f-d061-40d9-a5dc-ac1c1964b8c5\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/4d0340753bef49b2a49e3b24\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"4d0340753bef49b2a49e3b24\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"delegated test\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cd3aa116-8754-49c9-a813-ad46512ece54\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"value\": \"inheritThis\"\r\n          }\r\n        },\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-10-27T20:42:49.4800137Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-12-08T23:51:32.0323505Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": []\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"cc514f81-616b-428d-ad5d-5edf6eda6123\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/6cdf02569df44e97ac1207d8\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"6cdf02569df44e97ac1207d8\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Auditing on SQL servers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"retentionDays\": {\r\n            \"value\": \"365\"\r\n          },\r\n          \"storageAccountsResourceGroup\": {\r\n            \"value\": \"fasdf\"\r\n          }\r\n        },\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"62cf80f1-18ad-45ab-9f4a-31351e915e7a\",\r\n          \"createdOn\": \"2020-07-07T18:07:30.491332Z\",\r\n          \"updatedBy\": \"44b5ad13-adfa-4496-9ddf-e12eaf49394c\",\r\n          \"updatedOn\": \"2020-07-07T18:10:47.7361423Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"dee5ebd7-7c42-488f-9337-1e13990a5f0f\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3\",\r\n      \"location\": \"westus2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy SQL DB transparent data encryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"62cf80f1-18ad-45ab-9f4a-31351e915e7a\",\r\n          \"createdOn\": \"2020-07-07T18:07:24.6983719Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-09-04T17:44:25.5203202Z\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"c6cc2129-0f3b-4411-bf01-204c836e4254\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09\",\r\n      \"location\": \"westus2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet8609\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:29:28.8023541Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet6267\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet6267\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet542\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:42:07.4355399Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet7026\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet7026\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3520\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:40:46.6549504Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet924\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet924\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"VM Name\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/da148ce0-ba04-4b51-a529-289596d09d45\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-08-24T18:41:08.8973923Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/be606eef328541f195fddc74\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"be606eef328541f195fddc74\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enable Monitoring in Azure Security Center\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-03-31T22:09:50.4969437Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/c0921b86d1db4b8c9ac90f9f\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c0921b86d1db4b8c9ac90f9f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit NIST SP 800-53 R4 controls and deploy specific VM Extensions to support audit requirements\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"logAnalyticsWorkspaceIdforVMReporting\": {\r\n            \"value\": \"fasdff1\"\r\n          },\r\n          \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n            \"value\": [\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ]\r\n          },\r\n          \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": {\r\n            \"value\": \"cheggert\"\r\n          },\r\n          \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": {\r\n            \"value\": \"rohitbh\"\r\n          }\r\n        },\r\n        \"description\": \"This initiative includes audit and VM Extension deployment policies that address a subset of NIST SP 800-53 R4 controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/nist80053-blueprint.\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-20T22:11:26.047177Z\",\r\n          \"updatedBy\": \"0dc80135-ae53-4da3-8695-220a2d93aad8\",\r\n          \"updatedOn\": \"2021-01-11T09:52:35.5703801Z\"\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"c7519ca7-0d79-4b0f-af0b-0a4cfe3402d0\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/d17bc2764dae4ec1be07d178\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"d17bc2764dae4ec1be07d178\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"chegg: Replace tag without becoming compliant\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/270f0d11-af30-4c15-95f7-28ba884518f0\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-21T00:28:49.7568462Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"8b9d526a-9e43-4d1b-8bfe-cfe4d90f3b58\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/ee5909f9ee3f4c12bbed6efc\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"ee5909f9ee3f4c12bbed6efc\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Empty deployment on each KeyVault resource (SUB)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/78a38c70-5549-49bd-8a16-fe3619e5d2cf\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"Deploys an empty deployment (with one output) on each KeyVault vault.  Used for some PolicyInsights SDK tests.\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-21T17:43:53.4694168Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-01-08T19:53:50.7651317Z\"\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"dfd2385a-7700-420f-b164-bd9ffb52285b\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/fcddeb6113ec43798567dce2\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"fcddeb6113ec43798567dce2\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Access through Internet facing endpoint should be restricted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-07-07T19:45:25.2890242Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg/providers/Microsoft.Authorization/policyAssignments/427d0a75ba554b00a988a7b5\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"427d0a75ba554b00a988a7b5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"chegg NO KV\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"value\": [\r\n              \"microsoft.keyvault/vaults\"\r\n            ]\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {\r\n            \"listOfResourceTypesNotAllowed\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\"\r\n          },\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-09-21T21:40:09.2911762Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1/providers/Microsoft.Authorization/policyAssignments/c4fd18ae56ec4c5d9eb1d805\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c4fd18ae56ec4c5d9eb1d805\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CSEO Block WVD resource creation\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47/providers/Microsoft.Authorization/policyDefinitions/Deny WVD creation\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"notScopes\": [\r\n          \"/providers/Microsoft.Management/managementGroups/MSFT-DSRE-ISO-IAM\",\r\n          \"/providers/Microsoft.Management/managementGroups/9ce3369a-545b-cfba-c329-3631400b552f\",\r\n          \"/providers/Microsoft.Management/managementGroups/WVDSelfhost\",\r\n          \"/subscriptions/3ae2e9a4-54bd-459f-8211-6f920ecd52c4\",\r\n          \"/providers/Microsoft.Management/managementGroups/595d008b-0e4c-41f8-af09-254420fd7571\",\r\n          \"/providers/Microsoft.Management/managementGroups/CloudPCMSFTSubscriptions\"\r\n        ],\r\n        \"description\": \"IAMAADENG@microsoft.com\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"7f1579a6-c648-43a1-ac1e-0c3020dd9b8e\",\r\n          \"createdOn\": \"2020-11-17T19:41:36.3082667Z\",\r\n          \"updatedBy\": \"7f1579a6-c648-43a1-ac1e-0c3020dd9b8e\",\r\n          \"updatedOn\": \"2020-12-08T00:12:36.8374178Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47/providers/Microsoft.Authorization/policyAssignments/Block WVD creation\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"Block WVD creation\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Manual Policy Initiative\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policySetDefinitions/648898cb915947e68e67f582\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:12.4535246Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2021-01-21T19:02:48.9589454Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Subscription Manual Policy (parameterized effect)_1\",\r\n            \"message\": \"These subscriptions have been manually set to non-compliant\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Subscription Manual Policy (parameterized default)_1\",\r\n            \"message\": \"These subscriptions have been manually set to non-compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/4347209461a74f558795177c\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"4347209461a74f558795177c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription Manual Policy (parameterized effect)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14faf94\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"manual\"\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:47.6246297Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/6b90de548ea0486e925fcbad\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"6b90de548ea0486e925fcbad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription Manual Policy (parameterized default)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14faf8a\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"defaultState\": {\r\n            \"value\": \"NonCompliant\"\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:36.5851095Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/75aacc60963a4146a2e87f3e\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"75aacc60963a4146a2e87f3e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Multi-type Manual Policy (parameterized effect)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/d4094db5-f5c0-45d4-8540-67f60ba1b923\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"manual\"\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:58.1343344Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/92216833e0dd4e1793da2eb7\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"92216833e0dd4e1793da2eb7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription Manual Policy (unknown default)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14fa603\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:26.2531867Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/c210fc4598ea42358daa72d0\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c210fc4598ea42358daa72d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Empty deployment on each KeyVault resource (MG)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/78a38c70-5549-49bd-8a16-fe3619e5d2cf\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"Deploys an empty deployment (with one output) on each KeyVault vault.  Used for some PolicyInsights SDK tests.\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-21T17:44:17.3643721Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-09-04T17:44:00.7898442Z\"\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"067c1aa0-c425-4ad5-80fe-41d4639b1d42\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/d80d743b97874fd3bfd1d539\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"d80d743b97874fd3bfd1d539\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit tag at MG\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/03ae6c12-b46a-43f1-9f3d-c20620473106\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [\r\n          \"/subscriptions/086aecf4-23d6-4dfd-99a8-a5c6299f0322\"\r\n        ],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"327c26bf-bf3e-4128-9b75-fbbd99e98739\",\r\n          \"createdOn\": \"2019-09-19T21:02:48.2629834Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2019-10-01T17:50:28.4254014Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/ef26e8bbc3da423ebf7fcb80\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"ef26e8bbc3da423ebf7fcb80\"\r\n    }\r\n  ]\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments?api-version=2020-09-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZjY3Y2M5MTgtZjY0Zi00YzNmLWFhMjQtYTg1NTQ2NWY5ZDQxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lBc3NpZ25tZW50cz9hcGktdmVyc2lvbj0yMDIwLTA5LTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "317af5fa-1b42-4bc5-a620-90fdf28d9340"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:39c38639-feb3-4f4e-a0d2-94097e164de8"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11991"
        ],
        "x-ms-correlation-request-id": [
          "53b90d12-c5ef-4124-9e83-b6cac6139d00"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194744Z:53b90d12-c5ef-4124-9e83-b6cac6139d00"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:44 GMT"
        ],
        "Content-Length": [
          "22690"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"PUX Testing\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/b755afb5-655c-4ebd-b231-ed2ea62788da\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [\r\n          \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\",\r\n          \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg\"\r\n        ],\r\n        \"parameters\": {},\r\n        \"description\": \"asdf\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-08-24T19:55:15.037589Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-12-08T23:32:56.5545843Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": [\r\n          {\r\n            \"message\": \"general msg\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13123074483967204561\",\r\n            \"message\": \"asdf\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3854513742587939697\",\r\n            \"message\": \"asdf\"\r\n          }\r\n        ]\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"93a1325f-d061-40d9-a5dc-ac1c1964b8c5\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/4d0340753bef49b2a49e3b24\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"4d0340753bef49b2a49e3b24\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"delegated test\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cd3aa116-8754-49c9-a813-ad46512ece54\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"value\": \"inheritThis\"\r\n          }\r\n        },\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-10-27T20:42:49.4800137Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-12-08T23:51:32.0323505Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": []\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"cc514f81-616b-428d-ad5d-5edf6eda6123\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/6cdf02569df44e97ac1207d8\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"6cdf02569df44e97ac1207d8\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Auditing on SQL servers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"retentionDays\": {\r\n            \"value\": \"365\"\r\n          },\r\n          \"storageAccountsResourceGroup\": {\r\n            \"value\": \"fasdf\"\r\n          }\r\n        },\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"62cf80f1-18ad-45ab-9f4a-31351e915e7a\",\r\n          \"createdOn\": \"2020-07-07T18:07:30.491332Z\",\r\n          \"updatedBy\": \"44b5ad13-adfa-4496-9ddf-e12eaf49394c\",\r\n          \"updatedOn\": \"2020-07-07T18:10:47.7361423Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"dee5ebd7-7c42-488f-9337-1e13990a5f0f\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3\",\r\n      \"location\": \"westus2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy SQL DB transparent data encryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"62cf80f1-18ad-45ab-9f4a-31351e915e7a\",\r\n          \"createdOn\": \"2020-07-07T18:07:24.6983719Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-09-04T17:44:25.5203202Z\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"c6cc2129-0f3b-4411-bf01-204c836e4254\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09\",\r\n      \"location\": \"westus2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet8609\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:29:28.8023541Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet6267\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet6267\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet542\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:42:07.4355399Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet7026\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet7026\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3520\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:40:46.6549504Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet924\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet924\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"VM Name\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/da148ce0-ba04-4b51-a529-289596d09d45\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-08-24T18:41:08.8973923Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/be606eef328541f195fddc74\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"be606eef328541f195fddc74\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enable Monitoring in Azure Security Center\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-03-31T22:09:50.4969437Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/c0921b86d1db4b8c9ac90f9f\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c0921b86d1db4b8c9ac90f9f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit NIST SP 800-53 R4 controls and deploy specific VM Extensions to support audit requirements\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policySetDefinitions/cf25b9c1-bd23-4eb6-bd2c-f4f3ac644a5f\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"logAnalyticsWorkspaceIdforVMReporting\": {\r\n            \"value\": \"fasdff1\"\r\n          },\r\n          \"listOfResourceTypesWithDiagnosticLogsEnabled\": {\r\n            \"value\": [\r\n              \"Microsoft.Network/applicationGateways\",\r\n              \"Microsoft.Automation/automationAccounts\",\r\n              \"Microsoft.ContainerInstance/containerGroups\",\r\n              \"Microsoft.ContainerRegistry/registries\",\r\n              \"Microsoft.ContainerService/managedClusters\",\r\n              \"Microsoft.Batch/batchAccounts\",\r\n              \"Microsoft.Cdn/profiles/endpoints\",\r\n              \"Microsoft.CognitiveServices/accounts\",\r\n              \"Microsoft.DocumentDB/databaseAccounts\",\r\n              \"Microsoft.DataFactory/factories\",\r\n              \"Microsoft.DataLakeAnalytics/accounts\",\r\n              \"Microsoft.DataLakeStore/accounts\",\r\n              \"Microsoft.EventGrid/eventSubscriptions\",\r\n              \"Microsoft.EventGrid/topics\",\r\n              \"Microsoft.EventHub/namespaces\",\r\n              \"Microsoft.Network/expressRouteCircuits\",\r\n              \"Microsoft.Network/azureFirewalls\",\r\n              \"Microsoft.HDInsight/clusters\",\r\n              \"Microsoft.Devices/IotHubs\",\r\n              \"Microsoft.KeyVault/vaults\",\r\n              \"Microsoft.Network/loadBalancers\",\r\n              \"Microsoft.Logic/integrationAccounts\",\r\n              \"Microsoft.Logic/workflows\",\r\n              \"Microsoft.DBforMySQL/servers\",\r\n              \"Microsoft.Network/networkInterfaces\",\r\n              \"Microsoft.Network/networkSecurityGroups\",\r\n              \"Microsoft.DBforPostgreSQL/servers\",\r\n              \"Microsoft.PowerBIDedicated/capacities\",\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.RecoveryServices/vaults\",\r\n              \"Microsoft.Cache/redis\",\r\n              \"Microsoft.Relay/namespaces\",\r\n              \"Microsoft.Search/searchServices\",\r\n              \"Microsoft.ServiceBus/namespaces\",\r\n              \"Microsoft.SignalRService/SignalR\",\r\n              \"Microsoft.Sql/servers/databases\",\r\n              \"Microsoft.Sql/servers/elasticPools\",\r\n              \"Microsoft.StreamAnalytics/streamingjobs\",\r\n              \"Microsoft.TimeSeriesInsights/environments\",\r\n              \"Microsoft.Network/trafficManagerProfiles\",\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachineScaleSets\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.Network/virtualNetworkGateways\"\r\n            ]\r\n          },\r\n          \"listOfMembersToExcludeFromWindowsVMAdministratorsGroup\": {\r\n            \"value\": \"cheggert\"\r\n          },\r\n          \"listOfMembersToIncludeInWindowsVMAdministratorsGroup\": {\r\n            \"value\": \"rohitbh\"\r\n          }\r\n        },\r\n        \"description\": \"This initiative includes audit and VM Extension deployment policies that address a subset of NIST SP 800-53 R4 controls. Additional policies will be added in upcoming releases. For more information, please visit https://aka.ms/nist80053-blueprint.\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-20T22:11:26.047177Z\",\r\n          \"updatedBy\": \"0dc80135-ae53-4da3-8695-220a2d93aad8\",\r\n          \"updatedOn\": \"2021-01-11T09:52:35.5703801Z\"\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"c7519ca7-0d79-4b0f-af0b-0a4cfe3402d0\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/d17bc2764dae4ec1be07d178\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"d17bc2764dae4ec1be07d178\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"chegg: Replace tag without becoming compliant\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/270f0d11-af30-4c15-95f7-28ba884518f0\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-21T00:28:49.7568462Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"8b9d526a-9e43-4d1b-8bfe-cfe4d90f3b58\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/ee5909f9ee3f4c12bbed6efc\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"ee5909f9ee3f4c12bbed6efc\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Empty deployment on each KeyVault resource (SUB)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/78a38c70-5549-49bd-8a16-fe3619e5d2cf\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"Deploys an empty deployment (with one output) on each KeyVault vault.  Used for some PolicyInsights SDK tests.\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-21T17:43:53.4694168Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-01-08T19:53:50.7651317Z\"\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"dfd2385a-7700-420f-b164-bd9ffb52285b\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/fcddeb6113ec43798567dce2\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"fcddeb6113ec43798567dce2\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Access through Internet facing endpoint should be restricted\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-07-07T19:45:25.2890242Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg/providers/Microsoft.Authorization/policyAssignments/427d0a75ba554b00a988a7b5\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"427d0a75ba554b00a988a7b5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"chegg NO KV\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"value\": [\r\n              \"microsoft.keyvault/vaults\"\r\n            ]\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {\r\n            \"listOfResourceTypesNotAllowed\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\"\r\n          },\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-09-21T21:40:09.2911762Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1/providers/Microsoft.Authorization/policyAssignments/c4fd18ae56ec4c5d9eb1d805\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c4fd18ae56ec4c5d9eb1d805\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CSEO Block WVD resource creation\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47/providers/Microsoft.Authorization/policyDefinitions/Deny WVD creation\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"notScopes\": [\r\n          \"/providers/Microsoft.Management/managementGroups/MSFT-DSRE-ISO-IAM\",\r\n          \"/providers/Microsoft.Management/managementGroups/9ce3369a-545b-cfba-c329-3631400b552f\",\r\n          \"/providers/Microsoft.Management/managementGroups/WVDSelfhost\",\r\n          \"/subscriptions/3ae2e9a4-54bd-459f-8211-6f920ecd52c4\",\r\n          \"/providers/Microsoft.Management/managementGroups/595d008b-0e4c-41f8-af09-254420fd7571\",\r\n          \"/providers/Microsoft.Management/managementGroups/CloudPCMSFTSubscriptions\"\r\n        ],\r\n        \"description\": \"IAMAADENG@microsoft.com\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"7f1579a6-c648-43a1-ac1e-0c3020dd9b8e\",\r\n          \"createdOn\": \"2020-11-17T19:41:36.3082667Z\",\r\n          \"updatedBy\": \"7f1579a6-c648-43a1-ac1e-0c3020dd9b8e\",\r\n          \"updatedOn\": \"2020-12-08T00:12:36.8374178Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/72f988bf-86f1-41af-91ab-2d7cd011db47/providers/Microsoft.Authorization/policyAssignments/Block WVD creation\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"Block WVD creation\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Manual Policy Initiative\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policySetDefinitions/648898cb915947e68e67f582\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:12.4535246Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2021-01-21T19:02:48.9589454Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Subscription Manual Policy (parameterized effect)_1\",\r\n            \"message\": \"These subscriptions have been manually set to non-compliant\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"Subscription Manual Policy (parameterized default)_1\",\r\n            \"message\": \"These subscriptions have been manually set to non-compliant\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/4347209461a74f558795177c\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"4347209461a74f558795177c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription Manual Policy (parameterized effect)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14faf94\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"manual\"\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:47.6246297Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/6b90de548ea0486e925fcbad\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"6b90de548ea0486e925fcbad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription Manual Policy (parameterized default)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14faf8a\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"defaultState\": {\r\n            \"value\": \"NonCompliant\"\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:36.5851095Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/75aacc60963a4146a2e87f3e\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"75aacc60963a4146a2e87f3e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Multi-type Manual Policy (parameterized effect)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/d4094db5-f5c0-45d4-8540-67f60ba1b923\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"value\": \"manual\"\r\n          }\r\n        },\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:58.1343344Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/92216833e0dd4e1793da2eb7\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"92216833e0dd4e1793da2eb7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription Manual Policy (unknown default)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/7f8c3bdf-74b5-4796-a396-4a71a14fa603\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2021-01-20T20:53:26.2531867Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/c210fc4598ea42358daa72d0\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c210fc4598ea42358daa72d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Empty deployment on each KeyVault resource (MG)\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/78a38c70-5549-49bd-8a16-fe3619e5d2cf\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"Deploys an empty deployment (with one output) on each KeyVault vault.  Used for some PolicyInsights SDK tests.\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2019-11-21T17:44:17.3643721Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-09-04T17:44:00.7898442Z\"\r\n        },\r\n        \"enforcementMode\": \"DoNotEnforce\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"067c1aa0-c425-4ad5-80fe-41d4639b1d42\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/d80d743b97874fd3bfd1d539\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"d80d743b97874fd3bfd1d539\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit tag at MG\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyDefinitions/03ae6c12-b46a-43f1-9f3d-c20620473106\",\r\n        \"scope\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"notScopes\": [\r\n          \"/subscriptions/086aecf4-23d6-4dfd-99a8-a5c6299f0322\"\r\n        ],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"327c26bf-bf3e-4128-9b75-fbbd99e98739\",\r\n          \"createdOn\": \"2019-09-19T21:02:48.2629834Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2019-10-01T17:50:28.4254014Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest/providers/Microsoft.Authorization/policyAssignments/ef26e8bbc3da423ebf7fcb80\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"ef26e8bbc3da423ebf7fcb80\"\r\n    }\r\n  ]\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments?$top=10&api-version=2020-09-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZjY3Y2M5MTgtZjY0Zi00YzNmLWFhMjQtYTg1NTQ2NWY5ZDQxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lBc3NpZ25tZW50cz8kdG9wPTEwJmFwaS12ZXJzaW9uPTIwMjAtMDktMDE=",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "9e346a3e-1b84-4e60-9b31-9f733a1fa944"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:a65b3da2-191f-4ead-bf44-1a1dea501639"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "dc2c46d2-d793-4dec-92d7-d8548287631e"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194739Z:dc2c46d2-d793-4dec-92d7-d8548287631e"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:39 GMT"
        ],
        "Content-Length": [
          "9013"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"PUX Testing\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/b755afb5-655c-4ebd-b231-ed2ea62788da\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [\r\n          \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/chegg1\",\r\n          \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/resourceGroups/cheggrg\"\r\n        ],\r\n        \"parameters\": {},\r\n        \"description\": \"asdf\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-08-24T19:55:15.037589Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-12-08T23:32:56.5545843Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": [\r\n          {\r\n            \"message\": \"general msg\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13123074483967204561\",\r\n            \"message\": \"asdf\"\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3854513742587939697\",\r\n            \"message\": \"asdf\"\r\n          }\r\n        ]\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"93a1325f-d061-40d9-a5dc-ac1c1964b8c5\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/4d0340753bef49b2a49e3b24\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"4d0340753bef49b2a49e3b24\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"delegated test\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/cd3aa116-8754-49c9-a813-ad46512ece54\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"value\": \"inheritThis\"\r\n          }\r\n        },\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-10-27T20:42:49.4800137Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-12-08T23:51:32.0323505Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\",\r\n        \"nonComplianceMessages\": []\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"cc514f81-616b-428d-ad5d-5edf6eda6123\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/6cdf02569df44e97ac1207d8\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"6cdf02569df44e97ac1207d8\",\r\n      \"location\": \"eastus\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Auditing on SQL servers\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {\r\n          \"retentionDays\": {\r\n            \"value\": \"365\"\r\n          },\r\n          \"storageAccountsResourceGroup\": {\r\n            \"value\": \"fasdf\"\r\n          }\r\n        },\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"62cf80f1-18ad-45ab-9f4a-31351e915e7a\",\r\n          \"createdOn\": \"2020-07-07T18:07:30.491332Z\",\r\n          \"updatedBy\": \"44b5ad13-adfa-4496-9ddf-e12eaf49394c\",\r\n          \"updatedOn\": \"2020-07-07T18:10:47.7361423Z\"\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"dee5ebd7-7c42-488f-9337-1e13990a5f0f\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"9e393025809a24c62c491145acc450502c3afc6588a14895261fa17233b071f3\",\r\n      \"location\": \"westus2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy SQL DB transparent data encryption\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"description\": \"\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"62cf80f1-18ad-45ab-9f4a-31351e915e7a\",\r\n          \"createdOn\": \"2020-07-07T18:07:24.6983719Z\",\r\n          \"updatedBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"updatedOn\": \"2020-09-04T17:44:25.5203202Z\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"identity\": {\r\n        \"principalId\": \"c6cc2129-0f3b-4411-bf01-204c836e4254\",\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"type\": \"SystemAssigned\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"a38877dbc1711e8fdfdb2f64ed05de993e32951e83934101f9678355b186af09\",\r\n      \"location\": \"westus2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-27T19:47:39.7096539Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet5088\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet8609\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:29:28.8023541Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet6267\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet6267\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet542\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:42:07.4355399Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet7026\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet7026\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyExemptionErrorHandling Policy Assignment $[Auto Test]\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3520\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"metadata\": {\r\n          \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n          \"createdOn\": \"2021-01-26T06:40:46.6549504Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet924\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"azsmnet924\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"VM Name\",\r\n        \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/da148ce0-ba04-4b51-a529-289596d09d45\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-08-24T18:41:08.8973923Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/be606eef328541f195fddc74\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"be606eef328541f195fddc74\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enable Monitoring in Azure Security Center\",\r\n        \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\r\n        \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n        \"notScopes\": [],\r\n        \"parameters\": {},\r\n        \"metadata\": {\r\n          \"assignedBy\": \"Chris Eggert\",\r\n          \"parameterScopes\": {},\r\n          \"createdBy\": \"36e2f355-d2e2-4fbc-88ab-4281639dff94\",\r\n          \"createdOn\": \"2020-03-31T22:09:50.4969437Z\",\r\n          \"updatedBy\": null,\r\n          \"updatedOn\": null\r\n        },\r\n        \"enforcementMode\": \"Default\"\r\n      },\r\n      \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/c0921b86d1db4b8c9ac90f9f\",\r\n      \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n      \"name\": \"c0921b86d1db4b8c9ac90f9f\"\r\n    }\r\n  ],\r\n  \"nextLink\": \"https://management.azure.com/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments?%24top=10&api-version=2020-09-01&%24skiptoken=eyJuZXh0UG9saWN5U3RvcmUiOiJDb250cm9sUGxhbmVBc3NpZ25tZW50IiwibmV4dFBhcnRpdGlvbktleSI6IjEhOCFNREF4UXpVLSIsIm5leHRSb3dLZXkiOiIxITEyNCFOekpHT1RnNFFrWTROa1l4TkRGQlJqa3hRVUl5UkRkRFJEQXhNVVJDTkRkZlUwNHRNVGRFTTBWRk56ZzFNRE0yTjBJeE5FUXpOalpFTUVRMU9VRXlOVFk0TURjdFJERTNRa015TnpZMFJFRkZORVZETVVKRk1EZEVNVGM0In0%253D\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDUwODg/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "485ae58d-7680-41c3-8263-262318f674e3"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:a48125e1-182e-4497-a2f4-e30ac392bd8b"
        ],
        "x-ms-ratelimit-remaining-subscription-deletes": [
          "14999"
        ],
        "x-ms-correlation-request-id": [
          "e7f602f7-9867-406e-8183-b0a5f7e7753d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194742Z:e7f602f7-9867-406e-8183-b0a5f7e7753d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:42 GMT"
        ],
        "Content-Length": [
          "940"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\",\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:39.7096539Z\",\r\n      \"updatedBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"updatedOn\": \"2021-01-27T19:47:41.2171763Z\"\r\n    },\r\n    \"enforcementMode\": \"DoNotEnforce\"\r\n  },\r\n  \"identity\": {\r\n    \"principalId\": \"1f3ac475-4f76-4fac-b317-4af1293e4a66\",\r\n    \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n    \"type\": \"SystemAssigned\"\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet5088\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet5088\",\r\n  \"location\": \"eastus\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet8873?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDg4NzM/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\"\r\n    },\r\n    \"enforcementMode\": \"DoNotEnforce\"\r\n  },\r\n  \"location\": \"eastus\",\r\n  \"identity\": {\r\n    \"type\": \"SystemAssigned\"\r\n  }\r\n}",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "ca6dda03-f73e-4948-a1b5-15ed685de45f"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "474"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:8276aca3-74a9-4f30-a9d6-4bab224892aa"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1196"
        ],
        "x-ms-correlation-request-id": [
          "3e8c851b-ac80-478f-a909-aa071a88da82"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194743Z:3e8c851b-ac80-478f-a909-aa071a88da82"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:42 GMT"
        ],
        "Content-Length": [
          "880"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\",\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:43.1570383Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"enforcementMode\": \"DoNotEnforce\"\r\n  },\r\n  \"identity\": {\r\n    \"principalId\": \"6fdd33aa-baa2-4562-becb-faf9b7d7ba16\",\r\n    \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n    \"type\": \"SystemAssigned\"\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet8873\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet8873\",\r\n  \"location\": \"eastus\"\r\n}",
      "StatusCode": 201
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet8873?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDg4NzM/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "42a23cce-0f86-413a-a8fe-b212e443e33a"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:7d9b2237-fb6e-413f-9160-fae265788c5e"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11993"
        ],
        "x-ms-correlation-request-id": [
          "aebbb6a3-d163-4953-8988-0e0d13deff3c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194743Z:aebbb6a3-d163-4953-8988-0e0d13deff3c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:42 GMT"
        ],
        "Content-Length": [
          "880"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\",\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:43.1570383Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"enforcementMode\": \"DoNotEnforce\"\r\n  },\r\n  \"identity\": {\r\n    \"principalId\": \"6fdd33aa-baa2-4562-becb-faf9b7d7ba16\",\r\n    \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n    \"type\": \"SystemAssigned\"\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet8873\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet8873\",\r\n  \"location\": \"eastus\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet8873?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDg4NzM/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "afbb3943-cdab-431d-932f-5bf4900b7326"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:97e57ea6-09d5-4a8d-b90f-452ca388c35a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11992"
        ],
        "x-ms-correlation-request-id": [
          "622e9ca9-4548-4623-8e39-716edb55c762"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194744Z:622e9ca9-4548-4623-8e39-716edb55c762"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:44 GMT"
        ],
        "Content-Length": [
          "107"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyAssignmentNotFound\",\r\n    \"message\": \"The policy assignment 'azsmnet8873' is not found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "//subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet8873?api-version=2020-09-01",
      "EncodedRequestUri": "Ly9zdWJzY3JpcHRpb25zL2Y2N2NjOTE4LWY2NGYtNGMzZi1hYTI0LWE4NTU0NjVmOWQ0MS9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDg4NzM/YXBpLXZlcnNpb249MjAyMC0wOS0wMQ==",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "ade47ef8-deb2-4d7b-bd9f-74dec24e350d"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:8a9ba32d-63a2-4b8c-994c-b24668fdcfa6"
        ],
        "x-ms-ratelimit-remaining-subscription-deletes": [
          "14998"
        ],
        "x-ms-correlation-request-id": [
          "98101a12-8dcc-472c-a558-a6b0714f0785"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194744Z:98101a12-8dcc-472c-a558-a6b0714f0785"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:44 GMT"
        ],
        "Content-Length": [
          "880"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicyAssignment Policy Assignment $[Auto Test]\",\r\n    \"policyDefinitionId\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n    \"scope\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\",\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:43.1570383Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"enforcementMode\": \"DoNotEnforce\"\r\n  },\r\n  \"identity\": {\r\n    \"principalId\": \"6fdd33aa-baa2-4562-becb-faf9b7d7ba16\",\r\n    \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n    \"type\": \"SystemAssigned\"\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyAssignments/azsmnet8873\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet8873\",\r\n  \"location\": \"eastus\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952?api-version=2020-09-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZjY3Y2M5MTgtZjY0Zi00YzNmLWFhMjQtYTg1NTQ2NWY5ZDQxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0ODk1Mj9hcGktdmVyc2lvbj0yMDIwLTA5LTAx",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "c26edac1-8e76-4490-a9c8-f5af125005e2"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:b18f3c1f-1dc9-4feb-be7b-09b3c588ab20"
        ],
        "x-ms-ratelimit-remaining-subscription-deletes": [
          "14997"
        ],
        "x-ms-correlation-request-id": [
          "294e03f2-910f-4954-a640-3ef3889ace99"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194744Z:294e03f2-910f-4954-a640-3ef3889ace99"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:44 GMT"
        ],
        "Content-Length": [
          "612"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignment Policy Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"Indexed\",\r\n    \"metadata\": {\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2021-01-27T19:47:39.5196097Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"azsmnet8952\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions/azsmnet8952?api-version=2020-09-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZjY3Y2M5MTgtZjY0Zi00YzNmLWFhMjQtYTg1NTQ2NWY5ZDQxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0ODk1Mj9hcGktdmVyc2lvbj0yMDIwLTA5LTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "df49f5aa-3a1c-446d-b0c9-cacab4e5fa55"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:d1e32fe2-c810-4c2f-b02b-91bde287f591"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11990"
        ],
        "x-ms-correlation-request-id": [
          "6ce54823-f47a-40d4-915c-01eb0ff1beae"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194744Z:6ce54823-f47a-40d4-915c-01eb0ff1beae"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:44 GMT"
        ],
        "Content-Length": [
          "113"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'azsmnet8952' could not be found.\"\r\n  }\r\n}",
      "StatusCode": 404
    },
    {
      "RequestUri": "/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions?api-version=2020-09-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZjY3Y2M5MTgtZjY0Zi00YzNmLWFhMjQtYTg1NTQ2NWY5ZDQxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDIwLTA5LTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "32af0b44-e5b8-44c2-9eeb-9b7a6e790b80"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.29518.01",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.19042.",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.12.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Vary": [
          "Accept-Encoding"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "11989"
        ],
        "x-ms-request-id": [
          "westus2:f3309164-7fb5-4efa-855f-6df53b0ba834"
        ],
        "x-ms-correlation-request-id": [
          "80478a86-8a7e-4a5a-8f13-3cd4f9d8a7df"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20210127T194745Z:80478a86-8a7e-4a5a-8f13-3cd4f9d8a7df"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Wed, 27 Jan 2021 19:47:44 GMT"
        ],
        "Content-Length": [
          "875566"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1599 - Developer Configuration Management | Software / Firmware Integrity Verification\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1599\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0004bbf0-5099-4179-869e-e9ffe5fb0945\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0004bbf0-5099-4179-869e-e9ffe5fb0945\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit virtual machines without disaster recovery configured\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit virtual machines which do not have disaster recovery configured. To learn more about disaster recovery, visit https://aka.ms/asr-doc.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Resources/links\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"like\": \"ASR-Protect-*\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Sockets state for a Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within an Function app must be carefully reviewed.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"DisableWebSockets\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"001802d1-4969-4c82-a700-c29c6c6f9bbd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1375 - Incident Response Assistance | Automation Support For Availability Of Information / Support\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1375\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/00379355-8932-4b52-b63a-3bc6daf3451a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"00379355-8932-4b52-b63a-3bc6daf3451a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerability assessment should be enabled on your Synapse workspaces\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Discover, track, and remediate potential vulnerabilities by configuring recurring SQL vulnerability assessment scans on your Synapse workspaces.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Synapse\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Synapse/workspaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Synapse/workspaces/vulnerabilityAssessments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Synapse/workspaces/vulnerabilityAssessments/recurringScans.isEnabled\",\r\n                \"equals\": \"True\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0049a6b3-a662-4f3e-8635-39cf44ace45a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0049a6b3-a662-4f3e-8635-39cf44ace45a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1605 - Developer Security Testing And Evaluation | Static Code Analysis\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1605\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0062eb8b-dc75-4718-8ea5-9bb4a9606655\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0062eb8b-dc75-4718-8ea5-9bb4a9606655\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Backup should be enabled for Virtual Machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Ensure protection of your Azure Virtual Machines by enabling Azure Backup. Azure Backup is a secure and cost effective data protection solution for Azure.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Backup\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.RecoveryServices/backupprotecteditems\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/013e242c-8828-4970-87b3-ab247555486d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"013e242c-8828-4970-87b3-ab247555486d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1142 - Security Assessment And Authorization Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1142\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/01524fa8-4555-48ce-ba5f-c3b8dcef5147\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"01524fa8-4555-48ce-ba5f-c3b8dcef5147\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1099 - Security Training Records\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Awareness and Training control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1099\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/01910bab-8639-4bd0-84ef-cc53b24d79ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"01910bab-8639-4bd0-84ef-cc53b24d79ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1285 - Telecommunications Services | Provider Contingency Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1285\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/01f7726b-db54-45c2-bcb5-9bd7a43796ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"01f7726b-db54-45c2-bcb5-9bd7a43796ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1709 - Security Function Verification\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1709\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/025992d6-7fee-4137-9bbf-2ffc39c0686c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"025992d6-7fee-4137-9bbf-2ffc39c0686c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1052 - Session Lock\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1052\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/027cae1c-ec3e-4492-9036-4168d540c42a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"027cae1c-ec3e-4492-9036-4168d540c42a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1034 - Least Privilege\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1034\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/02a5ed00-6d2e-4e97-9a98-46c32c057329\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"02a5ed00-6d2e-4e97-9a98-46c32c057329\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs on which the remote connection status does not match the specified one\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines on which the remote host connection status does not match the specified one. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsRemoteConnection\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/02a84be7-c304-421f-9bb7-5d2c26af54ad\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"02a84be7-c304-421f-9bb7-5d2c26af54ad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1623 - Boundary Protection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1623\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/02ce1b22-412a-4528-8630-c42146f917ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"02ce1b22-412a-4528-8630-c42146f917ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1515 - Personnel Termination\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1515\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/02dd141a-a2b2-49a7-bcbd-ca31142f6211\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"02dd141a-a2b2-49a7-bcbd-ca31142f6211\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1327 - Authenticator Management | Password-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1327\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03188d8f-1ae5-4fe1-974d-2d7d32ef937d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03188d8f-1ae5-4fe1-974d-2d7d32ef937d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1229 - Information System Component Inventory | No Duplicate Accounting Of Components\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1229\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03752212-103c-4ab8-a306-7e813022ca9d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03752212-103c-4ab8-a306-7e813022ca9d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cognitive Services accounts should restrict network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Network access to Cognitive Services accounts should be restricted. Configure network rules so only applications from allowed networks can access the Cognitive Services account. To allow connections from specific internet or on-premises clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cognitive Services\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/networkAcls.defaultAction\",\r\n                \"notEquals\": \"Deny\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"037eea7a-bd0a-46c5-9a66-03aea78705d3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1123 - Audit Review, Analysis, And Reporting | Audit Level Adjustment\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1123\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03996055-37a4-45a5-8b70-3f1caa45f87d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03996055-37a4-45a5-8b70-3f1caa45f87d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1474 - Emergency Power | Long-Term Alternate Power Supply - Minimal Operational Capability\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1474\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03ad326e-d7a1-44b1-9a76-e17492efc9e4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03ad326e-d7a1-44b1-9a76-e17492efc9e4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1227 - Information System Component Inventory | Automated Unauthorized Component Detection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1227\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03b78f5e-4877-4303-b0f4-eb6583f25768\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03b78f5e-4877-4303-b0f4-eb6583f25768\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1361 - Incident Handling\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1361\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03ed3be1-7276-4452-9a5d-e4168565ac67\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03ed3be1-7276-4452-9a5d-e4168565ac67\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1594 - Developer Configuration Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1594\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/042ba2a1-8bb8-45f4-b080-c78cf62b90e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"042ba2a1-8bb8-45f4-b080-c78cf62b90e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Linux machines that have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the Chef InSpec resource indicates that one or more of the packages provided by the parameter are installed.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"3.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"not_installed_application_linux\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"ApplicationName\": \"[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"ApplicationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'python; powershell'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"microsoft-aks\",\r\n                          \"qubole-inc\",\r\n                          \"datastax\",\r\n                          \"couchbase\",\r\n                          \"scalegrid\",\r\n                          \"checkpoint\",\r\n                          \"paloaltonetworks\",\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"OpenLogic\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"CentOS*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Oracle\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Oracle-Linux\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"RHEL\",\r\n                              \"RHEL-HA\",\r\n                              \"RHEL-SAP\",\r\n                              \"RHEL-SAP-APPS\",\r\n                              \"RHEL-SAP-HA\",\r\n                              \"RHEL-SAP-HANA\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"osa\",\r\n                              \"rhel-byos\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"cis-centos-7-l1\",\r\n                              \"cis-centos-7-v2-1-1-l1\",\r\n                              \"cis-centos-8-l1\",\r\n                              \"cis-debian-linux-8-l1\",\r\n                              \"cis-debian-linux-9-l1\",\r\n                              \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                              \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                              \"cis-oracle-linux-8-l1\",\r\n                              \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                              \"cis-rhel-7-l2\",\r\n                              \"cis-rhel-7-v2-2-0-l1\",\r\n                              \"cis-rhel-8-l1\",\r\n                              \"cis-suse-linux-12-v2-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1804-l1\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"credativ\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Debian\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"7*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Suse\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"SLES*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"11*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Canonical\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"UbuntuServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"12*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"linux-data-science-vm-ubuntu\",\r\n                              \"azureml\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-centos-os\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-altus-centos-os\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Linux*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"notIn\": [\r\n                                  \"OpenLogic\",\r\n                                  \"RedHat\",\r\n                                  \"credativ\",\r\n                                  \"Suse\",\r\n                                  \"Canonical\",\r\n                                  \"microsoft-dsvm\",\r\n                                  \"cloudera\",\r\n                                  \"microsoft-ads\",\r\n                                  \"center-for-internet-security-inc\",\r\n                                  \"Oracle\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"not_installed_application_linux\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent', '=', parameters('ApplicationName')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0447bc18-e2f7-4c0d-aa20-bff034275be1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0447bc18-e2f7-4c0d-aa20-bff034275be1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Cosmos DB allowed locations\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can specify when deploying Azure Cosmos DB resources. Use to enforce your geo-compliance requirements.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cosmos DB\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of locations that can be specified when deploying Azure Cosmos DB resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"policyEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Policy Effect\",\r\n              \"description\": \"The desired effect of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"deny\",\r\n              \"audit\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"deny\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.DocumentDB/databaseAccounts/Locations[*]\",\r\n                  \"where\": {\r\n                    \"value\": \"[replace(toLower(first(field('Microsoft.DocumentDB/databaseAccounts/Locations[*].locationName'))), ' ', '')]\",\r\n                    \"in\": \"[parameters('listOfAllowedLocations')]\"\r\n                  }\r\n                },\r\n                \"notEquals\": \"[length(field('Microsoft.DocumentDB/databaseAccounts/Locations[*]'))]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('policyEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0473574d-2d43-4217-aefe-941fcdf7e684\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0473574d-2d43-4217-aefe-941fcdf7e684\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL managed instances should use customer-managed keys to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Implementing Transparent Data Encryption (TDE) with your own key provides you with increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/encryptionProtector\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/serverKeyType\",\r\n                    \"equals\": \"AzureKeyVault\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/uri\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/uri\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"048248b0-55cd-46da-b1ff-39efd52db260\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Network traffic data collection agent should be installed on Linux virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Security Center uses the Microsoft Dependency agent to collect network traffic data from your Azure virtual machines to enable advanced network protection features such as traffic visualization on the network map, network hardening recommendations and specific network threats.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1-preview\",\r\n          \"category\": \"Monitoring\",\r\n          \"preview\": \"true\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Effect\",\r\n              \"description\": \"Enable or disable Dependency Agent for Linux VMs monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"14.04.0-LTS\",\r\n                              \"14.04.1-LTS\",\r\n                              \"14.04.5-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"16.04-LTS\",\r\n                              \"16.04.0-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"18.04-LTS\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"12-SP2\",\r\n                              \"12-SP3\",\r\n                              \"12-SP4\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"DependencyAgentLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04c4380f-3fae-46e8-96c9-30193528f602\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Shared dashboards should not have markdown tiles with inline content\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disallow creating a shared dashboard that has inline content in markdown tiles and enforce that the content should be stored as a markdown file that's hosted online. If you use inline content in the markdown tile, you cannot manage encryption of the content. By configuring your own storage, you can encrypt, double encrypt and even bring your own keys. Enabling this policy restricts users to use 2020-09-01-preview or above version of shared dashboards REST API.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Portal\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Portal/dashboards\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"value\": \"[requestContext().apiVersion]\",\r\n                      \"greaterOrEquals\": \"2020-09-01-alpha\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"count\": {\r\n                      \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*]\",\r\n                      \"where\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*].metadata.type\",\r\n                            \"equals\": \"Extension/HubsExtension/PartType/MarkdownPart\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*].metadata.Extension-HubsExtension-PartType-MarkdownPart.settings.content.settings.markdownUri\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*].metadata.Extension-HubsExtension-PartType-MarkdownPart.settings.content.settings.markdownSource\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*].metadata.Extension-HubsExtension-PartType-MarkdownPart.settings.content.settings.markdownSource\",\r\n                                \"equals\": \"1\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    },\r\n                    \"greater\": 0\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04c655fe-0ac7-48ae-9a32-3a2e208c7624\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04c655fe-0ac7-48ae-9a32-3a2e208c7624\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Service Bus to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Service Bus to stream to a regional Log Analytics workspace when any Service Bus which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ServiceBus/namespaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.ServiceBus/namespaces/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"OperationalLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04d53d87-841c-4f23-8a5b-21564380b55e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1572 - Acquisition Process\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1572\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04f5fb00-80bb-48a9-a75b-4cb4d4c97c36\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04f5fb00-80bb-48a9-a75b-4cb4d4c97c36\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure API for FHIR should use a customer-managed key (CMK) to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"API for FHIR\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HealthcareApis/services\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.HealthcareApis/services/cosmosDbConfiguration.keyVaultKeyUri\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"051cba44-2429-45b9-9649-46cec11c7119\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Log Analytics agent for Linux VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Log Analytics agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"in\": [\r\n                                  \"SLES\",\r\n                                  \"SLES-HPC\",\r\n                                  \"SLES-HPC-Priority\",\r\n                                  \"SLES-SAP\",\r\n                                  \"SLES-SAP-BYOS\",\r\n                                  \"SLES-Priority\",\r\n                                  \"SLES-BYOS\",\r\n                                  \"SLES-SAPCAL\",\r\n                                  \"SLES-Standard\"\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"like\": \"12*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"like\": \"15*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-12-sp*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-15-sp*\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"in\": [\r\n                                  \"gen1\",\r\n                                  \"gen2\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"UbuntuServer\",\r\n                          \"0001-com-ubuntu-server-focal\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"14.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16_04*lts-gen2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18_04*lts-gen2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"20_04*lts\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"20_04*lts-gen2\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"9*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7.*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"OmsAgentForLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"OMSAgentForLinux\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"vmExtensionType\": \"OmsAgentForLinux\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"1.13\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                            \"stopOnMultipleConnections\": \"true\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"053d3325-282c-4e5c-b944-24faffd30d77\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1331 - Authenticator Management | Password-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1331\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05460fe2-301f-4ed1-8174-d62c8bb92ff4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05460fe2-301f-4ed1-8174-d62c8bb92ff4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Web Application Firewall (WAF) should be enabled for Azure Front Door Service service\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Azure Web Application Firewall (WAF) in front of public facing web applications for additional inspection of incoming traffic. Web Application Firewall (WAF) provides centralized protection of your web applications from common exploits and vulnerabilities such as SQL injections, Cross-Site Scripting, local and remote file executions. You can also restrict access to your web applications by countries, IP address ranges, and other http(s) parameters via custom rules.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/frontdoors\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/frontdoors/frontendEndpoints[*].webApplicationFirewallPolicyLink.id\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"055aa869-bc98-4af8-bafc-23f1ab6ffe2c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Private endpoint should be enabled for PostgreSQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for PostgreSQL. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DBforPostgreSQL/servers/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0564d078-92f5-4f97-8398-b9f58a51f70b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0564d078-92f5-4f97-8398-b9f58a51f70b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerability Assessment settings for SQL server should contain an email address to receive scan reports\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Ensure that an email address is provided for the 'Send scan reports to' field in the Vulnerability Assessment settings. This email address receives scan result summary after a periodic scan runs on SQL servers.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/vulnerabilityAssessments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/vulnerabilityAssessments/default.recurringScans.emails[*]\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"count\": {\r\n                      \"field\": \"Microsoft.Sql/servers/vulnerabilityAssessments/default.recurringScans.emails[*]\"\r\n                    },\r\n                    \"notEquals\": 0\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Azure Data Lake Store should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Data Lake\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"0\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                                \"notEquals\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/storageAccountId\",\r\n                                \"exists\": false\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"057ef27e-665e-4328-8ea3-04b3122bd9fb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1132 - Protection Of Audit Information | Audit Backup On Separate Physical Systems / Components\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1132\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05938e10-cdbd-4a54-9b2b-1cbcfc141ad0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05938e10-cdbd-4a54-9b2b-1cbcfc141ad0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1223 - Information System Component Inventory\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1223\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05a1bb01-ad5a-49c1-aad3-b0c893b2ec3a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05a1bb01-ad5a-49c1-aad3-b0c893b2ec3a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1640 - Transmission Confidentiality And Integrity\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1640\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05a289ce-6a20-4b75-a0f3-dc8601b6acd0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05a289ce-6a20-4b75-a0f3-dc8601b6acd0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1420 - Maintenance Personnel\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1420\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05ae08cc-a282-413b-90c7-21a2c60b8404\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05ae08cc-a282-413b-90c7-21a2c60b8404\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1658 - Secure Name / Address Resolution Service (Recursive Or Caching Resolver)\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1658\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/063b540e-4bdc-4e7a-a569-3a42ddf22098\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"063b540e-4bdc-4e7a-a569-3a42ddf22098\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1688 - Information System Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1688\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/063c3f09-e0f0-4587-8fd5-f4276fae675f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"063c3f09-e0f0-4587-8fd5-f4276fae675f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1332 - Authenticator Management | Password-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1332\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/068260be-a5e6-4b0a-a430-cd27071c226a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"068260be-a5e6-4b0a-a430-cd27071c226a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1455 - Physical Access Control\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1455\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/068a88d4-e520-434e-baf0-9005a8164e6a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"068a88d4-e520-434e-baf0-9005a8164e6a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit SQL DB Level Audit Setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit DB level audit setting for SQL databases\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Audit Setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers/databases\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"master\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                    \"equals\": \"[parameters('setting')]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit VMs that do not use managed disks\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits VMs that do not use managed disks\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                        \"exists\": \"True\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                        \"exists\": \"True\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a4d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1366 - Incident Handling | Information Correlation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1366\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06c45c30-ae44-4f0f-82be-41331da911cc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06c45c30-ae44-4f0f-82be-41331da911cc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Public network access should be disabled for Cognitive Services accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy audits any Cognitive Services account in your environment with public network access enabled. Public network access should be disabled so that only connections from private endpoints are allowed.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cognitive Services\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0725b4dd-7e76-479c-a735-68e7ee23d5ca\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0725b4dd-7e76-479c-a735-68e7ee23d5ca\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1633 - Boundary Protection | Route Traffic To Authenticated Proxy Servers\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1633\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/07557aa0-e02f-4460-9a81-8ecd2fed601a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"07557aa0-e02f-4460-9a81-8ecd2fed601a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CORS should not allow every resource to access your Function Apps\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Cross-Origin Resource Sharing (CORS) should not allow all domains to access your Function app. Allow only required domains to interact with your Function app.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"functionapp*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.cors.allowedOrigins[*]\",\r\n                \"notEquals\": \"*\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0820b7b9-23aa-4725-a1ce-ae4558f718e5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Log Analytics agent for Windows VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Log Analytics agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"MicrosoftMonitoringAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"MicrosoftMonitoringAgent\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"vmExtensionType\": \"MicrosoftMonitoringAgent\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"1.0\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                            \"stopOnMultipleConnections\": \"true\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0868462e-646c-4fe3-9ced-a733534b6a2c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1583 - Information System Documentation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1583\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0882d488-8e80-4466-bc0f-0cd15b6cb66d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0882d488-8e80-4466-bc0f-0cd15b6cb66d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines on which the DSC configuration is not compliant\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the Windows PowerShell command Get-DSCConfigurationStatus returns that the DSC configuration for the machine is not compliant.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"WindowsDscConfiguration\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsDscConfiguration\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08a2f2d2-94b2-4a7b-aa3b-bb3f523ee6fd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08a2f2d2-94b2-4a7b-aa3b-bb3f523ee6fd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported PHP Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported PHP version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestPHP\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08b17839-76c6-4015-90e0-33d9d54d219c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Search Services to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Search Services to stream to a regional Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Search/searchServices\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Search/searchServices/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"OperationLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08ba64b8-738f-4918-9686-730d2ed79c7d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Adaptive network hardening recommendations should be applied on internet facing virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Security Center analyzes the traffic patterns of Internet facing virtual machines and provides Network Security Group rule recommendations that reduce the potential attack surface\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"f9f0eed0-f143-47bf-b856-671ea2eeed62\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08e6af2d-db70-460a-bfe9-d5bd474ba9d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"There should be more than one owner assigned to your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"It is recommended to designate more than one subscription owner in order to have administrator access redundancy.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"2c79b4af-f830-b61e-92b9-63dfa30f16e4\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09024ccc-0c5f-475e-9457-b7c0d9ed487b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1159 - Security Authorization\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1159\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0925f098-7877-450b-8ba4-d1e55f2d8795\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0925f098-7877-450b-8ba4-d1e55f2d8795\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Disk encryption should be applied on virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Virtual machines without an enabled disk encryption will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"d57a4221-a804-52ca-3dea-768284f06bb7\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0961003e-5a0a-4549-abde-af6a37f2724d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1302 - Identification And Authentication (Org. Users) | Network Access To Non-Privileged Accounts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1302\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/09828c65-e323-422b-9774-9d5c646124da\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09828c65-e323-422b-9774-9d5c646124da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure backup on VMs without a given tag to an existing recovery services vault in the same location\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enforce backup for all virtual machines by backing them up to an existing central recovery services vault in the same location and subscription as the virtual machine. Doing this is useful when there is a central team in your organization managing backups for all resources in a subscription. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMCentralBackupExcludeTag\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Backup\"\r\n        },\r\n        \"parameters\": {\r\n          \"vaultLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Location (Specify the location of the VMs that you want to protect)\",\r\n              \"description\": \"Specify the location of the VMs that you want to protect. VMs should be backed up to a vault in the same location. For example - southeastasia\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"backupPolicyId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Backup Policy (of type Azure VM from a vault in the location chosen above)\",\r\n              \"description\": \"Specify the id of the Azure backup policy to configure backup of the virtual machines. The selected Azure backup policy should be of type Azure virtual machine. This policy needs to be in a vault that is present in the location chosen above. For example - /subscriptions/<SubscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.RecoveryServices/vaults/<VaultName>/backupPolicies/<BackupPolicyName>\",\r\n              \"strongType\": \"Microsoft.RecoveryServices/vaults/backupPolicies\"\r\n            }\r\n          },\r\n          \"exclusionTagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Exclusion Tag Name\",\r\n              \"description\": \"Name of the tag to use for excluding VMs from the scope of this policy. This should be used along with the Exclusion Tag Value parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"exclusionTagValue\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Exclusion Tag Values\",\r\n              \"description\": \"Value of the tag to use for excluding VMs from the scope of this policy (in case of multiple values, use a comma-separated list). This should be used along with the Exclusion Tag Name parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"deployIfNotExists\",\r\n              \"auditIfNotExists\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"deployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('vaultLocation')]\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"[concat('tags[', parameters('exclusionTagName'), ']')]\",\r\n                      \"in\": \"[parameters('exclusionTagValue')]\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"value\": \"[empty(parameters('exclusionTagValue'))]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[empty(parameters('exclusionTagName'))]\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2019\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"12*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"14.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18.04*LTS\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7.*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b\"\r\n              ],\r\n              \"type\": \"Microsoft.RecoveryServices/backupprotecteditems\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"backupPolicyId\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"fabricName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"protectionContainers\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"protectedItems\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"sourceResourceId\": {\r\n                        \"type\": \"String\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[concat('DeployProtection-',uniqueString(parameters('protectedItems')))]\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[first(skip(split(parameters('backupPolicyId'), '/'), 4))]\",\r\n                        \"subscriptionId\": \"[first(skip(split(parameters('backupPolicyId'), '/'), 2))]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"backupPolicyId\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"fabricName\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"protectionContainers\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"protectedItems\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"sourceResourceId\": {\r\n                                \"type\": \"String\"\r\n                              }\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems\",\r\n                                \"name\": \"[concat(first(skip(split(parameters('backupPolicyId'), '/'), 8)), '/', parameters('fabricName'), '/',parameters('protectionContainers'), '/', parameters('protectedItems'))]\",\r\n                                \"apiVersion\": \"2016-06-01\",\r\n                                \"properties\": {\r\n                                  \"protectedItemType\": \"Microsoft.Compute/virtualMachines\",\r\n                                  \"policyId\": \"[parameters('backupPolicyId')]\",\r\n                                  \"sourceResourceId\": \"[parameters('sourceResourceId')]\"\r\n                                }\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"parameters\": {\r\n                            \"backupPolicyId\": {\r\n                              \"value\": \"[parameters('backupPolicyId')]\"\r\n                            },\r\n                            \"fabricName\": {\r\n                              \"value\": \"[parameters('fabricName')]\"\r\n                            },\r\n                            \"protectionContainers\": {\r\n                              \"value\": \"[parameters('protectionContainers')]\"\r\n                            },\r\n                            \"protectedItems\": {\r\n                              \"value\": \"[parameters('protectedItems')]\"\r\n                            },\r\n                            \"sourceResourceId\": {\r\n                              \"value\": \"[parameters('sourceResourceId')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"backupPolicyId\": {\r\n                      \"value\": \"[parameters('backupPolicyId')]\"\r\n                    },\r\n                    \"fabricName\": {\r\n                      \"value\": \"Azure\"\r\n                    },\r\n                    \"protectionContainers\": {\r\n                      \"value\": \"[concat('iaasvmcontainer;iaasvmcontainerv2;', resourceGroup().name, ';' ,field('name'))]\"\r\n                    },\r\n                    \"protectedItems\": {\r\n                      \"value\": \"[concat('vm;iaasvmcontainerv2;', resourceGroup().name, ';' ,field('name'))]\"\r\n                    },\r\n                    \"sourceResourceId\": {\r\n                      \"value\": \"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/',field('name'))]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/09ce66bc-1220-4153-8104-e3f51c936913\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09ce66bc-1220-4153-8104-e3f51c936913\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Private endpoint should be enabled for MariaDB servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for MariaDB. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DBforMariaDB/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DBforMariaDB/servers/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.DBforMariaDB/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a1302fb-a631-4106-9753-f3d494733990\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a1302fb-a631-4106-9753-f3d494733990\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Policy Add-on for Kubernetes service (AKS) should be installed and enabled on your clusters\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Policy Add-on for Kubernetes service (AKS) extends Gatekeeper v3, an admission controller webhook for Open Policy Agent (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"Kubernetes\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a15ec92-a229-4763-bb14-0ea34a568f8d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a15ec92-a229-4763-bb14-0ea34a568f8d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1654 - Voice Over Internet Protocol\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1654\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a2ee16e-ab1f-414a-800b-d1608835862b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a2ee16e-ab1f-414a-800b-d1608835862b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1402 - Controlled Maintenance | Automated Maintenance Activities\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1402\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a560d32-8075-4fec-9615-9f7c853f4ea9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a560d32-8075-4fec-9615-9f7c853f4ea9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1428 - Media Access\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1428\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a77fcc7-b8d8-451a-ab52-56197913c0c7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a77fcc7-b8d8-451a-ab52-56197913c0c7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit resource location matches resource group location\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit that the resource location matches its resource group location\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notIn\": [\r\n              \"[resourcegroup().location]\",\r\n              \"global\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a914e76-4921-4c19-b460-a2d36003525a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'System Audit Policies - Account Management'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'System Audit Policies - Account Management'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesAccountManagement\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SystemAuditPoliciesAccountManagement\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a9991e6-21be-49f9-8916-a06d934bcf29\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a9991e6-21be-49f9-8916-a06d934bcf29\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1044 - Unsuccessful Logon Attempts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1044\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0abbac52-57cf-450d-8408-1208d0dd9e90\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0abbac52-57cf-450d-8408-1208d0dd9e90\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1253 - Contingency Plan | Resume Essential Missions / Business Functions\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1253\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0afce0b3-dd9f-42bb-af28-1e4284ba8311\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0afce0b3-dd9f-42bb-af28-1e4284ba8311\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Email notification to subscription owner for high severity alerts should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"To ensure your subscription owners are notified when there is a potential security breach in their subscription, set email notifications to subscription owners for high severity alerts in Security Center.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/securityContacts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/securityContacts/alertsToAdmins\",\r\n                \"notEquals\": \"Off\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b15565f-aa9e-48ba-8619-45960f2c314d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1046 - Automatic Account Lock | Purge / Wipe Mobile Device\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1046\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b1aa965-7502-41f9-92be-3e2fe7cc392a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b1aa965-7502-41f9-92be-3e2fe7cc392a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1020 - Account Management | Role-Based Schemes\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1020\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b291ee8-3140-4cad-beb7-568c077c78ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b291ee8-3140-4cad-beb7-568c077c78ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Key vaults should have purge protection enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Malicious deletion of a key vault can lead to permanent data loss. A malicious insider in your organization can potentially delete and purge key vaults. Purge protection protects you from insider attacks by enforcing a mandatory retention period for soft deleted key vaults. No one inside your organization or Microsoft will be able to purge your key vaults during the soft delete retention period.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.1\",\r\n          \"category\": \"Key Vault\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/vaults\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enablePurgeProtection\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\r\n                    \"equals\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enablePurgeProtection\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1115 - Audit Review, Analysis, And Reporting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1115\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b653845-2ad9-4e09-a4f3-5a7c1d78353d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b653845-2ad9-4e09-a4f3-5a7c1d78353d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Cosmos DB throughput should be limited\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the maximum throughput your organization can specify when creating Azure Cosmos DB databases and containers through the resource provider. It blocks the creation of autoscale resources.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cosmos DB\"\r\n        },\r\n        \"parameters\": {\r\n          \"throughputMax\": {\r\n            \"type\": \"Integer\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Max RUs\",\r\n              \"description\": \"The maximum throughput (RU/s) that can be assigned to a container via the Resource Provider during create or update.\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Policy Effect\",\r\n              \"description\": \"The desired effect of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"deny\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"like\": \"Microsoft.DocumentDB/databaseAccounts/*/throughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"in\": [\r\n                      \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/tables\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"value\": \"[requestContext().apiVersion]\",\r\n                    \"less\": \"2019-08-01\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/sqlDatabases/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/sqlDatabases/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/tables/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/tables/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/tables/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/tables/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/tables/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b7ef78e-a035-4f23-b9bd-aff122a1b1cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b7ef78e-a035-4f23-b9bd-aff122a1b1cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1239 - User-Installed Software\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1239\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0be51298-f643-4556-88af-d7db90794879\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0be51298-f643-4556-88af-d7db90794879\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure API app has 'Client Certificates (Incoming client certificates)' set to 'On'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"*api\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/clientCertEnabled\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0c192fe8-9cbb-4516-85b3-0ade8bd03886\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0c192fe8-9cbb-4516-85b3-0ade8bd03886\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1496 - System Security Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1496\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ca96127-2f87-46ab-a4fc-0d2a786df1c8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ca96127-2f87-46ab-a4fc-0d2a786df1c8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL servers should use customer-managed keys to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.1\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"analytics\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/encryptionProtector\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/serverKeyType\",\r\n                    \"equals\": \"AzureKeyVault\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/uri\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/uri\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d134df8-db83-46fb-ad72-fe0c9428c8dd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1518 - Personnel Termination\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1518\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d58f734-c052-40e9-8b2f-a1c2bff0b815\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d58f734-c052-40e9-8b2f-a1c2bff0b815\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1713 - Software, Firmware, And Information Integrity | Integrity Checks\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1713\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d87c70b-5012-48e9-994b-e70dd4b8def0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d87c70b-5012-48e9-994b-e70dd4b8def0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1466 - Visitor Access Records\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1466\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d943a9c-a6f1-401f-a792-740cdb09c451\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d943a9c-a6f1-401f-a792-740cdb09c451\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs on which Windows Defender Exploit Guard is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines on which Windows Defender Exploit Guard is not enabled. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsDefenderExploitGuard\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Managed identity should be used in your Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use a managed identity for enhanced authentication security\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"functionapp*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/managedServiceIdentityId\",\r\n                \"exists\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0da106f2-4ca3-48e8-bc85-c638fe6aea8f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy a flow log resource with target network security group\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configures flow log for specific network security group. It will allow to log information about IP traffic flowing through an network security group. Flow log helps to identify unknown or undesired traffic, verify network isolation and compliance with enterprise access rules, analyze network flows from compromised IPs and network interfaces.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"nsgRegion\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"NSG Region\",\r\n              \"description\": \"This Policy will review NSGs only in the selected region. You can create other assignments to include other regions.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"storageId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Storage id\",\r\n              \"description\": \"A string with the storage id for the flowlogs to be sent to. It will be used for deployment purposes only. Make sure this storage account is located in the same region as the NSG. The format must be: '/subscriptions/{subscription id}/resourceGroups/{resourceGroup name}/providers/Microsoft.Storage/storageAccounts/{storage account name}\",\r\n              \"assignPermissions\": \"true\"\r\n            }\r\n          },\r\n          \"networkWatcherRG\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Watchers RG\",\r\n              \"description\": \"The name of the resource group where the flowLog resources will be created. This will be used only if a deployment is required. This is the resource group where the Network Watchers are located.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"networkWatcherName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Watcher name\",\r\n              \"description\": \"The name of the network watcher under which the flowLog resources will be created. Make sure it belongs to the same region as the NSG.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('nsgRegion')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkWatchers/flowlogs\",\r\n              \"resourceGroupName\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), parameters('networkWatcherRG'), split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\",\r\n              \"name\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkWatchers/flowLogs/enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkWatchers/flowLogs/storageId\",\r\n                    \"equals\": \"[parameters('storageId')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"storageId\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"networkWatcherRG\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"networkWatcherName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"flowlogName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"targetResource\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[concat('flowlogDeployment-', uniqueString(parameters('flowlogName')))]\",\r\n                        \"apiVersion\": \"2019-10-01\",\r\n                        \"resourceGroup\": \"[parameters('networkWatcherRG')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"incremental\",\r\n                          \"parameters\": {},\r\n                          \"template\": {\r\n                            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {},\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.Network/networkWatchers/flowLogs\",\r\n                                \"name\": \"[concat(parameters('networkWatcherName'), '/', parameters('flowlogName'))]\",\r\n                                \"apiVersion\": \"2019-11-01\",\r\n                                \"location\": \"[parameters('location')]\",\r\n                                \"properties\": {\r\n                                  \"targetResourceId\": \"[parameters('targetResource')]\",\r\n                                  \"storageId\": \"[parameters('storageId')]\",\r\n                                  \"enabled\": \"true\",\r\n                                  \"retentionPolicy\": {\r\n                                    \"days\": \"0\",\r\n                                    \"enabled\": \"false\"\r\n                                  }\r\n                                }\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"storageId\": {\r\n                      \"value\": \"[parameters('storageId')]\"\r\n                    },\r\n                    \"networkWatcherRG\": {\r\n                      \"value\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), parameters('networkWatcherRG'), split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\"\r\n                    },\r\n                    \"networkWatcherName\": {\r\n                      \"value\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), parameters('networkWatcherName'), split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8])]\"\r\n                    },\r\n                    \"flowlogName\": {\r\n                      \"value\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), concat(field('name'), '-', resourceGroup().name, '-', 'flowlog'), split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10])]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"targetResource\": {\r\n                      \"value\": \"[concat(resourceGroup().id, '/providers/Microsoft.Network/networkSecurityGroups/', field('name'))]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0db34a60-64f4-4bf6-bd44-f95c16cf34b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0db34a60-64f4-4bf6-bd44-f95c16cf34b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1718 - Software, Firmware, And Information Integrity | Binary Or Machine Executable Code\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1718\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0dced7ab-9ce5-4137-93aa-14c13e06ab17\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0dced7ab-9ce5-4137-93aa-14c13e06ab17\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Authorized IP ranges should be defined on Kubernetes Services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Restrict access to the Kubernetes Service Management API by granting API access only to IP addresses in specific ranges. It is recommended to limit access to authorized IP ranges to ensure that only applications from allowed networks can access the cluster.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.1\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.authorizedIPRanges\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Remote debugging should be turned off for Function Apps\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Remote debugging requires inbound ports to be opened on function apps. Remote debugging should be turned off.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"functionapp*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.remoteDebuggingEnabled\",\r\n                \"equals\": \"false\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e60b895-3786-45da-8377-9c6b4b6ac5f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Defender for Key Vault should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for Key Vault provides an additional layer of protection and security intelligence by detecting unusual and potentially harmful attempts to access or exploit key vault accounts.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.3\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"KeyVaults\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e6763cc-5078-4e64-889d-ff4d9a839047\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Geo-redundant backup should be enabled for Azure Database for MariaDB\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Database for MariaDB allows you to choose the redundancy option for your database server. It can be set to a geo-redundant backup storage in which the data is not only stored within the region in which your server is hosted, but is also replicated to a paired region to provide recovery option in case of a region failure. Configuring geo-redundant storage for backup is only allowed during server create.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DBforMariaDB/servers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DBforMariaDB/servers/storageProfile.geoRedundantBackup\",\r\n                \"notEquals\": \"Enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ec47710-77ff-4a3d-9181-6aa50af424d0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ec47710-77ff-4a3d-9181-6aa50af424d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to enable Guest Configuration Policy on Windows VMs.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a system-assigned managed identity and deploys the VM extension for Guest Configuration on Windows VMs. This is a prerequisite for Guest Configuration Policy and must be assigned to the scope before using any Guest Configuration policy. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"notLike\": \"SQL2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                            \"like\": \"Windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"exists\": \"false\"\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"notLike\": \"2008*\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"notLike\": \"SQL2008*\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"name\": \"AzurePolicyforWindows\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.GuestConfiguration\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"ConfigurationforWindows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ecd903d-91e7-4726-83d3-a229d7f2e293\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ecd903d-91e7-4726-83d3-a229d7f2e293\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1601 - Developer Security Testing And Evaluation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1601\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ee79a0c-addf-4ce9-9b3c-d9576ed5e20e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ee79a0c-addf-4ce9-9b3c-d9576ed5e20e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Azure Spring Cloud instances where distributed tracing is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Distributed tracing tools in Azure Spring Cloud allow debugging and monitoring the complex interconnections between microservices in an application. Distributed tracing tools should be enabled and in a healthy state.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"App Platform\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.AppPlatform/Spring\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.AppPlatform/Spring/trace.enabled\",\r\n                    \"notEquals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.AppPlatform/Spring/trace.state\",\r\n                    \"notEquals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f2d8593-4667-4932-acca-6a9f187af109\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f2d8593-4667-4932-acca-6a9f187af109\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1476 - Fire Protection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1476\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f3c4ac2-3e35-4906-a80b-473b12a622d7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f3c4ac2-3e35-4906-a80b-473b12a622d7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1204 - Access Restrictions For Change | Review System Changes\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1204\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f4f6750-d1ab-4a4c-8dfd-af3237682665\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f4f6750-d1ab-4a4c-8dfd-af3237682665\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1430 - Media Marking\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1430\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f559588-5e53-4b14-a7c4-85d28ebc2234\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f559588-5e53-4b14-a7c4-85d28ebc2234\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1574 - Acquisition Process\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1574\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f935dab-83d6-47b8-85ef-68b8584161b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f935dab-83d6-47b8-85ef-68b8584161b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1164 - Continuous Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1164\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fb8d3ce-9e96-481c-9c68-88d4e3019310\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fb8d3ce-9e96-481c-9c68-88d4e3019310\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1017 - Account Management | Inactivity Logout\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1017\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fc3db37-e59a-48c1-84e9-1780cedb409e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fc3db37-e59a-48c1-84e9-1780cedb409e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CORS should not allow every domain to access your API for FHIR\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Cross-Origin Resource Sharing (CORS) should not allow all domains to access your API for FHIR. To protect your API for FHIR, remove access for all domains and explicitly define the domains allowed to connect.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"API for FHIR\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HealthcareApis/services\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.HealthcareApis/services/corsConfiguration.origins[*]\",\r\n                  \"notEquals\": \"*\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fea8f8a-4169-495d-8307-30ec335f387d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fea8f8a-4169-495d-8307-30ec335f387d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1087 - Security Awareness And Training Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Awareness and Training control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1087\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/100c82ba-42e9-4d44-a2ba-94b209248583\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"100c82ba-42e9-4d44-a2ba-94b209248583\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that do not contain the specified certificates in Trusted Root\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"CertificateThumbprints\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Certificate thumbprints\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\\\LocalMachine\\\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsCertificateInTrustedRoot\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude', '=', parameters('CertificateThumbprints')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsCertificateInTrustedRoot\"\r\n                    },\r\n                    \"CertificateThumbprints\": {\r\n                      \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"CertificateThumbprints\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n                                \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n                                \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"106ccbe4-a791-4f33-a44a-06796944b8d5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1554 - Vulnerability Scanning | Discoverable Information\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1554\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10984b4e-c93e-48d7-bf20-9c03b04e9eca\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10984b4e-c93e-48d7-bf20-9c03b04e9eca\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Ensure that '.NET Framework' version is the latest, if used as a part of the Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy is not required since Azure App Service automatically updates and maintains the .NET Framework versions installed on the platform.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"App Service\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"functionapp*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.netFrameworkVersion\",\r\n                \"in\": [\r\n                  \"v3.0\",\r\n                  \"v4.0\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10c1859c-e1a7-4df3-ab97-a487fa8059f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10c1859c-e1a7-4df3-ab97-a487fa8059f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Custom subscription owner roles should not exist\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy ensures that no custom subscription owner roles exist.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Authorization/roleDefinitions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Authorization/roleDefinitions/type\",\r\n                \"equals\": \"CustomRole\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Authorization/roleDefinitions/permissions[*].actions[*]\",\r\n                      \"notEquals\": \"*\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Authorization/roleDefinitions/permissions.actions[*]\",\r\n                      \"notEquals\": \"*\"\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Authorization/roleDefinitions/assignableScopes[*]\",\r\n                      \"notIn\": [\r\n                        \"[concat(subscription().id,'/')]\",\r\n                        \"[subscription().id]\",\r\n                        \"/\"\r\n                      ]\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Authorization/roleDefinitions/assignableScopes[*]\",\r\n                      \"notLike\": \"/providers/Microsoft.Management/*\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10ee2ea2-fb4d-45b8-a7e9-a2e770044cd9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10ee2ea2-fb4d-45b8-a7e9-a2e770044cd9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1230 - Configuration Management Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1230\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11158848-f679-4e9b-aa7b-9fb07d945071\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11158848-f679-4e9b-aa7b-9fb07d945071\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1432 - Media Storage\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1432\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1140e542-b80d-4048-af45-3f7245be274b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1140e542-b80d-4048-af45-3f7245be274b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cognitive Services accounts should use customer owned storage or enable data encryption.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy audits any Cognitive Services account not using customer owned storage nor data encryption. For each Cognitive Services account with storage, use either customer owned storage or enable data encryption.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cognitive Services\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.CognitiveServices/accounts/userOwnedStorage[*]\"\r\n                },\r\n                \"less\": 1\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/encryption.keySource\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11566b39-f7f7-4b82-ab06-68d8700eb0a4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11566b39-f7f7-4b82-ab06-68d8700eb0a4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Dependency agent deployment - VM Image (OS) unlisted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"2008-R2-SP1\",\r\n                                \"2008-R2-SP1-smalldisk\",\r\n                                \"2012-Datacenter\",\r\n                                \"2012-Datacenter-smalldisk\",\r\n                                \"2012-R2-Datacenter\",\r\n                                \"2012-R2-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter\",\r\n                                \"2016-Datacenter-Server-Core\",\r\n                                \"2016-Datacenter-Server-Core-smalldisk\",\r\n                                \"2016-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter-with-Containers\",\r\n                                \"2016-Datacenter-with-RDSH\",\r\n                                \"2019-Datacenter\",\r\n                                \"2019-Datacenter-Core\",\r\n                                \"2019-Datacenter-Core-smalldisk\",\r\n                                \"2019-Datacenter-Core-with-Containers\",\r\n                                \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-smalldisk\",\r\n                                \"2019-Datacenter-with-Containers\",\r\n                                \"2019-Datacenter-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-zhcn\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerSemiAnnual\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"Datacenter-Core-1709-smalldisk\",\r\n                                \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                                \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerHPCPack\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftSQLServer\"\r\n                            },\r\n                            {\r\n                              \"anyOf\": [\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016-BYOL\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2-BYOL\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftRServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"MLServer-WS2016\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftVisualStudio\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"in\": [\r\n                                \"VisualStudio\",\r\n                                \"Windows\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftDynamicsAX\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Dynamics\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"microsoft-ads\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"windows-data-science-vm\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsDesktop\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Windows-10\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"RedHat\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"RHEL\",\r\n                            \"RHEL-SAP-HANA\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"SUSE\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"SLES\",\r\n                            \"SLES-HPC\",\r\n                            \"SLES-HPC-Priority\",\r\n                            \"SLES-SAP\",\r\n                            \"SLES-SAP-BYOS\",\r\n                            \"SLES-Priority\",\r\n                            \"SLES-BYOS\",\r\n                            \"SLES-SAPCAL\",\r\n                            \"SLES-Standard\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"12-SP2\",\r\n                                \"12-SP3\",\r\n                                \"12-SP4\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Canonical\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"UbuntuServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"14.04.0-LTS\",\r\n                                \"14.04.1-LTS\",\r\n                                \"14.04.5-LTS\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"16.04-LTS\",\r\n                                \"16.04.0-LTS\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"18.04-LTS\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"OpenLogic\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"Centos\",\r\n                            \"Centos-LVM\",\r\n                            \"CentOS-SRIOV\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"cloudera\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"cloudera-centos-os\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11ac78e3-31bc-4f0c-8434-37ab963cea07\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Security Options - System settings'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Security Options - System settings' for certificate rules on executables for SRP and optional subsystems. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SecurityOptionsSystemsettings\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\": \"System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies\",\r\n              \"description\": \"Specifies whether digital certificates are processed when software restriction policies are enabled and a user or process attempts to run software with an .exe file name extension. It enables or disables certificate rules (a type of software restriction policies rule). For certificate rules to take effect in software restriction policies, you must enable this policy setting.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsSystemsettings\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue', '=', parameters('SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12017595-5a75-4bb1-9d97-4c2c939ea3c3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12017595-5a75-4bb1-9d97-4c2c939ea3c3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1655 - Voice Over Internet Protocol\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1655\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/121eab72-390e-4629-a7e2-6d6184f57c6b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"121eab72-390e-4629-a7e2-6d6184f57c6b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Security Options - Network Security'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Security Options - Network Security' for including Local System behavior, PKU2U, LAN Manager, LDAP client, and NTLM SSP. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SecurityOptionsNetworkSecurity\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\": \"Network Security: Configure encryption types allowed for Kerberos;ExpectedValue\",\r\n              \"NetworkSecurityLANManagerAuthenticationLevel\": \"Network security: LAN Manager authentication level;ExpectedValue\",\r\n              \"NetworkSecurityLDAPClientSigningRequirements\": \"Network security: LDAP client signing requirements;ExpectedValue\",\r\n              \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue\",\r\n              \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Security: Configure encryption types allowed for Kerberos\",\r\n              \"description\": \"Specifies the encryption types that Kerberos is allowed to use.\"\r\n            },\r\n            \"defaultValue\": \"2147483644\"\r\n          },\r\n          \"NetworkSecurityLANManagerAuthenticationLevel\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network security: LAN Manager authentication level\",\r\n              \"description\": \"Specify which challenge-response authentication protocol is used for network logons. This choice affects the level of authentication protocol used by clients, the level of session security negotiated, and the level of authentication accepted by servers.\"\r\n            },\r\n            \"defaultValue\": \"5\"\r\n          },\r\n          \"NetworkSecurityLDAPClientSigningRequirements\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network security: LDAP client signing requirements\",\r\n              \"description\": \"Specify the level of data signing that is requested on behalf of clients that issue LDAP BIND requests.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) clients\",\r\n              \"description\": \"Specifies which behaviors are allowed by clients for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services. See https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-minimum-session-security-for-ntlm-ssp-based-including-secure-rpc-servers for more information.\"\r\n            },\r\n            \"defaultValue\": \"537395200\"\r\n          },\r\n          \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) servers\",\r\n              \"description\": \"Specifies which behaviors are allowed by servers for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services.\"\r\n            },\r\n            \"defaultValue\": \"537395200\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsNetworkSecurity\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Network Security: Configure encryption types allowed for Kerberos;ExpectedValue', '=', parameters('NetworkSecurityConfigureEncryptionTypesAllowedForKerberos'), ',', 'Network security: LAN Manager authentication level;ExpectedValue', '=', parameters('NetworkSecurityLANManagerAuthenticationLevel'), ',', 'Network security: LDAP client signing requirements;ExpectedValue', '=', parameters('NetworkSecurityLDAPClientSigningRequirements'), ',', 'Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue', '=', parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients'), ',', 'Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue', '=', parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1221c620-d201-468c-81e7-2817e6107e84\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1221c620-d201-468c-81e7-2817e6107e84\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowlist rules in your adaptive application control policy should be updated\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Monitor for changes in behavior on groups of machines configured for auditing by Azure Security Center's adaptive application controls. Security Center uses machine learning to analyze the running processes on your machines and suggest a list of known-safe applications. These are presented as recommended apps to allow in adaptive application control policies.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"1234abcd-1b53-4fd4-9835-2c2fa3935313\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/123a3936-f020-408a-ba0c-47873faf1534\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"123a3936-f020-408a-ba0c-47873faf1534\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Web Application Firewall (WAF) should use the specified mode for Application Gateway\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Mandates the use of 'Detection' or 'Prevention' mode to be active on all Web Application Firewall policies for Application Gateway.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"modeRequirement\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Mode Requirement\",\r\n              \"description\": \"Mode required for all WAF policies\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Prevention\",\r\n              \"Detection\"\r\n            ],\r\n            \"defaultValue\": \"Detection\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/applicationGatewayWebApplicationFirewallPolicies\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/applicationGatewayWebApplicationFirewallPolicies/policySettings.mode\",\r\n                \"notEquals\": \"[parameters('modeRequirement')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12430be1-6cc8-4527-a9a8-e3d38f250096\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12430be1-6cc8-4527-a9a8-e3d38f250096\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1681 - Malicious Code Protection | Automatic Updates\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1681\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12623e7e-4736-4b2e-b776-c1600f35f93a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12623e7e-4736-4b2e-b776-c1600f35f93a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1240 - User-Installed Software\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1240\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/129eb39f-d79a-4503-84cd-92f036b5e429\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"129eb39f-d79a-4503-84cd-92f036b5e429\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'Security Options - System objects'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - System objects'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsSystemobjects\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SecurityOptionsSystemobjects\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12ae2d24-3805-4b37-9fa9-465968bfbcfa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12ae2d24-3805-4b37-9fa9-465968bfbcfa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1666 - System And Information Integrity Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1666\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12e30ee3-61e6-4509-8302-a871e8ebb91e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12e30ee3-61e6-4509-8302-a871e8ebb91e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that do not have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"installedApplication\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Application names (supports wildcards)\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WhitelistedApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[InstalledApplication]bwhitelistedapp;Name', '=', parameters('installedApplication')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WhitelistedApplication\"\r\n                    },\r\n                    \"installedApplication\": {\r\n                      \"value\": \"[parameters('installedApplication')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"installedApplication\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[InstalledApplication]bwhitelistedapp;Name\",\r\n                                \"value\": \"[parameters('installedApplication')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[InstalledApplication]bwhitelistedapp;Name\",\r\n                                \"value\": \"[parameters('installedApplication')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1347 - Identification And Authentication (Non-Org. Users) | Acceptance Of PIV Creds. From Other Agys.\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1347\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/131a2706-61e9-4916-a164-00e052056462\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"131a2706-61e9-4916-a164-00e052056462\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1450 - Physical Access Authorizations\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1450\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/134d7a13-ba3e-41e2-b236-91bfcfa24e01\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"134d7a13-ba3e-41e2-b236-91bfcfa24e01\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1184 - Configuration Change Control\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1184\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13579d0e-0ab0-4b26-b0fb-d586f6d7ed20\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13579d0e-0ab0-4b26-b0fb-d586f6d7ed20\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1085 - Publicly Accessible Content\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1085\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13d117e0-38b0-4bbb-aaab-563be5dd10ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13d117e0-38b0-4bbb-aaab-563be5dd10ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1404 - Maintenance Tools\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1404\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13d8f903-0cd6-449f-a172-50f6579c182b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13d8f903-0cd6-449f-a172-50f6579c182b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1695 - Information System Monitoring | Wireless Intrusion Detection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1695\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13fcf812-ec82-4eda-9b89-498de9efd620\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13fcf812-ec82-4eda-9b89-498de9efd620\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines that contain certificates expiring within the specified number of days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if certificates in the specified store have an expiration date out of range for the number of days given as parameter. The policy also provides the option to only check for specific certificates or exclude specific certificates, and whether to report on expired certificates.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"CertificateExpiration\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"CertificateStorePath\": \"[CertificateStore]CertificateStore1;CertificateStorePath\",\r\n              \"ExpirationLimitInDays\": \"[CertificateStore]CertificateStore1;ExpirationLimitInDays\",\r\n              \"CertificateThumbprintsToInclude\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n              \"CertificateThumbprintsToExclude\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude\",\r\n              \"IncludeExpiredCertificates\": \"[CertificateStore]CertificateStore1;IncludeExpiredCertificates\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"CertificateStorePath\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate store path\",\r\n              \"description\": \"The path to the certificate store containing the certificates to check the expiration dates of. Default value is 'Cert:' which is the root certificate store path, so all certificates on the machine will be checked. Other example paths: 'Cert:\\\\LocalMachine', 'Cert:\\\\LocalMachine\\\\TrustedPublisher', 'Cert:\\\\CurrentUser'\"\r\n            },\r\n            \"defaultValue\": \"Cert:\"\r\n          },\r\n          \"ExpirationLimitInDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expiration limit in days\",\r\n              \"description\": \"An integer indicating the number of days within which to check for certificates that are expiring. For example, if this value is 30, any certificate expiring within the next 30 days will cause this policy to be non-compliant.\"\r\n            },\r\n            \"defaultValue\": \"30\"\r\n          },\r\n          \"CertificateThumbprintsToInclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints to include\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints to check under the specified path. If a value is not specified, all certificates under the certificate store path will be checked. If a value is specified, no certificates other than those with the thumbprints specified will be checked. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"CertificateThumbprintsToExclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints to exclude\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints to ignore. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"IncludeExpiredCertificates\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include expired certificates\",\r\n              \"description\": \"Must be 'true' or 'false'. True indicates that any found certificates that have already expired will also make this policy non-compliant. False indicates that certificates that have expired will be be ignored.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"CertificateExpiration\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[CertificateStore]CertificateStore1;CertificateStorePath', '=', parameters('CertificateStorePath'), ',', '[CertificateStore]CertificateStore1;ExpirationLimitInDays', '=', parameters('ExpirationLimitInDays'), ',', '[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude', '=', parameters('CertificateThumbprintsToInclude'), ',', '[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude', '=', parameters('CertificateThumbprintsToExclude'), ',', '[CertificateStore]CertificateStore1;IncludeExpiredCertificates', '=', parameters('IncludeExpiredCertificates')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1417908b-4bff-46ee-a2a6-4acc899320ab\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1417908b-4bff-46ee-a2a6-4acc899320ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs if the Administrators group contains any of the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group contains any of the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"MembersToExclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Members to exclude\",\r\n              \"description\": \"A semicolon-separated list of members that should be excluded in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AdministratorsGroupMembersToExclude\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;MembersToExclude', '=', parameters('MembersToExclude')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AdministratorsGroupMembersToExclude\"\r\n                    },\r\n                    \"MembersToExclude\": {\r\n                      \"value\": \"[parameters('MembersToExclude')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"MembersToExclude\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[LocalGroup]AdministratorsGroup;MembersToExclude\",\r\n                                \"value\": \"[parameters('MembersToExclude')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[LocalGroup]AdministratorsGroup;MembersToExclude\",\r\n                                \"value\": \"[parameters('MembersToExclude')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"144f1397-32f9-4598-8c88-118decc3ccba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy - Configure Windows machines to automatically install the Azure Security agent\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configure Windows machines to automatically install the Azure Security agent. Security Center collects events from the agent and uses them to provide security alerts and tailored hardening tasks (recommendations). Create a resource group and Log Analytics workspace in the same region as the machine to store audit records. Target virtual machines must be in a supported location.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"1.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"australiacentral\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"eastasia\",\r\n                  \"eastus2euap\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"germanywestcentral\",\r\n                  \"japaneast\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"southcentralus\",\r\n                  \"southeastasia\",\r\n                  \"uksouth\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westus\",\r\n                  \"westus2\"\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"deploymentScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"AzureSecurityWindowsAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/Publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"in\": [\r\n                      \"Succeeded\",\r\n                      \"Provisioning succeeded\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"location\": \"eastus\",\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"resourceGroup\": {\r\n                      \"value\": \"[resourceGroup().name]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceGroup\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"pairedLocations\": {\r\n                        \"australiacentral\": \"australiacentral\",\r\n                        \"australiaeast\": \"australiaeast\",\r\n                        \"australiasoutheast\": \"australiasoutheast\",\r\n                        \"centralindia\": \"centralindia\",\r\n                        \"centralus\": \"centralus\",\r\n                        \"eastasia\": \"eastasia\",\r\n                        \"eastus2euap\": \"eastus2euap\",\r\n                        \"eastus\": \"eastus\",\r\n                        \"eastus2\": \"eastus2\",\r\n                        \"germanywestcentral\": \"germanywestcentral\",\r\n                        \"japaneast\": \"japaneast\",\r\n                        \"northcentralus\": \"northcentralus\",\r\n                        \"northeurope\": \"northeurope\",\r\n                        \"southcentralus\": \"southcentralus\",\r\n                        \"southeastasia\": \"southeastasia\",\r\n                        \"uksouth\": \"uksouth\",\r\n                        \"westcentralus\": \"westcentralus\",\r\n                        \"westeurope\": \"westeurope\",\r\n                        \"westus\": \"westus\",\r\n                        \"westus2\": \"westus2\"\r\n                      },\r\n                      \"locationLongNameToShortMap\": {\r\n                        \"australiacentral\": \"CAU\",\r\n                        \"australiaeast\": \"EAU\",\r\n                        \"australiasoutheast\": \"SEAU\",\r\n                        \"centralindia\": \"CIN\",\r\n                        \"centralus\": \"CUS\",\r\n                        \"eastasia\": \"EA\",\r\n                        \"eastus2euap\": \"eus2p\",\r\n                        \"eastus\": \"EUS\",\r\n                        \"eastus2\": \"EUS2\",\r\n                        \"germanywestcentral\": \"DEWC\",\r\n                        \"japaneast\": \"EJP\",\r\n                        \"northcentralus\": \"NCUS\",\r\n                        \"northeurope\": \"NEU\",\r\n                        \"southcentralus\": \"SCUS\",\r\n                        \"southeastasia\": \"SEA\",\r\n                        \"uksouth\": \"SUK\",\r\n                        \"westcentralus\": \"WCUS\",\r\n                        \"westeurope\": \"WEU\",\r\n                        \"westus\": \"WUS\",\r\n                        \"westus2\": \"WUS2\"\r\n                      },\r\n                      \"locationCode\": \"[variables('locationLongNameToShortMap')[variables('pairedLocations')[parameters('location')]]]\",\r\n                      \"subscriptionId\": \"[subscription().subscriptionId]\",\r\n                      \"defaultRGName\": \"[concat('DefaultResourceGroup-', variables('locationCode'))]\",\r\n                      \"defaultRGLocation\": \"[variables('pairedLocations')[parameters('location')]]\",\r\n                      \"workspaceName\": \"[concat('defaultWorkspace-', variables('subscriptionId'),'-', variables('locationCode'))]\",\r\n                      \"dcrName\": \"[concat('Microsoft-Security-', variables('locationCode'), '-dcr')]\",\r\n                      \"dcrId\": \"[concat('/subscriptions/', variables('subscriptionId'), '/resourceGroups/', variables('defaultRGName'), '/providers/Microsoft.Insights/dataCollectionRules/', variables('dcrName'))]\",\r\n                      \"dcraName\": \"[concat(parameters('vmName'),'/Microsoft.Insights/Security-RulesAssociation')]\",\r\n                      \"deployAzureSecurityWindowsAgent\": \"[concat('deployAzureSecurityWindowsAgent-', uniqueString(deployment().name))]\",\r\n                      \"deployDefaultAscResourceGroup\": \"[concat('deployDefaultAscResourceGroup-', uniqueString(deployment().name))]\",\r\n                      \"deployDataCollectionRulesAssociation\": \"[concat('deployDataCollectionRulesAssociation-', uniqueString(deployment().name))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('deployAzureSecurityWindowsAgent')]\",\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"resourceGroup\": \"[parameters('resourceGroup')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"vmName\": {\r\n                              \"value\": \"[parameters('vmName')]\"\r\n                            }\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"location\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"vmName\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"variables\": {},\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                                \"name\": \"[concat(parameters('vmName'), '/', 'AzureSecurityWindowsAgent')]\",\r\n                                \"apiVersion\": \"2019-03-01\",\r\n                                \"location\": \"[parameters('location')]\",\r\n                                \"properties\": {\r\n                                  \"publisher\": \"Microsoft.Azure.Security.Monitoring\",\r\n                                  \"type\": \"AzureSecurityWindowsAgent\",\r\n                                  \"typeHandlerVersion\": \"1.0\",\r\n                                  \"autoUpgradeMinorVersion\": \"true\",\r\n                                  \"settings\": {},\r\n                                  \"protectedsettings\": {}\r\n                                }\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                        \"name\": \"[variables('defaultRGName')]\",\r\n                        \"apiVersion\": \"2019-05-01\",\r\n                        \"location\": \"[variables('defaultRGLocation')]\"\r\n                      },\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('deployDefaultAscResourceGroup')]\",\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"resourceGroup\": \"[variables('defaultRGName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"defaultRGLocation\": {\r\n                              \"value\": \"[variables('defaultRGLocation')]\"\r\n                            },\r\n                            \"workspaceName\": {\r\n                              \"value\": \"[variables('workspaceName')]\"\r\n                            },\r\n                            \"dcrName\": {\r\n                              \"value\": \"[variables('dcrName')]\"\r\n                            }\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"defaultRGLocation\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"workspaceName\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"dcrName\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"variables\": {\r\n                              \"securitySolution\": {\r\n                                \"Name\": \"[Concat('Security', '(', parameters('workspaceName'), ')')]\",\r\n                                \"GalleryName\": \"Security\"\r\n                              },\r\n                              \"securityCenterFreeSolution\": {\r\n                                \"Name\": \"[Concat('SecurityCenterFree', '(', parameters('workspaceName'), ')')]\",\r\n                                \"GalleryName\": \"SecurityCenterFree\"\r\n                              }\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.OperationalInsights/workspaces\",\r\n                                \"name\": \"[parameters('workspaceName')]\",\r\n                                \"apiVersion\": \"2015-11-01-preview\",\r\n                                \"location\": \"[parameters('defaultRGLocation')]\",\r\n                                \"properties\": {\r\n                                  \"sku\": {\r\n                                    \"name\": \"pernode\"\r\n                                  },\r\n                                  \"retentionInDays\": 30,\r\n                                  \"features\": {\r\n                                    \"searchVersion\": 1\r\n                                  }\r\n                                }\r\n                              },\r\n                              {\r\n                                \"type\": \"Microsoft.OperationsManagement/solutions\",\r\n                                \"name\": \"[variables('securitySolution').Name]\",\r\n                                \"apiVersion\": \"2015-11-01-preview\",\r\n                                \"location\": \"[parameters('defaultRGLocation')]\",\r\n                                \"dependsOn\": [\r\n                                  \"[parameters('workspaceName')]\"\r\n                                ],\r\n                                \"properties\": {\r\n                                  \"workspaceResourceId\": \"[resourceId('Microsoft.OperationalInsights/workspaces/', parameters('workspaceName'))]\"\r\n                                },\r\n                                \"plan\": {\r\n                                  \"name\": \"[variables('securitySolution').Name]\",\r\n                                  \"publisher\": \"Microsoft\",\r\n                                  \"product\": \"[Concat('OMSGallery/', variables('securitySolution').GalleryName)]\",\r\n                                  \"promotionCode\": \"\"\r\n                                }\r\n                              },\r\n                              {\r\n                                \"type\": \"Microsoft.OperationsManagement/solutions\",\r\n                                \"name\": \"[variables('securityCenterFreeSolution').Name]\",\r\n                                \"apiVersion\": \"2015-11-01-preview\",\r\n                                \"location\": \"[parameters('defaultRGLocation')]\",\r\n                                \"dependsOn\": [\r\n                                  \"[parameters('workspaceName')]\"\r\n                                ],\r\n                                \"properties\": {\r\n                                  \"workspaceResourceId\": \"[resourceId('Microsoft.OperationalInsights/workspaces/', parameters('workspaceName'))]\"\r\n                                },\r\n                                \"plan\": {\r\n                                  \"name\": \"[variables('securityCenterFreeSolution').Name]\",\r\n                                  \"publisher\": \"Microsoft\",\r\n                                  \"product\": \"[Concat('OMSGallery/', variables('securityCenterFreeSolution').GalleryName)]\",\r\n                                  \"promotionCode\": \"\"\r\n                                }\r\n                              },\r\n                              {\r\n                                \"type\": \"Microsoft.Insights/dataCollectionRules\",\r\n                                \"name\": \"[parameters('dcrName')]\",\r\n                                \"apiVersion\": \"2019-11-01-preview\",\r\n                                \"location\": \"[parameters('defaultRGLocation')]\",\r\n                                \"dependsOn\": [\r\n                                  \"[parameters('workspaceName')]\"\r\n                                ],\r\n                                \"properties\": {\r\n                                  \"description\": \"Data collection rule for Azure Security Center. Deleting this rule will break the detection of security vulnerabilities.\",\r\n                                  \"dataSources\": {\r\n                                    \"windowsEventLogs\": [\r\n                                      {\r\n                                        \"name\": \"RomeDetectionEventDataSource\",\r\n                                        \"streams\": [\r\n                                          \"Microsoft-RomeDetectionEvent\"\r\n                                        ],\r\n                                        \"scheduledTransferPeriod\": \"PT5M\",\r\n                                        \"xPathQueries\": [\r\n                                          \"Security!*\",\r\n                                          \"Microsoft-Windows-AppLocker/EXE and DLL!*\"\r\n                                        ]\r\n                                      }\r\n                                    ],\r\n                                    \"syslog\": [\r\n                                      {\r\n                                        \"name\": \"SyslogDataSource\",\r\n                                        \"streams\": [\r\n                                          \"Microsoft-Syslog\"\r\n                                        ],\r\n                                        \"facilityNames\": [\r\n                                          \"kern\",\r\n                                          \"auth\",\r\n                                          \"authpriv\",\r\n                                          \"cron\",\r\n                                          \"user\",\r\n                                          \"daemon\",\r\n                                          \"syslog\",\r\n                                          \"local0\"\r\n                                        ],\r\n                                        \"logLevels\": [\r\n                                          \"Debug\",\r\n                                          \"Critical\",\r\n                                          \"Emergency\"\r\n                                        ]\r\n                                      }\r\n                                    ],\r\n                                    \"extensions\": [\r\n                                      {\r\n                                        \"extensionName\": \"AzureSecurityLinuxAgent\",\r\n                                        \"name\": \"AscLinuxDataSource\",\r\n                                        \"streams\": [\r\n                                          \"Microsoft-OperationLog\",\r\n                                          \"Microsoft-SecurityBaseline\",\r\n                                          \"Microsoft-SecurityBaselineSummary\",\r\n                                          \"Microsoft-ProcessInvestigator\",\r\n                                          \"Microsoft-Auditd\",\r\n                                          \"Microsoft-ProtectionStatus\",\r\n                                          \"Microsoft-Heartbeat\"\r\n                                        ],\r\n                                        \"extensionSettings\": {\r\n                                          \"scanners\": [\r\n                                            {\r\n                                              \"name\": \"heartbeat\",\r\n                                              \"frequency\": \"PT1H\"\r\n                                            },\r\n                                            {\r\n                                              \"name\": \"time\",\r\n                                              \"frequency\": \"PT8H\"\r\n                                            },\r\n                                            {\r\n                                              \"name\": \"antimalware\",\r\n                                              \"frequency\": \"PT8H\"\r\n                                            },\r\n                                            {\r\n                                              \"name\": \"codeintegrity\",\r\n                                              \"frequency\": \"P1D\"\r\n                                            },\r\n                                            {\r\n                                              \"name\": \"processinvestigator\",\r\n                                              \"frequency\": \"P1D\"\r\n                                            },\r\n                                            {\r\n                                              \"name\": \"baseline\",\r\n                                              \"frequency\": \"P1D\",\r\n                                              \"options\": [\r\n                                                {\r\n                                                  \"name\": \"Baseline\",\r\n                                                  \"value\": \"Azure.Ubuntu\"\r\n                                                },\r\n                                                {\r\n                                                  \"name\": \"AscBaseline\",\r\n                                                  \"value\": \"OMS.Linux\"\r\n                                                }\r\n                                              ]\r\n                                            },\r\n                                            {\r\n                                              \"name\": \"docker\",\r\n                                              \"frequency\": \"P1D\",\r\n                                              \"options\": [\r\n                                                {\r\n                                                  \"name\": \"Baseline\",\r\n                                                  \"value\": \"Azure.Docker.Linux\"\r\n                                                },\r\n                                                {\r\n                                                  \"name\": \"AscBaseline\",\r\n                                                  \"value\": \"OMS.Docker.Linux\"\r\n                                                }\r\n                                              ]\r\n                                            }\r\n                                          ]\r\n                                        }\r\n                                      },\r\n                                      {\r\n                                        \"extensionName\": \"AzureSecurityWindowsAgent\",\r\n                                        \"name\": \"AsaWindowsDataSource\",\r\n                                        \"streams\": [\r\n                                          \"Microsoft-OperationLog\",\r\n                                          \"Microsoft-SecurityBaseline\",\r\n                                          \"Microsoft-ProcessInvestigator\",\r\n                                          \"Microsoft-ProtectionStatus\",\r\n                                          \"Microsoft-SecurityBaselineSummary\"\r\n                                        ],\r\n                                        \"extensionSettings\": {\r\n                                          \"scanners\": [\r\n                                            {\r\n                                              \"name\": \"heartbeat\",\r\n                                              \"frequency\": \"PT1H\"\r\n                                            },\r\n                                            {\r\n                                              \"name\": \"baseline\",\r\n                                              \"frequency\": \"P1D\"\r\n                                            },\r\n                                            {\r\n                                              \"name\": \"antimalware\",\r\n                                              \"frequency\": \"P1D\"\r\n                                            },\r\n                                            {\r\n                                              \"name\": \"processinvestigator\",\r\n                                              \"frequency\": \"PT1H\"\r\n                                            }\r\n                                          ]\r\n                                        }\r\n                                      }\r\n                                    ]\r\n                                  },\r\n                                  \"destinations\": {\r\n                                    \"logAnalytics\": [\r\n                                      {\r\n                                        \"workspaceResourceId\": \"[resourceId('Microsoft.OperationalInsights/workspaces/', parameters('workspaceName'))]\",\r\n                                        \"name\": \"LogAnalyticsDest\"\r\n                                      }\r\n                                    ]\r\n                                  },\r\n                                  \"dataFlows\": [\r\n                                    {\r\n                                      \"streams\": [\r\n                                        \"Microsoft-Syslog\",\r\n                                        \"Microsoft-OperationLog\",\r\n                                        \"Microsoft-SecurityBaseline\",\r\n                                        \"Microsoft-SecurityBaselineSummary\",\r\n                                        \"Microsoft-RomeDetectionEvent\",\r\n                                        \"Microsoft-ProcessInvestigator\",\r\n                                        \"Microsoft-Auditd\",\r\n                                        \"Microsoft-ProtectionStatus\",\r\n                                        \"Microsoft-Heartbeat\"\r\n                                      ],\r\n                                      \"destinations\": [\r\n                                        \"LogAnalyticsDest\"\r\n                                      ]\r\n                                    }\r\n                                  ]\r\n                                }\r\n                              }\r\n                            ]\r\n                          }\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[resourceId('Microsoft.Resources/resourceGroups', variables('defaultRGName'))]\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('deployDataCollectionRulesAssociation')]\",\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"resourceGroup\": \"[parameters('resourceGroup')]\",\r\n                        \"dependsOn\": [\r\n                          \"[variables('deployDefaultAscResourceGroup')]\"\r\n                        ],\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"vmName\": {\r\n                              \"value\": \"[parameters('vmName')]\"\r\n                            },\r\n                            \"dcrId\": {\r\n                              \"value\": \"[variables('dcrId')]\"\r\n                            },\r\n                            \"dcraName\": {\r\n                              \"value\": \"[variables('dcraName')]\"\r\n                            }\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"location\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"vmName\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"dcrId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"dcraName\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"variables\": {},\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.Compute/virtualMachines/providers/dataCollectionRuleAssociations\",\r\n                                \"name\": \"[parameters('dcraName')]\",\r\n                                \"apiVersion\": \"2019-11-01-preview\",\r\n                                \"properties\": {\r\n                                  \"description\": \"Association of data collection rule for Azure Security Center. Deleting this association will break the detection of security vulnerabilities for this virtual machine.\",\r\n                                  \"dataCollectionRuleId\": \"[parameters('dcrId')]\"\r\n                                }\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1537496a-b1e8-482b-a06a-1cc2415cdc7b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1537496a-b1e8-482b-a06a-1cc2415cdc7b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1157 - Plan Of Action And Milestones\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1157\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/15495367-cf68-464c-bbc3-f53ca5227b7a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"15495367-cf68-464c-bbc3-f53ca5227b7a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1491 - Security Planning Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1491\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1571dd40-dafc-4ef4-8f55-16eba27efc7b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1571dd40-dafc-4ef4-8f55-16eba27efc7b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1564 - System Development Life Cycle\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1564\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/157f0ef9-143f-496d-b8f9-f8c8eeaad801\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"157f0ef9-143f-496d-b8f9-f8c8eeaad801\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that do not have a minimum password age of 1 day\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have a minimum password age of 1 day. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"2.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordAge\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"MinimumPasswordAge\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16390df4-2f73-4b42-af13-c801066763df\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1662 - Fail In Known State\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1662\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/165cb91f-7ea8-4ab7-beaf-8636b98c9d15\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"165cb91f-7ea8-4ab7-beaf-8636b98c9d15\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1684 - Information System Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1684\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16bfdb59-db38-47a5-88a9-2e9371a638cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16bfdb59-db38-47a5-88a9-2e9371a638cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs that do not have the specified Windows PowerShell modules installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have the specified Windows PowerShell modules installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsPowerShellModules\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16f9b37c-4408-4c30-bc17-254958f2e2d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1103 - Audit Events\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1103\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16feeb31-6377-437e-bbab-d7f73911896d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16feeb31-6377-437e-bbab-d7f73911896d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1007 - Account Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1007\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17200329-bf6c-46d8-ac6d-abf4641c2add\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17200329-bf6c-46d8-ac6d-abf4641c2add\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1349 - Identification And Authentication (Non-Org. Users) | Use Of FICAM-Approved Products\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1349\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17641f70-94cd-4a5d-a613-3d1143e20e34\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17641f70-94cd-4a5d-a613-3d1143e20e34\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy associations for a managed application\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys an association resource that associates selected resource types to the specified managed application.  This policy deployment does not support nested resource types.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Managed Application\"\r\n        },\r\n        \"parameters\": {\r\n          \"targetManagedApplicationId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Managed application ID\",\r\n              \"description\": \"Resource ID of the managed application to which resources need to be associated.\"\r\n            }\r\n          },\r\n          \"resourceTypesToAssociate\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource types to associate\",\r\n              \"description\": \"The list of resource types to be associated to the managed application.\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          },\r\n          \"associationNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Association name prefix\",\r\n              \"description\": \"Prefix to be added to the name of the association resource being created.\"\r\n            },\r\n            \"defaultValue\": \"DeployedByPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('resourceTypesToAssociate')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.CustomProviders/Associations\",\r\n              \"name\": \"[concat(parameters('associationNamePrefix'), '-', uniqueString(parameters('targetManagedApplicationId')))]\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"associatedResourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"resourceTypesToAssociate\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"targetManagedApplicationId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"associationNamePrefix\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"resourceType\": \"[concat(parameters('resourceTypesToAssociate'), '/providers/associations')]\",\r\n                      \"resourceName\": \"[concat(parameters('associatedResourceName'), '/microsoft.customproviders/', parameters('associationNamePrefix'), '-', uniqueString(parameters('targetManagedApplicationId')))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[concat(deployment().Name, '-2')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"[variables('resourceType')]\",\r\n                                \"name\": \"[variables('resourceName')]\",\r\n                                \"apiVersion\": \"2018-09-01-preview\",\r\n                                \"properties\": {\r\n                                  \"targetResourceId\": \"[parameters('targetManagedApplicationId')]\"\r\n                                }\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"resourceTypesToAssociate\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"associatedResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"targetManagedApplicationId\": {\r\n                      \"value\": \"[parameters('targetManagedApplicationId')]\"\r\n                    },\r\n                    \"associationNamePrefix\": {\r\n                      \"value\": \"[parameters('associationNamePrefix')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17763ad9-70c0-4794-9397-53d765932634\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17763ad9-70c0-4794-9397-53d765932634\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[ASC Private Preview] Deploy - Configure system-assigned managed identity to enable Azure Monitor assignments on VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"[ASC Private Preview] Configure system-assigned managed identity to virtual machines hosted in Azure that are supported by Azure Monitor that do not have a system-assigned managed identity. A system-assigned managed identity is a prerequisite for all Azure Monitor assignments and must be added to machines before using any Azure Monitor extension. Target virtual machines must be in a supported location.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\",\r\n          \"version\": \"1.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"australiacentral\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"eastasia\",\r\n                  \"eastus2euap\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"germanywestcentral\",\r\n                  \"japaneast\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"southcentralus\",\r\n                  \"southeastasia\",\r\n                  \"uksouth\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westus\",\r\n                  \"westus2\"\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"12*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"14.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18.04*LTS\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"9\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"debian-10\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"10\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"[requestContext().apiVersion]\",\r\n                \"greaterOrEquals\": \"2018-10-01\"\r\n              },\r\n              {\r\n                \"field\": \"identity.type\",\r\n                \"notContains\": \"SystemAssigned\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"modify\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/99980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"identity.type\",\r\n                  \"value\": \"[if(contains(field('identity.type'), 'UserAssigned'), concat(field('identity.type'), ',SystemAssigned'), 'SystemAssigned')]\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17b3de92-f710-4cf4-aa55-0e7859f1ed7b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17b3de92-f710-4cf4-aa55-0e7859f1ed7b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Transparent Data Encryption on SQL databases should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Transparent data encryption should be enabled to protect data-at-rest and meet compliance requirements\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers/databases\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"master\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                    \"equals\": \"enabled\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17k78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1325 - Authenticator Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1325\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1845796a-7581-49b2-ae20-443121538e19\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1845796a-7581-49b2-ae20-443121538e19\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1480 - Temperature And Humidity Controls\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1480\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/18a767cc-1947-4338-a240-bc058c81164f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"18a767cc-1947-4338-a240-bc058c81164f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Bring your own key data protection should be enabled for PostgreSQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DBforPostgreSQL/servers/keys\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.DBforPostgreSQL/servers/keys/serverKeyType\",\r\n                    \"equals\": \"AzureKeyVault\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DBforPostgreSQL/servers/keys/uri\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DBforPostgreSQL/servers/keys/uri\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"18adea5e-f416-4d0f-8aa8-d24321e3e274\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1369 - Incident Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1369\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/18cc35ed-a429-486d-8d59-cb47e87304ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"18cc35ed-a429-486d-8d59-cb47e87304ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1269 - Alternate Storage Site | Separation From Primary Site\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1269\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/19b9439d-865d-4474-b17d-97d2702fdb66\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"19b9439d-865d-4474-b17d-97d2702fdb66\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'System Audit Policies - Logon-Logoff'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Logon-Logoff' for auditing IPSec, network policy, claims, account lockout, group membership, and logon/logoff events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SystemAuditPoliciesLogonLogoff\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"AuditGroupMembership\": \"Audit Group Membership;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"AuditGroupMembership\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Group Membership\",\r\n              \"description\": \"Specifies whether audit events are generated when group memberships are enumerated on the client computer.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"Success\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesLogonLogoff\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Audit Group Membership;ExpectedValue', '=', parameters('AuditGroupMembership')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/19be9779-c776-4dfa-8a15-a2fd5dc843d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"19be9779-c776-4dfa-8a15-a2fd5dc843d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1071 - Wireless Access | Restrict Configurations By Users\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1071\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1a437f5b-9ad6-4f28-8861-de404d511ae4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1a437f5b-9ad6-4f28-8861-de404d511ae4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Monitor log profile should collect logs for categories 'write,' 'delete,' and 'action'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy ensures that a log profile collects logs for categories 'write,' 'delete,' and 'action'\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/logprofiles\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/categories[*]\",\r\n                      \"notEquals\": \"Write\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/categories[*]\",\r\n                      \"notEquals\": \"Delete\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/categories[*]\",\r\n                      \"notEquals\": \"Action\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1a4e592a-6a6e-44a5-9814-e36264ca96e7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1a4e592a-6a6e-44a5-9814-e36264ca96e7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Access to App Services should be restricted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure security center has discovered that the networking configuration of some of your app services are overly permissive and allow inbound traffic from ranges that are too broad\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Web/sites\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"restrictAccessToAppServices\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1a833ff1-d297-4a0f-9944-888428f8e0ff\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerability assessment should be enabled on SQL Managed Instance\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit each SQL Managed Instance which doesn't have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/vulnerabilityAssessments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/managedInstances/vulnerabilityAssessments/recurringScans.isEnabled\",\r\n                \"equals\": \"True\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1b7aa243-30e4-4c9e-bca8-d0d3022b634a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Public network access on Azure SQL Database should be disabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling the public network access property improves security by ensuring your Azure SQL Database can only be accessed from a private endpoint. This configuration denies all logins that match IP or virtual network based firewall rules.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/servers/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1b8ca024-1d5c-4dec-8995-b1a932b41780\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure that 'PHP version' is the latest, if used as a part of the API app\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Periodically, newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for API apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"PHPLatestVersion\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Latest PHP version\",\r\n              \"description\": \"Latest supported PHP version for App Services\"\r\n            },\r\n            \"defaultValue\": \"7.3\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"*api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"linux\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/web.linuxFxVersion\",\r\n                    \"notContains\": \"PHP\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/web.linuxFxVersion\",\r\n                    \"equals\": \"[concat('PHP|', parameters('PHPLatestVersion'))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Dependency agent for Windows virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Dependency agent for Windows virtual machines if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.3.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"DependencyAgentWindows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"DependencyAgentWindows\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                      \"vmExtensionType\": \"DependencyAgentWindows\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"9.6\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1c210e94-a481-4beb-95fa-1571b434fb04\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1072 - Wireless Access | Antennas / Transmission Power Levels\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1072\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1ca29e41-34ec-4e70-aba9-6248aca18c31\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1ca29e41-34ec-4e70-aba9-6248aca18c31\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1656 - Secure Name / Address Resolution Service (Authoritative Source)\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1656\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1cb067d5-c8b5-4113-a7ee-0a493633924b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1cb067d5-c8b5-4113-a7ee-0a493633924b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1592 - External Information System Services | Consistent Interests Of Consumers And Providers\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1592\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d01ba6c-289f-42fd-a408-494b355b6222\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d01ba6c-289f-42fd-a408-494b355b6222\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1088 - Security Awareness And Training Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Awareness and Training control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1088\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d50f99d-1356-49c0-934a-45f742ba7783\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d50f99d-1356-49c0-934a-45f742ba7783\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy GitOps to Kubernetes cluster\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy deploys a 'sourceControlConfiguration' to Kubernetes clusters to assure that the clusters get their source of truth from the defined git repo. For instructions on using this policy, visit https://aka.ms/K8sGitOpsPolicy.\",\r\n        \"metadata\": {\r\n          \"preview\": true,\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"Kubernetes\"\r\n        },\r\n        \"parameters\": {\r\n          \"configurationResourceName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Configuration resource name\",\r\n              \"description\": \"The name for the sourceControlConfiguration.  Learn more about setting up GitOps configuration: https://aka.ms/AzureArcK8sUsingGitOps.\"\r\n            }\r\n          },\r\n          \"operatorInstanceName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Operator instance name\",\r\n              \"description\": \"The name of the operator associated with this configuration. The instance name can contain up to 353 lower-case alphanumeric characters, hyphen, or period. If enableHelmOperator is true, then operatorInstanceName + operatorNamespace strings cannot exceed 47 characters combined.\"\r\n            }\r\n          },\r\n          \"operatorNamespace\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Operator namespace\",\r\n              \"description\": \"The namespace to use for the configuration operator. The namespace can contain up to 353 lower-case alphanumeric characters, hyphen, or period. If enableHelmOperator is true, then operatorInstanceName + operatorNamespace strings cannot exceed 47 characters combined.\"\r\n            }\r\n          },\r\n          \"operatorScope\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Operator scope\",\r\n              \"description\": \"The permission scope for the operator. Possible values are 'cluster' (full access) or 'namespace' (restricted access).\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"cluster\",\r\n              \"namespace\"\r\n            ],\r\n            \"defaultValue\": \"namespace\"\r\n          },\r\n          \"operatorType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Operator type\",\r\n              \"description\": \"The type of operator to install. Currently, 'Flux' is supported.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Flux\"\r\n            ],\r\n            \"defaultValue\": \"Flux\"\r\n          },\r\n          \"operatorParams\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Operator parameters\",\r\n              \"description\": \"Parameters to set on the Flux operator, separated by spaces.  For example, --git-readonly --git-path=namespaces,workloads.  Learn more: http://aka.ms/AzureArcK8sFluxOperatorParams.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"repositoryUrl\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Repository Url\",\r\n              \"description\": \"The URL for the source control repository. Private repo: git@github.com:Contoso/cluster-config\"\r\n            }\r\n          },\r\n          \"enableHelmOperator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Enable Helm\",\r\n              \"description\": \"Indicate whether to enable Helm for this instance of Flux.  Learn more: http://aka.ms/AzureArcK8sGitOpsWithHelm.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"true\"\r\n          },\r\n          \"chartVersion\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Helm chart version for installing Flux Helm\",\r\n              \"description\": \"The version of the Helm chart for installing Flux Helm.  For example, 0.6.0\"\r\n            },\r\n            \"defaultValue\": \"0.6.0\"\r\n          },\r\n          \"chartValues\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Helm chart parameters for installing Flux Helm\",\r\n              \"description\": \"Parameters for the Helm chart for installing Flux Helm, separated by spaces.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Kubernetes/connectedClusters\",\r\n              \"Microsoft.ContainerService/managedClusters\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations\",\r\n              \"name\": \"[parameters('configurationResourceName')]\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deploymentScope\": \"ResourceGroup\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/operatorParams\",\r\n                    \"in\": [\r\n                      \"--git-readonly\",\r\n                      \"[parameters('operatorParams')]\",\r\n                      \"[concat('--git-readonly ',parameters('operatorParams'))]\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/repositoryUrl\",\r\n                    \"equals\": \"[parameters('repositoryUrl')]\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/enableHelmOperator\",\r\n                        \"equals\": \"false\"\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/enableHelmOperator\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/helmOperatorProperties.chartVersion\",\r\n                            \"equals\": \"[parameters('chartVersion')]\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/helmOperatorProperties.chartValues\",\r\n                            \"equals\": \"[parameters('chartValues')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"configurationResourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"clusterLocation\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"clusterName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorInstanceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorNamespace\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorScope\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorType\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorParams\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"repositoryUrl\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"enableHelmOperator\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"chartVersion\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"chartValues\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"clusterResourceType\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[contains(parameters('clusterResourceType'), 'connectedclusters')]\",\r\n                        \"type\": \"Microsoft.Kubernetes/connectedClusters/providers/sourceControlConfigurations\",\r\n                        \"name\": \"[concat(parameters('clusterName'), '/Microsoft.KubernetesConfiguration/', parameters('configurationResourceName'))]\",\r\n                        \"apiVersion\": \"2019-11-01-preview\",\r\n                        \"properties\": {\r\n                          \"operatorInstanceName\": \"[parameters('operatorInstanceName')]\",\r\n                          \"operatorNamespace\": \"[parameters('operatorNamespace')]\",\r\n                          \"operatorScope\": \"[parameters('operatorScope')]\",\r\n                          \"operatorType\": \"[parameters('operatorType')]\",\r\n                          \"operatorParams\": \"[parameters('operatorParams')]\",\r\n                          \"repositoryUrl\": \"[parameters('repositoryUrl')]\",\r\n                          \"enableHelmOperator\": \"[parameters('enableHelmOperator')]\",\r\n                          \"helmOperatorProperties\": {\r\n                            \"chartVersion\": \"[parameters('chartVersion')]\",\r\n                            \"chartValues\": \"[parameters('chartValues')]\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[contains(parameters('clusterResourceType'), 'managedclusters')]\",\r\n                        \"type\": \"Microsoft.ContainerService/managedClusters/providers/sourceControlConfigurations\",\r\n                        \"name\": \"[concat(parameters('clusterName'), '/Microsoft.KubernetesConfiguration/', parameters('configurationResourceName'))]\",\r\n                        \"apiVersion\": \"2019-11-01-preview\",\r\n                        \"properties\": {\r\n                          \"operatorInstanceName\": \"[parameters('operatorInstanceName')]\",\r\n                          \"operatorNamespace\": \"[parameters('operatorNamespace')]\",\r\n                          \"operatorScope\": \"[parameters('operatorScope')]\",\r\n                          \"operatorType\": \"[parameters('operatorType')]\",\r\n                          \"operatorParams\": \"[parameters('operatorParams')]\",\r\n                          \"repositoryUrl\": \"[parameters('repositoryUrl')]\",\r\n                          \"enableHelmOperator\": \"[parameters('enableHelmOperator')]\",\r\n                          \"helmOperatorProperties\": {\r\n                            \"chartVersion\": \"[parameters('chartVersion')]\",\r\n                            \"chartValues\": \"[parameters('chartValues')]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"clusterLocation\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"clusterName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"configurationResourceName\": {\r\n                      \"value\": \"[parameters('configurationResourceName')]\"\r\n                    },\r\n                    \"operatorInstanceName\": {\r\n                      \"value\": \"[parameters('operatorInstanceName')]\"\r\n                    },\r\n                    \"operatorNamespace\": {\r\n                      \"value\": \"[parameters('operatorNamespace')]\"\r\n                    },\r\n                    \"operatorScope\": {\r\n                      \"value\": \"[parameters('operatorScope')]\"\r\n                    },\r\n                    \"operatorType\": {\r\n                      \"value\": \"[parameters('operatorType')]\"\r\n                    },\r\n                    \"operatorParams\": {\r\n                      \"value\": \"[parameters('operatorParams')]\"\r\n                    },\r\n                    \"repositoryUrl\": {\r\n                      \"value\": \"[parameters('repositoryUrl')]\"\r\n                    },\r\n                    \"enableHelmOperator\": {\r\n                      \"value\": \"[parameters('enableHelmOperator')]\"\r\n                    },\r\n                    \"chartVersion\": {\r\n                      \"value\": \"[parameters('chartVersion')]\"\r\n                    },\r\n                    \"chartValues\": {\r\n                      \"value\": \"[parameters('chartValues')]\"\r\n                    },\r\n                    \"clusterResourceType\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d61c4d2-aef2-432b-87fc-7f96b019b7e1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d61c4d2-aef2-432b-87fc-7f96b019b7e1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1538 - Security Categorization\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1538\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d7658b2-e827-49c3-a2ae-6d2bd0b45874\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d7658b2-e827-49c3-a2ae-6d2bd0b45874\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Virtual machines should be migrated to new Azure Resource Manager resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use new Azure Resource Manager for your virtual machines to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.ClassicCompute/virtualMachines\",\r\n                  \"Microsoft.Compute/virtualMachines\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"[field('type')]\",\r\n                \"equals\": \"Microsoft.ClassicCompute/virtualMachines\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d84d5fb-01f6-4d12-ba4f-4a26081d403d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1298 - Identification And Authentication Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1298\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1dc784b5-4895-4d27-9d40-a06b032bd1ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1dc784b5-4895-4d27-9d40-a06b032bd1ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported .NET Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported .NET Framework version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestDotNet\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1de7b11d-1870-41a5-8181-507e7c663cfb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1595 - Developer Configuration Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1595\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e0414e7-6ef5-4182-8076-aa82fbb53341\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e0414e7-6ef5-4182-8076-aa82fbb53341\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require a tag and its value on resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enforces a required tag and its value. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Tags\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e30110a-5ceb-460c-a204-c1c3969c6d62\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Key vaults should have soft delete enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deleting a key vault without soft delete enabled permanently deletes all secrets, keys, and certificates stored in the key vault. Accidental deletion of a key vault can lead to permanent data loss. Soft delete allows you to recover an accidently deleted key vault for a configurable retention period.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Key Vault\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/vaults\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure API for FHIR should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure API for FHIR should have at least one approved private endpoint connection. Clients in a virtual network can securely access resources that have private endpoint connections through private links. For more information, visit: https://aka.ms/fhir-privatelink.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"API for FHIR\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HealthcareApis/services\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.HealthcareApis/services/privateEndpointConnections[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.HealthcareApis/services/privateEndpointConnections[*].privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1ee56206-5dd1-42ab-b02d-8aae8b1634ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1ee56206-5dd1-42ab-b02d-8aae8b1634ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"An Azure Active Directory administrator should be provisioned for SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit provisioning of an Azure Active Directory administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/administrators\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f314764-cb73-4fc9-b863-8eca98ac36e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Event Hub to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Event Hub to stream to a regional Log Analytics workspace when any Event Hub which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.EventHub/namespaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.EventHub/namespaces/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"ArchiveLogs\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            },\r\n                            {\r\n                              \"category\": \"OperationalLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"AutoScaleLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"KafkaCoordinatorLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"KafkaUserErrorLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"EventHubVNetConnectionEvent\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"CustomerManagedKeyUserLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f6e93e8-6b31-41b1-83f6-36e449a42579\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'Security Options - Shutdown'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - Shutdown'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Shutdown: Allow system to be shut down without having to log on\",\r\n              \"description\": \"Specifies whether a computer can be shut down when a user is not logged on. If this policy setting is enabled, the shutdown command is available on the Windows logon screen.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"ShutdownClearVirtualMemoryPagefile\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Shutdown: Clear virtual memory pagefile\",\r\n              \"description\": \"Specifies whether the virtual memory pagefile is cleared when the system is shut down. When this policy setting is enabled, the system pagefile is cleared each time that the system shuts down properly. For systems with large amounts of RAM, this could result in substantial time needed to complete the shutdown.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsShutdown\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('Shutdown: Allow system to be shut down without having to log on;ExpectedValue', '=', parameters('ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn'), ',', 'Shutdown: Clear virtual memory pagefile;ExpectedValue', '=', parameters('ShutdownClearVirtualMemoryPagefile')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SecurityOptionsShutdown\"\r\n                    },\r\n                    \"ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\": {\r\n                      \"value\": \"[parameters('ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn')]\"\r\n                    },\r\n                    \"ShutdownClearVirtualMemoryPagefile\": {\r\n                      \"value\": \"[parameters('ShutdownClearVirtualMemoryPagefile')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ShutdownClearVirtualMemoryPagefile\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Shutdown: Allow system to be shut down without having to log on;ExpectedValue\",\r\n                                \"value\": \"[parameters('ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Shutdown: Clear virtual memory pagefile;ExpectedValue\",\r\n                                \"value\": \"[parameters('ShutdownClearVirtualMemoryPagefile')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Shutdown: Allow system to be shut down without having to log on;ExpectedValue\",\r\n                                \"value\": \"[parameters('ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Shutdown: Clear virtual memory pagefile;ExpectedValue\",\r\n                                \"value\": \"[parameters('ShutdownClearVirtualMemoryPagefile')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f8c20ce-3414-4496-8b26-0e902a1541da\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f8c20ce-3414-4496-8b26-0e902a1541da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys (CMK) are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/cosmosdb-cmk.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Cosmos DB\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The desired effect of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/keyVaultKeyUri\",\r\n                \"exists\": false\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f905d99-2ab7-462c-a6b0-f709acca6c8f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure HDInsight clusters should use encryption at host to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enabling encryption at host helps protect and safeguard your data to meet your organizational security and compliance commitments. When you enable encryption at host, data stored on the VM host is encrypted at rest and flows encrypted to the Storage service.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"HDInsight\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HDInsight/clusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.HDInsight/clusters/diskEncryptionProperties.encryptionAtHost\",\r\n                    \"exists\": false\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HDInsight/clusters/diskEncryptionProperties.encryptionAtHost\",\r\n                    \"equals\": false\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1616 - System And Communications Protection Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1616\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2006457a-48b3-4f7b-8d2e-1532287f9929\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2006457a-48b3-4f7b-8d2e-1532287f9929\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1650 - Public Key Infrastructure Certificates\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1650\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/201d3740-bd16-4baf-b4b8-7cda352228b7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"201d3740-bd16-4baf-b4b8-7cda352228b7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Web ports should be restricted on Network Security Groups associated to your VM\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure security center has discovered that some of your virtual machines are running web applications, and the NSGs associated to these virtual machines are overly permissive with regards to the web application ports\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"201ea587-7c90-41c3-910f-c280ae01cfd6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"VM Image Builder templates should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit VM Image Builder templates that do not have a virtual network configured. When a virtual network is not configured, a public IP is created and used instead which may directly expose resources to the internet and increase the potential attack surface.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"VM Image Builder\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.VirtualMachineImages/imageTemplates\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.VirtualMachineImages/imageTemplates/vmProfile.vnetConfig\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2154edb9-244f-4741-9970-660785bccdaa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2154edb9-244f-4741-9970-660785bccdaa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1181 - Baseline Configuration | Retention Of Previous Configurations\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1181\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21839937-d241-4fa5-95c6-b669253d9ab9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21839937-d241-4fa5-95c6-b669253d9ab9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1111 - Response To Audit Processing Failures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1111\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21de687c-f15e-4e51-bf8d-f35c8619965b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21de687c-f15e-4e51-bf8d-f35c8619965b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1596 - Developer Configuration Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1596\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21e25e01-0ae0-41be-919e-04ce92b8e8b8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21e25e01-0ae0-41be-919e-04ce92b8e8b8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs configurations in 'Security Options - Audit'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - Audit'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsAudit\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21e2995e-683e-497a-9e81-2f42ad07050a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21e2995e-683e-497a-9e81-2f42ad07050a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1426 - Media Protection Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1426\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21f639bc-f42b-46b1-8f40-7a2a389c291a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21f639bc-f42b-46b1-8f40-7a2a389c291a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Apps that are not using custom domains\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use of custom domains protects a API app from common attacks such as phishing and other DNS-related attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UsedCustomDomains\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"224da9fe-0d38-4e79-adb3-0a6e2af942ac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1399 - Controlled Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1399\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2256e638-eb23-480f-9e15-6cf1af0a76b3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2256e638-eb23-480f-9e15-6cf1af0a76b3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1221 - Least Functionality | Authorized Software / Whitelisting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1221\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22589a07-0007-486a-86ca-95355081ae2a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22589a07-0007-486a-86ca-95355081ae2a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs configurations in 'System Audit Policies - Account Management'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: 'System Audit Policies - Account Management'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesAccountManagement\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/225e937e-d32e-4713-ab74-13ce95b3519a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"225e937e-d32e-4713-ab74-13ce95b3519a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Management ports should be closed on your virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Open remote management ports are exposing your VM to a high level of risk from Internet-based attacks. These attacks attempt to brute force credentials to gain admin access to the machine.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"bc303248-3d14-44c2-96a0-55f5c326b5fe\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22730e10-96f6-4aac-ad84-9383d35b5917\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1493 - System Security Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1493\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22b469b3-fccf-42da-aa3b-a28e6fb113ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22b469b3-fccf-42da-aa3b-a28e6fb113ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Only secure connections to your Azure Cache for Redis should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cache\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Cache/redis\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Cache/Redis/enableNonSslPort\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22bee202-a82f-4305-9a2a-6d7f44d4dedb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that do not restrict the minimum password length to 14 characters\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not restrict the minimum password length to 14 characters. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"2.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordLength\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"MinimumPasswordLength\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"23020aa6-1135-4be2-bae2-149982b06eca\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1256 - Contingency Plan | Identify Critical Assets\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1256\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/232ab24b-810b-4640-9019-74a7d0d6a980\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"232ab24b-810b-4640-9019-74a7d0d6a980\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Service Bus should use a virtual network service endpoint\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy audits any Service Bus not configured to use a virtual network service endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ServiceBus/namespaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.ServiceBus/namespaces/virtualNetworkRules\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.ServiceBus/namespaces/virtualNetworkRules/virtualNetworkSubnetId\",\r\n                \"exists\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/235359c5-7c52-4b82-9055-01c75cf9f60e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"235359c5-7c52-4b82-9055-01c75cf9f60e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines that do not have a minimum password age of 1 day\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not have a minimum password age of 1 day\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"MinimumPasswordAge\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordAge\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/237b38db-ca4d-4259-9e47-7882441ca2c0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"237b38db-ca4d-4259-9e47-7882441ca2c0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Stream Analytics to stream to a regional Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.StreamAnalytics/streamingjobs\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"Execution\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Authoring\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"237e0f7e-b0e8-4ec4-ad46-8c12cb66d673\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1268 - Alternate Storage Site\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1268\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/23f6e984-3053-4dfc-ab48-543b764781f5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"23f6e984-3053-4dfc-ab48-543b764781f5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1122 - Audit Review, Analysis, And Reporting | Permitted Actions\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1122\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/243ec95e-800c-49d4-ba52-1fdd9f6b8b57\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"243ec95e-800c-49d4-ba52-1fdd9f6b8b57\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1231 - Configuration Management Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1231\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/244e0c05-cc45-4fe7-bf36-42dcf01f457d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"244e0c05-cc45-4fe7-bf36-42dcf01f457d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1082 - Information Sharing\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1082\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/24d480ef-11a0-4b1b-8e70-4e023bf2be23\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24d480ef-11a0-4b1b-8e70-4e023bf2be23\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs that do not have a maximum password age of 70 days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have a maximum password age of 70 days. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MaximumPasswordAge\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24dde96d-f0b1-425e-884f-4a1421e2dcdc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Infrastructure encryption should be enabled for Azure Database for PostgreSQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enable infrastructure encryption for Azure Database for PostgreSQL servers to have higher level of assurance that the data is secure. When infrastructure encryption is enabled, the data at rest is encrypted twice using FIPS 140-2 compliant Microsoft managed keys\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/infrastructureEncryption\",\r\n                \"notEquals\": \"Enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/24fba194-95d6-48c0-aea7-f65bf859c598\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24fba194-95d6-48c0-aea7-f65bf859c598\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Data Lake Storage Gen1 to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Data Lake Storage Gen1 to stream to a regional Log Analytics workspace when any Data Lake Storage Gen1 which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.DataLakeStore/accounts/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"Audit\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Requests\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25763a0a-5783-4f14-969e-79d4933eb74b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"25763a0a-5783-4f14-969e-79d4933eb74b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1372 - Incident Reporting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1372\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25b96717-c912-4c00-9143-4e487f411726\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"25b96717-c912-4c00-9143-4e487f411726\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1038 - Least Privilege | Privileged Accounts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1038\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26692e88-71b7-4a5f-a8ac-9f31dd05bd8e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26692e88-71b7-4a5f-a8ac-9f31dd05bd8e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Endpoint protection solution should be installed on virtual machine scale sets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit the existence and health of an endpoint protection solution on your virtual machines scale sets, to protect them from threats and vulnerabilities.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"e71020c2-860c-3235-cd39-04f3f8c936d2\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26a828e1-e88f-464e-bbb3-c134a282b9de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1649 - Collaborative Computing Devices\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1649\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26d292cc-b0b8-4c29-9337-68abc758bf7b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26d292cc-b0b8-4c29-9337-68abc758bf7b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Metric alert rules should be configured on Batch accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit configuration of metric alert rules on Batch account to enable the required metric\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Batch\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name that an alert rule must be enabled on\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Batch/batchAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/alertRules\",\r\n              \"existenceScope\": \"Subscription\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/alertRules/isEnabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/alertRules/condition.dataSource.metricName\",\r\n                    \"equals\": \"[parameters('metricName')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/alertRules/condition.dataSource.resourceUri\",\r\n                    \"equals\": \"[concat('/subscriptions/', subscription().subscriptionId, '/resourcegroups/', resourceGroup().name, '/providers/Microsoft.Batch/batchAccounts/', field('name'))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enable Automanage - Azure virtual machine best practices\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Automanage enrolls, configures, and monitors virtual machines with Azure VM best practice services. Use this policy to apply Automanage to your selected scope.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Automanage\"\r\n        },\r\n        \"parameters\": {\r\n          \"automanageAccount\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Automanage account\",\r\n              \"description\": \"Select Automanage account from dropdown list. If this account is outside of the scope of the assignment you must manually grant 'Contributor' permissions (or similar) on the account to the policy assignment's principal ID.\",\r\n              \"strongType\": \"Microsoft.Automanage/accounts\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"configurationProfileAssignment\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Configuration profile\",\r\n              \"description\": \"The management services provided are based on whether the machine is intended to be used in a dev/test environment or production.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Azure virtual machine best practices – Production\",\r\n              \"Azure virtual machine best practices – Dev/test\"\r\n            ],\r\n            \"defaultValue\": \"Azure virtual machine best practices – Production\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"eastus\",\r\n                  \"westus2\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"canadacentral\"\r\n                ]\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"notLike\": \"SQL2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                            \"like\": \"Windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"exists\": \"false\"\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"notLike\": \"2008*\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"notLike\": \"SQL2008*\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.Automanage/configurationProfileAssignments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Automanage/configurationProfileAssignments/configurationProfile\",\r\n                    \"equals\": \"[parameters('configurationProfileAssignment')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Automanage/configurationProfileAssignments/accountId\",\r\n                    \"equals\": \"[parameters('automanageAccount')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"machineName\": {\r\n                      \"value\": \"[field('Name')]\"\r\n                    },\r\n                    \"automanageAccount\": {\r\n                      \"value\": \"[parameters('automanageAccount')]\"\r\n                    },\r\n                    \"configurationProfileAssignment\": {\r\n                      \"value\": \"[parameters('configurationProfileAssignment')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"machineName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"automanageAccount\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationProfileAssignment\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/configurationProfileAssignments\",\r\n                        \"apiVersion\": \"2020-06-30-preview\",\r\n                        \"name\": \"[concat(parameters('machineName'), '/Microsoft.Automanage/', 'default')]\",\r\n                        \"properties\": {\r\n                          \"configurationProfile\": \"[parameters('configurationProfileAssignment')]\",\r\n                          \"accountId\": \"[parameters('automanageAccount')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/270610db-8c04-438a-a739-e8e6745b22d3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"270610db-8c04-438a-a739-e8e6745b22d3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1396 - Controlled Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1396\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/276af98f-4ff9-4e69-99fb-c9b2452fb85f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"276af98f-4ff9-4e69-99fb-c9b2452fb85f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1074 - Access Control For Mobile Devices\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1074\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/27a69937-af92-4198-9b86-08d355c7e59a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"27a69937-af92-4198-9b86-08d355c7e59a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1527 - Access Agreements\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1527\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2823de66-332f-4bfd-94a3-3eb036cd3b67\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2823de66-332f-4bfd-94a3-3eb036cd3b67\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy default Microsoft IaaSAntimalware extension for Windows Server\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys a Microsoft IaaSAntimalware extension with a default configuration when a VM is not configured with the antimalware extension.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"MicrosoftWindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"WindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"2008-R2-SP1\",\r\n                  \"2008-R2-SP1-smalldisk\",\r\n                  \"2012-Datacenter\",\r\n                  \"2012-Datacenter-smalldisk\",\r\n                  \"2012-R2-Datacenter\",\r\n                  \"2012-R2-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter\",\r\n                  \"2016-Datacenter-Server-Core\",\r\n                  \"2016-Datacenter-Server-Core-smalldisk\",\r\n                  \"2016-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter-with-Containers\",\r\n                  \"2016-Datacenter-with-RDSH\",\r\n                  \"2019-Datacenter\",\r\n                  \"2019-Datacenter-Core\",\r\n                  \"2019-Datacenter-Core-smalldisk\",\r\n                  \"2019-Datacenter-Core-with-Containers\",\r\n                  \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                  \"2019-Datacenter-smalldisk\",\r\n                  \"2019-Datacenter-with-Containers\",\r\n                  \"2019-Datacenter-with-Containers-smalldisk\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"IaaSAntimalware\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ExclusionsPaths\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file paths or locations to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsExtensions\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file extensions to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsProcesses\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of process names to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"RealtimeProtectionEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not real time protection is enabled (default is true)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsIsEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"false\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not custom scheduled scan settings are enabled (default is false)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsScanType\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Quick\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether scheduled scan setting type is set to Quick or Full (default is Quick)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsDay\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"7\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Day of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsTime\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"120\",\r\n                        \"metadata\": {\r\n                          \"description\": \"When to perform the scheduled scan, measured in minutes from midnight (0-1440). For example: 0 = 12AM, 60 = 1AM, 120 = 2AM.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/IaaSAntimalware')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Security\",\r\n                          \"type\": \"IaaSAntimalware\",\r\n                          \"typeHandlerVersion\": \"1.3\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"AntimalwareEnabled\": true,\r\n                            \"RealtimeProtectionEnabled\": \"[parameters('RealtimeProtectionEnabled')]\",\r\n                            \"ScheduledScanSettings\": {\r\n                              \"isEnabled\": \"[parameters('ScheduledScanSettingsIsEnabled')]\",\r\n                              \"day\": \"[parameters('ScheduledScanSettingsDay')]\",\r\n                              \"time\": \"[parameters('ScheduledScanSettingsTime')]\",\r\n                              \"scanType\": \"[parameters('ScheduledScanSettingsScanType')]\"\r\n                            },\r\n                            \"Exclusions\": {\r\n                              \"Extensions\": \"[parameters('ExclusionsExtensions')]\",\r\n                              \"Paths\": \"[parameters('ExclusionsPaths')]\",\r\n                              \"Processes\": \"[parameters('ExclusionsProcesses')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"RealtimeProtectionEnabled\": {\r\n                      \"value\": \"true\"\r\n                    },\r\n                    \"ScheduledScanSettingsIsEnabled\": {\r\n                      \"value\": \"true\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2835b622-407b-4114-9198-6f7064cbe0dc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1342 - Authenticator Management | Hardware Token-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1342\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/283a4e29-69d5-4c94-b99e-29acf003c899\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"283a4e29-69d5-4c94-b99e-29acf003c899\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1436 - Media Transport\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1436\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28aab8b4-74fd-4b7c-9080-5a7be525d574\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28aab8b4-74fd-4b7c-9080-5a7be525d574\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1224 - Information System Component Inventory | Updates During Installations / Removals\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1224\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28cfa30b-7f72-47ce-ba3b-eed26c8d2c82\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28cfa30b-7f72-47ce-ba3b-eed26c8d2c82\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1148 - Security Assessments | Independent Assessors\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1148\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28e62650-c7c2-4786-bdfa-17edc1673902\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28e62650-c7c2-4786-bdfa-17edc1673902\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1418 - Nonlocal Maintenance | Comparable Security / Sanitization\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1418\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28e633fd-284e-4ea7-88b4-02ca157ed713\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28e633fd-284e-4ea7-88b4-02ca157ed713\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Defender for App Service should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for App Service leverages the scale of the cloud, and the visibility that Azure has as a cloud provider, to monitor for common web app attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.3\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"AppServices\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2913021d-f2fd-4f3d-b958-22354e2bdbcb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1634 - Boundary Protection | Prevent Unauthorized Exfiltration\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1634\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/292a7c44-37fa-4c68-af7c-9d836955ded2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"292a7c44-37fa-4c68-af7c-9d836955ded2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Service Bus Premium namespaces should use a customer-managed key for encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Service Bus supports the option of encrypting data at rest with either Microsoft-managed keys (default) or customer-managed keys. Choosing to encrypt data using customer-managed keys enables you to assign, rotate, disable, and revoke access to the keys that Service Bus will use to encrypt data in your namespace. Note that Service Bus only supports encryption with customer-managed keys for premium namespaces.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Service Bus\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ServiceBus/namespaces\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ServiceBus/namespaces/sku.tier\",\r\n                \"equals\": \"Premium\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.ServiceBus/namespaces/encryption.keySource\",\r\n                  \"equals\": \"Microsoft.Keyvault\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/295fc8b1-dc9f-4f53-9c61-3f313ceab40a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"295fc8b1-dc9f-4f53-9c61-3f313ceab40a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs configurations in 'Security Options - User Account Control'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - User Account Control'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsUserAccountControl\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/29829ec2-489d-4925-81b7-bda06b1718e0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"29829ec2-489d-4925-81b7-bda06b1718e0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append a tag and its value to resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Appends the specified tag and value when any resource which is missing this tag is created or updated. Does not modify the tags of resources created before this policy was applied until those resources are changed. Does not apply to resource groups. New 'modify' effect policies are available that support remediation of tags on existing resources (see https://aka.ms/modifydoc).\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Tags\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a0e14a6-b0a6-4fab-991a-187a4f81c498\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage accounts should restrict network access using virtual network rules\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Protect your storage accounts from potential threats using virtual network rules as a preferred method instead of IP-based filtering. Disabling IP-based filtering prevents public IPs from accessing your storage accounts.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the audit policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\r\n                    \"notEquals\": \"Deny\"\r\n                  },\r\n                  {\r\n                    \"count\": {\r\n                      \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.ipRules[*]\"\r\n                    },\r\n                    \"greaterOrEquals\": 1\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1219 - Least Functionality | Authorized Software / Whitelisting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1219\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a39ac75-622b-4c88-9a3f-45b7373f7ef7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a39ac75-622b-4c88-9a3f-45b7373f7ef7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'System Audit Policies - Policy Change'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Policy Change' for auditing changes to system audit policies. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SystemAuditPoliciesPolicyChange\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"AuditAuthenticationPolicyChange\": \"Audit Authentication Policy Change;ExpectedValue\",\r\n              \"AuditAuthorizationPolicyChange\": \"Audit Authorization Policy Change;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"AuditAuthenticationPolicyChange\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Authentication Policy Change\",\r\n              \"description\": \"Specifies whether audit events are generated when changes are made to authentication policy. This setting is useful for tracking changes in domain-level and forest-level trust and privileges that are granted to user accounts or groups.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"Success\"\r\n          },\r\n          \"AuditAuthorizationPolicyChange\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Authorization Policy Change\",\r\n              \"description\": \"Specifies whether audit events are generated for assignment and removal of user rights in user right policies, changes in security token object permission, resource attributes changes and Central Access Policy changes for file system objects.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"No Auditing\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesPolicyChange\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Audit Authentication Policy Change;ExpectedValue', '=', parameters('AuditAuthenticationPolicyChange'), ',', 'Audit Authorization Policy Change;ExpectedValue', '=', parameters('AuditAuthorizationPolicyChange')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a7a701e-dff3-4da9-9ec5-42cb98594c0b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a7a701e-dff3-4da9-9ec5-42cb98594c0b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1274 - Alternate Processing Site\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1274\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2aee175f-cd16-4825-939a-a85349d96210\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2aee175f-cd16-4825-939a-a85349d96210\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1603 - Developer Security Testing And Evaluation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1603\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2b909c26-162f-47ce-8e15-0c1f55632eac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b909c26-162f-47ce-8e15-0c1f55632eac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Managed identity should be used in your Web App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use a managed identity for enhanced authentication security\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"app*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/managedServiceIdentityId\",\r\n                \"exists\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b9ad585-36bc-4615-b300-fd4435808332\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cognitive Services accounts should enable data encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy audits any Cognitive Services account not using data encryption. For each Cognitive Services account with storage, should enable data encryption with either customer managed or Microsoft managed key.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cognitive Services\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/encryption.keySource\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2bdd0062-9d75-436e-89df-487dd8e4b3c7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2bdd0062-9d75-436e-89df-487dd8e4b3c7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1434 - Media Transport\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1434\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c18f06b-a68d-41c3-8863-b8cd3acb5f8f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c18f06b-a68d-41c3-8863-b8cd3acb5f8f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1343 - Authenticator Management | Expiration Of Cached Authenticators\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1343\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c251a55-31eb-4e53-99c6-e9c43c393ac2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c251a55-31eb-4e53-99c6-e9c43c393ac2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1388 - Information Spillage Response\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1388\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c7c575a-d4c5-4f6f-bd49-dee97a8cba55\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c7c575a-d4c5-4f6f-bd49-dee97a8cba55\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1344 - Authenticator Feedback\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1344\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c895fe7-2d8e-43a2-838c-3a533a5b355e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c895fe7-2d8e-43a2-838c-3a533a5b355e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SSH access from the Internet should be blocked\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits any network security rule that allows SSH access from Internet\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"equals\": \"*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"equals\": \"22\"\r\n                      },\r\n                      {\r\n                        \"value\": \"[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),22),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),22)), 'false')]\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"count\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"where\": {\r\n                            \"value\": \"[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),22),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),22)) , 'false')]\",\r\n                            \"equals\": \"true\"\r\n                          }\r\n                        },\r\n                        \"greater\": 0\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notEquals\": \"*\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notEquals\": \"22\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"equals\": \"*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"equals\": \"Internet\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                          \"notEquals\": \"*\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                          \"notEquals\": \"Internet\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fab\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c89a2e5-7285-40fe-afe0-ae8654b92fab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Unattached disks should be encrypted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy audits any unattached disk without encryption enabled.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/disks\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/disks/diskState\",\r\n                \"equals\": \"Unattached\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/disks/encryptionSettingsCollection.enabled\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/disks/encryptionSettingsCollection.enabled\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fb2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c89a2e5-7285-40fe-afe0-ae8654b92fb2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1593 - External Information System Services | Processing, Storage, And Service Location\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1593\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2cd0a426-b5f5-4fe0-9539-a6043cdbc6fa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2cd0a426-b5f5-4fe0-9539-a6043cdbc6fa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1546 - Vulnerability Scanning\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1546\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2ce1ea7e-4038-4e53-82f4-63e8859333c1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2ce1ea7e-4038-4e53-82f4-63e8859333c1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1414 - Nonlocal Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1414\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2ce63a52-e47b-4ae2-adbb-6e40d967f9e6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2ce63a52-e47b-4ae2-adbb-6e40d967f9e6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1679 - Malicious Code Protection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1679\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2cf42a28-193e-41c5-98df-7688e7ef0a88\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2cf42a28-193e-41c5-98df-7688e7ef0a88\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1068 - Wireless Access\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1068\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d045bca-a0fd-452e-9f41-4ec33769717c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d045bca-a0fd-452e-9f41-4ec33769717c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"App Service should use a virtual network service endpoint\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy audits any App Service not configured to use a virtual network service endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"app*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/virtualNetworkConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/virtualnetworkconnections/vnetResourceId\",\r\n                \"exists\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d21331d-a4c2-4def-a9ad-ee4e1e023beb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d21331d-a4c2-4def-a9ad-ee4e1e023beb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1704 - Security Alerts, Advisories, And Directives\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1704\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d44b6fa-1134-4ea6-ad4e-9edb68f65429\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d44b6fa-1134-4ea6-ad4e-9edb68f65429\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs that do not store passwords using reversible encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not store passwords using reversible encryption. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"StorePasswordsUsingReversibleEncryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d60d3b7-aa10-454c-88a8-de39d99d17c6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Linux VMs that allow remote connections from accounts without passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that allow remote connections from accounts without passwords. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"microsoft-aks\",\r\n                          \"qubole-inc\",\r\n                          \"datastax\",\r\n                          \"couchbase\",\r\n                          \"scalegrid\",\r\n                          \"checkpoint\",\r\n                          \"paloaltonetworks\",\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"OpenLogic\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"CentOS*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Oracle\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Oracle-Linux\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"RHEL\",\r\n                              \"RHEL-HA\",\r\n                              \"RHEL-SAP\",\r\n                              \"RHEL-SAP-APPS\",\r\n                              \"RHEL-SAP-HA\",\r\n                              \"RHEL-SAP-HANA\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"osa\",\r\n                              \"rhel-byos\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"cis-centos-7-l1\",\r\n                              \"cis-centos-7-v2-1-1-l1\",\r\n                              \"cis-centos-8-l1\",\r\n                              \"cis-debian-linux-8-l1\",\r\n                              \"cis-debian-linux-9-l1\",\r\n                              \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                              \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                              \"cis-oracle-linux-8-l1\",\r\n                              \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                              \"cis-rhel-7-l2\",\r\n                              \"cis-rhel-7-v2-2-0-l1\",\r\n                              \"cis-rhel-8-l1\",\r\n                              \"cis-suse-linux-12-v2-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1804-l1\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"credativ\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Debian\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"7*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Suse\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"SLES*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"11*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Canonical\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"UbuntuServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"12*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"linux-data-science-vm-ubuntu\",\r\n                              \"azureml\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-centos-os\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-altus-centos-os\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Linux*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"notIn\": [\r\n                                  \"OpenLogic\",\r\n                                  \"RedHat\",\r\n                                  \"credativ\",\r\n                                  \"Suse\",\r\n                                  \"Canonical\",\r\n                                  \"microsoft-dsvm\",\r\n                                  \"cloudera\",\r\n                                  \"microsoft-ads\",\r\n                                  \"center-for-internet-security-inc\",\r\n                                  \"Oracle\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"PasswordPolicy_msid110\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d67222d-05fd-4526-a171-2ee132ad9e83\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Managed workspace virtual network on Azure Synapse workspaces should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enabling a managed workspace virtual network ensures that your workspace is network isolated from other workspaces. Data integration and Spark resources deployed in this virtual network also provides user level isolation for Spark activities.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Synapse\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Synapse/workspaces\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Synapse/workspaces/managedVirtualNetwork\",\r\n                \"notEquals\": \"default\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d9dbfa3-927b-4cf0-9d0f-08747f971650\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d9dbfa3-927b-4cf0-9d0f-08747f971650\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1077 - Use Of External Information Systems\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1077\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2dad3668-797a-412e-a798-07d3849a7a79\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2dad3668-797a-412e-a798-07d3849a7a79\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1149 - Security Assessments | Specialized Assessments\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1149\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2e1b855b-a013-481a-aeeb-2bcb129fd35d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2e1b855b-a013-481a-aeeb-2bcb129fd35d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1497 - System Security Plan | Plan / Coordinate With Other Organizational Entities\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1497\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2e3c5583-1729-4d36-8771-59c32f090a22\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2e3c5583-1729-4d36-8771-59c32f090a22\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1000 - Access Control Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1000\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2ef3cc79-733e-48ed-ab6f-7bf439e9b406\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2ef3cc79-733e-48ed-ab6f-7bf439e9b406\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1519 - Personnel Termination\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1519\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2f13915a-324c-4ab8-b45c-2eefeeefb098\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2f13915a-324c-4ab8-b45c-2eefeeefb098\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Security Options - System objects'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Security Options - System objects' for case insensitivity for non-Windows subsystems and permissions of internal system objects. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SecurityOptionsSystemobjects\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsSystemobjects\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2f262ace-812a-4fd0-b731-b38ba9e9708d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2f262ace-812a-4fd0-b731-b38ba9e9708d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Network traffic data collection agent should be installed on Windows virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Security Center uses the Microsoft Dependency agent to collect network traffic data from your Azure virtual machines to enable advanced network protection features such as traffic visualization on the network map, network hardening recommendations and specific network threats.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1-preview\",\r\n          \"category\": \"Monitoring\",\r\n          \"preview\": \"true\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Effect\",\r\n              \"description\": \"Enable or disable Dependency Agent for Windows VMs monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"DependencyAgentWindows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2f2ee1de-44aa-4762-b6bd-0893fc3f306d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2f2ee1de-44aa-4762-b6bd-0893fc3f306d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1144 - Security Assessments\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1144\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2fa15ff1-a693-4ee4-b094-324818dc9a51\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2fa15ff1-a693-4ee4-b094-324818dc9a51\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1090 - Security Awareness Training\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Awareness and Training control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1090\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2fb740e5-cbc7-4d10-8686-d1bf826652b1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2fb740e5-cbc7-4d10-8686-d1bf826652b1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Web Application should only be accessible over HTTPS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"OnlyHttpsForWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2fde8a98-6892-426a-83ba-050e640c0ce0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs configurations in 'Security Options - Network Access'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - Network Access'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/30040dab-4e75-4456-8273-14b8f75d91d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"30040dab-4e75-4456-8273-14b8f75d91d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Defender for Storage should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for Storage provides detections of unusual and potentially harmful attempts to access or exploit storage accounts.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.3\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"StorageAccounts\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/308fbb08-4ab8-4e67-9b29-592e93fb94fa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"308fbb08-4ab8-4e67-9b29-592e93fb94fa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines missing any of specified members in the Administrators group\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the local Administrators group does not contain one or more members that are listed in the policy parameter.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AdministratorsGroupMembersToInclude\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"MembersToInclude\": \"[LocalGroup]AdministratorsGroup;MembersToInclude\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"MembersToInclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Members to include\",\r\n              \"description\": \"A semicolon-separated list of members that should be included in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AdministratorsGroupMembersToInclude\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;MembersToInclude', '=', parameters('MembersToInclude')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"30f71ea1-ac77-4f26-9fc5-2d926bbd4ba7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that are not joined to the specified domain\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that are not joined to the specified domain. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"DomainName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Domain Name (FQDN)\",\r\n              \"description\": \"The fully qualified domain name (FQDN) that the Windows VMs should be joined to\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsDomainMembership\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[DomainMembership]WindowsDomainMembership;DomainName', '=', parameters('DomainName')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsDomainMembership\"\r\n                    },\r\n                    \"DomainName\": {\r\n                      \"value\": \"[parameters('DomainName')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"DomainName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[DomainMembership]WindowsDomainMembership;DomainName\",\r\n                                \"value\": \"[parameters('DomainName')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[DomainMembership]WindowsDomainMembership;DomainName\",\r\n                                \"value\": \"[parameters('DomainName')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/315c850a-272d-4502-8935-b79010405970\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"315c850a-272d-4502-8935-b79010405970\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1042 - Least Privilege | Auditing Use Of Privileged Functions\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1042\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/319dc4f0-0fed-4ac9-8fc3-7aeddee82c07\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"319dc4f0-0fed-4ac9-8fc3-7aeddee82c07\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1698 - Information System Monitoring | Individuals Posing Greater Risk\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1698\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/31b752c1-05a9-432a-8fce-c39b56550119\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"31b752c1-05a9-432a-8fce-c39b56550119\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Log Analytics Agent Deployment - VM Image (OS) unlisted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"Monitoring\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageId\",\r\n                          \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageId\",\r\n                          \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"2008-R2-SP1\",\r\n                                \"2008-R2-SP1-smalldisk\",\r\n                                \"2012-Datacenter\",\r\n                                \"2012-Datacenter-smalldisk\",\r\n                                \"2012-R2-Datacenter\",\r\n                                \"2012-R2-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter\",\r\n                                \"2016-Datacenter-Server-Core\",\r\n                                \"2016-Datacenter-Server-Core-smalldisk\",\r\n                                \"2016-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter-with-Containers\",\r\n                                \"2016-Datacenter-with-RDSH\",\r\n                                \"2019-Datacenter\",\r\n                                \"2019-Datacenter-Core\",\r\n                                \"2019-Datacenter-Core-smalldisk\",\r\n                                \"2019-Datacenter-Core-with-Containers\",\r\n                                \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-smalldisk\",\r\n                                \"2019-Datacenter-with-Containers\",\r\n                                \"2019-Datacenter-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-zhcn\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerSemiAnnual\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"Datacenter-Core-1709-smalldisk\",\r\n                                \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                                \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerHPCPack\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftSQLServer\"\r\n                            },\r\n                            {\r\n                              \"anyOf\": [\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016-BYOL\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2-BYOL\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftRServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"MLServer-WS2016\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftVisualStudio\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"in\": [\r\n                                \"VisualStudio\",\r\n                                \"Windows\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftDynamicsAX\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Dynamics\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"microsoft-ads\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"windows-data-science-vm\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsDesktop\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Windows-10\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"RedHat\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"RHEL\",\r\n                            \"RHEL-SAP-HANA\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"SUSE\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"SLES\",\r\n                            \"SLES-HPC\",\r\n                            \"SLES-HPC-Priority\",\r\n                            \"SLES-SAP\",\r\n                            \"SLES-SAP-BYOS\",\r\n                            \"SLES-Priority\",\r\n                            \"SLES-BYOS\",\r\n                            \"SLES-SAPCAL\",\r\n                            \"SLES-Standard\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"12*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Canonical\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"UbuntuServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"14.04*LTS\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"16.04*LTS\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"18.04*LTS\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Oracle\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"Oracle-Linux\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7.*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"OpenLogic\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"CentOS\",\r\n                            \"Centos-LVM\",\r\n                            \"CentOS-SRIOV\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"cloudera\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"cloudera-centos-os\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"32133ab0-ee4b-4b44-98d6-042180979d50\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1587 - External Information System Services\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1587\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/32820956-9c6d-4376-934c-05cd8525be7c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"32820956-9c6d-4376-934c-05cd8525be7c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1333 - Authenticator Management | Pki-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1333\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3298d6bf-4bc6-4278-a95d-f7ef3ac6e594\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3298d6bf-4bc6-4278-a95d-f7ef3ac6e594\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs on which the specified services are not installed and 'Running'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines on which the specified services are not installed and 'Running'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"ServiceName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Service names (supports wildcards)\",\r\n              \"description\": \"A semicolon-separated list of the names of the services that should be installed and 'Running'. e.g. 'WinRm;Wi*'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsServiceStatus\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[WindowsServiceStatus]WindowsServiceStatus1;ServiceName', '=', parameters('ServiceName')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsServiceStatus\"\r\n                    },\r\n                    \"ServiceName\": {\r\n                      \"value\": \"[parameters('ServiceName')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ServiceName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[WindowsServiceStatus]WindowsServiceStatus1;ServiceName\",\r\n                                \"value\": \"[parameters('ServiceName')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[WindowsServiceStatus]WindowsServiceStatus1;ServiceName\",\r\n                                \"value\": \"[parameters('ServiceName')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/32b1e4d4-6cd5-47b4-a935-169da8a5c262\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"32b1e4d4-6cd5-47b4-a935-169da8a5c262\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1445 - Physical And Environmental Protection Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1445\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/32d07d59-2716-4972-b37b-214a67ac4a37\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"32d07d59-2716-4972-b37b-214a67ac4a37\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure SQL Database should have the minimal TLS version of 1.2\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Setting minimal TLS version to 1.2 improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/minimalTlsVersion\",\r\n                    \"exists\": false\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/minimalTlsVersion\",\r\n                    \"notEquals\": \"1.2\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"32e6bbec-16b6-44c2-be37-c5b672d103cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy the Linux Guest Configuration extension to enable Guest Configuration assignments on Linux VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys the Linux Guest Configuration extension to Linux virtual machines hosted in Azure that are supported by Guest Configuration. The Linux Guest Configuration extension is a prerequisite for all Linux Guest Configuration assignments and must deployed to machines before using any Linux Guest Configuration policy definition. For more information on Guest Configuration, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"microsoft-aks\",\r\n                      \"qubole-inc\",\r\n                      \"datastax\",\r\n                      \"couchbase\",\r\n                      \"scalegrid\",\r\n                      \"checkpoint\",\r\n                      \"paloaltonetworks\",\r\n                      \"debian\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"CentOS*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-HA\",\r\n                          \"RHEL-SAP\",\r\n                          \"RHEL-SAP-APPS\",\r\n                          \"RHEL-SAP-HA\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"osa\",\r\n                          \"rhel-byos\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"cis-centos-7-l1\",\r\n                          \"cis-centos-7-v2-1-1-l1\",\r\n                          \"cis-centos-8-l1\",\r\n                          \"cis-debian-linux-8-l1\",\r\n                          \"cis-debian-linux-9-l1\",\r\n                          \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                          \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                          \"cis-oracle-linux-8-l1\",\r\n                          \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                          \"cis-rhel-7-l2\",\r\n                          \"cis-rhel-7-v2-2-0-l1\",\r\n                          \"cis-rhel-8-l1\",\r\n                          \"cis-suse-linux-12-v2-0-0-l1\",\r\n                          \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                          \"cis-ubuntu-linux-1804-l1\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Suse\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"SLES*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"11*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"12*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"linux-data-science-vm-ubuntu\",\r\n                          \"azureml\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-altus-centos-os\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"linux*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                            \"like\": \"Linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"exists\": \"false\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"notIn\": [\r\n                              \"OpenLogic\",\r\n                              \"RedHat\",\r\n                              \"credativ\",\r\n                              \"Suse\",\r\n                              \"Canonical\",\r\n                              \"microsoft-dsvm\",\r\n                              \"cloudera\",\r\n                              \"microsoft-ads\",\r\n                              \"center-for-internet-security-inc\",\r\n                              \"Oracle\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"name\": \"AzurePolicyforLinux\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.GuestConfiguration\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"ConfigurationforLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforLinux\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/331e8ea8-378a-410f-a2e5-ae22f38bb0da\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"331e8ea8-378a-410f-a2e5-ae22f38bb0da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MySQL server should use a virtual network service endpoint\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Virtual network based firewall rules are used to enable traffic from a specific subnet to Azure Database for MySQL while ensuring the traffic stays within the Azure boundary. This policy provides a way to audit if the Azure Database for MySQL has virtual network service endpoint being used.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DBforMySQL/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DBforMySQL/servers/virtualNetworkRules\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.DBforMySQL/servers/virtualNetworkRules/virtualNetworkSubnetId\",\r\n                \"exists\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3375856c-3824-4e0e-ae6a-79e011dd4c47\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3375856c-3824-4e0e-ae6a-79e011dd4c47\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Security Options - Audit'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Security Options - Audit' for forcing audit policy subcategory and shutting down if unable to log security audits. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SecurityOptionsAudit\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\": \"Audit: Shut down system immediately if unable to log security audits;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit: Shut down system immediately if unable to log security audits\",\r\n              \"description\": \"Audits if the system will shut down when unable to log Security events.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsAudit\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Audit: Shut down system immediately if unable to log security audits;ExpectedValue', '=', parameters('AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/33936777-f2ac-45aa-82ec-07958ec9ade4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"33936777-f2ac-45aa-82ec-07958ec9ade4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1282 - Telecommunications Services | Single Points Of Failure\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1282\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34042a97-ec6d-4263-93d2-8c1c46823b2a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"34042a97-ec6d-4263-93d2-8c1c46823b2a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Configure backup on VMs with a given tag to an existing recovery services vault in the same location\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enforce backup for all virtual machines by backing them up to an existing central recovery services vault in the same location and subscription as the virtual machine. Doing this is useful when there is a central team in your organization managing backups for all resources in a subscription. You can optionally include virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMCentralBackupIncludeTag\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"preview\": true,\r\n          \"category\": \"Backup\"\r\n        },\r\n        \"parameters\": {\r\n          \"vaultLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Location (Specify the location of the VMs that you want to protect)\",\r\n              \"description\": \"Specify the location of the VMs that you want to protect. VMs should be backed up to a vault in the same location. For example - CanadaCentral\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"inclusionTagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Inclusion Tag Name\",\r\n              \"description\": \"Name of the tag to use for including VMs in the scope of this policy. This should be used along with the Inclusion Tag Value parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"inclusionTagValue\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Inclusion Tag Values\",\r\n              \"description\": \"Value of the tag to use for including VMs in the scope of this policy (in case of multiple values, use a comma-separated list). This should be used along with the Inclusion Tag Name parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\"\r\n            }\r\n          },\r\n          \"backupPolicyId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Backup Policy (of type Azure VM from a vault in the location chosen above)\",\r\n              \"description\": \"Specify the ID of the Azure Backup policy to configure backup of the virtual machines. The selected Azure Backup policy should be of type Azure Virtual Machine. This policy needs to be in a vault that is present in the location chosen above. For example - /subscriptions/<SubscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.RecoveryServices/vaults/<VaultName>/backupPolicies/<BackupPolicyName>\",\r\n              \"strongType\": \"Microsoft.RecoveryServices/vaults/backupPolicies\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"deployIfNotExists\",\r\n              \"auditIfNotExists\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"deployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('vaultLocation')]\"\r\n              },\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('inclusionTagName'), ']')]\",\r\n                \"in\": \"[parameters('inclusionTagValue')]\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2019\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"12*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"14.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18.04*LTS\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7.*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b\"\r\n              ],\r\n              \"type\": \"Microsoft.RecoveryServices/backupprotecteditems\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"backupPolicyId\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"fabricName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"protectionContainers\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"protectedItems\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"sourceResourceId\": {\r\n                        \"type\": \"String\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[concat('DeployProtection-',uniqueString(parameters('protectedItems')))]\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[first(skip(split(parameters('backupPolicyId'), '/'), 4))]\",\r\n                        \"subscriptionId\": \"[first(skip(split(parameters('backupPolicyId'), '/'), 2))]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"backupPolicyId\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"fabricName\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"protectionContainers\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"protectedItems\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"sourceResourceId\": {\r\n                                \"type\": \"String\"\r\n                              }\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems\",\r\n                                \"name\": \"[concat(first(skip(split(parameters('backupPolicyId'), '/'), 8)), '/', parameters('fabricName'), '/',parameters('protectionContainers'), '/', parameters('protectedItems'))]\",\r\n                                \"apiVersion\": \"2016-06-01\",\r\n                                \"properties\": {\r\n                                  \"protectedItemType\": \"Microsoft.Compute/virtualMachines\",\r\n                                  \"policyId\": \"[parameters('backupPolicyId')]\",\r\n                                  \"sourceResourceId\": \"[parameters('sourceResourceId')]\"\r\n                                }\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"parameters\": {\r\n                            \"backupPolicyId\": {\r\n                              \"value\": \"[parameters('backupPolicyId')]\"\r\n                            },\r\n                            \"fabricName\": {\r\n                              \"value\": \"[parameters('fabricName')]\"\r\n                            },\r\n                            \"protectionContainers\": {\r\n                              \"value\": \"[parameters('protectionContainers')]\"\r\n                            },\r\n                            \"protectedItems\": {\r\n                              \"value\": \"[parameters('protectedItems')]\"\r\n                            },\r\n                            \"sourceResourceId\": {\r\n                              \"value\": \"[parameters('sourceResourceId')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"backupPolicyId\": {\r\n                      \"value\": \"[parameters('backupPolicyId')]\"\r\n                    },\r\n                    \"fabricName\": {\r\n                      \"value\": \"Azure\"\r\n                    },\r\n                    \"protectionContainers\": {\r\n                      \"value\": \"[concat('iaasvmcontainer;iaasvmcontainerv2;', resourceGroup().name, ';' ,field('name'))]\"\r\n                    },\r\n                    \"protectedItems\": {\r\n                      \"value\": \"[concat('vm;iaasvmcontainerv2;', resourceGroup().name, ';' ,field('name'))]\"\r\n                    },\r\n                    \"sourceResourceId\": {\r\n                      \"value\": \"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/',field('name'))]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/345fa903-145c-4fe1-8bcd-93ec2adccde8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"345fa903-145c-4fe1-8bcd-93ec2adccde8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Linux VMs that have accounts without passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that have accounts without passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"microsoft-aks\",\r\n                          \"qubole-inc\",\r\n                          \"datastax\",\r\n                          \"couchbase\",\r\n                          \"scalegrid\",\r\n                          \"checkpoint\",\r\n                          \"paloaltonetworks\",\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"OpenLogic\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"CentOS*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Oracle\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Oracle-Linux\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"RHEL\",\r\n                              \"RHEL-HA\",\r\n                              \"RHEL-SAP\",\r\n                              \"RHEL-SAP-APPS\",\r\n                              \"RHEL-SAP-HA\",\r\n                              \"RHEL-SAP-HANA\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"osa\",\r\n                              \"rhel-byos\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"cis-centos-7-l1\",\r\n                              \"cis-centos-7-v2-1-1-l1\",\r\n                              \"cis-centos-8-l1\",\r\n                              \"cis-debian-linux-8-l1\",\r\n                              \"cis-debian-linux-9-l1\",\r\n                              \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                              \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                              \"cis-oracle-linux-8-l1\",\r\n                              \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                              \"cis-rhel-7-l2\",\r\n                              \"cis-rhel-7-v2-2-0-l1\",\r\n                              \"cis-rhel-8-l1\",\r\n                              \"cis-suse-linux-12-v2-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1804-l1\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"credativ\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Debian\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"7*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Suse\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"SLES*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"11*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Canonical\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"UbuntuServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"12*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"linux-data-science-vm-ubuntu\",\r\n                              \"azureml\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-centos-os\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-altus-centos-os\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Linux*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"notIn\": [\r\n                                  \"OpenLogic\",\r\n                                  \"RedHat\",\r\n                                  \"credativ\",\r\n                                  \"Suse\",\r\n                                  \"Canonical\",\r\n                                  \"microsoft-dsvm\",\r\n                                  \"cloudera\",\r\n                                  \"microsoft-ads\",\r\n                                  \"center-for-internet-security-inc\",\r\n                                  \"Oracle\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"PasswordPolicy_msid232\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"PasswordPolicy_msid232\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforLinux\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3470477a-b35a-49db-aca5-1073d04524fe\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1151 - System Interconnections\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1151\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/347e3b69-7fb7-47df-a8ef-71a1a7b44bca\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"347e3b69-7fb7-47df-a8ef-71a1a7b44bca\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1412 - Nonlocal Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1412\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3492d949-0dbb-4589-88b3-7b59601cc764\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3492d949-0dbb-4589-88b3-7b59601cc764\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1475 - Emergency Lighting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1475\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34a63848-30cf-4081-937e-ce1a1c885501\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"34a63848-30cf-4081-937e-ce1a1c885501\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1060 - Remote Access\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1060\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34a987fd-2003-45de-a120-014956581f2b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"34a987fd-2003-45de-a120-014956581f2b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage accounts should restrict network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Network access to storage accounts should be restricted. Configure network rules so only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premise clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\r\n                \"notEquals\": \"Deny\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"34c877ad-507e-4c82-993e-3452a6e0ad3c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1341 - Authenticator Management | Multiple Information System Accounts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1341\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34cb7e92-fe4c-4826-b51e-8cd203fa5d35\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"34cb7e92-fe4c-4826-b51e-8cd203fa5d35\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Logic Apps should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Logic Apps\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Logic/workflows\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"0\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                                \"notEquals\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/storageAccountId\",\r\n                                \"exists\": false\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"34f95f76-5386-4de7-b824-0d8478470c9d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1210 - Configuration Settings\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1210\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3502c968-c490-4570-8167-1476f955e9b8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3502c968-c490-4570-8167-1476f955e9b8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that do not have a maximum password age of 70 days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have a maximum password age of 70 days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"2.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MaximumPasswordAge\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"MaximumPasswordAge\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"356a906e-05e5-4625-8729-90771e0ee934\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'System Audit Policies - Object Access'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Object Access' for auditing file, registry, SAM, storage, filtering, kernel, and other system types. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SystemAuditPoliciesObjectAccess\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"AuditDetailedFileShare\": \"Audit Detailed File Share;ExpectedValue\",\r\n              \"AuditFileShare\": \"Audit File Share;ExpectedValue\",\r\n              \"AuditFileSystem\": \"Audit File System;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"AuditDetailedFileShare\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Detailed File Share\",\r\n              \"description\": \"If this policy setting is enabled, access to all shared files and folders on the system is audited. Auditing for Success can lead to very high volumes of events.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"No Auditing\"\r\n          },\r\n          \"AuditFileShare\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit File Share\",\r\n              \"description\": \"Specifies whether to audit events related to file shares: creation, deletion, modification, and access attempts. Also, it shows failed SMB SPN checks. Event volumes can be high on DCs and File Servers.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"No Auditing\"\r\n          },\r\n          \"AuditFileSystem\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit File System\",\r\n              \"description\": \"Specifies whether audit events are generated when users attempt to access file system objects. Audit events are generated only for objects that have configured system access control lists (SACLs).\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"No Auditing\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesObjectAccess\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Audit Detailed File Share;ExpectedValue', '=', parameters('AuditDetailedFileShare'), ',', 'Audit File Share;ExpectedValue', '=', parameters('AuditFileShare'), ',', 'Audit File System;ExpectedValue', '=', parameters('AuditFileSystem')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/35781875-8026-4628-b19b-f6efb4d88a1d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"35781875-8026-4628-b19b-f6efb4d88a1d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CORS should not allow every resource to access your API App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Cross-Origin Resource Sharing (CORS) should not allow all domains to access your API app. Allow only required domains to interact with your API app.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"*api\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.cors.allowedOrigins[*]\",\r\n                \"notEquals\": \"*\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1659 - Architecture And Provisioning For Name / Address Resolution Service\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1659\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/35a4102f-a778-4a2e-98c2-971056288df8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"35a4102f-a778-4a2e-98c2-971056288df8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Windows Firewall Properties'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Windows Firewall Properties' for firewall state, connections, rule management, and notifications. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_WindowsFirewallProperties\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"WindowsFirewallDomainUseProfileSettings\": \"Windows Firewall: Domain: Firewall state;ExpectedValue\",\r\n              \"WindowsFirewallDomainBehaviorForOutboundConnections\": \"Windows Firewall: Domain: Outbound connections;ExpectedValue\",\r\n              \"WindowsFirewallDomainApplyLocalConnectionSecurityRules\": \"Windows Firewall: Domain: Settings: Apply local connection security rules;ExpectedValue\",\r\n              \"WindowsFirewallDomainApplyLocalFirewallRules\": \"Windows Firewall: Domain: Settings: Apply local firewall rules;ExpectedValue\",\r\n              \"WindowsFirewallDomainDisplayNotifications\": \"Windows Firewall: Domain: Settings: Display a notification;ExpectedValue\",\r\n              \"WindowsFirewallPrivateUseProfileSettings\": \"Windows Firewall: Private: Firewall state;ExpectedValue\",\r\n              \"WindowsFirewallPrivateBehaviorForOutboundConnections\": \"Windows Firewall: Private: Outbound connections;ExpectedValue\",\r\n              \"WindowsFirewallPrivateApplyLocalConnectionSecurityRules\": \"Windows Firewall: Private: Settings: Apply local connection security rules;ExpectedValue\",\r\n              \"WindowsFirewallPrivateApplyLocalFirewallRules\": \"Windows Firewall: Private: Settings: Apply local firewall rules;ExpectedValue\",\r\n              \"WindowsFirewallPrivateDisplayNotifications\": \"Windows Firewall: Private: Settings: Display a notification;ExpectedValue\",\r\n              \"WindowsFirewallPublicUseProfileSettings\": \"Windows Firewall: Public: Firewall state;ExpectedValue\",\r\n              \"WindowsFirewallPublicBehaviorForOutboundConnections\": \"Windows Firewall: Public: Outbound connections;ExpectedValue\",\r\n              \"WindowsFirewallPublicApplyLocalConnectionSecurityRules\": \"Windows Firewall: Public: Settings: Apply local connection security rules;ExpectedValue\",\r\n              \"WindowsFirewallPublicApplyLocalFirewallRules\": \"Windows Firewall: Public: Settings: Apply local firewall rules;ExpectedValue\",\r\n              \"WindowsFirewallPublicDisplayNotifications\": \"Windows Firewall: Public: Settings: Display a notification;ExpectedValue\",\r\n              \"WindowsFirewallDomainAllowUnicastResponse\": \"Windows Firewall: Domain: Allow unicast response;ExpectedValue\",\r\n              \"WindowsFirewallPrivateAllowUnicastResponse\": \"Windows Firewall: Private: Allow unicast response;ExpectedValue\",\r\n              \"WindowsFirewallPublicAllowUnicastResponse\": \"Windows Firewall: Public: Allow unicast response;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"WindowsFirewallDomainUseProfileSettings\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Domain): Use profile settings\",\r\n              \"description\": \"Specifies whether Windows Firewall with Advanced Security uses the settings for the Domain profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallDomainBehaviorForOutboundConnections\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Domain): Behavior for outbound connections\",\r\n              \"description\": \"Specifies the behavior for outbound connections for the Domain profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"WindowsFirewallDomainApplyLocalConnectionSecurityRules\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Domain): Apply local connection security rules\",\r\n              \"description\": \"Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Domain profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallDomainApplyLocalFirewallRules\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Domain): Apply local firewall rules\",\r\n              \"description\": \"Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Domain profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallDomainDisplayNotifications\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Domain): Display notifications\",\r\n              \"description\": \"Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Domain profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallPrivateUseProfileSettings\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Private): Use profile settings\",\r\n              \"description\": \"Specifies whether Windows Firewall with Advanced Security uses the settings for the Private profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallPrivateBehaviorForOutboundConnections\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Private): Behavior for outbound connections\",\r\n              \"description\": \"Specifies the behavior for outbound connections for the Private profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"WindowsFirewallPrivateApplyLocalConnectionSecurityRules\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Private): Apply local connection security rules\",\r\n              \"description\": \"Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Private profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallPrivateApplyLocalFirewallRules\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Private): Apply local firewall rules\",\r\n              \"description\": \"Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Private profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallPrivateDisplayNotifications\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Private): Display notifications\",\r\n              \"description\": \"Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Private profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallPublicUseProfileSettings\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Public): Use profile settings\",\r\n              \"description\": \"Specifies whether Windows Firewall with Advanced Security uses the settings for the Public profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallPublicBehaviorForOutboundConnections\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Public): Behavior for outbound connections\",\r\n              \"description\": \"Specifies the behavior for outbound connections for the Public profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"WindowsFirewallPublicApplyLocalConnectionSecurityRules\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Public): Apply local connection security rules\",\r\n              \"description\": \"Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Public profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallPublicApplyLocalFirewallRules\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Public): Apply local firewall rules\",\r\n              \"description\": \"Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Public profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallPublicDisplayNotifications\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall (Public): Display notifications\",\r\n              \"description\": \"Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Public profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"WindowsFirewallDomainAllowUnicastResponse\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall: Domain: Allow unicast response\",\r\n              \"description\": \"Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Domain profile.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"WindowsFirewallPrivateAllowUnicastResponse\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall: Private: Allow unicast response\",\r\n              \"description\": \"Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Private profile.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"WindowsFirewallPublicAllowUnicastResponse\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Windows Firewall: Public: Allow unicast response\",\r\n              \"description\": \"Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Public profile.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_WindowsFirewallProperties\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Windows Firewall: Domain: Firewall state;ExpectedValue', '=', parameters('WindowsFirewallDomainUseProfileSettings'), ',', 'Windows Firewall: Domain: Outbound connections;ExpectedValue', '=', parameters('WindowsFirewallDomainBehaviorForOutboundConnections'), ',', 'Windows Firewall: Domain: Settings: Apply local connection security rules;ExpectedValue', '=', parameters('WindowsFirewallDomainApplyLocalConnectionSecurityRules'), ',', 'Windows Firewall: Domain: Settings: Apply local firewall rules;ExpectedValue', '=', parameters('WindowsFirewallDomainApplyLocalFirewallRules'), ',', 'Windows Firewall: Domain: Settings: Display a notification;ExpectedValue', '=', parameters('WindowsFirewallDomainDisplayNotifications'), ',', 'Windows Firewall: Private: Firewall state;ExpectedValue', '=', parameters('WindowsFirewallPrivateUseProfileSettings'), ',', 'Windows Firewall: Private: Outbound connections;ExpectedValue', '=', parameters('WindowsFirewallPrivateBehaviorForOutboundConnections'), ',', 'Windows Firewall: Private: Settings: Apply local connection security rules;ExpectedValue', '=', parameters('WindowsFirewallPrivateApplyLocalConnectionSecurityRules'), ',', 'Windows Firewall: Private: Settings: Apply local firewall rules;ExpectedValue', '=', parameters('WindowsFirewallPrivateApplyLocalFirewallRules'), ',', 'Windows Firewall: Private: Settings: Display a notification;ExpectedValue', '=', parameters('WindowsFirewallPrivateDisplayNotifications'), ',', 'Windows Firewall: Public: Firewall state;ExpectedValue', '=', parameters('WindowsFirewallPublicUseProfileSettings'), ',', 'Windows Firewall: Public: Outbound connections;ExpectedValue', '=', parameters('WindowsFirewallPublicBehaviorForOutboundConnections'), ',', 'Windows Firewall: Public: Settings: Apply local connection security rules;ExpectedValue', '=', parameters('WindowsFirewallPublicApplyLocalConnectionSecurityRules'), ',', 'Windows Firewall: Public: Settings: Apply local firewall rules;ExpectedValue', '=', parameters('WindowsFirewallPublicApplyLocalFirewallRules'), ',', 'Windows Firewall: Public: Settings: Display a notification;ExpectedValue', '=', parameters('WindowsFirewallPublicDisplayNotifications'), ',', 'Windows Firewall: Domain: Allow unicast response;ExpectedValue', '=', parameters('WindowsFirewallDomainAllowUnicastResponse'), ',', 'Windows Firewall: Private: Allow unicast response;ExpectedValue', '=', parameters('WindowsFirewallPrivateAllowUnicastResponse'), ',', 'Windows Firewall: Public: Allow unicast response;ExpectedValue', '=', parameters('WindowsFirewallPublicAllowUnicastResponse')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/35d9882c-993d-44e6-87d2-db66ce21b636\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"35d9882c-993d-44e6-87d2-db66ce21b636\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Gateway subnets should not be configured with a network security group\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy denies if a gateway subnet is configured with a network security group. Assigning a network security group to a gateway subnet will cause the gateway to stop functioning.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"GatewaySubnet\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\",\r\n                \"exists\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"35f9c03a-cc27-418e-9c0c-539ff999d010\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1043 - Least Privilege | Prohibit Non-Privileged Users From Executing Privileged Functions\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1043\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/361a77f6-0f9c-4748-8eec-bc13aaaa2455\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"361a77f6-0f9c-4748-8eec-bc13aaaa2455\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Advanced Threat Protection on Storage Accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables Advanced Threat Protection on Storage Accounts.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/advancedThreatProtectionSettings\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/advancedThreatProtectionSettings/isEnabled\",\r\n                \"equals\": \"true\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"storageAccountName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2019-01-01\",\r\n                        \"type\": \"Microsoft.Storage/storageAccounts/providers/advancedThreatProtectionSettings\",\r\n                        \"name\": \"[concat(parameters('storageAccountName'), '/Microsoft.Security/current')]\",\r\n                        \"properties\": {\r\n                          \"isEnabled\": true\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"storageAccountName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"361c2074-3595-4e5d-8cab-4f21dffc835c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1313 - Identifier Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1313\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/36220f5b-79a1-4cdb-8c74-2d2449f9a510\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"36220f5b-79a1-4cdb-8c74-2d2449f9a510\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1630 - Boundary Protection | External Telecommunications Services\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1630\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3643717a-3897-4bfd-8530-c7c96b26b2a0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3643717a-3897-4bfd-8530-c7c96b26b2a0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Automation account variables should be encrypted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"It is important to enable encryption of Automation account variable assets when storing sensitive data\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Automation\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Automation/automationAccounts/variables\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Automation/automationAccounts/variables/isEncrypted\",\r\n                \"notEquals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3657f5a0-770e-44a3-b44e-9431ba1e9735\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1339 - Authenticator Management | Protection Of Authenticators\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1339\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/367ae386-db7f-4167-b672-984ff86277c0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"367ae386-db7f-4167-b672-984ff86277c0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1685 - Information System Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1685\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/36b0ef30-366f-4b1b-8652-a3511df11f53\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"36b0ef30-366f-4b1b-8652-a3511df11f53\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Threat Detection on SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures that Threat Detection is enabled on SQL Servers.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"analytics\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/securityAlertPolicies.state\",\r\n                \"equals\": \"Enabled\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"serverName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/securityAlertPolicies\",\r\n                        \"apiVersion\": \"2017-03-01-preview\",\r\n                        \"properties\": {\r\n                          \"state\": \"Enabled\",\r\n                          \"emailAccountAdmins\": false\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"serverName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"36d49e87-48c4-4f2e-beed-ba4ed02b71f5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'Security Options - Network Security'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - Network Security'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Network Security: Configure encryption types allowed for Kerberos\",\r\n              \"description\": \"Specifies the encryption types that Kerberos is allowed to use.\"\r\n            },\r\n            \"defaultValue\": \"2147483644\"\r\n          },\r\n          \"NetworkSecurityLANManagerAuthenticationLevel\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Network security: LAN Manager authentication level\",\r\n              \"description\": \"Specify which challenge-response authentication protocol is used for network logons. This choice affects the level of authentication protocol used by clients, the level of session security negotiated, and the level of authentication accepted by servers.\"\r\n            },\r\n            \"defaultValue\": \"5\"\r\n          },\r\n          \"NetworkSecurityLDAPClientSigningRequirements\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Network security: LDAP client signing requirements\",\r\n              \"description\": \"Specify the level of data signing that is requested on behalf of clients that issue LDAP BIND requests.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Network security: Minimum session security for NTLM SSP based (including secure RPC) clients\",\r\n              \"description\": \"Specifies which behaviors are allowed by clients for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services. See https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-minimum-session-security-for-ntlm-ssp-based-including-secure-rpc-servers for more information.\"\r\n            },\r\n            \"defaultValue\": \"537395200\"\r\n          },\r\n          \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Network security: Minimum session security for NTLM SSP based (including secure RPC) servers\",\r\n              \"description\": \"Specifies which behaviors are allowed by servers for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services.\"\r\n            },\r\n            \"defaultValue\": \"537395200\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsNetworkSecurity\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('Network Security: Configure encryption types allowed for Kerberos;ExpectedValue', '=', parameters('NetworkSecurityConfigureEncryptionTypesAllowedForKerberos'), ',', 'Network security: LAN Manager authentication level;ExpectedValue', '=', parameters('NetworkSecurityLANManagerAuthenticationLevel'), ',', 'Network security: LDAP client signing requirements;ExpectedValue', '=', parameters('NetworkSecurityLDAPClientSigningRequirements'), ',', 'Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue', '=', parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients'), ',', 'Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue', '=', parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SecurityOptionsNetworkSecurity\"\r\n                    },\r\n                    \"NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\": {\r\n                      \"value\": \"[parameters('NetworkSecurityConfigureEncryptionTypesAllowedForKerberos')]\"\r\n                    },\r\n                    \"NetworkSecurityLANManagerAuthenticationLevel\": {\r\n                      \"value\": \"[parameters('NetworkSecurityLANManagerAuthenticationLevel')]\"\r\n                    },\r\n                    \"NetworkSecurityLDAPClientSigningRequirements\": {\r\n                      \"value\": \"[parameters('NetworkSecurityLDAPClientSigningRequirements')]\"\r\n                    },\r\n                    \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\": {\r\n                      \"value\": \"[parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients')]\"\r\n                    },\r\n                    \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\": {\r\n                      \"value\": \"[parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"NetworkSecurityLANManagerAuthenticationLevel\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"NetworkSecurityLDAPClientSigningRequirements\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Network Security: Configure encryption types allowed for Kerberos;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityConfigureEncryptionTypesAllowedForKerberos')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Network security: LAN Manager authentication level;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityLANManagerAuthenticationLevel')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Network security: LDAP client signing requirements;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityLDAPClientSigningRequirements')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Network Security: Configure encryption types allowed for Kerberos;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityConfigureEncryptionTypesAllowedForKerberos')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Network security: LAN Manager authentication level;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityLANManagerAuthenticationLevel')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Network security: LDAP client signing requirements;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityLDAPClientSigningRequirements')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue\",\r\n                                \"value\": \"[parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/36e17963-7202-494a-80c3-f508211c826b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"36e17963-7202-494a-80c3-f508211c826b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1557 - Vulnerability Scanning | Review Historic Audit Logs\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1557\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/36fbe499-f2f2-41b6-880e-52d7ea1d94a5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"36fbe499-f2f2-41b6-880e-52d7ea1d94a5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'Security Options - Interactive Logon'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - Interactive Logon'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsInteractiveLogon\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SecurityOptionsInteractiveLogon\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3750712b-43d0-478e-9966-d2c26f6141b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3750712b-43d0-478e-9966-d2c26f6141b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1624 - Boundary Protection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1624\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/37d079e3-d6aa-4263-a069-dd7ac6dd9684\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37d079e3-d6aa-4263-a069-dd7ac6dd9684\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage accounts should be migrated to new Azure Resource Manager resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use new Azure Resource Manager for your storage accounts to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.ClassicStorage/storageAccounts\",\r\n                  \"Microsoft.Storage/StorageAccounts\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"[field('type')]\",\r\n                \"equals\": \"Microsoft.ClassicStorage/storageAccounts\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37e0d2fe-28a5-43d6-a273-67d37d1f5606\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1335 - Authenticator Management | Pki-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1335\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/382016f3-d4ba-4e15-9716-55077ec4dc2a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"382016f3-d4ba-4e15-9716-55077ec4dc2a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in IoT Hub should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Internet of Things\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Devices/IotHubs\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"0\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                              \"equals\": \"true\"\r\n                            }\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"383856f8-de7f-44a2-81fc-e5135b5c2aa4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy the Windows Guest Configuration extension to enable Guest Configuration assignments on Windows VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys the Windows Guest Configuration extension to Windows virtual machines hosted in Azure that are supported by Guest Configuration. The Windows Guest Configuration extension is a prerequisite for all Windows Guest Configuration assignments and must deployed to machines before using any Windows Guest Configuration policy definition. For more information on Guest Configuration, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"notLike\": \"SQL2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                            \"like\": \"Windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"exists\": \"false\"\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"notLike\": \"2008*\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"notLike\": \"SQL2008*\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"name\": \"AzurePolicyforWindows\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.GuestConfiguration\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"ConfigurationforWindows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/385f5831-96d4-41db-9a3c-cd3af78aaae6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"385f5831-96d4-41db-9a3c-cd3af78aaae6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1081 - Information Sharing\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1081\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3867f2a9-23bb-4729-851f-c3ad98580caf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3867f2a9-23bb-4729-851f-c3ad98580caf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1522 - Personnel Transfer\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1522\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/38b470cc-f939-4a15-80e0-9f0c74f2e2c9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"38b470cc-f939-4a15-80e0-9f0c74f2e2c9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1416 - Nonlocal Maintenance | Document Nonlocal Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1416\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/38dfd8a3-5290-4099-88b7-4081f4c4d8ae\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"38dfd8a3-5290-4099-88b7-4081f4c4d8ae\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1397 - Controlled Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1397\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/391af4ab-1117-46b9-b2c7-78bbd5cd995b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"391af4ab-1117-46b9-b2c7-78bbd5cd995b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1556 - Vulnerability Scanning | Automated Trend Analyses\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1556\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/391ff8b3-afed-405e-9f7d-ef2f8168d5da\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"391ff8b3-afed-405e-9f7d-ef2f8168d5da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Advanced data security settings for SQL Managed Instance should contain an email address for security alerts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Ensure that an email address is provided for the 'Send alerts to' field in the advanced data security settings. This email address receives alert notifications when anomalous activities are detected on SQL Managed Instance.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1-deprecated\",\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/securityAlertPolicies\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3965c43d-b5f4-482e-b74a-d89ee0e0b3a8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3965c43d-b5f4-482e-b74a-d89ee0e0b3a8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1232 - Configuration Management Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1232\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/396ba986-eac1-4d6d-85c4-d3fda6b78272\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"396ba986-eac1-4d6d-85c4-d3fda6b78272\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1246 - Contingency Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1246\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/398eb61e-8111-40d5-a0c9-003df28f1753\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"398eb61e-8111-40d5-a0c9-003df28f1753\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"FTPS only should be required in your Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enable FTPS enforcement for enhanced security\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"functionapp*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/ftpsState\",\r\n                \"in\": [\r\n                  \"FtpsOnly\",\r\n                  \"Disabled\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"399b2637-a50f-4f95-96f8-3a145476eb15\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1680 - Malicious Code Protection | Central Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1680\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/399cd6ee-0e18-41db-9dea-cde3bd712f38\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"399cd6ee-0e18-41db-9dea-cde3bd712f38\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1228 - Information System Component Inventory | Accountability Information\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1228\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/39c54140-5902-4079-8bb5-ad31936fe764\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"39c54140-5902-4079-8bb5-ad31936fe764\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Synapse managed private endpoints should only connect to resources in approved Azure Active Directory tenants\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Protect your Synapse workspace by only allowing connections to resources in approved Azure Active Directory (Azure AD) tenants. The approved Azure AD tenants can be defined during policy assignment.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Synapse\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedTenantIds\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of Allowed Tenant Ids for private endpoint creation\",\r\n              \"description\": \"This parameter defines the list of Allowed Tenant Ids that are allowed to create managed private endpoints in the workspaces\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\",\r\n              \"Deny\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Synapse/workspaces\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Synapse/workspaces/managedVirtualNetworkSettings.allowedAadTenantIdsForLinking[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.Synapse/workspaces/managedVirtualNetworkSettings.allowedAadTenantIdsForLinking[*]\",\r\n                    \"notIn\": \"[parameters('allowedTenantIds')]\"\r\n                  }\r\n                },\r\n                \"greater\": 0\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3a003702-13d2-4679-941b-937e58c443f0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3a003702-13d2-4679-941b-937e58c443f0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Infrastructure encryption should be enabled for Azure Database for MySQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enable infrastructure encryption for Azure Database for MySQL servers to have higher level of assurance that the data is secure. When infrastructure encryption is enabled, the data at rest is encrypted twice using FIPS 140-2 compliant Microsoft managed keys.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DBforMySQL/servers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DBforMySQL/servers/infrastructureEncryption\",\r\n                \"notEquals\": \"Enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3a58212a-c829-4f13-9872-6371df2fd0b4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3a58212a-c829-4f13-9872-6371df2fd0b4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1039 - Least Privilege | Review Of User Privileges\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1039\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3a7b9de4-a8a2-4672-914d-c5f6752aa7f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3a7b9de4-a8a2-4672-914d-c5f6752aa7f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1648 - Collaborative Computing Devices\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1648\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3a9eb14b-495a-4ebb-933c-ce4ef5264e32\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3a9eb14b-495a-4ebb-933c-ce4ef5264e32\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Administrative Templates - Control Panel'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Administrative Templates - Control Panel' for input personalization and prevention of enabling lock screens. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_AdministrativeTemplatesControlPanel\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_AdministrativeTemplatesControlPanel\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3aa2661b-02d7-4ba6-99bc-dc36b10489fd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3aa2661b-02d7-4ba6-99bc-dc36b10489fd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1315 - Identifier Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1315\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3aa87116-f1a1-4edb-bfbf-14e036f8d454\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3aa87116-f1a1-4edb-bfbf-14e036f8d454\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Pod Security Policies should be defined on Kubernetes Services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Define Pod Security Policies to reduce the attack vector by removing unnecessary application privileges. It is recommended to configure Pod Security Policies to only allow pods to access the resources which they have permissions to access.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3abeb944-26af-43ee-b83d-32aaf060fb94\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3abeb944-26af-43ee-b83d-32aaf060fb94\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1548 - Vulnerability Scanning\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1548\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3afe6c78-6124-4d95-b85c-eb8c0c9539cb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3afe6c78-6124-4d95-b85c-eb8c0c9539cb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1266 - Contingency Plan Testing | Alternate Processing Site\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1266\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3b4a3eb2-c25d-40bf-ad41-5094b6f59cee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3b4a3eb2-c25d-40bf-ad41-5094b6f59cee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1003 - Account Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1003\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3b68b179-3704-4ff7-b51d-7d65374d165d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3b68b179-3704-4ff7-b51d-7d65374d165d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"An activity log alert should exist for specific Security operations\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits specific Security operations with no activity log alerts configured.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"operationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operation Name\",\r\n              \"description\": \"Security Operation name for which activity log alert should exist\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Microsoft.Security/policies/write\",\r\n              \"Microsoft.Security/securitySolutions/write\",\r\n              \"Microsoft.Security/securitySolutions/delete\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/ActivityLogAlerts\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/ActivityLogAlerts/enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"count\": {\r\n                      \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\",\r\n                      \"where\": {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                                \"equals\": \"category\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                                \"equals\": \"Security\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                                \"equals\": \"operationName\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\",\r\n                                \"equals\": \"[parameters('operationName')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    },\r\n                    \"equals\": 2\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                      \"equals\": \"category\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\",\r\n                      \"equals\": \"operationName\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3b980d31-7904-4bb7-8575-5665739a8052\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3b980d31-7904-4bb7-8575-5665739a8052\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Dependency agent for Windows virtual machine scale sets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Dependency agent for Windows virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all virtual machines in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.3.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"DependencyAgentWindows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"DependencyAgentWindows\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                      \"vmExtensionType\": \"DependencyAgentWindows\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"9.7\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3be22e3b-d919-47aa-805e-8985dbeb0ad9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"PostgreSQL server should use a virtual network service endpoint\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Virtual network based firewall rules are used to enable traffic from a specific subnet to Azure Database for PostgreSQL while ensuring the traffic stays within the Azure boundary. This policy provides a way to audit if the Azure Database for PostgreSQL has virtual network service endpoint being used.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DBforPostgreSQL/servers/virtualNetworkRules\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/virtualNetworkRules/virtualNetworkSubnetId\",\r\n                \"exists\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3c14b034-bcb6-4905-94e7-5b8e98a47b65\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3c14b034-bcb6-4905-94e7-5b8e98a47b65\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Log Analytics agent for Windows virtual machine scale sets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Log Analytics agent for Windows virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"MicrosoftMonitoringAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"MicrosoftMonitoringAgent\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"vmExtensionType\": \"MicrosoftMonitoringAgent\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"1.0\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                            \"stopOnMultipleConnections\": \"true\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for: ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3c1b3629-c8f8-4bf6-862c-037cb9094038\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerabilities in security configuration on your virtual machine scale sets should be remediated\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit the OS vulnerabilities on your virtual machine scale sets to protect them from attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"8941d121-f740-35f6-952c-6561d2b38d36\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1621 - Resource Availability\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1621\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3cb9f731-744a-4691-a481-ca77b0411538\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3cb9f731-744a-4691-a481-ca77b0411538\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1521 - Personnel Termination | Automated Notification\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1521\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3cbddf9c-a3aa-4330-a0f5-4c0c1f1862e5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3cbddf9c-a3aa-4330-a0f5-4c0c1f1862e5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1127 - Time Stamps\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1127\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3ce328db-aef3-48ed-9f81-2ab7cf839c66\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3ce328db-aef3-48ed-9f81-2ab7cf839c66\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Add system-assigned managed identity to enable Guest Configuration assignments on virtual machines with no identities\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy adds a system-assigned managed identity to virtual machines hosted in Azure that are supported by Guest Configuration but do not have any managed identities. A system-assigned managed identity is a prerequisite for all Guest Configuration assignments and must be added to machines before using any Guest Configuration policy definitions. For more information on Guest Configuration, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"microsoft-aks\",\r\n                          \"qubole-inc\",\r\n                          \"datastax\",\r\n                          \"couchbase\",\r\n                          \"scalegrid\",\r\n                          \"checkpoint\",\r\n                          \"paloaltonetworks\",\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"OpenLogic\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"CentOS*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Oracle\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Oracle-Linux\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"RHEL\",\r\n                              \"RHEL-HA\",\r\n                              \"RHEL-SAP\",\r\n                              \"RHEL-SAP-APPS\",\r\n                              \"RHEL-SAP-HA\",\r\n                              \"RHEL-SAP-HANA\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"osa\",\r\n                              \"rhel-byos\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"cis-centos-7-l1\",\r\n                              \"cis-centos-7-v2-1-1-l1\",\r\n                              \"cis-centos-8-l1\",\r\n                              \"cis-debian-linux-8-l1\",\r\n                              \"cis-debian-linux-9-l1\",\r\n                              \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                              \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                              \"cis-oracle-linux-8-l1\",\r\n                              \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                              \"cis-rhel-7-l2\",\r\n                              \"cis-rhel-7-v2-2-0-l1\",\r\n                              \"cis-rhel-8-l1\",\r\n                              \"cis-suse-linux-12-v2-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1804-l1\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"credativ\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Debian\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"7*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Suse\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"SLES*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"11*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Canonical\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"UbuntuServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"12*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"linux-data-science-vm-ubuntu\",\r\n                              \"azureml\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-centos-os\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-altus-centos-os\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Linux*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"notIn\": [\r\n                                  \"OpenLogic\",\r\n                                  \"RedHat\",\r\n                                  \"credativ\",\r\n                                  \"Suse\",\r\n                                  \"Canonical\",\r\n                                  \"microsoft-dsvm\",\r\n                                  \"cloudera\",\r\n                                  \"microsoft-ads\",\r\n                                  \"center-for-internet-security-inc\",\r\n                                  \"Oracle\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"[requestContext().apiVersion]\",\r\n                \"greaterOrEquals\": \"2018-10-01\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"identity.type\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"identity.type\",\r\n                    \"equals\": \"None\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"modify\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"identity.type\",\r\n                  \"value\": \"SystemAssigned\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3cf2ab00-13f1-4d0c-8971-2ac904541a7e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3cf2ab00-13f1-4d0c-8971-2ac904541a7e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines that have extra accounts in the Administrators group\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the local Administrators group contains members that are not listed in the policy parameter.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AdministratorsGroupMembers\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"Members\": \"[LocalGroup]AdministratorsGroup;Members\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"Members\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Members\",\r\n              \"description\": \"A semicolon-separated list of all the expected members of the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            },\r\n            \"allowedValues\": [],\r\n            \"defaultValue\": \"Administrator\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AdministratorsGroupMembers\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;Members', '=', parameters('Members')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3d2a3320-2a72-4c67-ac5f-caa40fbee2b2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3d2a3320-2a72-4c67-ac5f-caa40fbee2b2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Search Services to Event Hub\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Search Services to stream to a regional Event Hub when any Search Services which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_eventHub\"\r\n          },\r\n          \"eventHubRuleId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Event Hub Authorization Rule Id\",\r\n              \"description\": \"The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\",\r\n              \"strongType\": \"Microsoft.EventHub/Namespaces/AuthorizationRules\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"eventHubLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Event Hub Location\",\r\n              \"description\": \"The location the Event Hub resides in. Only Search Services in this location will be linked to this Event Hub.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Event Hub - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Event Hub  - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Search/searchServices\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('eventHubLocation')]\",\r\n                    \"equals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"location\",\r\n                    \"equals\": \"[parameters('eventHubLocation')]\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"eventHubRuleId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Search/searchServices/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"eventHubAuthorizationRuleId\": \"[parameters('eventHubRuleId')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"OperationLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"eventHubRuleId\": {\r\n                      \"value\": \"[parameters('eventHubRuleId')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3d5da587-71bd-41f5-ac95-dd3330c2d58d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3d5da587-71bd-41f5-ac95-dd3330c2d58d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs configurations in 'Security Options - Devices'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - Devices'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsDevices\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3d7b154e-2700-4c8c-9e46-cb65ac1578c2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3d7b154e-2700-4c8c-9e46-cb65ac1578c2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy default Log Analytics Agent for Ubuntu VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys the Log Analytics Agent on Ubuntu VMs, and connects to the selected Log Analytics workspace\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Compute\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"Canonical\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"UbuntuServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"18.04-LTS\",\r\n                  \"16.04-LTS\",\r\n                  \"16.04.0-LTS\",\r\n                  \"14.04.2-LTS\",\r\n                  \"12.04.5-LTS\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"OmsAgentForLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/omsPolicy')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                          \"type\": \"OmsAgentForLinux\",\r\n                          \"typeHandlerVersion\": \"1.4\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled monitoring for Linux VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1385 - Information Spillage Response\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1385\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3e495e65-8663-49ca-9b38-9f45e800bc58\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e495e65-8663-49ca-9b38-9f45e800bc58\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines that do not have the specified Windows PowerShell modules installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if a module isn't available in a location specified by the environment variable PSModulePath.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"WindowsPowerShellModules\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"Modules\": \"[PowerShellModules]PowerShellModules1;Modules\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"Modules\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"PowerShell Modules\",\r\n              \"description\": \"A semicolon-separated list of the names of the PowerShell modules that should be installed. You may also specify a specific version of a module that should be installed by including a comma after the module name, followed by the desired version. Example: PSDscResources; SqlServerDsc, 12.0.0.0; ComputerManagementDsc, 6.1.0.0\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsPowerShellModules\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[PowerShellModules]PowerShellModules1;Modules', '=', parameters('Modules')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3e4e2bd5-15a2-4628-b3e1-58977e9793f3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e4e2bd5-15a2-4628-b3e1-58977e9793f3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Monitor solution 'Security and Audit' must be deployed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy ensures that Security and Audit is deployed.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.OperationsManagement/solutions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.OperationsManagement/solutions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  },\r\n                  {\r\n                    \"field\": \"name\",\r\n                    \"like\": \"Security(*)\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3e596b57-105f-48a6-be97-03e9243bad6e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e596b57-105f-48a6-be97-03e9243bad6e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1160 - Security Authorization\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1160\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3e797ca6-2aa8-4333-b335-7036f1110c05\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e797ca6-2aa8-4333-b335-7036f1110c05\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1545 - Risk Assessment\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1545\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3f4b171a-a56b-4328-8112-32cf7f947ee1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3f4b171a-a56b-4328-8112-32cf7f947ee1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1179 - Baseline Configuration | Reviews And Updates\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1179\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3f9ce557-c8ab-4e6c-bb2c-9b8ed002c46c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3f9ce557-c8ab-4e6c-bb2c-9b8ed002c46c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported PHP Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported PHP version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestPHP\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3fe37002-5d00-4b37-a301-da09e3a0ca66\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Security Options - Network Access'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Security Options - Network Access' for including access for anonymous users, local accounts, and remote access to the registry. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SecurityOptionsNetworkAccess\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"NetworkAccessRemotelyAccessibleRegistryPaths\": \"Network access: Remotely accessible registry paths;ExpectedValue\",\r\n              \"NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\": \"Network access: Remotely accessible registry paths and sub-paths;ExpectedValue\",\r\n              \"NetworkAccessSharesThatCanBeAccessedAnonymously\": \"Network access: Shares that can be accessed anonymously;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"NetworkAccessRemotelyAccessibleRegistryPaths\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network access: Remotely accessible registry paths\",\r\n              \"description\": \"Specifies which registry paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the `winreg` registry key.\"\r\n            },\r\n            \"defaultValue\": \"System\\\\CurrentControlSet\\\\Control\\\\ProductOptions|#|System\\\\CurrentControlSet\\\\Control\\\\Server Applications|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\"\r\n          },\r\n          \"NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network access: Remotely accessible registry paths and sub-paths\",\r\n              \"description\": \"Specifies which registry paths and sub-paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the `winreg` registry key.\"\r\n            },\r\n            \"defaultValue\": \"System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Printers|#|System\\\\CurrentControlSet\\\\Services\\\\Eventlog|#|Software\\\\Microsoft\\\\OLAP Server|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows|#|System\\\\CurrentControlSet\\\\Control\\\\ContentIndex|#|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server|#|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\UserConfig|#|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\DefaultUserConfiguration|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib|#|System\\\\CurrentControlSet\\\\Services\\\\SysmonLog\"\r\n          },\r\n          \"NetworkAccessSharesThatCanBeAccessedAnonymously\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network access: Shares that can be accessed anonymously\",\r\n              \"description\": \"Specifies which network shares can be accessed by anonymous users. The default configuration for this policy setting has little effect because all users have to be authenticated before they can access shared resources on the server.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Network access: Remotely accessible registry paths;ExpectedValue', '=', parameters('NetworkAccessRemotelyAccessibleRegistryPaths'), ',', 'Network access: Remotely accessible registry paths and sub-paths;ExpectedValue', '=', parameters('NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths'), ',', 'Network access: Shares that can be accessed anonymously;ExpectedValue', '=', parameters('NetworkAccessSharesThatCanBeAccessedAnonymously')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3ff60f98-7fa4-410a-9f7f-0b00f5afdbdd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3ff60f98-7fa4-410a-9f7f-0b00f5afdbdd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1561 - Allocation Of Resources\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1561\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/40364c3f-c331-4e29-b1e3-2fbe998ba2f5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"40364c3f-c331-4e29-b1e3-2fbe998ba2f5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Secure transfer to storage accounts should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"value\": \"[requestContext().apiVersion]\",\r\n                        \"less\": \"2019-04-01\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\r\n                        \"exists\": \"false\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"404c3081-a854-4457-ae30-26a93ef643f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1100 - Audit And Accountability Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1100\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4057863c-ca7d-47eb-b1e0-503580cba8a4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4057863c-ca7d-47eb-b1e0-503580cba8a4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1637 - Boundary Protection | Fail Secure\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1637\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4075bedc-c62a-4635-bede-a01be89807f3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4075bedc-c62a-4635-bede-a01be89807f3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'Administrative Templates - System'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'Administrative Templates - System'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"AlwaysUseClassicLogon\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Always use classic logon\",\r\n              \"description\": \"Specifies whether to force the user to log on to the computer using the classic logon screen. This setting only works when the computer is not on a domain.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"BootStartDriverInitializationPolicy\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Boot-Start Driver Initialization Policy\",\r\n              \"description\": \"Specifies which boot-start drivers are initialized based on a classification determined by an Early Launch Antimalware boot-start driver.\"\r\n            },\r\n            \"defaultValue\": \"3\"\r\n          },\r\n          \"EnableWindowsNTPClient\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Enable Windows NTP Client\",\r\n              \"description\": \"Specifies whether the Windows NTP Client is enabled. Enabling the Windows NTP Client allows your computer to synchronize its computer clock with other NTP servers.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"TurnOnConveniencePINSignin\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Turn on convenience PIN sign-in\",\r\n              \"description\": \"Specifies whether a domain user can sign in using a convenience PIN.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_AdministrativeTemplatesSystem\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('Always use classic logon;ExpectedValue', '=', parameters('AlwaysUseClassicLogon'), ',', 'Boot-Start Driver Initialization Policy;ExpectedValue', '=', parameters('BootStartDriverInitializationPolicy'), ',', 'Enable Windows NTP Client;ExpectedValue', '=', parameters('EnableWindowsNTPClient'), ',', 'Turn on convenience PIN sign-in;ExpectedValue', '=', parameters('TurnOnConveniencePINSignin')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_AdministrativeTemplatesSystem\"\r\n                    },\r\n                    \"AlwaysUseClassicLogon\": {\r\n                      \"value\": \"[parameters('AlwaysUseClassicLogon')]\"\r\n                    },\r\n                    \"BootStartDriverInitializationPolicy\": {\r\n                      \"value\": \"[parameters('BootStartDriverInitializationPolicy')]\"\r\n                    },\r\n                    \"EnableWindowsNTPClient\": {\r\n                      \"value\": \"[parameters('EnableWindowsNTPClient')]\"\r\n                    },\r\n                    \"TurnOnConveniencePINSignin\": {\r\n                      \"value\": \"[parameters('TurnOnConveniencePINSignin')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"AlwaysUseClassicLogon\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"BootStartDriverInitializationPolicy\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"EnableWindowsNTPClient\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"TurnOnConveniencePINSignin\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Always use classic logon;ExpectedValue\",\r\n                                \"value\": \"[parameters('AlwaysUseClassicLogon')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Boot-Start Driver Initialization Policy;ExpectedValue\",\r\n                                \"value\": \"[parameters('BootStartDriverInitializationPolicy')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Enable Windows NTP Client;ExpectedValue\",\r\n                                \"value\": \"[parameters('EnableWindowsNTPClient')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Turn on convenience PIN sign-in;ExpectedValue\",\r\n                                \"value\": \"[parameters('TurnOnConveniencePINSignin')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Always use classic logon;ExpectedValue\",\r\n                                \"value\": \"[parameters('AlwaysUseClassicLogon')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Boot-Start Driver Initialization Policy;ExpectedValue\",\r\n                                \"value\": \"[parameters('BootStartDriverInitializationPolicy')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Enable Windows NTP Client;ExpectedValue\",\r\n                                \"value\": \"[parameters('EnableWindowsNTPClient')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Turn on convenience PIN sign-in;ExpectedValue\",\r\n                                \"value\": \"[parameters('TurnOnConveniencePINSignin')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/40917425-69db-4018-8dae-2a0556cef899\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"40917425-69db-4018-8dae-2a0556cef899\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1202 - Access Restrictions For Change\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1202\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/40a2a83b-74f2-4c02-ae65-f460a5d2792a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"40a2a83b-74f2-4c02-ae65-f460a5d2792a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Machine Learning workspaces should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your Azure Machine Learning workspaces instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/azureml-workspaces-privatelink.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Machine Learning\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.MachineLearningServices/workspaces\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.MachineLearningServices/workspaces/privateEndpointConnections[*].privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/40cec1dd-a100-4920-b15b-3024fe8901ab\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"40cec1dd-a100-4920-b15b-3024fe8901ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit a tag from the subscription if missing\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Adds the specified tag with its value from the containing subscription when any resource missing this tag is created or updated. Existing resources can be remediated by triggering a remediation task. If the tag exists with a different value it will not be changed.\",\r\n        \"metadata\": {\r\n          \"category\": \"Tags\",\r\n          \"version\": \"1.0.0\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"value\": \"[subscription().tags[parameters('tagName')]]\",\r\n                \"notEquals\": \"\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"modify\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"operation\": \"add\",\r\n                  \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                  \"value\": \"[subscription().tags[parameters('tagName')]]\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/40df99da-1232-49b1-a39a-6da8d878f469\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"40df99da-1232-49b1-a39a-6da8d878f469\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1438 - Media Sanitization\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1438\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/40fcc635-52a2-4dbc-9523-80a1f4aa1de6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"40fcc635-52a2-4dbc-9523-80a1f4aa1de6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1365 - Incident Handling | Continuity Of Operations\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1365\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4116891d-72f7-46ee-911c-8056cc8dcbd5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4116891d-72f7-46ee-911c-8056cc8dcbd5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1022 - Account Management | Shared / Group Account Credential Termination\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1022\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/411f7e2d-9a0b-4627-a0b9-1700432db47d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"411f7e2d-9a0b-4627-a0b9-1700432db47d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1464 - Monitoring Physical Access | Intrusion Alarms / Surveillance Equipment\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1464\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/41256567-1795-4684-b00b-a1308ce43cac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41256567-1795-4684-b00b-a1308ce43cac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Monitor should collect activity logs from all regions\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits the Azure Monitor log profile which does not export activities from all Azure supported regions including global.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/logProfiles\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"australiacentral\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"australiacentral2\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"australiaeast\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"australiasoutheast\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"brazilsouth\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"canadacentral\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"canadaeast\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"centralindia\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"centralus\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"eastasia\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"eastus\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"eastus2\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"francecentral\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"francesouth\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"japaneast\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"japanwest\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"koreacentral\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"koreasouth\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"northcentralus\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"northeurope\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"southafricanorth\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"southafricawest\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"southcentralus\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"southindia\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"southeastasia\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"uaecentral\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"uaenorth\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"uksouth\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"ukwest\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"westcentralus\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"westeurope\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"westindia\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"westus\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"westus2\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/locations[*]\",\r\n                      \"notEquals\": \"global\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1263 - Contingency Plan Testing\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1263\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/41472613-3b05-49f6-8fe8-525af113ce17\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41472613-3b05-49f6-8fe8-525af113ce17\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1096 - Role-Based Security Training | Practical Exercises\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Awareness and Training control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1096\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/420c1477-aa43-49d0-bd7e-c4abdd9addff\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"420c1477-aa43-49d0-bd7e-c4abdd9addff\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows VMs with a pending reboot\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the machine is pending reboot for any of the following reasons: component based servicing, Windows Update, pending file rename, pending computer rename, configuration manager pending reboot. Each detection has a unique registry path.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"WindowsPendingReboot\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsPendingReboot\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4221adbc-5c0f-474f-88b7-037a99e6114c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4221adbc-5c0f-474f-88b7-037a99e6114c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1260 - Contingency Training | Simulated Events\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1260\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/42254fc4-2738-4128-9613-72aaa4f0d9c3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"42254fc4-2738-4128-9613-72aaa4f0d9c3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Web Application Firewall (WAF) should use the specified mode for Azure Front Door Service\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Mandates the use of 'Detection' or 'Prevention' mode to be active on all Web Application Firewall policies for Azure Front Door Service.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"modeRequirement\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Mode Requirement\",\r\n              \"description\": \"Mode required for all WAF policies\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Prevention\",\r\n              \"Detection\"\r\n            ],\r\n            \"defaultValue\": \"Detection\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/frontdoorwebapplicationfirewallpolicies\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/frontdoorWebApplicationFirewallPolicies/policySettings.mode\",\r\n                \"notEquals\": \"[parameters('modeRequirement')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/425bea59-a659-4cbb-8d31-34499bd030b8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"425bea59-a659-4cbb-8d31-34499bd030b8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1694 - Information System Monitoring | Analyze Communications Traffic Anomalies\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1694\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/426c4ac9-ff17-49d0-acd7-a13c157081c0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"426c4ac9-ff17-49d0-acd7-a13c157081c0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Diagnostic logs in Batch accounts should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Batch\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required diagnostic logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Batch/batchAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"0\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"[parameters('requiredRetentionDays')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                                \"notEquals\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/storageAccountId\",\r\n                                \"exists\": false\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"428256e6-1fac-4f48-a757-df34c2b3336d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'System Audit Policies - Detailed Tracking'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'System Audit Policies - Detailed Tracking'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"AuditProcessTermination\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Audit Process Termination\",\r\n              \"description\": \"Specifies whether audit events are generated when a process has exited. Recommended for monitoring termination of critical processes.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"No Auditing\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesDetailedTracking\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('Audit Process Termination;ExpectedValue', '=', parameters('AuditProcessTermination')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SystemAuditPoliciesDetailedTracking\"\r\n                    },\r\n                    \"AuditProcessTermination\": {\r\n                      \"value\": \"[parameters('AuditProcessTermination')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"AuditProcessTermination\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Audit Process Termination;ExpectedValue\",\r\n                                \"value\": \"[parameters('AuditProcessTermination')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Audit Process Termination;ExpectedValue\",\r\n                                \"value\": \"[parameters('AuditProcessTermination')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/42a07bbf-ffcf-459a-b4b1-30ecd118a505\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"42a07bbf-ffcf-459a-b4b1-30ecd118a505\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1174 - Configuration Management Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1174\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/42a9a714-8fbb-43ac-b115-ea12d2bd652f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"42a9a714-8fbb-43ac-b115-ea12d2bd652f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1137 - Audit Generation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1137\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4344df62-88ab-4637-b97b-bcaf2ec97e7c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4344df62-88ab-4637-b97b-bcaf2ec97e7c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1367 - Incident Handling | Insider Threats - Specific Capabilities\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1367\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/435b2547-6374-4f87-b42d-6e8dbe6ae62a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"435b2547-6374-4f87-b42d-6e8dbe6ae62a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1552 - Vulnerability Scanning | Update By Frequency / Prior To New Scan / When Identified\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1552\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/43684572-e4f1-4642-af35-6b933bc506da\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"43684572-e4f1-4642-af35-6b933bc506da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'Security Options - System settings'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - System settings'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies\",\r\n              \"description\": \"Specifies whether digital certificates are processed when software restriction policies are enabled and a user or process attempts to run software with an .exe file name extension. It enables or disables certificate rules (a type of software restriction policies rule). For certificate rules to take effect in software restriction policies, you must enable this policy setting.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsSystemsettings\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue', '=', parameters('SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SecurityOptionsSystemsettings\"\r\n                    },\r\n                    \"SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\": {\r\n                      \"value\": \"[parameters('SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue\",\r\n                                \"value\": \"[parameters('SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue\",\r\n                                \"value\": \"[parameters('SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/437a1f8f-8552-47a8-8b12-a2fee3269dd5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"437a1f8f-8552-47a8-8b12-a2fee3269dd5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'System Audit Policies - Account Logon'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Account Logon' for auditing credential validation and other account logon events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SystemAuditPoliciesAccountLogon\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"AuditCredentialValidation\": \"Audit Credential Validation;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"AuditCredentialValidation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Credential Validation\",\r\n              \"description\": \"Specifies whether audit events are generated when credentials are submitted for a user account logon request.  This setting is especially useful for monitoring unsuccessful attempts, to find brute-force attacks, account enumeration, and potential account compromise events on domain controllers.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"Success and Failure\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesAccountLogon\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Audit Credential Validation;ExpectedValue', '=', parameters('AuditCredentialValidation')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/43bb60fe-1d7e-4b82-9e93-496bfc99e7d5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"43bb60fe-1d7e-4b82-9e93-496bfc99e7d5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1544 - Risk Assessment\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1544\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/43ced7c9-cd53-456b-b0da-2522649a4271\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"43ced7c9-cd53-456b-b0da-2522649a4271\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1398 - Controlled Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1398\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/443e8f3d-b51a-45d8-95a7-18b0e42f4dc4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"443e8f3d-b51a-45d8-95a7-18b0e42f4dc4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Monitor permissive network access in Azure Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Network Security Groups with too permissive rules will be monitored by Azure Security Center as recommendations\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"permissiveNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"44452482-524f-4bf4-b852-0bff7cc4a3ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1066 - Remote Access | Disconnect / Disable Access\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1066\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4455c2e8-c65d-4acf-895e-304916f90b36\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4455c2e8-c65d-4acf-895e-304916f90b36\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1720 - Spam Protection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1720\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44b9a7cd-f36a-491a-a48b-6d04ae7c4221\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"44b9a7cd-f36a-491a-a48b-6d04ae7c4221\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1334 - Authenticator Management | Pki-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1334\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44bfdadc-8c2e-4c30-9c99-f005986fabcd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"44bfdadc-8c2e-4c30-9c99-f005986fabcd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1604 - Developer Security Testing And Evaluation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1604\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44dbba23-0b61-478e-89c7-b3084667782f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"44dbba23-0b61-478e-89c7-b3084667782f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1712 - Software, Firmware, And Information Integrity\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1712\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44e543aa-41db-42aa-98eb-8a5eb1db53f0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"44e543aa-41db-42aa-98eb-8a5eb1db53f0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1310 - Device Identification And Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1310\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/450d7ede-823d-4931-a99d-57f6a38807dc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"450d7ede-823d-4931-a99d-57f6a38807dc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1559 - System And Services Acquisition Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1559\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/45692294-f074-42bd-ac54-16f1a3c07554\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"45692294-f074-42bd-ac54-16f1a3c07554\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1578 - Acquisition Process | Functions / Ports / Protocols / Services In Use\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1578\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/45b7b644-5f91-498e-9d89-7402532d3645\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"45b7b644-5f91-498e-9d89-7402532d3645\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1565 - System Development Life Cycle\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1565\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/45ce2396-5c76-4654-9737-f8792ab3d26b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"45ce2396-5c76-4654-9737-f8792ab3d26b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1337 - Authenticator Management | In-Person Or Trusted Third-Party Registration\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1337\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/463e5220-3f79-4e24-a63f-343e4096cd22\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"463e5220-3f79-4e24-a63f-343e4096cd22\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Require SQL Server version 12.0\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures all SQL servers use version 12.0. This policy is deprecated because it is no longer possible to create an Azure SQL server with any version other than 12.0.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Sql/servers/version\",\r\n                  \"equals\": \"12.0\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1346 - Identification And Authentication (Non-Organizational Users)\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1346\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/464dc8ce-2200-4720-87a5-dc5952924cc6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"464dc8ce-2200-4720-87a5-dc5952924cc6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported Python Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported Python version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestPython\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"46544d7b-1f0d-46f5-81da-5c1351de1b06\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require automatic OS image patching on Virtual Machine Scale Sets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enforces enabling automatic OS image patching on Virtual Machine Scale Sets to always keep Virtual Machines secure by safely applying latest security patches every month.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgradePolicy.enableAutomaticOSUpgrade\",\r\n                \"notEquals\": \"True\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade\",\r\n                \"notEquals\": \"True\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"465f0161-0087-490a-9ad9-ad6217f4f43a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1368 - Incident Handling | Correlation With External Organizations\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1368\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/465f32da-0ace-4603-8d1b-7be5a3a702de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"465f32da-0ace-4603-8d1b-7be5a3a702de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cognitive Services accounts should use customer owned storage\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy audits any Cognitive Services account not using customer owned storage.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cognitive Services\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.CognitiveServices/accounts/userOwnedStorage[*]\"\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/46aa9b05-0e60-4eae-a88b-1e9d374fa515\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"46aa9b05-0e60-4eae-a88b-1e9d374fa515\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1062 - Remote Access | Protection Of Confidentiality / Integrity Using Encryption\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1062\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4708723f-e099-4af1-bbf9-b6df7642e444\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4708723f-e099-4af1-bbf9-b6df7642e444\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage accounts should have infrastructure encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enable infrastructure encryption for higher level of assurance that the data is secure. When infrastructure encryption is enabled, data in a storage account is encrypted twice.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the audit policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/encryption.requireInfrastructureEncryption\",\r\n                \"notEquals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4733ea7b-a883-42fe-8cac-97454c2a9e4a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4733ea7b-a883-42fe-8cac-97454c2a9e4a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Cosmos DB key based metadata write access should be disabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables you to ensure all Azure Cosmos DB accounts disable key based metadata write access.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cosmos DB\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/disableKeyBasedMetadataWriteAccess\",\r\n                \"notEquals\": true\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/disableKeyBasedMetadataWriteAccess\",\r\n                \"value\": true\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4750c32b-89c0-46af-bfcb-2e4541a818d5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4750c32b-89c0-46af-bfcb-2e4541a818d5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Auto provisioning of the Log Analytics agent should be enabled on your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"To monitor for security vulnerabilities and threats, Azure Security Center collects data from your Azure virtual machines. Data is collected by the Log Analytics agent, formerly known as the Microsoft Monitoring Agent (MMA), which reads various security-related configurations and event logs from the machine and copies the data to your Log Analytics workspace for analysis. We recommend enabling auto provisioning to automatically deploy the agent to all supported Azure VMs and any new ones that are created.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/autoProvisioningSettings\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/autoProvisioningSettings/autoProvision\",\r\n                \"equals\": \"On\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/475aae12-b88a-4572-8b36-9b712b2b3a17\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"475aae12-b88a-4572-8b36-9b712b2b3a17\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Adaptive application controls for defining safe applications should be enabled on your machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enable application controls to define the list of known-safe applications running on your machines, and alert you when other applications run. This helps harden your machines against malware. To simplify the process of configuring and maintaining your rules, Security Center uses machine learning to analyze the applications running on each machine and suggest the list of known-safe applications.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"35f45c95-27cf-4e52-891f-8390d1de5828\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"47a6b606-51aa-4496-8bb7-64b11cf66adc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1359 - Incident Response Testing | Coordination With Related Plans\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1359\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/47bc7ea0-7d13-4f7c-a154-b903f7194253\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"47bc7ea0-7d13-4f7c-a154-b903f7194253\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1165 - Continuous Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1165\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/47e10916-6c9e-446b-b0bd-ff5fd439d79d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"47e10916-6c9e-446b-b0bd-ff5fd439d79d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1048 - System Use Notification\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1048\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/483e7ca9-82b3-45a2-be97-b93163a0deb7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"483e7ca9-82b3-45a2-be97-b93163a0deb7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1033 - Separation Of Duties\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1033\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/48540f01-fc11-411a-b160-42807c68896e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"48540f01-fc11-411a-b160-42807c68896e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1477 - Fire Protection | Detection Devices / Systems\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1477\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4862a63c-6c74-4a9d-a221-89af3c374503\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4862a63c-6c74-4a9d-a221-89af3c374503\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1484 - Water Damage Protection | Automation Support\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1484\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/486b006a-3653-45e8-b41c-a052d3e05456\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"486b006a-3653-45e8-b41c-a052d3e05456\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit IP restrictions configuration for an API App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects an API app from common attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"ConfigureIPRestrictions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"48893b84-a2c8-4d9a-badf-835d5d1b7d53\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Geo-redundant backup should be enabled for Azure Database for PostgreSQL\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Database for PostgreSQL allows you to choose the redundancy option for your database server. It can be set to a geo-redundant backup storage in which the data is not only stored within the region in which your server is hosted, but is also replicated to a paired region to provide recovery option in case of a region failure. Configuring geo-redundant storage for backup is only allowed during server create.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/storageProfile.geoRedundantBackup\",\r\n                \"notEquals\": \"Enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/48af4db5-9b8b-401c-8e74-076be876a430\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"48af4db5-9b8b-401c-8e74-076be876a430\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1669 - Flaw Remediation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1669\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/48f2f62b-5743-4415-a143-288adc0e078d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"48f2f62b-5743-4415-a143-288adc0e078d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Security Options - User Account Control'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Security Options - User Account Control' for mode for admins, behavior of elevation prompt, and virtualizing file and registry write failures. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SecurityOptionsUserAccountControl\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"UACAdminApprovalModeForTheBuiltinAdministratorAccount\": \"User Account Control: Admin Approval Mode for the Built-in Administrator account;ExpectedValue\",\r\n              \"UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\": \"User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode;ExpectedValue\",\r\n              \"UACDetectApplicationInstallationsAndPromptForElevation\": \"User Account Control: Detect application installations and prompt for elevation;ExpectedValue\",\r\n              \"UACRunAllAdministratorsInAdminApprovalMode\": \"User Account Control: Run all administrators in Admin Approval Mode;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"UACAdminApprovalModeForTheBuiltinAdministratorAccount\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"UAC: Admin Approval Mode for the Built-in Administrator account\",\r\n              \"description\": \"Specifies the behavior of Admin Approval Mode for the built-in Administrator account.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"UAC: Behavior of the elevation prompt for administrators in Admin Approval Mode\",\r\n              \"description\": \"Specifies the behavior of the elevation prompt for administrators.\"\r\n            },\r\n            \"defaultValue\": \"2\"\r\n          },\r\n          \"UACDetectApplicationInstallationsAndPromptForElevation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"UAC: Detect application installations and prompt for elevation\",\r\n              \"description\": \"Specifies the behavior of application installation detection for the computer.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"UACRunAllAdministratorsInAdminApprovalMode\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"UAC: Run all administrators in Admin Approval Mode\",\r\n              \"description\": \"Specifies the behavior of all User Account Control (UAC) policy settings for the computer.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsUserAccountControl\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('User Account Control: Admin Approval Mode for the Built-in Administrator account;ExpectedValue', '=', parameters('UACAdminApprovalModeForTheBuiltinAdministratorAccount'), ',', 'User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode;ExpectedValue', '=', parameters('UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode'), ',', 'User Account Control: Detect application installations and prompt for elevation;ExpectedValue', '=', parameters('UACDetectApplicationInstallationsAndPromptForElevation'), ',', 'User Account Control: Run all administrators in Admin Approval Mode;ExpectedValue', '=', parameters('UACRunAllAdministratorsInAdminApprovalMode')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/492a29ed-d143-4f03-b6a4-705ce081b463\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"492a29ed-d143-4f03-b6a4-705ce081b463\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1376 - Incident Response Assistance | Coordination With External Providers\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1376\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/493a95f3-f2e3-47d0-af02-65e6d6decc2f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"493a95f3-f2e3-47d0-af02-65e6d6decc2f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure that 'Java version' is the latest, if used as a part of the Web app\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Periodically, newer versions are released for Java software either due to security flaws or to include additional functionality. Using the latest Java version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. Currently, this policy only applies to Linux web apps.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"JavaLatestVersion\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Latest Java version\",\r\n              \"description\": \"Latest supported Java version for App Services\"\r\n            },\r\n            \"defaultValue\": \"11\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"app*\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"linux\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/web.linuxFxVersion\",\r\n                    \"notContains\": \"JAVA\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/web.linuxFxVersion\",\r\n                    \"like\": \"[concat('*', parameters('JavaLatestVersion'))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/496223c3-ad65-4ecd-878a-bae78737e9ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"496223c3-ad65-4ecd-878a-bae78737e9ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Add system-assigned managed identity to enable Guest Configuration assignments on VMs with a user-assigned identity\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy adds a system-assigned managed identity to virtual machines hosted in Azure that are supported by Guest Configuration and have at least one user-assigned identity but do not have a system-assigned managed identity. A system-assigned managed identity is a prerequisite for all Guest Configuration assignments and must be added to machines before using any Guest Configuration policy definitions. For more information on Guest Configuration, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"microsoft-aks\",\r\n                          \"qubole-inc\",\r\n                          \"datastax\",\r\n                          \"couchbase\",\r\n                          \"scalegrid\",\r\n                          \"checkpoint\",\r\n                          \"paloaltonetworks\",\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"OpenLogic\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"CentOS*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Oracle\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Oracle-Linux\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"RHEL\",\r\n                              \"RHEL-HA\",\r\n                              \"RHEL-SAP\",\r\n                              \"RHEL-SAP-APPS\",\r\n                              \"RHEL-SAP-HA\",\r\n                              \"RHEL-SAP-HANA\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"osa\",\r\n                              \"rhel-byos\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"cis-centos-7-l1\",\r\n                              \"cis-centos-7-v2-1-1-l1\",\r\n                              \"cis-centos-8-l1\",\r\n                              \"cis-debian-linux-8-l1\",\r\n                              \"cis-debian-linux-9-l1\",\r\n                              \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                              \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                              \"cis-oracle-linux-8-l1\",\r\n                              \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                              \"cis-rhel-7-l2\",\r\n                              \"cis-rhel-7-v2-2-0-l1\",\r\n                              \"cis-rhel-8-l1\",\r\n                              \"cis-suse-linux-12-v2-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1804-l1\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"credativ\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Debian\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"7*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Suse\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"SLES*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"11*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Canonical\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"UbuntuServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"12*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"linux-data-science-vm-ubuntu\",\r\n                              \"azureml\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-centos-os\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-altus-centos-os\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Linux*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"notIn\": [\r\n                                  \"OpenLogic\",\r\n                                  \"RedHat\",\r\n                                  \"credativ\",\r\n                                  \"Suse\",\r\n                                  \"Canonical\",\r\n                                  \"microsoft-dsvm\",\r\n                                  \"cloudera\",\r\n                                  \"microsoft-ads\",\r\n                                  \"center-for-internet-security-inc\",\r\n                                  \"Oracle\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"[requestContext().apiVersion]\",\r\n                \"greaterOrEquals\": \"2018-10-01\"\r\n              },\r\n              {\r\n                \"field\": \"identity.type\",\r\n                \"contains\": \"UserAssigned\"\r\n              },\r\n              {\r\n                \"field\": \"identity.type\",\r\n                \"notContains\": \"SystemAssigned\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"modify\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"identity.type\",\r\n                  \"value\": \"[concat(field('identity.type'), ',SystemAssigned')]\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/497dff13-db2a-4c0f-8603-28fa3b331ab6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"497dff13-db2a-4c0f-8603-28fa3b331ab6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'Security Options - Audit'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - Audit'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Audit: Shut down system immediately if unable to log security audits\",\r\n              \"description\": \"Audits if the system will shut down when unable to log Security events.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsAudit\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('Audit: Shut down system immediately if unable to log security audits;ExpectedValue', '=', parameters('AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SecurityOptionsAudit\"\r\n                    },\r\n                    \"AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\": {\r\n                      \"value\": \"[parameters('AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Audit: Shut down system immediately if unable to log security audits;ExpectedValue\",\r\n                                \"value\": \"[parameters('AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Audit: Shut down system immediately if unable to log security audits;ExpectedValue\",\r\n                                \"value\": \"[parameters('AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/498b810c-59cd-4222-9338-352ba146ccf3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"498b810c-59cd-4222-9338-352ba146ccf3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1329 - Authenticator Management | Password-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1329\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/498f6234-3e20-4b6a-a880-cbd646d973bd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"498f6234-3e20-4b6a-a880-cbd646d973bd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1638 - Boundary Protection | Dynamic Isolation / Segregation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1638\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/49b99653-32cd-405d-a135-e7d60a9aae1f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"49b99653-32cd-405d-a135-e7d60a9aae1f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append a tag and its value to resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Appends the specified tag and value when any resource group which is missing this tag is created or updated. Does not modify the tags of resource groups created before this policy was applied until those resource groups are changed. New 'modify' effect policies are available that support remediation of tags on existing resources (see https://aka.ms/modifydoc).\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Tags\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1294 - Information System Backup | Transfer To Alternate Storage Site\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1294\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/49dbe627-2c1e-438c-979e-dd7a39bbf81d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"49dbe627-2c1e-438c-979e-dd7a39bbf81d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1218 - Least Functionality | Prevent Program Execution\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1218\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4a1d0394-b9f5-493e-9e83-563fd0ac4df8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4a1d0394-b9f5-493e-9e83-563fd0ac4df8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1677 - Malicious Code Protection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1677\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4a248e1e-040f-43e5-bff2-afc3a57a3923\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4a248e1e-040f-43e5-bff2-afc3a57a3923\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1094 - Role-Based Security Training\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Awareness and Training control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1094\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4b1853e0-8973-446b-b567-09d901d31a09\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4b1853e0-8973-446b-b567-09d901d31a09\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Event Grid topics should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your topics instead of the entire service, you'll also be protected against data leakage risks. Learn more at: https://aka.ms/privateendpoints.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Event Grid\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.EventGrid/topics\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.EventGrid/topics/privateEndpointConnections[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.EventGrid/topics/privateEndpointConnections[*].privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4b90e17e-8448-49db-875e-bd83fb6f804f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4b90e17e-8448-49db-875e-bd83fb6f804f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1114 - Response To Audit Processing Failures | Real-Time Alerts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1114\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4c090801-59bc-4454-bb33-e0455133486a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4c090801-59bc-4454-bb33-e0455133486a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1364 - Incident Handling | Dynamic Reconfiguration\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1364\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4c615c2a-dc83-4dda-8220-abce7b50c9bc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4c615c2a-dc83-4dda-8220-abce7b50c9bc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1661 - Session Authenticity | Invalidate Session Identifiers At Logout\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1661\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4c643c9a-1be7-4016-a5e7-e4bada052920\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4c643c9a-1be7-4016-a5e7-e4bada052920\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1373 - Incident Reporting | Automated Reporting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1373\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4cca950f-c3b7-492a-8e8f-ea39663c14f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4cca950f-c3b7-492a-8e8f-ea39663c14f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1632 - Boundary Protection | Prevent Split Tunneling For Remote Devices\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1632\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4ce9073a-77fa-48f0-96b1-87aa8e6091c2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4ce9073a-77fa-48f0-96b1-87aa8e6091c2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines that do not have a maximum password age of 70 days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not have a maximum password age of 70 days\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"MaximumPasswordAge\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MaximumPasswordAge\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4ceb8dc2-559c-478b-a15b-733fbf1e3738\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4ceb8dc2-559c-478b-a15b-733fbf1e3738\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Linux VMs that do not have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Linux virtual machines that do not have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"ApplicationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Application names\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'python; powershell'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"microsoft-aks\",\r\n                          \"qubole-inc\",\r\n                          \"datastax\",\r\n                          \"couchbase\",\r\n                          \"scalegrid\",\r\n                          \"checkpoint\",\r\n                          \"paloaltonetworks\",\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"OpenLogic\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"CentOS*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Oracle\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Oracle-Linux\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"RHEL\",\r\n                              \"RHEL-HA\",\r\n                              \"RHEL-SAP\",\r\n                              \"RHEL-SAP-APPS\",\r\n                              \"RHEL-SAP-HA\",\r\n                              \"RHEL-SAP-HANA\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"osa\",\r\n                              \"rhel-byos\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"cis-centos-7-l1\",\r\n                              \"cis-centos-7-v2-1-1-l1\",\r\n                              \"cis-centos-8-l1\",\r\n                              \"cis-debian-linux-8-l1\",\r\n                              \"cis-debian-linux-9-l1\",\r\n                              \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                              \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                              \"cis-oracle-linux-8-l1\",\r\n                              \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                              \"cis-rhel-7-l2\",\r\n                              \"cis-rhel-7-v2-2-0-l1\",\r\n                              \"cis-rhel-8-l1\",\r\n                              \"cis-suse-linux-12-v2-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1804-l1\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"credativ\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Debian\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"7*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Suse\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"SLES*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"11*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Canonical\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"UbuntuServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"12*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"linux-data-science-vm-ubuntu\",\r\n                              \"azureml\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-centos-os\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-altus-centos-os\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Linux*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"notIn\": [\r\n                                  \"OpenLogic\",\r\n                                  \"RedHat\",\r\n                                  \"credativ\",\r\n                                  \"Suse\",\r\n                                  \"Canonical\",\r\n                                  \"microsoft-dsvm\",\r\n                                  \"cloudera\",\r\n                                  \"microsoft-ads\",\r\n                                  \"center-for-internet-security-inc\",\r\n                                  \"Oracle\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"installed_application_linux\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent', '=', concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"installed_application_linux\"\r\n                    },\r\n                    \"ApplicationName\": {\r\n                      \"value\": \"[parameters('ApplicationName')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ApplicationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent\",\r\n                                \"value\": \"[concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent\",\r\n                                \"value\": \"[concat('packages: [', replace(parameters('ApplicationName'), ';', ','), ']')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforLinux')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforLinux\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4d1c04de-2172-403f-901b-90608c35c721\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"FTPS should be required in your Web App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enable FTPS enforcement for enhanced security\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"app*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/ftpsState\",\r\n                \"in\": [\r\n                  \"FtpsOnly\",\r\n                  \"Disabled\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1155 - System Interconnections | Restrictions On External System Connections\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1155\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4d33f9f1-12d0-46ad-9fbd-8f8046694977\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4d33f9f1-12d0-46ad-9fbd-8f8046694977\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1156 - Plan Of Action And Milestones\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1156\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4d52e864-9a3b-41ee-8f03-520815fe5378\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4d52e864-9a3b-41ee-8f03-520815fe5378\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1312 - Identifier Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1312\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4d6a5968-9eef-4c18-8534-376790ab7274\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4d6a5968-9eef-4c18-8534-376790ab7274\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Dependency agent for Linux virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Dependency agent for Linux virtual machines if the VM Image (OS) is in the list defined and the agent is not installed.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.3.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"14.04.0-LTS\",\r\n                              \"14.04.1-LTS\",\r\n                              \"14.04.5-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"16.04-LTS\",\r\n                              \"16.04.0-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"18.04-LTS\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"12-SP2\",\r\n                              \"12-SP3\",\r\n                              \"12-SP4\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"DependencyAgentLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"DependencyAgentLinux\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                      \"vmExtensionType\": \"DependencyAgentLinux\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"9.6\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Defender for servers should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for servers provides real-time threat protection for server workloads and generates hardening recommendations as well as alerts about suspicious activities.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.3\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"VirtualMachines\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4da35fc9-c9e7-4960-aec9-797fe7d9051d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4da35fc9-c9e7-4960-aec9-797fe7d9051d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Data Lake Analytics to Event Hub\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Data Lake Analytics to stream to a regional Event Hub when any Data Lake Analytics which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_eventHub\"\r\n          },\r\n          \"eventHubRuleId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Event Hub Authorization Rule Id\",\r\n              \"description\": \"The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\",\r\n              \"strongType\": \"Microsoft.EventHub/Namespaces/AuthorizationRules\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"eventHubLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Event Hub Location\",\r\n              \"description\": \"The location the Event Hub resides in. Only Data Lake Analytics in this location will be linked to this Event Hub.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Event Hub - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Event Hub  - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataLakeAnalytics/accounts\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('eventHubLocation')]\",\r\n                    \"equals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"location\",\r\n                    \"equals\": \"[parameters('eventHubLocation')]\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"eventHubRuleId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"eventHubAuthorizationRuleId\": \"[parameters('eventHubRuleId')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"Audit\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Requests\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"eventHubRuleId\": {\r\n                      \"value\": \"[parameters('eventHubRuleId')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4daddf25-4823-43d4-88eb-2419eb6dcc08\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4daddf25-4823-43d4-88eb-2419eb6dcc08\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1394 - System Maintenance Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1394\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4db56f68-3f50-45ab-88f3-ca46f5379a94\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4db56f68-3f50-45ab-88f3-ca46f5379a94\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1702 - Information System Monitoring | Indicators Of Compromise\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1702\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4dfc0855-92c4-4641-b155-a55ddd962362\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4dfc0855-92c4-4641-b155-a55ddd962362\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1001 - Access Control Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1001\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4e26f8c3-4bf3-4191-b8fc-d888805101b7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4e26f8c3-4bf3-4191-b8fc-d888805101b7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1083 - Publicly Accessible Content\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1083\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4e319cb6-2ca3-4a58-ad75-e67f484e50ec\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4e319cb6-2ca3-4a58-ad75-e67f484e50ec\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1579 - Acquisition Process | Use Of Approved Piv Products\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1579\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4e54c7ef-7457-430b-9a3e-ef8881d4a8e0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4e54c7ef-7457-430b-9a3e-ef8881d4a8e0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1247 - Contingency Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1247\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4e666db5-b2ef-4b06-aac6-09bfce49151b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4e666db5-b2ef-4b06-aac6-09bfce49151b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1196 - Configuration Change Control | Automated Document / Notification / Prohibition Of Changes\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1196\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4e7f4ea4-dd62-44f6-8886-ac6137cf52b0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4e7f4ea4-dd62-44f6-8886-ac6137cf52b0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1134 - Protection Of Audit Information | Access By Subset Of Privileged Users\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1134\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4e95f70e-181c-4422-9da2-43079710c789\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4e95f70e-181c-4422-9da2-43079710c789\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1267 - Alternate Storage Site\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1267\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4e97ba1d-be5d-4953-8da4-0cccf28f4805\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4e97ba1d-be5d-4953-8da4-0cccf28f4805\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1192 - Configuration Change Control | Automated Document / Notification / Prohibition Of Changes\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1192\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4ebd97f7-b105-4f50-8daf-c51465991240\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4ebd97f7-b105-4f50-8daf-c51465991240\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure data factories should be encrypted with a customer-managed key (CMK)\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use customer-managed keys (CMKs) to manage the encryption at rest of your Azure Data Factory. By default, customer data is encrypted with service-managed keys, but CMKs are commonly required to meet regulatory compliance standards. CMKs enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more about CMK encryption at https://aka.ms/adf-cmk.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Data Factory\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataFactory/factories\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DataFactory/factories/encryption.vaultBaseUrl\",\r\n                \"exists\": false\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4ec52d6d-beb7-40c4-9a9e-fe753254690e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4ec52d6d-beb7-40c4-9a9e-fe753254690e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1139 - Audit Generation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1139\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4ed62522-de00-4dda-9810-5205733d2f34\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4ed62522-de00-4dda-9810-5205733d2f34\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"A maximum of 3 owners should be designated for your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"It is recommended to designate up to 3 subscription owners in order to reduce the potential for breach by a compromised owner.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"6f90a6d6-d4d6-0794-0ec1-98fa77878c2e\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4f11b553-d42e-4e3a-89be-32ca364cad4c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1442 - Media Sanitization | Nondestructive Techniques\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1442\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4f26049b-2c5a-4841-9ff3-d48a26aae475\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4f26049b-2c5a-4841-9ff3-d48a26aae475\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1182 - Baseline Configuration | Configure Systems, Components, Or Devices For High-Risk Areas\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1182\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4f34f554-da4b-4786-8d66-7915c90893da\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4f34f554-da4b-4786-8d66-7915c90893da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscriptions should have a contact email address for security issues\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"To ensure the relevant people in your organization are notified when there is a potential security breach in one of your subscriptions, set a security contact to receive email notifications from Security Center.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/securityContacts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/securityContacts/email\",\r\n                \"notEquals\": \"\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Add a tag to resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Adds the specified tag and value when any resource missing this tag is created or updated. Existing resources can be remediated by triggering a remediation task. If the tag exists with a different value it will not be changed. Does not modify tags on resource groups.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Tags\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"modify\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"operation\": \"add\",\r\n                  \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                  \"value\": \"[parameters('tagValue')]\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4f9dc7db-30c1-420c-b61a-e1d640128d26\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4f9dc7db-30c1-420c-b61a-e1d640128d26\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Storage account public access should be disallowed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Anonymous public read access to containers and blobs in Azure Storage is a convenient way to share data but might present security risks. To prevent data breaches caused by undesired anonymous access, Microsoft recommends preventing public access to a storage account unless your scenario requires it.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.1-preview\",\r\n          \"category\": \"Storage\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"id\",\r\n                \"notContains\": \"/resourceGroups/databricks-rg-\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/allowBlobPublicAccess\",\r\n                  \"equals\": \"false\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4fa4b6c0-31ca-4c0d-b10d-24b96f62a751\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"A vulnerability assessment solution should be enabled on your virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audits virtual machines to detect whether they are running a supported vulnerability assessment solution. A core component of every cyber risk and security program is the identification and analysis of vulnerabilities. Azure Security Center's standard pricing tier includes vulnerability scanning for your virtual machines at no extra cost. Additionally, Security Center can automatically deploy this tool for you.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"ffff0522-1e88-47fc-8382-2a80ba848f5d\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"501541f7-f7e7-4cd6-868c-4190fdad3ac9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1485 - Delivery And Removal\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1485\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/50301354-95d0-4a11-8af5-8039ecf6d38b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"50301354-95d0-4a11-8af5-8039ecf6d38b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1646 - Cryptographic Key Establishment And Management | Asymmetric Keys\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1646\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/506814fa-b930-4b10-894e-a45b98c40e1a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"506814fa-b930-4b10-894e-a45b98c40e1a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1566 - System Development Life Cycle\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1566\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/50ad3724-e2ac-4716-afcc-d8eabd97adb9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"50ad3724-e2ac-4716-afcc-d8eabd97adb9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"A custom IPsec/IKE policy must be applied to all Azure virtual network gateway connections\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy ensures that all Azure virtual network gateway connections use a custom Internet Protocol Security(Ipsec)/Internet Key Exchange(IKE) policy. Supported algorithms and key strengths - https://aka.ms/AA62kb0\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"IPsecEncryption\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IPsec Encryption\",\r\n              \"description\": \"IPsec Encryption\"\r\n            }\r\n          },\r\n          \"IPsecIntegrity\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IPsec Integrity\",\r\n              \"description\": \"IPsec Integrity\"\r\n            }\r\n          },\r\n          \"IKEEncryption\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IKE Encryption\",\r\n              \"description\": \"IKE Encryption\"\r\n            }\r\n          },\r\n          \"IKEIntegrity\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IKE Integrity\",\r\n              \"description\": \"IKE Integrity\"\r\n            }\r\n          },\r\n          \"DHGroup\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"DH Group\",\r\n              \"description\": \"DH Group\"\r\n            }\r\n          },\r\n          \"PFSGroup\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"PFS Group\",\r\n              \"description\": \"PFS Group\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/connections\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Network/connections/ipsecPolicies[*].ipsecEncryption\",\r\n                    \"notIn\": \"[parameters('IPsecEncryption')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/connections/ipsecPolicies[*].ipsecIntegrity\",\r\n                    \"notIn\": \"[parameters('IPsecIntegrity')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/connections/ipsecPolicies[*].ikeEncryption\",\r\n                    \"notIn\": \"[parameters('IKEEncryption')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/connections/ipsecPolicies[*].ikeIntegrity\",\r\n                    \"notIn\": \"[parameters('IKEIntegrity')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/connections/ipsecPolicies[*].dhGroup\",\r\n                    \"notIn\": \"[parameters('DHGroup')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/connections/ipsecPolicies[*].pfsGroup\",\r\n                    \"notIn\": \"[parameters('PFSGroup')]\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/50b83b09-03da-41c1-b656-c293c914862b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"50b83b09-03da-41c1-b656-c293c914862b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1248 - Contingency Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1248\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/50fc602d-d8e0-444b-a039-ad138ee5deb0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"50fc602d-d8e0-444b-a039-ad138ee5deb0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1386 - Information Spillage Response\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1386\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5120193e-91fd-4f9d-bc6d-194f94734065\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5120193e-91fd-4f9d-bc6d-194f94734065\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Bot Service should be encrypted with a customer-managed key\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Bot Service automatically encrypts your resource to protect your data and meet organizational security and compliance commitments. By default, Microsoft-managed encryption keys are used. For greater flexibility in managing keys or controlling access to your subscription, select customer-managed keys, also known as bring your own key (BYOK). Learn more about Azure Bot Service encryption: https://docs.microsoft.com/azure/bot-service/bot-service-encryption.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Bot Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The desired effect of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.BotService/botServices\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.BotService/botServices/isCmekEnabled\",\r\n                \"notEquals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/51522a96-0869-4791-82f3-981000c2c67f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"51522a96-0869-4791-82f3-981000c2c67f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1352 - Incident Response Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1352\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/518cb545-bfa8-43f8-a108-3b7d5037469a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"518cb545-bfa8-43f8-a108-3b7d5037469a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Defender for Kubernetes should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for Kubernetes provides real-time threat protection for containerized environments and generates alerts for suspicious activities.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.3\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"KubernetesService\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/523b5cd1-3e23-492f-a539-13118b6d1e3a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"523b5cd1-3e23-492f-a539-13118b6d1e3a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1642 - Network Disconnect\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1642\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/53397227-5ee3-4b23-9e5e-c8a767ce6928\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"53397227-5ee3-4b23-9e5e-c8a767ce6928\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Connection throttling should be enabled for PostgreSQL database servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy helps audit any PostgreSQL databases in your environment without Connection throttling enabled. This setting enables temporary connection throttling per IP for too many invalid password login failures.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DBforPostgreSQL/servers/configurations\",\r\n              \"name\": \"connection_throttling\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/configurations/value\",\r\n                \"equals\": \"ON\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5345bb39-67dc-4960-a1bf-427e16b9a0bd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5345bb39-67dc-4960-a1bf-427e16b9a0bd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure SignalR Service should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your  SignalR resources instead of the entire service, you'll also be protected against data leakage risks .Learn more at: https://aka.ms/asrs/privatelink.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"SignalR\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.SignalRService/SignalR\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.SignalRService/SignalR/privateEndpointConnections[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.SignalRService/SignalR/privateEndpointConnections[*].privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/53503636-bcc9-4748-9663-5348217f160f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"53503636-bcc9-4748-9663-5348217f160f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1467 - Visitor Access Records\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1467\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5350cbf9-8bdd-4904-b22a-e88be84ca49d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5350cbf9-8bdd-4904-b22a-e88be84ca49d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1183 - Baseline Configuration | Configure Systems, Components, Or Devices For High-Risk Areas\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1183\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5352e3e0-e63a-452e-9e5f-9c1d181cff9c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5352e3e0-e63a-452e-9e5f-9c1d181cff9c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1029 - Information Flow Enforcement | Security Policy Filters\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1029\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/53ac8f8e-c2b5-4d44-8a2d-058e9ced9b69\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"53ac8f8e-c2b5-4d44-8a2d-058e9ced9b69\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1270 - Alternate Storage Site | Recovery Time / Point Objectives\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1270\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/53c76a39-2097-408a-b237-b279f7b4614d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"53c76a39-2097-408a-b237-b279f7b4614d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1040 - Least Privilege | Review Of User Privileges\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1040\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/54205576-cec9-463f-ba44-b4b3f5d0a84c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"54205576-cec9-463f-ba44-b4b3f5d0a84c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1015 - Account Management | Disable Inactive Accounts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1015\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/544a208a-9c3f-40bc-b1d1-d7e144495c14\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"544a208a-9c3f-40bc-b1d1-d7e144495c14\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1026 - Account Management | Disable Accounts For High-Risk Individuals\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1026\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/55419419-c597-4cd4-b51e-009fd2266783\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"55419419-c597-4cd4-b51e-009fd2266783\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1045 - Unsuccessful Logon Attempts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1045\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/554d2dd6-f3a8-4ad5-b66f-5ce23bd18892\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"554d2dd6-f3a8-4ad5-b66f-5ce23bd18892\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Firewall should be enabled on Key Vault\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Key vault's firewall prevents unauthorized traffic from reaching your key vault and provides an additional layer of protection for your secrets. Enable the firewall to make sure that only traffic from allowed networks can access your key vault.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2-preview\",\r\n          \"category\": \"Key Vault\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Preview]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/vaults\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.KeyVault/vaults/networkAcls.defaultAction\",\r\n                \"notEquals\": \"Deny\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"55615ac9-af46-4a59-874e-391cc3dfb490\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1523 - Personnel Transfer\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1523\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5577a310-2551-49c8-803b-36e0d5e55601\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5577a310-2551-49c8-803b-36e0d5e55601\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1113 - Response To Audit Processing Failures | Audit Storage Capacity\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1113\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/562afd61-56be-4313-8fe4-b9564aa4ba7d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"562afd61-56be-4313-8fe4-b9564aa4ba7d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Web Application Firewall (WAF) should be enabled for Application Gateway\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Azure Web Application Firewall (WAF) in front of public facing web applications for additional inspection of incoming traffic. Web Application Firewall (WAF) provides centralized protection of your web applications from common exploits and vulnerabilities such as SQL injections, Cross-Site Scripting, local and remote file executions. You can also restrict access to your web applications by countries, IP address ranges, and other http(s) parameters via custom rules.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/applicationGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/applicationGateways/webApplicationFirewallConfiguration\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"564feb30-bf6a-4854-b4bb-0d2d2d1e6c66\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1212 - Configuration Settings | Automated Central Management / Application / Verification\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1212\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/56d970ee-4efc-49c8-8a4e-5916940d784c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"56d970ee-4efc-49c8-8a4e-5916940d784c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"IP firewall rules on Azure Synapse workspaces should be removed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Removing all IP firewall rules improves security by ensuring your Azure Synapse workspace can only be accessed from a private endpoint. This configuration audits creation of firewall rules that allow public network access on the workspace.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Synapse\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Synapse/workspaces/firewallrules\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"exists\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/56fd377d-098c-4f02-8406-81eb055902b8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"56fd377d-098c-4f02-8406-81eb055902b8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1403 - Controlled Maintenance | Automated Maintenance Activities\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1403\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/57149289-d52b-4f40-9fe6-5233c1ef80f7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"57149289-d52b-4f40-9fe6-5233c1ef80f7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CORS should not allow every resource to access your Web Applications\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Cross-Origin Resource Sharing (CORS) should not allow all domains to access your web application. Allow only required domains to interact with your web app.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"app*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.cors.allowedOrigins[*]\",\r\n                \"notEquals\": \"*\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5744710e-cc2f-4ee8-8809-3b11e89f4bc9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows web servers that are not using secure communication protocols\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the registry key HKLM:\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\SecurityProviders\\\\SCHANNEL\\\\Protocols includes protocols less secure than what is selected in the policy parameter.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AuditSecureProtocol\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"MinimumTLSVersion\": \"[SecureWebServer]s1;MinimumTLSVersion\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"MinimumTLSVersion\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Minimum TLS version\",\r\n              \"description\": \"The minimum TLS protocol version that should be enabled. Windows web servers with lower TLS versions will be marked as non-compliant.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"1.1\",\r\n              \"1.2\"\r\n            ],\r\n            \"defaultValue\": \"1.1\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AuditSecureProtocol\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[SecureWebServer]s1;MinimumTLSVersion', '=', parameters('MinimumTLSVersion')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5752e6d6-1206-46d8-8ab1-ecc2f71a8112\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5752e6d6-1206-46d8-8ab1-ecc2f71a8112\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1162 - Continuous Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1162\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5770f3d6-8c2b-4f6f-bf0e-c8c8fc36d592\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5770f3d6-8c2b-4f6f-bf0e-c8c8fc36d592\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1054 - Session Termination\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1054\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5807e1b4-ba5e-4718-8689-a0ca05a191b2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5807e1b4-ba5e-4718-8689-a0ca05a191b2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'System Audit Policies - Detailed Tracking'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Detailed Tracking' for auditing DPAPI, process creation/termination, RPC events, and PNP activity. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SystemAuditPoliciesDetailedTracking\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"AuditProcessTermination\": \"Audit Process Termination;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"AuditProcessTermination\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Process Termination\",\r\n              \"description\": \"Specifies whether audit events are generated when a process has exited. Recommended for monitoring termination of critical processes.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"No Auditing\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesDetailedTracking\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Audit Process Termination;ExpectedValue', '=', parameters('AuditProcessTermination')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/58383b73-94a9-4414-b382-4146eb02611b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"58383b73-94a9-4414-b382-4146eb02611b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1584 - Information System Documentation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1584\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5864522b-ff1d-4979-a9f8-58bee1fb174c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5864522b-ff1d-4979-a9f8-58bee1fb174c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1547 - Vulnerability Scanning\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1547\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/58abf9b8-c6d4-4b4b-bfb9-fe98fe295f52\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"58abf9b8-c6d4-4b4b-bfb9-fe98fe295f52\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines on which Windows Serial Console is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the machine does not have the Serial Console software installed or if the EMS port number or baud rate are not configured with the same values as the policy parameters.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"WindowsSerialConsole\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"EMSPortNumber\": \"[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber\",\r\n              \"EMSBaudRate\": \"[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"EMSPortNumber\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"EMS Port Number\",\r\n              \"description\": \"An integer indicating the COM port to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ],\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"EMSBaudRate\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"EMS Baud Rate\",\r\n              \"description\": \"An integer indicating the baud rate to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"9600\",\r\n              \"19200\",\r\n              \"38400\",\r\n              \"57600\",\r\n              \"115200\"\r\n            ],\r\n            \"defaultValue\": \"115200\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsSerialConsole\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber', '=', parameters('EMSPortNumber'), ',', '[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate', '=', parameters('EMSBaudRate')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/58c460e9-7573-4bb2-9676-339c2f2486bb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"58c460e9-7573-4bb2-9676-339c2f2486bb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1573 - Acquisition Process\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1573\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/58c93053-7b98-4cf0-b99f-1beb985416c2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"58c93053-7b98-4cf0-b99f-1beb985416c2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Ensure Function app is using the latest version of TLS encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Please use /providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193 instead. The TLS(Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards, such as PCI DSS\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"App Service\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"[Deprecated]: Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"functionapp*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.minTlsVersion\",\r\n                \"equals\": \"1.2\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/58d94fc1-a072-47c2-bd37-9cdb38e77453\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"58d94fc1-a072-47c2-bd37-9cdb38e77453\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1063 - Remote Access | Managed Access Control Points\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1063\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/593ce201-54b2-4dd0-b34f-c308005d7780\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"593ce201-54b2-4dd0-b34f-c308005d7780\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1463 - Monitoring Physical Access\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1463\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/59721f87-ae25-4db0-a2a4-77cc5b25d495\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"59721f87-ae25-4db0-a2a4-77cc5b25d495\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1425 - Timely Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1425\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5983d99c-f39b-4c32-a3dc-170f19f6941b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5983d99c-f39b-4c32-a3dc-170f19f6941b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1512 - Personnel Screening\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1512\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5a8324ad-f599-429b-aaed-f9c6e8c987a8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5a8324ad-f599-429b-aaed-f9c6e8c987a8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Operating system version should be the most current version for your cloud service roles\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Keeping the operating system (OS) on the most recent supported version for your cloud service roles enhances the systems security posture.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.ClassicCompute/domainNames/slots/roles\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"8bc390da-9eb6-938d-25ed-44a35d9bcc9d\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5a913c68-0590-402c-a531-e57e19379da3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5a913c68-0590-402c-a531-e57e19379da3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs that do not have a minimum password age of 1 day\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have a minimum password age of 1 day. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordAge\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5aa11bbc-5c76-4302-80e5-aba46a4282e7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1032 - Separation Of Duties\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1032\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5aa85661-d618-46b8-a20f-ca40a86f0751\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5aa85661-d618-46b8-a20f-ca40a86f0751\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs that do not restrict the minimum password length to 14 characters\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not restrict the minimum password length to 14 characters. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordLength\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5aebc8d1-020d-4037-89a0-02043a7524ec\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1555 - Vulnerability Scanning | Privileged Access\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1555\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5afa8cab-1ed7-4e40-884c-64e0ac2059cc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5afa8cab-1ed7-4e40-884c-64e0ac2059cc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines that allow re-use of the previous 24 passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that allow re-use of the previous 24 passwords\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"EnforcePasswordHistory\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"EnforcePasswordHistory\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5b054a0d-39e2-4d53-bea3-9734cad2c69b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5b054a0d-39e2-4d53-bea3-9734cad2c69b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1205 - Access Restrictions For Change | Signed Components\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1205\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5b070cab-0fb8-4e48-ad29-fc90b4c2797c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5b070cab-0fb8-4e48-ad29-fc90b4c2797c\"\r\n    }\r\n  ],\r\n  \"nextLink\": \"https://management.azure.com/subscriptions/f67cc918-f64f-4c3f-aa24-a855465f9d41/providers/Microsoft.Authorization/policyDefinitions?api-version=2020-09-01&%24skiptoken=eyJuZXh0UG9saWN5U3RvcmUiOiJDb250cm9sUGxhbmVCdWlsdEluRGVmaW5pdGlvbiIsIm5leHRQYXJ0aXRpb25LZXkiOiIxITghTXpJd056VS0iLCJuZXh0Um93S2V5IjoiMSExMDQhUmpoRFJFVkdNekZCTXpGRk5FSTBRVGt6UlRRMVJqVTNNVVU1TVRJMU5VRmZMVFZDTmpJMlFVSkRPakpFTWpaRU5Eb3lSRFJGTWpJNk1rUTVSRVU0T2pKRU16Z3pNVGd4T0RVeU5rSXgifQ%253D%253D\"\r\n}",
      "StatusCode": 200
    }
  ],
  "Names": {
    "CanCrudPolicyAssignment": [
      "azsmnet8952",
      "azsmnet5088",
      "azsmnet8873"
    ]
  },
  "Variables": {
    "SubscriptionId": "f67cc918-f64f-4c3f-aa24-a855465f9d41"
  }
}