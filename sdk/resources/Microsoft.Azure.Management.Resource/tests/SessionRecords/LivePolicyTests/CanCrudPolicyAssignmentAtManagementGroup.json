{
  "Entries": [
    {
      "RequestUri": "/providers/Microsoft.Management/managementGroups?api-version=2021-04-01",
      "EncodedRequestUri": "L3Byb3ZpZGVycy9NaWNyb3NvZnQuTWFuYWdlbWVudC9tYW5hZ2VtZW50R3JvdXBzP2FwaS12ZXJzaW9uPTIwMjEtMDQtMDE=",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "e3e01b59-82f6-4d07-8777-7d5555e83783"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.700.22.51102",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.22621",
          "Microsoft.Azure.Management.ManagementGroups.ManagementGroupsAPIClient/1.1.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westcentralus:d9f939de-6ec5-4356-9711-e0c61c8d9b94"
        ],
        "x-ba-restapi": [
          "0.0.0.0"
        ],
        "client-request-id": [
          "d9f939de-6ec5-4356-9711-e0c61c8d9b94"
        ],
        "request-id": [
          "d9f939de-6ec5-4356-9711-e0c61c8d9b94"
        ],
        "Server": [
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-correlation-request-id": [
          "d9f939de-6ec5-4356-9711-e0c61c8d9b94"
        ],
        "x-ms-routing-request-id": [
          "WESTCENTRALUS:20221117T033408Z:d9f939de-6ec5-4356-9711-e0c61c8d9b94"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 17 Nov 2022 03:34:08 GMT"
        ],
        "Content-Length": [
          "285"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n      \"type\": \"Microsoft.Management/managementGroups\",\r\n      \"name\": \"AzGovPerfTest\",\r\n      \"properties\": {\r\n        \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n        \"displayName\": \"Azure Governance Performance Test\"\r\n      }\r\n    }\r\n  ],\r\n  \"@nextLink\": null\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/providers/Microsoft.Management/managementGroups/azsmnet9706?api-version=2021-04-01",
      "EncodedRequestUri": "L3Byb3ZpZGVycy9NaWNyb3NvZnQuTWFuYWdlbWVudC9tYW5hZ2VtZW50R3JvdXBzL2F6c21uZXQ5NzA2P2FwaS12ZXJzaW9uPTIwMjEtMDQtMDE=",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"name\": \"azsmnet9706\",\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignmentAtManagementGroup\",\r\n    \"details\": {\r\n      \"parent\": {\r\n        \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\"\r\n      }\r\n    }\r\n  }\r\n}",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "45c46d51-1988-454e-8a30-443fe703dab8"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.700.22.51102",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.22621",
          "Microsoft.Azure.Management.ManagementGroups.ManagementGroupsAPIClient/1.1.1.0"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "251"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-ratelimit-remaining-managementgroups-requests": [
          "59"
        ],
        "x-ms-request-id": [
          "westcentralus:a2067eeb-99e1-4175-81b6-6588873e015b"
        ],
        "x-ba-restapi": [
          "0.0.0.0"
        ],
        "client-request-id": [
          "a2067eeb-99e1-4175-81b6-6588873e015b"
        ],
        "request-id": [
          "a2067eeb-99e1-4175-81b6-6588873e015b"
        ],
        "Server": [
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-ratelimit-remaining-tenant-writes": [
          "1199"
        ],
        "x-ms-correlation-request-id": [
          "a2067eeb-99e1-4175-81b6-6588873e015b"
        ],
        "x-ms-routing-request-id": [
          "WESTCENTRALUS:20221117T033410Z:a2067eeb-99e1-4175-81b6-6588873e015b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 17 Nov 2022 03:34:10 GMT"
        ],
        "Content-Length": [
          "533"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"id\": \"/providers/Microsoft.Management/managementGroups/azsmnet9706\",\r\n  \"type\": \"Microsoft.Management/managementGroups\",\r\n  \"name\": \"azsmnet9706\",\r\n  \"properties\": {\r\n    \"tenantId\": \"72f988bf-86f1-41af-91ab-2d7cd011db47\",\r\n    \"displayName\": \"CanCrudPolicyAssignmentAtManagementGroup\",\r\n    \"details\": {\r\n      \"version\": 2,\r\n      \"updatedTime\": \"2022-11-17T03:25:41.9112839Z\",\r\n      \"updatedBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"parent\": {\r\n        \"id\": \"/providers/Microsoft.Management/managementGroups/AzGovPerfTest\",\r\n        \"name\": \"AzGovPerfTest\",\r\n        \"displayName\": \"Azure Governance Performance Test\"\r\n      }\r\n    }\r\n  }\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/providers/Microsoft.Authorization/policyDefinitions?api-version=2021-06-01",
      "EncodedRequestUri": "L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDIxLTA2LTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "d14a5605-8ae9-4da6-b96b-4ec8a92c3f21"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.700.22.51102",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.22621",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.17.4.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "Server": [
          "Kestrel"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11999"
        ],
        "x-ms-request-id": [
          "a2a20a0e-53eb-4a6e-b141-9591205dcff1"
        ],
        "x-ms-correlation-request-id": [
          "a2a20a0e-53eb-4a6e-b141-9591205dcff1"
        ],
        "x-ms-routing-request-id": [
          "WESTCENTRALUS:20221117T033410Z:a2a20a0e-53eb-4a6e-b141-9591205dcff1"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 17 Nov 2022 03:34:09 GMT"
        ],
        "Content-Length": [
          "820510"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1599 - Developer Configuration Management | Software / Firmware Integrity Verification\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1599\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0004bbf0-5099-4179-869e-e9ffe5fb0945\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0004bbf0-5099-4179-869e-e9ffe5fb0945\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit virtual machines without disaster recovery configured\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit virtual machines which do not have disaster recovery configured. To learn more about disaster recovery, visit https://aka.ms/asr-doc.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Resources/links\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"like\": \"ASR-Protect-*\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Sockets state for a Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within an Function app must be carefully reviewed.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"functionapp,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"DisableWebSockets\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"001802d1-4969-4c82-a700-c29c6c6f9bbd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1375 - Incident Response Assistance | Automation Support For Availability Of Information / Support\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1375\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/00379355-8932-4b52-b63a-3bc6daf3451a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"00379355-8932-4b52-b63a-3bc6daf3451a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Restrict location of information processing, storage and services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1593 - Restrict location of information processing, storage and services\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1593\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0040d2e5-2779-170d-6a2c-1f5fca353335\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0040d2e5-2779-170d-6a2c-1f5fca353335\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerability assessment should be enabled on your Synapse workspaces\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Discover, track, and remediate potential vulnerabilities by configuring recurring SQL vulnerability assessment scans on your Synapse workspaces.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Synapse\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Synapse/workspaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Synapse/workspaces/vulnerabilityAssessments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Synapse/workspaces/vulnerabilityAssessments/recurringScans.isEnabled\",\r\n                \"equals\": \"True\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0049a6b3-a662-4f3e-8635-39cf44ace45a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0049a6b3-a662-4f3e-8635-39cf44ace45a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1605 - Developer Security Testing And Evaluation | Static Code Analysis\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1605\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0062eb8b-dc75-4718-8ea5-9bb4a9606655\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0062eb8b-dc75-4718-8ea5-9bb4a9606655\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Establish parameters for searching secret authenticators and verifiers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0274 - Establish parameters for searching secret authenticators and verifiers\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0274\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0065241c-72e9-3b2c-556f-75de66332a94\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0065241c-72e9-3b2c-556f-75de66332a94\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL Server Integration Services integration runtimes on Azure Data Factory should be joined to a virtual network\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Virtual Network deployment provides enhanced security and isolation for your SQL Server Integration Services integration runtimes on Azure Data Factory, as well as subnets, access control policies, and other features to further restrict access.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Data Factory\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataFactory/factories/integrationRuntimes\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DataFactory/factories/integrationruntimes/type\",\r\n                \"equals\": \"Managed\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DataFactory/factories/integrationRuntimes/Managed.typeProperties.computeProperties.vnetProperties.vnetId\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0088bc63-6dee-4a9c-9d29-91cfdc848952\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0088bc63-6dee-4a9c-9d29-91cfdc848952\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Configure VMSS created with Shared Image Gallery images to install the Guest Attestation extension\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configure VMSS created with Shared Image Gallery images to automatically install the Guest Attestation extension to allow Azure Security Center to proactively attest and monitor the boot integrity. Boot integrity is attested via Remote Attestation.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"2.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"attestationEndpoint\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Guest attestation tenant URL\",\r\n              \"description\": \"The Microsoft Azure Attestation (MAA) custom tenant URL.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.securityType\",\r\n                \"equals\": \"TrustedLaunch\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.uefiSettings\",\r\n                \"exists\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.uefiSettings.vTpmEnabled\",\r\n                \"equals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/virtualMachineProfile.securityProfile.uefiSettings.secureBootEnabled\",\r\n                \"equals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageid\",\r\n                \"exists\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"in\": [\r\n                      \"Microsoft.Azure.Security.LinuxAttestation\",\r\n                      \"Microsoft.Azure.Security.WindowsAttestation\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"GuestAttestation\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/provisioningState\",\r\n                    \"in\": [\r\n                      \"Succeeded\",\r\n                      \"Provisioning succeeded\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/acdd72a7-3385-48ef-bd42-f606fba81ae7\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"imageId\": {\r\n                      \"value\": \"[field('Microsoft.Compute/imageid')]\"\r\n                    },\r\n                    \"attestationEndpoint\": {\r\n                      \"value\": \"[parameters('attestationEndpoint')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"imageId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"attestationEndpoint\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"extensionName\": \"GuestAttestation\",\r\n                      \"extensionPublisherPrefix\": \"Microsoft.Azure.Security.\",\r\n                      \"extensionPublisherSuffix\": \"Attestation\",\r\n                      \"extensionVersion\": \"1.0\",\r\n                      \"maaTenantName\": \"GuestAttestation\",\r\n                      \"ascReportingEndpoint\": \"\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"apiVersion\": \"2018-10-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('extensionName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[concat(variables('extensionPublisherPrefix'), reference(split(parameters('imageId'), '/versions')[0], '2021-07-01').osType, variables('extensionPublisherSuffix'))]\",\r\n                          \"type\": \"[variables('extensionName')]\",\r\n                          \"typeHandlerVersion\": \"[variables('extensionVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"AttestationConfig\": {\r\n                              \"MaaSettings\": {\r\n                                \"maaEndpoint\": \"[parameters('attestationEndpoint')]\",\r\n                                \"maaTenantName\": \"[variables('maaTenantName')]\"\r\n                              },\r\n                              \"AscSettings\": {\r\n                                \"ascReportingEndpoint\": \"[variables('ascReportingEndpoint')]\",\r\n                                \"ascReportingFrequency\": \"\"\r\n                              },\r\n                              \"useCustomToken\": \"false\",\r\n                              \"disableAlerts\": \"false\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/009259b0-12e8-42c9-94e7-7af86aa58d13\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"009259b0-12e8-42c9-94e7-7af86aa58d13\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Private endpoint connections on Batch accounts should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoint connections allow secure communication by enabling private connectivity to Batch accounts without a need for public IP addresses at the source or destination. Learn more about private endpoints in Batch at https://docs.microsoft.com/azure/batch/private-connectivity.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Batch\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Batch/batchAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Batch/batchAccounts/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Batch/batchAccounts/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/009a0c92-f5b4-4776-9b66-4ed2b4775563\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"009a0c92-f5b4-4776-9b66-4ed2b4775563\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Integrate risk management process into SDLC\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1567 - Integrate risk management process into SDLC\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1567\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/00f12b6f-10d7-8117-9577-0f2b76488385\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"00f12b6f-10d7-8117-9577-0f2b76488385\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"View and configure system diagnostic data\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0544 - View and configure system diagnostic data\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0544\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0123edae-3567-a05a-9b05-b53ebe9d3e7e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0123edae-3567-a05a-9b05-b53ebe9d3e7e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Backup should be enabled for Virtual Machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Ensure protection of your Azure Virtual Machines by enabling Azure Backup. Azure Backup is a secure and cost effective data protection solution for Azure.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Backup\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"id\",\r\n                \"notContains\": \"/resourceGroups/databricks-rg-\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"notEquals\": \"azureopenshift\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"notEquals\": \"AzureDatabricks\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.RecoveryServices/backupprotecteditems\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/013e242c-8828-4970-87b3-ab247555486d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"013e242c-8828-4970-87b3-ab247555486d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure App Service app slots to use the latest TLS version\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for App Service apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites/slots\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"functionapp\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/slots/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/slots/config/minTlsVersion\",\r\n                \"equals\": \"1.2\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"siteName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"siteId\": {\r\n                      \"value\": \"[field('id')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"siteName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"siteId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Web/sites/slots/config\",\r\n                        \"apiVersion\": \"2021-02-01\",\r\n                        \"name\": \"[format('{0}/{1}/web', split(split(parameters('siteId'),'/')[7]), parameters('siteName'))]\",\r\n                        \"properties\": {\r\n                          \"minTlsVersion\": \"1.2\"\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/014664e7-e348-41a3-aeb9-566e4ff6a9df\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"014664e7-e348-41a3-aeb9-566e4ff6a9df\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1142 - Certification, Authorization, Security Assessment Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1142\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/01524fa8-4555-48ce-ba5f-c3b8dcef5147\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"01524fa8-4555-48ce-ba5f-c3b8dcef5147\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Implement a threat awareness program\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1758 - Implement a threat awareness program\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1758\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/015b4935-448a-8684-27c0-d13086356c33\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"015b4935-448a-8684-27c0-d13086356c33\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1099 - Security Training Records\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Awareness and Training control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1099\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/01910bab-8639-4bd0-84ef-cc53b24d79ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"01910bab-8639-4bd0-84ef-cc53b24d79ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Implement system boundary protection\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0328 - Implement system boundary protection\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0328\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/01ae60e2-38bb-0a32-7b20-d3a091423409\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"01ae60e2-38bb-0a32-7b20-d3a091423409\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Authorize remote access to privileged commands\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1064 - Authorize remote access to privileged commands\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1064\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/01c387ea-383d-4ca9-295a-977fab516b03\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"01c387ea-383d-4ca9-295a-977fab516b03\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1285 - Telecommunications Services | Provider Contingency Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1285\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/01f7726b-db54-45c2-bcb5-9bd7a43796ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"01f7726b-db54-45c2-bcb5-9bd7a43796ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1709 - Security Functionality Verification\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1709\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/025992d6-7fee-4137-9bbf-2ffc39c0686c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"025992d6-7fee-4137-9bbf-2ffc39c0686c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1052 - Session Lock\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1052\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/027cae1c-ec3e-4492-9036-4168d540c42a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"027cae1c-ec3e-4492-9036-4168d540c42a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure a private DNS Zone ID for table groupID\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configure private DNS zone group to override the DNS resolution for a table groupID private endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"privateDnsZoneId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Configure a private DNS Zone ID for table groupID\",\r\n              \"description\": \"Configure private DNS zone group to override the DNS resolution for a table groupID private endpoint.\",\r\n              \"strongType\": \"Microsoft.Network/privateDnsZones\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/privateEndpoints\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\r\n                    \"equals\": \"table\"\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"privateDnsZoneId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"privateEndpointName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\r\n                        \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\r\n                        \"apiVersion\": \"2020-03-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"privateDnsZoneConfigs\": [\r\n                            {\r\n                              \"name\": \"privateDnsZone\",\r\n                              \"properties\": {\r\n                                \"privateDnsZoneId\": \"[parameters('privateDnsZoneId')]\"\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"privateDnsZoneId\": {\r\n                      \"value\": \"[parameters('privateDnsZoneId')]\"\r\n                    },\r\n                    \"privateEndpointName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/028bbd88-e9b5-461f-9424-a1b63a7bee1a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"028bbd88-e9b5-461f-9424-a1b63a7bee1a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1034 - Least Privilege\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1034\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/02a5ed00-6d2e-4e97-9a98-46c32c057329\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"02a5ed00-6d2e-4e97-9a98-46c32c057329\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs on which the remote connection status does not match the specified one\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines on which the remote host connection status does not match the specified one. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsRemoteConnection\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/02a84be7-c304-421f-9bb7-5d2c26af54ad\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"02a84be7-c304-421f-9bb7-5d2c26af54ad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1623 - Boundary Protection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1623\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/02ce1b22-412a-4528-8630-c42146f917ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"02ce1b22-412a-4528-8630-c42146f917ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1515 - Personnel Termination\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1515\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/02dd141a-a2b2-49a7-bcbd-ca31142f6211\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"02dd141a-a2b2-49a7-bcbd-ca31142f6211\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1327 - Authenticator Management | Password-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1327\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03188d8f-1ae5-4fe1-974d-2d7d32ef937d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03188d8f-1ae5-4fe1-974d-2d7d32ef937d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Azure Security agent should be installed on your Windows Arc machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Install the Azure Security agent on your Windows Arc machines in order to monitor your machines for security configurations and vulnerabilities. Results of the assessments can seen and managed in Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"1.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HybridCompute/machines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                \"like\": \"windows*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.HybridCompute/machines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/type\",\r\n                    \"equals\": \"AzureSecurityWindowsAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/Publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0367cfc4-90b3-46ba-a8a6-ddd5d3514878\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0367cfc4-90b3-46ba-a8a6-ddd5d3514878\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1229 - Information System Component Inventory | No Duplicate Accounting Of Components\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1229\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03752212-103c-4ab8-a306-7e813022ca9d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03752212-103c-4ab8-a306-7e813022ca9d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Identify incident response personnel\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0301 - Identify incident response personnel\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0301\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/037c0089-6606-2dab-49ad-437005b5035f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"037c0089-6606-2dab-49ad-437005b5035f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cognitive Services accounts should restrict network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Network access to Cognitive Services accounts should be restricted. Configure network rules so only applications from allowed networks can access the Cognitive Services account. To allow connections from specific internet or on-premises clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Cognitive Services\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/networkAcls.defaultAction\",\r\n                \"notEquals\": \"Deny\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"037eea7a-bd0a-46c5-9a66-03aea78705d3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1123 - Audit Review, Analysis, And Reporting | Audit Level Adjustment\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1123\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03996055-37a4-45a5-8b70-3f1caa45f87d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03996055-37a4-45a5-8b70-3f1caa45f87d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1474 - Emergency Power | Long-Term Alternate Power Supply - Minimal Operational Capability\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1474\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03ad326e-d7a1-44b1-9a76-e17492efc9e4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03ad326e-d7a1-44b1-9a76-e17492efc9e4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Design an access control model\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0129 - Design an access control model\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0129\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03b6427e-6072-4226-4bd9-a410ab65317e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03b6427e-6072-4226-4bd9-a410ab65317e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1227 - Information System Component Inventory | Automated Unauthorized Component Detection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1227\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03b78f5e-4877-4303-b0f4-eb6583f25768\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03b78f5e-4877-4303-b0f4-eb6583f25768\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Review access control policies and procedures\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0457 - Review access control policies and procedures\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0457\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03d550b4-34ee-03f4-515f-f2e2faf7a413\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03d550b4-34ee-03f4-515f-f2e2faf7a413\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1361 - Incident Handling\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1361\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/03ed3be1-7276-4452-9a5d-e4168565ac67\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"03ed3be1-7276-4452-9a5d-e4168565ac67\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Kubernetes Service Private Clusters should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enable the private cluster feature for your Azure Kubernetes Service cluster to ensure network traffic between your API server and your node pools remains on the private network only. This is a common requirement in many regulatory and industry compliance standards.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Kubernetes\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy.\",\r\n              \"portalReview\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\",\r\n                \"notEquals\": true\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"040732e8-d947-40b8-95d6-854c95024bf8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1594 - Developer Configuration Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1594\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/042ba2a1-8bb8-45f4-b080-c78cf62b90e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"042ba2a1-8bb8-45f4-b080-c78cf62b90e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Create a data inventory\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0096 - Create a data inventory\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0096\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/043c1e56-5a16-52f8-6af8-583098ff3e60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"043c1e56-5a16-52f8-6af8-583098ff3e60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Linux machines that have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the Chef InSpec resource indicates that one or more of the packages provided by the parameter are installed.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"4.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"not_installed_application_linux\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"ApplicationName\": \"[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\r\n              \"portalReview\": \"true\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"ApplicationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should not be installed. e.g. 'python; powershell'\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"microsoft-aks\",\r\n                          \"qubole-inc\",\r\n                          \"datastax\",\r\n                          \"couchbase\",\r\n                          \"scalegrid\",\r\n                          \"checkpoint\",\r\n                          \"paloaltonetworks\",\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"OpenLogic\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"CentOS*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Oracle\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Oracle-Linux\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"RHEL\",\r\n                              \"RHEL-HA\",\r\n                              \"RHEL-SAP\",\r\n                              \"RHEL-SAP-APPS\",\r\n                              \"RHEL-SAP-HA\",\r\n                              \"RHEL-SAP-HANA\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"osa\",\r\n                              \"rhel-byos\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"cis-centos-7-l1\",\r\n                              \"cis-centos-7-v2-1-1-l1\",\r\n                              \"cis-centos-8-l1\",\r\n                              \"cis-debian-linux-8-l1\",\r\n                              \"cis-debian-linux-9-l1\",\r\n                              \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                              \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                              \"cis-oracle-linux-8-l1\",\r\n                              \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                              \"cis-rhel-7-l2\",\r\n                              \"cis-rhel-7-v2-2-0-l1\",\r\n                              \"cis-rhel-8-l1\",\r\n                              \"cis-suse-linux-12-v2-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1804-l1\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"credativ\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Debian\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"7*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Suse\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"SLES*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"11*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Canonical\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"contains\": \"Ubuntu\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"12*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"linux-data-science-vm-ubuntu\",\r\n                              \"azureml\",\r\n                              \"ubuntu-hpc\",\r\n                              \"ubuntu-1804\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-centos-os\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-altus-centos-os\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Linux*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"notIn\": [\r\n                                  \"OpenLogic\",\r\n                                  \"RedHat\",\r\n                                  \"credativ\",\r\n                                  \"Suse\",\r\n                                  \"Canonical\",\r\n                                  \"microsoft-dsvm\",\r\n                                  \"cloudera\",\r\n                                  \"microsoft-ads\",\r\n                                  \"center-for-internet-security-inc\",\r\n                                  \"Oracle\",\r\n                                  \"AzureDatabricks\",\r\n                                  \"azureopenshift\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"not_installed_application_linux\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent', '=', parameters('ApplicationName')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0447bc18-e2f7-4c0d-aa20-bff034275be1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0447bc18-e2f7-4c0d-aa20-bff034275be1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage account keys should not be expired\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Ensure the user storage account keys are not expired when key expiration policy is set, for improving security of account keys by taking action when the keys are expired.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Audit allows a non-compliant resource to be created, but flags it as non-compliant. Deny blocks the resource creation and update. Disable turns off the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"value\": \"[utcNow()]\",\r\n                    \"greater\": \"[if(and(not(empty(coalesce(field('Microsoft.Storage/storageAccounts/keyCreationTime.key1'), ''))), not(empty(string(coalesce(field('Microsoft.Storage/storageAccounts/keyPolicy.keyExpirationPeriodInDays'), ''))))), addDays(field('Microsoft.Storage/storageAccounts/keyCreationTime.key1'), field('Microsoft.Storage/storageAccounts/keyPolicy.keyExpirationPeriodInDays')), utcNow())]\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[utcNow()]\",\r\n                    \"greater\": \"[if(and(not(empty(coalesce(field('Microsoft.Storage/storageAccounts/keyCreationTime.key2'), ''))), not(empty(string(coalesce(field('Microsoft.Storage/storageAccounts/keyPolicy.keyExpirationPeriodInDays'), ''))))), addDays(field('Microsoft.Storage/storageAccounts/keyCreationTime.key2'), field('Microsoft.Storage/storageAccounts/keyPolicy.keyExpirationPeriodInDays')), utcNow())]\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/044985bb-afe1-42cd-8a36-9d5d42424537\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"044985bb-afe1-42cd-8a36-9d5d42424537\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Verify inaccurate or outdated PII\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1823 - Verify inaccurate or outdated PII\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1823\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0461cacd-0b3b-4f66-11c5-81c9b19a3d22\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0461cacd-0b3b-4f66-11c5-81c9b19a3d22\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Display an explicit logout message\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1056 - Display an explicit logout message\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1056\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0471c6b7-1588-701c-2713-1fade73b75f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0471c6b7-1588-701c-2713-1fade73b75f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Cosmos DB allowed locations\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can specify when deploying Azure Cosmos DB resources. Use to enforce your geo-compliance requirements.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Cosmos DB\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of locations that can be specified when deploying Azure Cosmos DB resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"policyEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Policy Effect\",\r\n              \"description\": \"The desired effect of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"Audit\",\r\n              \"deny\",\r\n              \"Deny\",\r\n              \"disabled\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Deny\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.DocumentDB/databaseAccounts/Locations[*]\",\r\n                  \"where\": {\r\n                    \"value\": \"[replace(toLower(first(field('Microsoft.DocumentDB/databaseAccounts/Locations[*].locationName'))), ' ', '')]\",\r\n                    \"in\": \"[parameters('listOfAllowedLocations')]\"\r\n                  }\r\n                },\r\n                \"notEquals\": \"[length(field('Microsoft.DocumentDB/databaseAccounts/Locations[*]'))]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('policyEffect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0473574d-2d43-4217-aefe-941fcdf7e684\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0473574d-2d43-4217-aefe-941fcdf7e684\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: SQL managed instances should use customer-managed keys to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy is deprecated. Please use /providers/Microsoft.Authorization/policyDefinitions/ac01ad65-10e5-46df-bdd9-6b0cad13e1d2 instead\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2-deprecated\",\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/encryptionProtector\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/serverKeyType\",\r\n                    \"equals\": \"AzureKeyVault\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/uri\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/managedInstances/encryptionProtector/uri\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"048248b0-55cd-46da-b1ff-39efd52db260\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Develop configuration management plan\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1232 - Develop configuration management plan\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1232\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04837a26-2601-1982-3da7-bf463e6408f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04837a26-2601-1982-3da7-bf463e6408f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Document and implement wireless access guidelines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0190 - Document and implement wireless access guidelines\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0190\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04b3e7f6-4841-888d-4799-cda19a0084f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04b3e7f6-4841-888d-4799-cda19a0084f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Network traffic data collection agent should be installed on Linux virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Security Center uses the Microsoft Dependency agent to collect network traffic data from your Azure virtual machines to enable advanced network protection features such as traffic visualization on the network map, network hardening recommendations and specific network threats.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2-preview\",\r\n          \"category\": \"Monitoring\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable Dependency Agent for Linux VMs monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"14.04.0-LTS\",\r\n                              \"14.04.1-LTS\",\r\n                              \"14.04.5-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"16.04-LTS\",\r\n                              \"16.04.0-LTS\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"18.04-LTS\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"in\": [\r\n                              \"12-SP2\",\r\n                              \"12-SP3\",\r\n                              \"12-SP4\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"DependencyAgentLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04c4380f-3fae-46e8-96c9-30193528f602\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Shared dashboards should not have markdown tiles with inline content\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disallow creating a shared dashboard that has inline content in markdown tiles and enforce that the content should be stored as a markdown file that's hosted online. If you use inline content in the markdown tile, you cannot manage encryption of the content. By configuring your own storage, you can encrypt, double encrypt and even bring your own keys. Enabling this policy restricts users to use 2020-09-01-preview or above version of shared dashboards REST API.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Portal\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Portal/dashboards\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"value\": \"[requestContext().apiVersion]\",\r\n                      \"greaterOrEquals\": \"2020-09-01-alpha\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"count\": {\r\n                      \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*]\",\r\n                      \"where\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*].metadata.type\",\r\n                            \"equals\": \"Extension/HubsExtension/PartType/MarkdownPart\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*].metadata.Extension-HubsExtension-PartType-MarkdownPart.settings.content.settings.markdownUri\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*].metadata.Extension-HubsExtension-PartType-MarkdownPart.settings.content.settings.markdownSource\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Portal/dashboards/lenses[*].parts[*].metadata.Extension-HubsExtension-PartType-MarkdownPart.settings.content.settings.markdownSource\",\r\n                                \"equals\": \"1\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    },\r\n                    \"greater\": 0\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04c655fe-0ac7-48ae-9a32-3a2e208c7624\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04c655fe-0ac7-48ae-9a32-3a2e208c7624\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Service Bus to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Service Bus to stream to a regional Log Analytics workspace when any Service Bus which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ServiceBus/namespaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.ServiceBus/namespaces/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"OperationalLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"VNetAndIPFilteringLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04d53d87-841c-4f23-8a5b-21564380b55e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1572 - Acquisitions Process\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1572\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/04f5fb00-80bb-48a9-a75b-4cb4d4c97c36\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"04f5fb00-80bb-48a9-a75b-4cb4d4c97c36\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Linux Virtual Machine Scale Sets to be associated with a Data Collection Rule\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Association to link Linux virtual machine scale sets to the specified Data Collection Rule. The list of locations and OS images are updated over time as support is increased.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"listOfLinuxImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Additional Linux Machine Images\",\r\n              \"description\": \"List of virtual machine scale set images that have supported Linux OS to add to scope. Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"dcrResourceId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Data Collection Rule Resource Id\",\r\n              \"description\": \"Resource Id of the Data Collection Rule to be applied on the Linux virtual machine scale sets in scope.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"australiacentral\",\r\n                  \"australiacentral2\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"brazilsouth\",\r\n                  \"brazilsoutheast\",\r\n                  \"canadacentral\",\r\n                  \"canadaeast\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"eastasia\",\r\n                  \"eastus2euap\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"francecentral\",\r\n                  \"francesouth\",\r\n                  \"germanywestcentral\",\r\n                  \"japaneast\",\r\n                  \"japanwest\",\r\n                  \"jioindiawest\",\r\n                  \"koreacentral\",\r\n                  \"koreasouth\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"norwayeast\",\r\n                  \"norwaywest\",\r\n                  \"southafricanorth\",\r\n                  \"southcentralus\",\r\n                  \"southeastasia\",\r\n                  \"southindia\",\r\n                  \"switzerlandnorth\",\r\n                  \"switzerlandwest\",\r\n                  \"uaenorth\",\r\n                  \"uksouth\",\r\n                  \"ukwest\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westindia\",\r\n                  \"westus\",\r\n                  \"westus2\"\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfLinuxImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-ARM64\",\r\n                          \"RHEL-BYOS\",\r\n                          \"RHEL-HA\",\r\n                          \"RHEL-SAP\",\r\n                          \"RHEL-SAP-APPS\",\r\n                          \"RHEL-SAP-HA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"8*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"rhel-lvm7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"rhel-lvm8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"in\": [\r\n                                  \"SLES\",\r\n                                  \"SLES-HPC\",\r\n                                  \"SLES-HPC-Priority\",\r\n                                  \"SLES-SAP\",\r\n                                  \"SLES-SAP-BYOS\",\r\n                                  \"SLES-Priority\",\r\n                                  \"SLES-BYOS\",\r\n                                  \"SLES-SAPCAL\",\r\n                                  \"SLES-Standard\"\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"12*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"15*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-12*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-15*\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"in\": [\r\n                                  \"gen1\",\r\n                                  \"gen2\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"UbuntuServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"0001-com-ubuntu-server-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"0001-com-ubuntu-pro-*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"14.04.0-lts\",\r\n                          \"14.04.1-lts\",\r\n                          \"14.04.2-lts\",\r\n                          \"14.04.3-lts\",\r\n                          \"14.04.4-lts\",\r\n                          \"14.04.5-lts\",\r\n                          \"16_04_0-lts-gen2\",\r\n                          \"16_04-lts-gen2\",\r\n                          \"16.04-lts\",\r\n                          \"16.04.0-lts\",\r\n                          \"18_04-lts-arm64\",\r\n                          \"18_04-lts-gen2\",\r\n                          \"18.04-lts\",\r\n                          \"20_04-lts-arm64\",\r\n                          \"20_04-lts-gen2\",\r\n                          \"20_04-lts\",\r\n                          \"22_04-lts-gen2\",\r\n                          \"22_04-lts\",\r\n                          \"pro-16_04-lts-gen2\",\r\n                          \"pro-16_04-lts\",\r\n                          \"pro-18_04-lts-gen2\",\r\n                          \"pro-18_04-lts\",\r\n                          \"pro-20_04-lts-gen2\",\r\n                          \"pro-20_04-lts\",\r\n                          \"pro-22_04-lts-gen2\",\r\n                          \"pro-22_04-lts\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"6*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"almalinux\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"almalinux\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"like\": \"8*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"ctrliqinc1648673227698\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"rocky-8*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"like\": \"rocky-8*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"Debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"equals\": \"9\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"debian-10\",\r\n                          \"debian-11\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"10\",\r\n                          \"10-gen2\",\r\n                          \"11\",\r\n                          \"11-gen2\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoftcblmariner\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cbl-mariner\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"1-gen2\",\r\n                          \"cbl-mariner-1\",\r\n                          \"cbl-mariner-2\",\r\n                          \"cbl-mariner-2-arm64\",\r\n                          \"cbl-mariner-2-gen2\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Insights/dataCollectionRuleAssociations/dataCollectionRuleId\",\r\n                \"equals\": \"[parameters('dcrResourceId')]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"dcrResourceId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"associationName\": \"[concat('assoc-', uniqueString(parameters('dcrResourceId')))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('associationName')]\",\r\n                        \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n                        \"apiVersion\": \"2021-04-01\",\r\n                        \"properties\": {\r\n                          \"dataCollectionRuleId\": \"[parameters('dcrResourceId')]\"\r\n                        },\r\n                        \"scope\": \"[concat('Microsoft.Compute/virtualMachineScaleSets/', parameters('resourceName'))]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"dcrResourceId\": {\r\n                      \"value\": \"[parameters('dcrResourceId')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/050a90d5-7cce-483f-8f6c-0df462036dda\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"050a90d5-7cce-483f-8f6c-0df462036dda\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure API for FHIR should use a customer-managed key to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use a customer-managed key to control the encryption at rest of the data stored in Azure API for FHIR when this is a regulatory or compliance requirement. Customer-managed keys also deliver double encryption by adding a second layer of encryption on top of the default one done with service-managed keys.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"API for FHIR\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"Audit\",\r\n              \"disabled\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HealthcareApis/services\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.HealthcareApis/services/cosmosDbConfiguration.keyVaultKeyUri\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/051cba44-2429-45b9-9649-46cec11c7119\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"051cba44-2429-45b9-9649-46cec11c7119\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Log Analytics extension for Linux VMs. See deprecation notice below\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Log Analytics extension for Linux VMs if the VM Image (OS) is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of VM images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"in\": [\r\n                                  \"SLES\",\r\n                                  \"SLES-HPC\",\r\n                                  \"SLES-HPC-Priority\",\r\n                                  \"SLES-SAP\",\r\n                                  \"SLES-SAP-BYOS\",\r\n                                  \"SLES-Priority\",\r\n                                  \"SLES-BYOS\",\r\n                                  \"SLES-SAPCAL\",\r\n                                  \"SLES-Standard\"\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"like\": \"12*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"like\": \"15*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-12-sp*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-15-sp*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-sap-15-sp1*\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"in\": [\r\n                                  \"gen1\",\r\n                                  \"gen2\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"UbuntuServer\",\r\n                          \"0001-com-ubuntu-server-focal\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"14.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16_04*lts-gen2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18_04*lts-gen2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"20_04*lts\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"20_04*lts-gen2\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"9*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7.*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"OmsAgentForLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"OMSAgentForLinux\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"vmExtensionType\": \"OmsAgentForLinux\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"1.13\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                            \"stopOnMultipleConnections\": \"true\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"053d3325-282c-4e5c-b944-24faffd30d77\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1331 - Authenticator Management | Password-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1331\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05460fe2-301f-4ed1-8174-d62c8bb92ff4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05460fe2-301f-4ed1-8174-d62c8bb92ff4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Web Application Firewall should be enabled for Azure Front Door entry-points\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Azure Web Application Firewall (WAF) in front of public facing web applications for additional inspection of incoming traffic. Web Application Firewall (WAF) provides centralized protection of your web applications from common exploits and vulnerabilities such as SQL injections, Cross-Site Scripting, local and remote file executions. You can also restrict access to your web applications by countries, IP address ranges, and other http(s) parameters via custom rules.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/frontdoors\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/frontdoors/frontendEndpoints[*].webApplicationFirewallPolicyLink.id\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"055aa869-bc98-4af8-bafc-23f1ab6ffe2c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Develop and maintain a vulnerability management standard\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0152 - Develop and maintain a vulnerability management standard\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0152\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/055da733-55c6-9e10-8194-c40731057ec4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"055da733-55c6-9e10-8194-c40731057ec4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Private endpoint should be enabled for PostgreSQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for PostgreSQL. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DBforPostgreSQL/servers/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0564d078-92f5-4f97-8398-b9f58a51f70b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0564d078-92f5-4f97-8398-b9f58a51f70b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Satisfy token quality requirements\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0487 - Satisfy token quality requirements\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0487\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/056a723b-4946-9d2a-5243-3aa27c4d31a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"056a723b-4946-9d2a-5243-3aa27c4d31a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerability Assessment settings for SQL server should contain an email address to receive scan reports\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Ensure that an email address is provided for the 'Send scan reports to' field in the Vulnerability Assessment settings. This email address receives scan result summary after a periodic scan runs on SQL servers.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/vulnerabilityAssessments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/vulnerabilityAssessments/default.recurringScans.emails[*]\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"count\": {\r\n                      \"field\": \"Microsoft.Sql/servers/vulnerabilityAssessments/default.recurringScans.emails[*]\"\r\n                    },\r\n                    \"notEquals\": 0\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Resource logs in Azure Data Lake Store should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of resource logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\",\r\n        \"metadata\": {\r\n          \"version\": \"5.0.0\",\r\n          \"category\": \"Data Lake\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required resource logs retention in days\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"0\"\r\n                              },\r\n                              {\r\n                                \"value\": \"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\",\r\n                                \"greaterOrEquals\": \"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                                \"notEquals\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/storageAccountId\",\r\n                                \"exists\": false\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"057ef27e-665e-4328-8ea3-04b3122bd9fb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce security configuration settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0249 - Enforce security configuration settings\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0249\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/058e9719-1ff9-3653-4230-23f76b6492e0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"058e9719-1ff9-3653-4230-23f76b6492e0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1132 - Protection Of Audit Information | Audit Backup On Separate Physical Systems / Components\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1132\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05938e10-cdbd-4a54-9b2b-1cbcfc141ad0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05938e10-cdbd-4a54-9b2b-1cbcfc141ad0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1223 - Information System Component Inventory\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1223\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05a1bb01-ad5a-49c1-aad3-b0c893b2ec3a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05a1bb01-ad5a-49c1-aad3-b0c893b2ec3a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1640 - Transmission Confidentiality And Integrity\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1640\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05a289ce-6a20-4b75-a0f3-dc8601b6acd0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05a289ce-6a20-4b75-a0f3-dc8601b6acd0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1728 - Incident Handling\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1728\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05a32666-d134-4842-a8cb-5c299f4bc099\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05a32666-d134-4842-a8cb-5c299f4bc099\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1420 - Maintenance Personnel\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1420\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05ae08cc-a282-413b-90c7-21a2c60b8404\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05ae08cc-a282-413b-90c7-21a2c60b8404\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Implement physical security for offices, working areas, and secure areas\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0323 - Implement physical security for offices, working areas, and secure areas\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0323\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05ec66a2-137c-14b8-8e75-3d7a2bef07f8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05ec66a2-137c-14b8-8e75-3d7a2bef07f8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1752 - Information Security Workforce\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1752\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/05f5163b-bd90-49eb-8b6e-c1044d0b170a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05f5163b-bd90-49eb-8b6e-c1044d0b170a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1658 - Secure Name / Address Resolution Service (Recursive Or Caching Resolver)\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1658\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/063b540e-4bdc-4e7a-a569-3a42ddf22098\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"063b540e-4bdc-4e7a-a569-3a42ddf22098\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1688 - Information System Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1688\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/063c3f09-e0f0-4587-8fd5-f4276fae675f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"063c3f09-e0f0-4587-8fd5-f4276fae675f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure File Sync to use private DNS zones\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"To access the private endpoint(s) for Storage Sync Service resource interfaces from a registered server, you need to configure your DNS to resolve the correct names to your private endpoint's private IP addresses. This policy creates the requisite Azure Private DNS Zone and A records for the interfaces of your Storage Sync Service private endpoint(s).\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"privateDnsZoneId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"privateDnsZoneId\",\r\n              \"strongType\": \"Microsoft.Network/privateDnsZones\",\r\n              \"description\": \"Private DNS Zone Identifier\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/privateEndpoints\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\r\n                    \"equals\": \"afs\"\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f\",\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"privateDnsZoneId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"privateEndpointName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\r\n                        \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\r\n                        \"apiVersion\": \"2020-03-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"privateDnsZoneConfigs\": [\r\n                            {\r\n                              \"name\": \"privatelink-afs\",\r\n                              \"properties\": {\r\n                                \"privateDnsZoneId\": \"[parameters('privateDnsZoneId')]\"\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"privateDnsZoneId\": {\r\n                      \"value\": \"[parameters('privateDnsZoneId')]\"\r\n                    },\r\n                    \"privateEndpointName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06695360-db88-47f6-b976-7500d4297475\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06695360-db88-47f6-b976-7500d4297475\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1332 - Authenticator Management | Password-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1332\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/068260be-a5e6-4b0a-a430-cd27071c226a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"068260be-a5e6-4b0a-a430-cd27071c226a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1455 - Physical Access Control\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1455\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/068a88d4-e520-434e-baf0-9005a8164e6a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"068a88d4-e520-434e-baf0-9005a8164e6a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Obtain consent prior to collection or processing of personal data\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0385 - Obtain consent prior to collection or processing of personal data\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0385\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/069101ac-4578-31da-0cd4-ff083edd3eb4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"069101ac-4578-31da-0cd4-ff083edd3eb4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit SQL DB Level Audit Setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit DB level audit setting for SQL databases\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers/databases\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"master\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                    \"equals\": \"[parameters('setting')]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit VMs that do not use managed disks\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits VMs that do not use managed disks\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                        \"exists\": \"True\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                        \"exists\": \"True\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a4d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Establish a discrete line item in budgeting documentation\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1563 - Establish a discrete line item in budgeting documentation\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1563\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06af77de-02ca-0f3e-838a-a9420fe466f5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06af77de-02ca-0f3e-838a-a9420fe466f5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1366 - Incident Handling | Information Correlation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1366\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06c45c30-ae44-4f0f-82be-41331da911cc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06c45c30-ae44-4f0f-82be-41331da911cc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Implement privacy notice delivery methods\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0324 - Implement privacy notice delivery methods\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0324\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06f84330-4c27-21f7-72cd-7488afd50244\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06f84330-4c27-21f7-72cd-7488afd50244\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure resources are authorized\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1159 - Ensure resources are authorized\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1159\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0716f0f5-4955-2ccb-8d5e-c6be14d57c0f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0716f0f5-4955-2ccb-8d5e-c6be14d57c0f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cognitive Services accounts should disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"To improve the security of Cognitive Services accounts, ensure that it isn't exposed to the public internet and can only be accessed from a private endpoint. Disable the public network access property as described in https://go.microsoft.com/fwlink/?linkid=2129800. This option disables access from any public address space outside the Azure IP range, and denies all logins that match IP or virtual network-based firewall rules. This reduces data leakage risks.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.1\",\r\n          \"category\": \"Cognitive Services\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0725b4dd-7e76-479c-a735-68e7ee23d5ca\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0725b4dd-7e76-479c-a735-68e7ee23d5ca\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1744 - Risk Management Strategy\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1744\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/07458826-9325-4481-abaf-bc9ed043459d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"07458826-9325-4481-abaf-bc9ed043459d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1633 - Boundary Protection | Route Traffic To Authenticated Proxy Servers\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1633\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/07557aa0-e02f-4460-9a81-8ecd2fed601a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"07557aa0-e02f-4460-9a81-8ecd2fed601a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Discover any indicators of compromise\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1702 - Discover any indicators of compromise\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1702\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/07b42fb5-027e-5a3c-4915-9d9ef3020ec7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"07b42fb5-027e-5a3c-4915-9d9ef3020ec7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Document acquisition contract acceptance criteria\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0187 - Document acquisition contract acceptance criteria\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0187\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0803eaa7-671c-08a7-52fd-ac419f775e75\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0803eaa7-671c-08a7-52fd-ac419f775e75\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Function apps should not have CORS configured to allow every resource to access your apps\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Cross-Origin Resource Sharing (CORS) should not allow all domains to access your Function app. Allow only required domains to interact with your Function app.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"workflowapp\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.cors.allowedOrigins[*]\",\r\n                \"notEquals\": \"*\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0820b7b9-23aa-4725-a1ce-ae4558f718e5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require developers to implement only approved changes\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1596 - Require developers to implement only approved changes\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1596\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/085467a6-9679-5c65-584a-f55acefd0d43\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"085467a6-9679-5c65-584a-f55acefd0d43\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy - Configure Log Analytics extension to be enabled on Windows virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Log Analytics extension for Windows virtual machines if the virtual machine image is in the list defined and the extension is not installed. Deprecation notice: The Log Analytics agent is on a deprecation path and won't be supported after August 31, 2024. You must migrate to the replacement 'Azure Monitor agent' prior to that date.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.1\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Log Analytics workspace is used to receive performance data. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of virtual machine images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2016-datacenter-gensecond\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\",\r\n                          \"2019-datacenter-gensecond\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-V4\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"MicrosoftMonitoringAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"MicrosoftMonitoringAgent\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                      \"vmExtensionType\": \"MicrosoftMonitoringAgent\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"1.0\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\",\r\n                            \"stopOnMultipleConnections\": \"true\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0868462e-646c-4fe3-9ced-a733534b6a2c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1583 - Information System Documentation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1583\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0882d488-8e80-4466-bc0f-0cd15b6cb66d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0882d488-8e80-4466-bc0f-0cd15b6cb66d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines on which the DSC configuration is not compliant\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if the Windows PowerShell command Get-DSCConfigurationStatus returns that the DSC configuration for the machine is not compliant.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"3.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"WindowsDscConfiguration\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\r\n              \"portalReview\": \"true\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"dsvm-win*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"[concat('WindowsDscConfiguration$pid', uniqueString(policy().assignmentId, policy().definitionReferenceId))]\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08a2f2d2-94b2-4a7b-aa3b-bb3f523ee6fd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08a2f2d2-94b2-4a7b-aa3b-bb3f523ee6fd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Configure Dependency agent on Azure Arc enabled Linux servers with Azure Monitoring Agent settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enable VM insights on servers and machines connected to Azure through Arc enabled servers by installing the Dependency agent virtual machine extension with Azure Monitoring Agent settings. VM insights uses the Dependency agent to collect network metrics and discovered data about processes running on the machine and external process dependencies. See more - https://aka.ms/vminsightsdocs.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.1-preview\",\r\n          \"category\": \"Monitoring\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"enableProcessesAndDependencies\": {\r\n            \"type\": \"Boolean\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable Processes and Dependencies\",\r\n              \"description\": \"This is the flag for enabling processes and dependencies data collection in VMInsights. If you are using this standalone policy and what to install Dependency Agent, keep this value as true.\"\r\n            },\r\n            \"allowedValues\": [\r\n              true,\r\n              false\r\n            ],\r\n            \"defaultValue\": true\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HybridCompute/machines\"\r\n              },\r\n              {\r\n                \"value\": \"[parameters('enableProcessesAndDependencies')]\",\r\n                \"equals\": true\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.HybridCompute/machines/osName\",\r\n                \"equals\": \"linux\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.HybridCompute/machines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/type\",\r\n                    \"equals\": \"DependencyAgentLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"DependencyAgentLinux\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                      \"vmExtensionType\": \"DependencyAgentLinux\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2019-12-12\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"settings\": {\r\n                            \"enableAMA\": \"true\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled DA extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08a4470f-b26d-428d-97f4-7e3e9c92b366\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08a4470f-b26d-428d-97f4-7e3e9c92b366\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Edge Hardware Center devices should have double encryption support enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Ensure that devices ordered from Azure Edge Hardware Center have double encryption support enabled, to secure the data at rest on the device. This option adds a second layer of data encryption.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Azure Edge Hardware Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The desired effect of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.EdgeOrder/orderItems\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.EdgeOrder/orderItems/orderItemDetails.preferences.encryptionPreferences.doubleEncryptionStatus\",\r\n                \"notEquals\": \"Enabled\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.EdgeOrder/orderItems/orderItemDetails.productDetails.productDoubleEncryptionStatus\",\r\n                \"notEquals\": \"Enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08a6b96f-576e-47a2-8511-119a212d344d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08a6b96f-576e-47a2-8511-119a212d344d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require use of individual authenticators\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1305 - Require use of individual authenticators\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1305\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08ad71d0-52be-6503-4908-e015460a16ae\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08ad71d0-52be-6503-4908-e015460a16ae\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Data Factories to disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disable public network access for your Data Factory so that it is not accessible over the public internet. This can reduce data leakage risks. Learn more at: https://docs.microsoft.com/azure/data-factory/data-factory-private-link.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Data Factory\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataFactory/factories\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DataFactory/factories/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"conflictEffect\": \"audit\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/673868aa-7521-48a0-acc6-0f60742d39f5\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2018-06-01')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.DataFactory/factories/publicNetworkAccess\",\r\n                  \"value\": \"Disabled\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08b1442b-7789-4130-8506-4f99a97226a7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08b1442b-7789-4130-8506-4f99a97226a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit Web Applications that are not using latest supported PHP Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported PHP version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"WebApp\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"app,linux,container\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestPHP\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08b17839-76c6-4015-90e0-33d9d54d219c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Search Services to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Search Services to stream to a regional Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Search/searchServices\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Search/searchServices/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"OperationLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08ba64b8-738f-4918-9686-730d2ed79c7d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Restrict use of open source software\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1237 - Restrict use of open source software\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1237\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08c11b48-8745-034d-1c1b-a144feec73b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08c11b48-8745-034d-1c1b-a144feec73b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Function app slots to only be accessible over HTTPS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites/slots\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"workflowapp\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/slots/httpsOnly\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/slots/httpsOnly\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"\r\n              ],\r\n              \"conflictEffect\": \"audit\",\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2019-08-01')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.Web/sites/slots/httpsOnly\",\r\n                  \"value\": true\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08cf2974-d178-48a0-b26d-f6b8e555748b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08cf2974-d178-48a0-b26d-f6b8e555748b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Adaptive network hardening recommendations should be applied on internet facing virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Security Center analyzes the traffic patterns of Internet facing virtual machines and provides Network Security Group rule recommendations that reduce the potential attack surface\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"f9f0eed0-f143-47bf-b856-671ea2eeed62\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08e6af2d-db70-460a-bfe9-d5bd474ba9d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"There should be more than one owner assigned to your subscription\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"It is recommended to designate more than one subscription owner in order to have administrator access redundancy.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"2c79b4af-f830-b61e-92b9-63dfa30f16e4\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09024ccc-0c5f-475e-9457-b7c0d9ed487b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1159 - Security Authorization\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1159\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0925f098-7877-450b-8ba4-d1e55f2d8795\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0925f098-7877-450b-8ba4-d1e55f2d8795\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Virtual machines should encrypt temp disks, caches, and data flows between Compute and Storage resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"By default, a virtual machine's OS and data disks are encrypted-at-rest using platform-managed keys. Temp disks, data caches and data flowing between compute and storage aren't encrypted. Disregard this recommendation if: 1. using encryption-at-host, or 2. server-side encryption on Managed Disks meets your security requirements. Learn more in: Server-side encryption of Azure Disk Storage: https://aka.ms/disksse, Different disk encryption offerings: https://aka.ms/diskencryptioncomparison\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.3\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.Compute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"d57a4221-a804-52ca-3dea-768284f06bb7\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0961003e-5a0a-4549-abde-af6a37f2724d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require interconnection security agreements\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1151 - Require interconnection security agreements\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1151\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/096a7055-30cb-2db4-3fda-41b20ac72667\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"096a7055-30cb-2db4-3fda-41b20ac72667\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1302 - User Identification And Authentication | Network Access To Non-Privileged Accounts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1302\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/09828c65-e323-422b-9774-9d5c646124da\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09828c65-e323-422b-9774-9d5c646124da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Provide privacy notice\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0414 - Provide privacy notice\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0414\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/098a7b84-1031-66d8-4e78-bd15b5fd2efb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"098a7b84-1031-66d8-4e78-bd15b5fd2efb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Distribute authenticators\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0184 - Distribute authenticators\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0184\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/098dcde7-016a-06c3-0985-0daaf3301d3a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"098dcde7-016a-06c3-0985-0daaf3301d3a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Protect administrator and user documentation\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1583 - Protect administrator and user documentation\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1583\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/09960521-759e-5d12-086f-4192a72a5e92\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09960521-759e-5d12-086f-4192a72a5e92\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure backup on virtual machines without a given tag to an existing recovery services vault in the same location\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enforce backup for all virtual machines by backing them up to an existing central recovery services vault in the same location and subscription as the virtual machine. Doing this is useful when there is a central team in your organization managing backups for all resources in a subscription. You can optionally exclude virtual machines containing a specified tag to control the scope of assignment. See https://aka.ms/AzureVMCentralBackupExcludeTag.\",\r\n        \"metadata\": {\r\n          \"version\": \"9.0.0\",\r\n          \"category\": \"Backup\"\r\n        },\r\n        \"parameters\": {\r\n          \"vaultLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Location (Specify the location of the VMs that you want to protect)\",\r\n              \"description\": \"Specify the location of the VMs that you want to protect. VMs should be backed up to a vault in the same location. For example - southeastasia.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"backupPolicyId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Backup Policy (of type Azure VM from a vault in the location chosen above)\",\r\n              \"description\": \"Specify the id of the Azure backup policy to configure backup of the virtual machines. The selected Azure backup policy should be of type Azure virtual machine. This policy needs to be in a vault that is present in the location chosen above. For example - /subscriptions/<SubscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.RecoveryServices/vaults/<VaultName>/backupPolicies/<BackupPolicyName>.\",\r\n              \"strongType\": \"Microsoft.RecoveryServices/vaults/backupPolicies\"\r\n            }\r\n          },\r\n          \"exclusionTagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Exclusion Tag Name\",\r\n              \"description\": \"Name of the tag to use for excluding VMs from the scope of this policy. This should be used along with the Exclusion Tag Value parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"exclusionTagValue\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Exclusion Tag Values\",\r\n              \"description\": \"Value of the tag to use for excluding VMs from the scope of this policy (in case of multiple values, use a comma-separated list). This should be used along with the Exclusion Tag Name parameter. Learn more at https://aka.ms/AppCentricVMBackupPolicy.\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"auditIfNotExists\",\r\n              \"AuditIfNotExists\",\r\n              \"deployIfNotExists\",\r\n              \"DeployIfNotExists\",\r\n              \"disabled\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('vaultLocation')]\"\r\n              },\r\n              {\r\n                \"field\": \"id\",\r\n                \"notContains\": \"/resourceGroups/databricks-rg-\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"notEquals\": \"azureopenshift\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"notEquals\": \"AzureDatabricks\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"[concat('tags[', parameters('exclusionTagName'), ']')]\",\r\n                      \"in\": \"[parameters('exclusionTagValue')]\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"value\": \"[empty(parameters('exclusionTagValue'))]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[empty(parameters('exclusionTagName'))]\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-datacenter-gensecond\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\",\r\n                          \"2019-datacenter-gensecond\",\r\n                          \"2022-datacenter-g2\",\r\n                          \"2022-datacenter\",\r\n                          \"2022-datacenter-azure-edition\",\r\n                          \"2022-datacenter-azure-edition-smalldisk\",\r\n                          \"2022-datacenter-azure-edition-core\",\r\n                          \"2022-datacenter-azure-edition-core-smalldisk\",\r\n                          \"2022-datacenter-smalldisk-g2\",\r\n                          \"2022-datacenter-smalldisk\",\r\n                          \"2022-datacenter-core-g2\",\r\n                          \"2022-datacenter-core\",\r\n                          \"2022-datacenter-core-smalldisk-g2\",\r\n                          \"2022-datacenter-core-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2019\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"12*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"contains\": \"ubuntu\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"14.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"*20_04-lts\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"20_04-lts*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7.*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b\"\r\n              ],\r\n              \"type\": \"Microsoft.RecoveryServices/backupprotecteditems\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"backupPolicyId\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"fabricName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"protectionContainers\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"protectedItems\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"sourceResourceId\": {\r\n                        \"type\": \"String\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[concat('DeployProtection-',uniqueString(parameters('protectedItems')))]\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[first(skip(split(parameters('backupPolicyId'), '/'), 4))]\",\r\n                        \"subscriptionId\": \"[first(skip(split(parameters('backupPolicyId'), '/'), 2))]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"backupPolicyId\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"fabricName\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"protectionContainers\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"protectedItems\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"sourceResourceId\": {\r\n                                \"type\": \"String\"\r\n                              }\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems\",\r\n                                \"name\": \"[concat(first(skip(split(parameters('backupPolicyId'), '/'), 8)), '/', parameters('fabricName'), '/',parameters('protectionContainers'), '/', parameters('protectedItems'))]\",\r\n                                \"apiVersion\": \"2016-06-01\",\r\n                                \"properties\": {\r\n                                  \"protectedItemType\": \"Microsoft.Compute/virtualMachines\",\r\n                                  \"policyId\": \"[parameters('backupPolicyId')]\",\r\n                                  \"sourceResourceId\": \"[parameters('sourceResourceId')]\"\r\n                                }\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"parameters\": {\r\n                            \"backupPolicyId\": {\r\n                              \"value\": \"[parameters('backupPolicyId')]\"\r\n                            },\r\n                            \"fabricName\": {\r\n                              \"value\": \"[parameters('fabricName')]\"\r\n                            },\r\n                            \"protectionContainers\": {\r\n                              \"value\": \"[parameters('protectionContainers')]\"\r\n                            },\r\n                            \"protectedItems\": {\r\n                              \"value\": \"[parameters('protectedItems')]\"\r\n                            },\r\n                            \"sourceResourceId\": {\r\n                              \"value\": \"[parameters('sourceResourceId')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"backupPolicyId\": {\r\n                      \"value\": \"[parameters('backupPolicyId')]\"\r\n                    },\r\n                    \"fabricName\": {\r\n                      \"value\": \"Azure\"\r\n                    },\r\n                    \"protectionContainers\": {\r\n                      \"value\": \"[concat('iaasvmcontainer;iaasvmcontainerv2;', resourceGroup().name, ';' ,field('name'))]\"\r\n                    },\r\n                    \"protectedItems\": {\r\n                      \"value\": \"[concat('vm;iaasvmcontainerv2;', resourceGroup().name, ';' ,field('name'))]\"\r\n                    },\r\n                    \"sourceResourceId\": {\r\n                      \"value\": \"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/',field('name'))]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/09ce66bc-1220-4153-8104-e3f51c936913\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09ce66bc-1220-4153-8104-e3f51c936913\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Private endpoint should be enabled for MariaDB servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoint connections enforce secure communication by enabling private connectivity to Azure Database for MariaDB. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DBforMariaDB/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DBforMariaDB/servers/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.DBforMariaDB/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a1302fb-a631-4106-9753-f3d494733990\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a1302fb-a631-4106-9753-f3d494733990\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Policy Add-on for Kubernetes service (AKS) should be installed and enabled on your clusters\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Policy Add-on for Kubernetes service (AKS) extends Gatekeeper v3, an admission controller webhook for Open Policy Agent (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.2\",\r\n          \"category\": \"Kubernetes\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/addonProfiles.azurePolicy.enabled\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a15ec92-a229-4763-bb14-0ea34a568f8d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a15ec92-a229-4763-bb14-0ea34a568f8d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1855 - Inventory of Personally Identifiable Information \",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1855\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a2119c1-f068-4bfe-9f03-db94317e8db9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a2119c1-f068-4bfe-9f03-db94317e8db9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Issue guidelines for ensuring data quality and integrity\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1824 - Issue guidelines for ensuring data quality and integrity\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1824\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a24f5dc-8c40-94a7-7aee-bb7cd4781d37\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a24f5dc-8c40-94a7-7aee-bb7cd4781d37\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1654 - Voice Over Internet Protocol\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1654\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a2ee16e-ab1f-414a-800b-d1608835862b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a2ee16e-ab1f-414a-800b-d1608835862b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL servers should use customer-managed keys to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Implementing Transparent Data Encryption (TDE) with your own key provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties. This recommendation applies to organizations with a related compliance requirement.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.1\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Sql/servers\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[resourcegroup().managedBy]\",\r\n                    \"notContains\": \"/providers/Microsoft.Synapse/\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Sql/servers/keyid\",\r\n                        \"exists\": false\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Sql/servers/keyid\",\r\n                        \"equals\": \"\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Sql/servers/encryptionProtector\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[resourcegroup().managedBy]\",\r\n                    \"notContains\": \"/providers/Microsoft.Synapse/\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/serverKeyType\",\r\n                    \"notequals\": \"AzureKeyVault\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a370ff3-6cab-4e85-8995-295fd854c5b8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Windows Virtual Machine Scale Sets to be associated with a Data Collection Rule\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Association to link Windows virtual machine scale sets to specified Data Collection Rule. The list of locations and OS images are updated over time as support is increased.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"listOfWindowsImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of virtual machine scale set images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"dcrResourceId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Data Collection Rule Resource Id\",\r\n              \"description\": \"Resource Id of the Data Collection Rule to be applied on the virtual machine sets in scope.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"australiacentral\",\r\n                  \"australiacentral2\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"brazilsouth\",\r\n                  \"brazilsoutheast\",\r\n                  \"canadacentral\",\r\n                  \"canadaeast\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"eastasia\",\r\n                  \"eastus2euap\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"francecentral\",\r\n                  \"francesouth\",\r\n                  \"germanywestcentral\",\r\n                  \"japaneast\",\r\n                  \"japanwest\",\r\n                  \"jioindiawest\",\r\n                  \"koreacentral\",\r\n                  \"koreasouth\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"norwayeast\",\r\n                  \"norwaywest\",\r\n                  \"southafricanorth\",\r\n                  \"southcentralus\",\r\n                  \"southeastasia\",\r\n                  \"southindia\",\r\n                  \"switzerlandnorth\",\r\n                  \"switzerlandwest\",\r\n                  \"uaenorth\",\r\n                  \"uksouth\",\r\n                  \"ukwest\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westindia\",\r\n                  \"westus\",\r\n                  \"westus2\"\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfWindowsImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2008-R2-SP1*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2012-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2016-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2019-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2022-*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1809-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Insights/dataCollectionRuleAssociations/dataCollectionRuleId\",\r\n                \"equals\": \"[parameters('dcrResourceId')]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"dcrResourceId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"associationName\": \"[concat('assoc-', uniqueString(parameters('dcrResourceId')))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('associationName')]\",\r\n                        \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n                        \"apiVersion\": \"2021-04-01\",\r\n                        \"properties\": {\r\n                          \"dataCollectionRuleId\": \"[parameters('dcrResourceId')]\"\r\n                        },\r\n                        \"scope\": \"[concat('Microsoft.Compute/virtualMachineScaleSets/', parameters('resourceName'))]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"dcrResourceId\": {\r\n                      \"value\": \"[parameters('dcrResourceId')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a3b9bf4-d30e-424a-af6b-9a93f6f78792\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a3b9bf4-d30e-424a-af6b-9a93f6f78792\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Establish alternate storage site to store and retrieve backup information\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1267 - Establish alternate storage site to store and retrieve backup information\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1267\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a412110-3874-9f22-187a-c7a81c8a6704\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a412110-3874-9f22-187a-c7a81c8a6704\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1402 - Controlled Maintenance | Automated Maintenance Activities\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1402\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a560d32-8075-4fec-9615-9f7c853f4ea9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a560d32-8075-4fec-9615-9f7c853f4ea9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1428 - Media Access\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1428\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a77fcc7-b8d8-451a-ab52-56197913c0c7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a77fcc7-b8d8-451a-ab52-56197913c0c7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit resource location matches resource group location\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit that the resource location matches its resource group location\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"General\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notEquals\": \"[resourcegroup().location]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"notEquals\": \"global\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a914e76-4921-4c19-b460-a2d36003525a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'System Audit Policies - Account Management'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'System Audit Policies - Account Management'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesAccountManagement\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SystemAuditPoliciesAccountManagement\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a9991e6-21be-49f9-8916-a06d934bcf29\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a9991e6-21be-49f9-8916-a06d934bcf29\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Defender for open-source relational databases should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for open-source relational databases detects anomalous activities indicating unusual and potentially harmful attempts to access or exploit databases. Learn more about the capabilities of Azure Defender for open-source relational databases at https://aka.ms/AzDforOpenSourceDBsDocu. Important: Enabling this plan will result in charges for protecting your open-source relational databases. Learn about the pricing on Security Center's pricing page: https://aka.ms/pricing-security-center\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"OpenSourceRelationalDatabases\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a9fbe0d-c5c4-4da8-87d8-f4fd77338835\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a9fbe0d-c5c4-4da8-87d8-f4fd77338835\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Container Instance container group should use customer-managed key for encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Secure your containers with greater flexibility using customer-managed keys. When you specify a customer-managed key, that key is used to protect and control access to the key that encrypts your data. Using customer-managed keys provides additional capabilities to control rotation of the key encryption key or cryptographically erase data.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Container Instance\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\",\r\n              \"Deny\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerInstance/containerGroups\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerInstance/containerGroups/encryptionProperties.vaultBaseUrl\",\r\n                    \"exists\": false\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerInstance/containerGroups/encryptionProperties.keyName\",\r\n                    \"exists\": false\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0aa61e00-0a01-4a3c-9945-e93cffedf0e6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0aa61e00-0a01-4a3c-9945-e93cffedf0e6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1044 - Unsuccessful Logon Attempts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1044\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0abbac52-57cf-450d-8408-1208d0dd9e90\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0abbac52-57cf-450d-8408-1208d0dd9e90\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Configure Azure Arc enabled Kubernetes clusters to install the Azure Policy extension\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Azure Policy's extension for Azure Arc to provide at-scale enforcements and safeguard your Arc enabled Kubernetes clusters in a centralized, consistent manner. Learn more at https://aka.ms/akspolicydoc.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"Kubernetes\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Kubernetes/connectedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.KubernetesConfiguration/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.KubernetesConfiguration/extensions/extensionType\",\r\n                \"equals\": \"microsoft.policyinsights\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/85cb6faf-e071-4c9b-8136-154b5a04f717\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"clusterRegion\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"clusterResourceId\": {\r\n                      \"value\": \"[field('id')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"clusterRegion\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"clusterResourceId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.KubernetesConfiguration/extensions\",\r\n                        \"apiVersion\": \"2021-09-01\",\r\n                        \"name\": \"azurepolicy\",\r\n                        \"location\": \"[parameters('clusterRegion')]\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"properties\": {\r\n                          \"extensionType\": \"microsoft.policyinsights\",\r\n                          \"configurationSettings\": {},\r\n                          \"configurationProtectedSettings\": {},\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"releaseTrain\": \"Stable\",\r\n                          \"scope\": {\r\n                            \"Cluster\": {\r\n                              \"releaseNamespace\": \"kube-system\"\r\n                            }\r\n                          }\r\n                        },\r\n                        \"scope\": \"[concat('Microsoft.Kubernetes/connectedClusters/', split(parameters('clusterResourceId'),'/')[8])]\"\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0adc5395-9169-4b9b-8687-af838d69410a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0adc5395-9169-4b9b-8687-af838d69410a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1804 - Governance And Privacy Program \",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Accountability, Audit, and Risk Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1804\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0afb38a3-5e1c-4339-9ab4-df6a3dfc7da2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0afb38a3-5e1c-4339-9ab4-df6a3dfc7da2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1253 - Contingency Plan | Resume Essential Missions / Business Functions\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1253\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0afce0b3-dd9f-42bb-af28-1e4284ba8311\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0afce0b3-dd9f-42bb-af28-1e4284ba8311\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Web PubSub Service to use private DNS zones\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Web PubSub service. Learn more at: https://aka.ms/awps/privatelink.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Web PubSub\"\r\n        },\r\n        \"parameters\": {\r\n          \"privateDnsZoneId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Private DNS Zone Id\",\r\n              \"description\": \"Private DNS zone to integrate with private endpoint.\",\r\n              \"strongType\": \"Microsoft.Network/privateDnsZones\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/privateEndpoints\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\r\n                    \"equals\": \"webpubsub\"\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"privateDnsZoneId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"privateEndpointName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\r\n                        \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\r\n                        \"apiVersion\": \"2020-03-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"privateDnsZoneConfigs\": [\r\n                            {\r\n                              \"name\": \"privatelink-webpubsub-azure-com\",\r\n                              \"properties\": {\r\n                                \"privateDnsZoneId\": \"[parameters('privateDnsZoneId')]\"\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"privateDnsZoneId\": {\r\n                      \"value\": \"[parameters('privateDnsZoneId')]\"\r\n                    },\r\n                    \"privateEndpointName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b026355-49cb-467b-8ac4-f777874e175a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b026355-49cb-467b-8ac4-f777874e175a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Email notification to subscription owner for high severity alerts should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"To ensure your subscription owners are notified when there is a potential security breach in their subscription, set email notifications to subscription owners for high severity alerts in Security Center.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/securityContacts\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Security/securityContacts/alertsToAdmins\",\r\n                      \"equals\": \"Off\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Security/securityContacts/alertNotifications.minimalSeverity\",\r\n                      \"equals\": \"High\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b15565f-aa9e-48ba-8619-45960f2c314d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1046 - Unsuccessful Logon Attempts | Purge / Wipe Mobile Device\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1046\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b1aa965-7502-41f9-92be-3e2fe7cc392a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b1aa965-7502-41f9-92be-3e2fe7cc392a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1020 - Account Management | Role-Based Schemes\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1020\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b291ee8-3140-4cad-beb7-568c077c78ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b291ee8-3140-4cad-beb7-568c077c78ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Key vaults should have purge protection enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Malicious deletion of a key vault can lead to permanent data loss. A malicious insider in your organization can potentially delete and purge key vaults. Purge protection protects you from insider attacks by enforcing a mandatory retention period for soft deleted key vaults. No one inside your organization or Microsoft will be able to purge your key vaults during the soft delete retention period.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Key Vault\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/vaults\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.KeyVault/vaults/createMode\",\r\n                  \"equals\": \"recover\"\r\n                }\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enablePurgeProtection\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\r\n                    \"equals\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KeyVault/vaults/enablePurgeProtection\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1115 - Audit Review, Analysis, And Reporting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1115\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b653845-2ad9-4e09-a4f3-5a7c1d78353d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b653845-2ad9-4e09-a4f3-5a7c1d78353d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Cosmos DB throughput should be limited\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the maximum throughput your organization can specify when creating Azure Cosmos DB databases and containers through the resource provider. It blocks the creation of autoscale resources.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Cosmos DB\"\r\n        },\r\n        \"parameters\": {\r\n          \"throughputMax\": {\r\n            \"type\": \"Integer\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Max RUs\",\r\n              \"description\": \"The maximum throughput (RU/s) that can be assigned to a container via the Resource Provider during create or update.\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Policy Effect\",\r\n              \"description\": \"The desired effect of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"Audit\",\r\n              \"deny\",\r\n              \"Deny\",\r\n              \"disabled\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Deny\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"like\": \"Microsoft.DocumentDB/databaseAccounts/*/throughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"in\": [\r\n                      \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables\",\r\n                      \"Microsoft.DocumentDB/databaseAccounts/tables\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"value\": \"[requestContext().apiVersion]\",\r\n                    \"less\": \"2019-08-01\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/sqlDatabases/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/sqlDatabases/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(equals(field('Microsoft.DocumentDB/databaseAccounts/tables/options.throughput'), ''), 0, int(field('Microsoft.DocumentDB/databaseAccounts/tables/options.throughput')))]\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/tables/options\",\r\n                    \"containsKey\": \"ProvisionedThroughputSettings\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/tables/throughputSettings/default.resource.throughput\",\r\n                    \"greater\": \"[parameters('throughputMax')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DocumentDB/databaseAccounts/tables/throughputSettings/default.resource.provisionedThroughputSettings\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0b7ef78e-a035-4f23-b9bd-aff122a1b1cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0b7ef78e-a035-4f23-b9bd-aff122a1b1cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Document requirements for the use of shared data in contracts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0197 - Document requirements for the use of shared data in contracts\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0197\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ba211ef-0e85-2a45-17fc-401d1b3f8f85\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ba211ef-0e85-2a45-17fc-401d1b3f8f85\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Keep accurate accounting of disclosures of information\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1818 - Keep accurate accounting of disclosures of information\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1818\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0bbfd658-93ab-6f5e-1e19-3c1c1da62d01\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0bbfd658-93ab-6f5e-1e19-3c1c1da62d01\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1239 - User-Installed Software\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1239\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0be51298-f643-4556-88af-d7db90794879\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0be51298-f643-4556-88af-d7db90794879\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: API apps should have 'Client Certificates (Incoming client certificates)' enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app. We recommend all customers who are still using API Apps to implement the built-in policy called 'App Service apps should have 'Client Certificates (Incoming client certificates)' enabled', which is scoped to include API apps in addition to Web Apps.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"App Service\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"*api\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/clientCertEnabled\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0c192fe8-9cbb-4516-85b3-0ade8bd03886\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0c192fe8-9cbb-4516-85b3-0ade8bd03886\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Private endpoint connections on Automation Accounts should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoint connections allow secure communication by enabling private connectivity to Automation accounts without a need for public IP addresses at the source or destination. Learn more about private endpoints in Azure Automation at https://docs.microsoft.com/azure/automation/how-to/private-link-security\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Automation\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Automation/automationAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Automation/automationAccounts/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Automation/automationAccounts/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0c2b3618-68a8-4034-a150-ff4abc873462\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0c2b3618-68a8-4034-a150-ff4abc873462\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Application Insights components with Private Link enabled should use Bring Your Own Storage accounts for profiler and debugger.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"To support private link and customer-managed key policies, create your own storage account for profiler and debugger. Learn more in https://docs.microsoft.com/azure/azure-monitor/app/profiler-bring-your-own-storage\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Deny\",\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Insights/components\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/components/ForceCustomerStorageForProfiler\",\r\n                \"notEquals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0c4bd2e8-8872-4f37-a654-03f6f38ddc76\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0c4bd2e8-8872-4f37-a654-03f6f38ddc76\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1755 - Contacts With Security Groups And Associations\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1755\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0c92e78e-4667-44f1-8b1d-bbc784b66950\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0c92e78e-4667-44f1-8b1d-bbc784b66950\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1496 - System Security Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1496\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ca96127-2f87-46ab-a4fc-0d2a786df1c8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ca96127-2f87-46ab-a4fc-0d2a786df1c8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Blocked accounts with owner permissions on Azure resources should be removed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deprecated accounts with owner permissions should be removed from your subscription.  Deprecated accounts are accounts that have been blocked from signing in.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"050ac097-3dda-4d24-ab6d-82568e7a50cf\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0cfea604-3201-4e14-88fc-fae4c427a6c5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0cfea604-3201-4e14-88fc-fae4c427a6c5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Assess risk in third party relationships\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0014 - Assess risk in third party relationships\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0014\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d04cb93-a0f1-2f4b-4b1b-a72a1b510d08\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d04cb93-a0f1-2f4b-4b1b-a72a1b510d08\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: SQL servers should use customer-managed keys to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy is deprecated. Please use /providers/Microsoft.Authorization/policyDefinitions/0a370ff3-6cab-4e85-8995-295fd854c5b8 instead.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.1-deprecated\",\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"analytics\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/encryptionProtector\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/serverKeyType\",\r\n                    \"equals\": \"AzureKeyVault\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/uri\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/encryptionProtector/uri\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d134df8-db83-46fb-ad72-fe0c9428c8dd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Private endpoint should be enabled for IoT Hub\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoint connections enforce secure communication by enabling private connectivity to IoT Hub. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses, including within Azure.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Internet of Things\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Devices/IotHubs\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Devices/IotHubs/privateEndpointConnections[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.Devices/IotHubs/privateEndpointConnections[*].privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d40b058-9f95-4a19-93e3-9b0330baa2a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d40b058-9f95-4a19-93e3-9b0330baa2a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1518 - Personnel Termination\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1518\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d58f734-c052-40e9-8b2f-a1c2bff0b815\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d58f734-c052-40e9-8b2f-a1c2bff0b815\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1713 - Software & Information Integrity | Integrity Checks\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1713\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d87c70b-5012-48e9-994b-e70dd4b8def0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d87c70b-5012-48e9-994b-e70dd4b8def0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1466 - Visitor Access Records\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1466\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d943a9c-a6f1-401f-a792-740cdb09c451\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d943a9c-a6f1-401f-a792-740cdb09c451\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs on which Windows Defender Exploit Guard is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines on which Windows Defender Exploit Guard is not enabled. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsDefenderExploitGuard\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Function apps should use managed identity\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use a managed identity for enhanced authentication security\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"workflowapp\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/managedServiceIdentityId\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/xmanagedServiceIdentityId\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0da106f2-4ca3-48e8-bc85-c638fe6aea8f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy a flow log resource with target network security group\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configures flow log for specific network security group. It will allow to log information about IP traffic flowing through an network security group. Flow log helps to identify unknown or undesired traffic, verify network isolation and compliance with enterprise access rules, analyze network flows from compromised IPs and network interfaces.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"nsgRegion\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"NSG Region\",\r\n              \"description\": \"This Policy will review NSGs only in the selected region. You can create other assignments to include other regions.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"storageId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Storage id\",\r\n              \"description\": \"A string with the storage id for the flowlogs to be sent to. It will be used for deployment purposes only. Make sure this storage account is located in the same region as the NSG. The format must be: '/subscriptions/{subscription id}/resourceGroups/{resourceGroup name}/providers/Microsoft.Storage/storageAccounts/{storage account name}\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"networkWatcherRG\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Watchers RG\",\r\n              \"description\": \"The name of the resource group where the flowLog resources will be created. This will be used only if a deployment is required. This is the resource group where the Network Watchers are located.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"networkWatcherName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Watcher name\",\r\n              \"description\": \"The name of the network watcher under which the flowLog resources will be created. Make sure it belongs to the same region as the NSG.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('nsgRegion')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkWatchers/flowlogs\",\r\n              \"resourceGroupName\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), parameters('networkWatcherRG'), split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\",\r\n              \"name\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id'))), 'null/null', concat(split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8], '/', split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10]))]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkWatchers/flowLogs/enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkWatchers/flowLogs/storageId\",\r\n                    \"equals\": \"[parameters('storageId')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"storageId\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"networkWatcherRG\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"networkWatcherName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"flowlogName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"targetResource\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[concat('flowlogDeployment-', uniqueString(parameters('flowlogName')))]\",\r\n                        \"apiVersion\": \"2019-10-01\",\r\n                        \"resourceGroup\": \"[parameters('networkWatcherRG')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"incremental\",\r\n                          \"parameters\": {},\r\n                          \"template\": {\r\n                            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {},\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.Network/networkWatchers/flowLogs\",\r\n                                \"name\": \"[concat(parameters('networkWatcherName'), '/', parameters('flowlogName'))]\",\r\n                                \"apiVersion\": \"2019-11-01\",\r\n                                \"location\": \"[parameters('location')]\",\r\n                                \"properties\": {\r\n                                  \"targetResourceId\": \"[parameters('targetResource')]\",\r\n                                  \"storageId\": \"[parameters('storageId')]\",\r\n                                  \"enabled\": \"true\",\r\n                                  \"retentionPolicy\": {\r\n                                    \"days\": \"0\",\r\n                                    \"enabled\": \"false\"\r\n                                  }\r\n                                }\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"storageId\": {\r\n                      \"value\": \"[parameters('storageId')]\"\r\n                    },\r\n                    \"networkWatcherRG\": {\r\n                      \"value\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), parameters('networkWatcherRG'), split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[4])]\"\r\n                    },\r\n                    \"networkWatcherName\": {\r\n                      \"value\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), parameters('networkWatcherName'), split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[8])]\"\r\n                    },\r\n                    \"flowlogName\": {\r\n                      \"value\": \"[if(empty(coalesce(field('Microsoft.Network/networkSecurityGroups/flowLogs'))), concat(field('name'), '-', resourceGroup().name, '-', 'flowlog'), split(first(field('Microsoft.Network/networkSecurityGroups/flowLogs[*].id')), '/')[10])]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"targetResource\": {\r\n                      \"value\": \"[concat(resourceGroup().id, '/providers/Microsoft.Network/networkSecurityGroups/', field('name'))]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0db34a60-64f4-4bf6-bd44-f95c16cf34b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0db34a60-64f4-4bf6-bd44-f95c16cf34b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Identify individuals with security roles and responsibilities\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1566 - Identify individuals with security roles and responsibilities\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1566\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0dcbaf2f-075e-947b-8f4c-74ecc5cd302c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0dcbaf2f-075e-947b-8f4c-74ecc5cd302c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1718 - Software & Information Integrity | Binary Or Machine Executable Code\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1718\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0dced7ab-9ce5-4137-93aa-14c13e06ab17\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0dced7ab-9ce5-4137-93aa-14c13e06ab17\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Modify - Configure Azure File Sync to disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"The Azure File Sync's internet-accessible public endpoint are disabled by your organizational policy. You may still access the Storage Sync Service via its private endpoint(s).\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.StorageSync/storageSyncServices\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.StorageSync/storageSyncServices/incomingTrafficPolicy\",\r\n                \"notEquals\": \"AllowVirtualNetworksOnly\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"conflictEffect\": \"Audit\",\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greater(requestContext().apiVersion, '2019-10-01')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.StorageSync/storageSyncServices/incomingTrafficPolicy\",\r\n                  \"value\": \"AllowVirtualNetworksOnly\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e07b2e9-6cd9-4c40-9ccb-52817b95133b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e07b2e9-6cd9-4c40-9ccb-52817b95133b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Authorized IP ranges should be defined on Kubernetes Services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Restrict access to the Kubernetes Service Management API by granting API access only to IP addresses in specific ranges. It is recommended to limit access to authorized IP ranges to ensure that only applications from allowed networks can access the cluster.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.1\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.authorizedIPRanges\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Function apps should have remote debugging turned off\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Remote debugging requires inbound ports to be opened on Function apps. Remote debugging should be turned off.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"workflowapp\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.remoteDebuggingEnabled\",\r\n                \"equals\": \"false\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e60b895-3786-45da-8377-9c6b4b6ac5f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Defender for Key Vault should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for Key Vault provides an additional layer of protection and security intelligence by detecting unusual and potentially harmful attempts to access or exploit key vault accounts.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.3\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"KeyVaults\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e6763cc-5078-4e64-889d-ff4d9a839047\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Protect audit information\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0401 - Protect audit information\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0401\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e696f5a-451f-5c15-5532-044136538491\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e696f5a-451f-5c15-5532-044136538491\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Databricks Workspaces should disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Databricks Workspaces should have public network access disabled. Disabling public network access improves security by ensuring that the resource isn't exposed on the public internet. You can limit exposure of your resources by creating private endpoints instead. Learn more at: https://docs.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Azure Databricks\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The desired effect of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Databricks/workspaces\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Databricks/workspaces/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e7849de-b939-4c50-ab48-fc6b0f5eeba2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e7849de-b939-4c50-ab48-fc6b0f5eeba2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Container Apps should only be accessible over HTTPS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks. Disabling 'allowInsecure' will result in the automatic redirection of requests from HTTP to HTTPS connections for container apps.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Container Apps\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.App/containerApps\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.App/containerApps/configuration.ingress.allowInsecure\",\r\n                \"equals\": true\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0e80e269-43a4-4ae9-b5bc-178126b8a5cb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Geo-redundant backup should be enabled for Azure Database for MariaDB\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Database for MariaDB allows you to choose the redundancy option for your database server. It can be set to a geo-redundant backup storage in which the data is not only stored within the region in which your server is hosted, but is also replicated to a paired region to provide recovery option in case of a region failure. Configuring geo-redundant storage for backup is only allowed during server create.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DBforMariaDB/servers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DBforMariaDB/servers/storageProfile.geoRedundantBackup\",\r\n                \"notEquals\": \"Enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ec47710-77ff-4a3d-9181-6aa50af424d0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ec47710-77ff-4a3d-9181-6aa50af424d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to enable Guest Configuration Policy on Windows VMs.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a system-assigned managed identity and deploys the VM extension for Guest Configuration on Windows VMs. This is a prerequisite for Guest Configuration Policy and must be assigned to the scope before using any Guest Configuration policy. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"notLike\": \"SQL2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                            \"like\": \"Windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"exists\": \"false\"\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"notLike\": \"2008*\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"notLike\": \"SQL2008*\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"name\": \"AzurePolicyforWindows\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.GuestConfiguration\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"ConfigurationforWindows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ecd903d-91e7-4726-83d3-a229d7f2e293\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ecd903d-91e7-4726-83d3-a229d7f2e293\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1601 - Developer Security Testing And Evaluation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1601\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ee79a0c-addf-4ce9-9b3c-d9576ed5e20e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ee79a0c-addf-4ce9-9b3c-d9576ed5e20e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Batch accounts with private endpoints\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoints connect your virtual network to Azure services without a public IP address at the source or destination. By mapping private endpoints to Batch accounts, you can reduce data leakage risks. Learn more about private links at: https://docs.microsoft.com/azure/batch/private-connectivity.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Batch\"\r\n        },\r\n        \"parameters\": {\r\n          \"privateEndpointSubnetId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Private endpoint subnet id\",\r\n              \"description\": \"A subnet with private endpoint network policies disabled\",\r\n              \"strongType\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Batch/batchAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Batch/batchAccounts/publicNetworkAccess\",\r\n                \"equals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Batch/batchAccounts/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Batch/batchAccounts/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"name\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"serviceId\": {\r\n                      \"value\": \"[field('id')]\"\r\n                    },\r\n                    \"privateEndpointSubnetId\": {\r\n                      \"value\": \"[parameters('privateEndpointSubnetId')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"name\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"serviceId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"privateEndpointSubnetId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"privateEndpointName\": \"[concat('pe-',substring(parameters('name'),0,min(length(parameters('name')),50)),'-',uniquestring(deployment().name))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('privateEndpointName')]\",\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"serviceId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"privateEndpointSubnetId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"subnetLocation\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"variables\": {\r\n                              \"privateEndpointName\": \"[deployment().name]\"\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"name\": \"[variables('privateEndpointName')]\",\r\n                                \"type\": \"Microsoft.Network/privateEndpoints\",\r\n                                \"apiVersion\": \"2020-07-01\",\r\n                                \"location\": \"[parameters('subnetLocation')]\",\r\n                                \"tags\": {},\r\n                                \"properties\": {\r\n                                  \"subnet\": {\r\n                                    \"id\": \"[parameters('privateEndpointSubnetId')]\"\r\n                                  },\r\n                                  \"privateLinkServiceConnections\": [\r\n                                    {\r\n                                      \"name\": \"[variables('privateEndpointName')]\",\r\n                                      \"properties\": {\r\n                                        \"privateLinkServiceId\": \"[parameters('serviceId')]\",\r\n                                        \"groupIds\": [\r\n                                          \"batchAccount\"\r\n                                        ],\r\n                                        \"requestMessage\": \"autoapprove\"\r\n                                      }\r\n                                    }\r\n                                  ],\r\n                                  \"manualPrivateLinkServiceConnections\": []\r\n                                }\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"parameters\": {\r\n                            \"serviceId\": {\r\n                              \"value\": \"[parameters('serviceId')]\"\r\n                            },\r\n                            \"privateEndpointSubnetId\": {\r\n                              \"value\": \"[parameters('privateEndpointSubnetId')]\"\r\n                            },\r\n                            \"subnetLocation\": {\r\n                              \"value\": \"[reference(first(take(split(parameters('privateEndpointSubnetId'),'/subnets'),1)),'2020-07-01','Full').location]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0ef5aac7-c064-427a-b87b-d47b3ddcaf73\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0ef5aac7-c064-427a-b87b-d47b3ddcaf73\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit Azure Spring Cloud instances where distributed tracing is not enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Distributed tracing tools in Azure Spring Cloud allow debugging and monitoring the complex interconnections between microservices in an application. Distributed tracing tools should be enabled and in a healthy state.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"App Platform\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.AppPlatform/Spring\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.AppPlatform/Spring/trace.enabled\",\r\n                    \"notEquals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.AppPlatform/Spring/trace.state\",\r\n                    \"notEquals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f2d8593-4667-4932-acca-6a9f187af109\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f2d8593-4667-4932-acca-6a9f187af109\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Prepare alternate processing site for use as operational site\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1278 - Prepare alternate processing site for use as operational site\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1278\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f31d98d-5ce2-705b-4aa5-b4f6705110dd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f31d98d-5ce2-705b-4aa5-b4f6705110dd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1476 - Fire Protection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1476\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f3c4ac2-3e35-4906-a80b-473b12a622d7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f3c4ac2-3e35-4906-a80b-473b12a622d7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1204 - Access Restrictions For Change | Review System Changes\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1204\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f4f6750-d1ab-4a4c-8dfd-af3237682665\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f4f6750-d1ab-4a4c-8dfd-af3237682665\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Provide real-time alerts for audit event failures\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1114 - Provide real-time alerts for audit event failures\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1114\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f4fa857-079d-9d3d-5c49-21f616189e03\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f4fa857-079d-9d3d-5c49-21f616189e03\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1430 - Media Labeling\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1430\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f559588-5e53-4b14-a7c4-85d28ebc2234\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f559588-5e53-4b14-a7c4-85d28ebc2234\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1574 - Acquisitions Process\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1574\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f935dab-83d6-47b8-85ef-68b8584161b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f935dab-83d6-47b8-85ef-68b8584161b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure App Service apps to only be accessible over HTTPS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/httpsOnly\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/httpsOnly\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"\r\n              ],\r\n              \"conflictEffect\": \"audit\",\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2019-08-01')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.Web/sites/httpsOnly\",\r\n                  \"value\": true\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0f98368e-36bc-4716-8ac2-8f8067203b63\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0f98368e-36bc-4716-8ac2-8f8067203b63\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1164 - Continuous Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1164\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fb8d3ce-9e96-481c-9c68-88d4e3019310\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fb8d3ce-9e96-481c-9c68-88d4e3019310\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Running container images should have vulnerability findings resolved\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Container image vulnerability assessment scans container images running on your Kubernetes clusters for security vulnerabilities and exposes detailed findings for each image. Resolving the vulnerabilities can greatly improve your containers' security posture and protect them from attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.ContainerService/managedClusters\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"41503391-efa5-47ee-9282-4eff6131462c\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fc39691-5a3f-4e3e-94ee-2e6447309ad9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fc39691-5a3f-4e3e-94ee-2e6447309ad9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1017 - Account Management | Inactivity Logout\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1017\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fc3db37-e59a-48c1-84e9-1780cedb409e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fc3db37-e59a-48c1-84e9-1780cedb409e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Monitor Private Link Scope should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Monitor Private Links Scope, you can reduce data leakage risks. Learn more about private links at: https://docs.microsoft.com/azure/azure-monitor/logs/private-link-security.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Insights/privateLinkScopes\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/privateLinkScopes/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Insights/privateLinkScopes/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fc55270-f8bf-4feb-b7b8-5e7e7eacc6a6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fc55270-f8bf-4feb-b7b8-5e7e7eacc6a6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Maintain data breach records\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0351 - Maintain data breach records\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0351\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fd1ca29-677b-2f12-1879-639716459160\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fd1ca29-677b-2f12-1879-639716459160\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Lab Services should require non-admin user for labs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy requires non-admin user accounts to be created for the labs managed through lab-services.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Lab Services\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"excludeLabPlanId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Lab Plan Id to exclude\",\r\n              \"description\": \"Optionally enter the lab Plan Id to exclude for this policy assignment.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.LabServices/labs\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.LabServices/labs/labPlanId\",\r\n                \"notEquals\": \"[parameters('excludeLabPlanId')]\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.LabServices/labs/virtualMachineProfile.nonAdminUser.username\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.LabServices/labs/virtualMachineProfile.nonAdminUser.username\",\r\n                    \"equals\": \"\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fd9915e-cab3-4f24-b200-6e20e1aa276a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fd9915e-cab3-4f24-b200-6e20e1aa276a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Cognitive Search services should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Cognitive Search, data leakage risks are reduced. Learn more about private links at: https://aka.ms/azure-cognitive-search/inbound-private-endpoints.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Search\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Search/searchServices\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Search/searchServices/privateEndpointConnections[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.Search/searchServices/privateEndpointConnections[*].privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fda3595-9f2b-4592-8675-4231d6fa82fe\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fda3595-9f2b-4592-8675-4231d6fa82fe\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Public network access should be disabled for Container registries\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling public network access improves security by ensuring that container registries are not exposed on the public internet. Creating private endpoints can limit exposure of container registry resources. Learn more at: https://aka.ms/acr/portal/public-network and https://aka.ms/acr/private-link.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Container Registry\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ContainerRegistry/registries\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ContainerRegistry/registries/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fdf0491-d080-4575-b627-ad0e843cba0f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CORS should not allow every domain to access your API for FHIR\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Cross-Origin Resource Sharing (CORS) should not allow all domains to access your API for FHIR. To protect your API for FHIR, remove access for all domains and explicitly define the domains allowed to connect.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"API for FHIR\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"Audit\",\r\n              \"disabled\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HealthcareApis/services\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.HealthcareApis/services/corsConfiguration.origins[*]\",\r\n                  \"notEquals\": \"*\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0fea8f8a-4169-495d-8307-30ec335f387d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0fea8f8a-4169-495d-8307-30ec335f387d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1087 - Security Awareness And Training Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Awareness and Training control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1087\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/100c82ba-42e9-4d44-a2ba-94b209248583\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"100c82ba-42e9-4d44-a2ba-94b209248583\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1820 - Accounting of Disclosures \",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Accountability, Audit, and Risk Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1820\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/106618ad-fe3e-49b4-bfef-01009f6770d8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"106618ad-fe3e-49b4-bfef-01009f6770d8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that do not contain the specified certificates in Trusted Root\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"CertificateThumbprints\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\\\LocalMachine\\\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsCertificateInTrustedRoot\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude', '=', parameters('CertificateThumbprints')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WindowsCertificateInTrustedRoot\"\r\n                    },\r\n                    \"CertificateThumbprints\": {\r\n                      \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"CertificateThumbprints\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n                                \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n                                \"value\": \"[parameters('CertificateThumbprints')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"106ccbe4-a791-4f33-a44a-06796944b8d5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Correlate audit records\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0087 - Correlate audit records\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0087\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10874318-0bf7-a41f-8463-03e395482080\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10874318-0bf7-a41f-8463-03e395482080\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1554 - Vulnerability Scanning | Discoverable Information\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1554\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10984b4e-c93e-48d7-bf20-9c03b04e9eca\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10984b4e-c93e-48d7-bf20-9c03b04e9eca\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Ensure that '.NET Framework' version is the latest, if used as a part of the Function App\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy is not required since Azure App Service automatically updates and maintains the .NET Framework versions installed on the platform.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"App Service\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"functionapp*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.netFrameworkVersion\",\r\n                \"in\": [\r\n                  \"v3.0\",\r\n                  \"v4.0\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10c1859c-e1a7-4df3-ab97-a487fa8059f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10c1859c-e1a7-4df3-ab97-a487fa8059f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Implement cryptographic mechanisms\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1419 - Implement cryptographic mechanisms\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1419\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10c3a1b1-29b0-a2d5-8f4c-a284b0f07830\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10c3a1b1-29b0-a2d5-8f4c-a284b0f07830\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce logical access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0245 - Enforce logical access\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0245\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10c4210b-3ec9-9603-050d-77e4d26c7ebb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10c4210b-3ec9-9603-050d-77e4d26c7ebb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Configure ChangeTracking Extension for Linux Arc machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configure Linux Arc machines to automatically install the ChangeTracking Extension to enable File Integrity Monitoring(FIM) in Azure Security Center. FIM examines operating system files, Windows registries, application software, Linux system files, and more, for changes that might indicate an attack. The extension can be installed in virtual machines and locations supported by Azure Monitor Agent.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0-preview\",\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"listOfApplicableLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Applicable Locations\",\r\n              \"description\": \"The list of locations where the policy should be applied.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"australiasoutheast\",\r\n              \"australiaeast\",\r\n              \"brazilsouth\",\r\n              \"canadacentral\",\r\n              \"centralindia\",\r\n              \"centralus\",\r\n              \"eastasia\",\r\n              \"eastus2euap\",\r\n              \"eastus\",\r\n              \"eastus2\",\r\n              \"francecentral\",\r\n              \"japaneast\",\r\n              \"koreacentral\",\r\n              \"northcentralus\",\r\n              \"northeurope\",\r\n              \"norwayeast\",\r\n              \"southcentralus\",\r\n              \"southeastasia\",\r\n              \"switzerlandnorth\",\r\n              \"uaenorth\",\r\n              \"uksouth\",\r\n              \"westcentralus\",\r\n              \"westeurope\",\r\n              \"westus\",\r\n              \"westus2\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"australiasoutheast\",\r\n              \"australiaeast\",\r\n              \"brazilsouth\",\r\n              \"canadacentral\",\r\n              \"centralindia\",\r\n              \"centralus\",\r\n              \"eastasia\",\r\n              \"eastus2euap\",\r\n              \"eastus\",\r\n              \"eastus2\",\r\n              \"francecentral\",\r\n              \"japaneast\",\r\n              \"koreacentral\",\r\n              \"northcentralus\",\r\n              \"northeurope\",\r\n              \"norwayeast\",\r\n              \"southcentralus\",\r\n              \"southeastasia\",\r\n              \"switzerlandnorth\",\r\n              \"uaenorth\",\r\n              \"uksouth\",\r\n              \"westcentralus\",\r\n              \"westeurope\",\r\n              \"westus\",\r\n              \"westus2\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HybridCompute/machines\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('listOfApplicableLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                \"like\": \"linux*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.HybridCompute/machines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/type\",\r\n                    \"equals\": \"ChangeTracking-Linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/Publisher\",\r\n                    \"equals\": \"Microsoft.Azure.ChangeTrackingAndInventory\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"ChangeTracking-Linux\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.ChangeTrackingAndInventory\",\r\n                      \"vmExtensionType\": \"ChangeTracking-Linux\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"2.0\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2021-06-10-preview\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10caed8a-652c-4d1d-84e4-2805b7c07278\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10caed8a-652c-4d1d-84e4-2805b7c07278\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Custom subscription owner roles should not exist\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy is deprecated.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0-deprecated\",\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Authorization/roleDefinitions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Authorization/roleDefinitions/type\",\r\n                \"equals\": \"CustomRole\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Authorization/roleDefinitions/permissions[*].actions[*]\",\r\n                      \"notEquals\": \"*\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Authorization/roleDefinitions/permissions.actions[*]\",\r\n                      \"notEquals\": \"*\"\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Authorization/roleDefinitions/assignableScopes[*]\",\r\n                      \"notIn\": [\r\n                        \"[concat(subscription().id,'/')]\",\r\n                        \"[subscription().id]\",\r\n                        \"/\"\r\n                      ]\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Authorization/roleDefinitions/assignableScopes[*]\",\r\n                      \"notLike\": \"/providers/Microsoft.Management/*\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/10ee2ea2-fb4d-45b8-a7e9-a2e770044cd9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"10ee2ea2-fb4d-45b8-a7e9-a2e770044cd9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1230 - Configuration Management Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1230\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11158848-f679-4e9b-aa7b-9fb07d945071\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11158848-f679-4e9b-aa7b-9fb07d945071\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1432 - Media Storage\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1432\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1140e542-b80d-4048-af45-3f7245be274b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1140e542-b80d-4048-af45-3f7245be274b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Modify - Configure Azure IoT Hubs to disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling the public network access property improves security by ensuring your Azure IoT Hub can only be accessed from a private endpoint. This policy disables public network access on IoT Hub resources.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Internet of Things\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Devices/IotHubs\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Devices/IotHubs/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"conflictEffect\": \"audit\",\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2020-03-01')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.Devices/IotHubs/publicNetworkAccess\",\r\n                  \"value\": \"Disabled\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/114eec6e-5e59-4bad-999d-6eceeb39d582\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"114eec6e-5e59-4bad-999d-6eceeb39d582\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Cognitive Services accounts should use customer owned storage or enable data encryption.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy is deprecated. Cognitive Services have data encryption enforced.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0-deprecated\",\r\n          \"category\": \"Cognitive Services\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.CognitiveServices/accounts/userOwnedStorage[*]\"\r\n                },\r\n                \"less\": 1\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/encryption.keySource\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/encryption\",\r\n                \"exists\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11566b39-f7f7-4b82-ab06-68d8700eb0a4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11566b39-f7f7-4b82-ab06-68d8700eb0a4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1850 - Redress \",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Individual Participation and Redress control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1850\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1189aa19-fbcf-4b3e-b9ec-76508e2fa17b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1189aa19-fbcf-4b3e-b9ec-76508e2fa17b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Dependency agent should be enabled for listed virtual machine images\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Reports virtual machines as non-compliant if the virtual machine image is not in the list defined and the agent is not installed. The list of OS images is updated over time as support is updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude_windows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of virtual machine images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"listOfImageIdToInclude_linux\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of virtual machine images that have supported Linux OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"anyOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_windows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageId\",\r\n                      \"in\": \"[parameters('listOfImageIdToInclude_linux')]\"\r\n                    },\r\n                    {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"2008-R2-SP1\",\r\n                                \"2008-R2-SP1-smalldisk\",\r\n                                \"2012-Datacenter\",\r\n                                \"2012-Datacenter-smalldisk\",\r\n                                \"2012-R2-Datacenter\",\r\n                                \"2012-R2-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter\",\r\n                                \"2016-Datacenter-Server-Core\",\r\n                                \"2016-Datacenter-Server-Core-smalldisk\",\r\n                                \"2016-Datacenter-smalldisk\",\r\n                                \"2016-Datacenter-with-Containers\",\r\n                                \"2016-Datacenter-with-RDSH\",\r\n                                \"2019-Datacenter\",\r\n                                \"2019-Datacenter-Core\",\r\n                                \"2019-Datacenter-Core-smalldisk\",\r\n                                \"2019-Datacenter-Core-with-Containers\",\r\n                                \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-smalldisk\",\r\n                                \"2019-Datacenter-with-Containers\",\r\n                                \"2019-Datacenter-with-Containers-smalldisk\",\r\n                                \"2019-Datacenter-zhcn\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerSemiAnnual\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"Datacenter-Core-1709-smalldisk\",\r\n                                \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                                \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"WindowsServerHPCPack\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftSQLServer\"\r\n                            },\r\n                            {\r\n                              \"anyOf\": [\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2016-BYOL\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2\"\r\n                                },\r\n                                {\r\n                                  \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                  \"like\": \"*-WS2012R2-BYOL\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftRServer\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"MLServer-WS2016\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftVisualStudio\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"in\": [\r\n                                \"VisualStudio\",\r\n                                \"Windows\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftDynamicsAX\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Dynamics\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftDynamicsAX\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Dynamics\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"equals\": \"Pre-Req-AX7-Onebox-V4\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"microsoft-ads\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"windows-data-science-vm\"\r\n                            }\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"allOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                              \"equals\": \"MicrosoftWindowsDesktop\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageOffer\",\r\n                              \"equals\": \"Windows-10\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"RedHat\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"RHEL\",\r\n                            \"RHEL-SAP-HANA\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"SUSE\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"SLES\",\r\n                            \"SLES-HPC\",\r\n                            \"SLES-HPC-Priority\",\r\n                            \"SLES-SAP\",\r\n                            \"SLES-SAP-BYOS\",\r\n                            \"SLES-Priority\",\r\n                            \"SLES-BYOS\",\r\n                            \"SLES-SAPCAL\",\r\n                            \"SLES-Standard\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"12-SP2\",\r\n                                \"12-SP3\",\r\n                                \"12-SP4\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"Canonical\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"UbuntuServer\"\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"14.04.0-LTS\",\r\n                                \"14.04.1-LTS\",\r\n                                \"14.04.5-LTS\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"16.04-LTS\",\r\n                                \"16.04.0-LTS\"\r\n                              ]\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"in\": [\r\n                                \"18.04-LTS\"\r\n                              ]\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"OpenLogic\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"in\": [\r\n                            \"Centos\",\r\n                            \"Centos-LVM\",\r\n                            \"CentOS-SRIOV\"\r\n                          ]\r\n                        },\r\n                        {\r\n                          \"anyOf\": [\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"6.*\"\r\n                            },\r\n                            {\r\n                              \"field\": \"Microsoft.Compute/imageSKU\",\r\n                              \"like\": \"7*\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"allOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"cloudera\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"equals\": \"cloudera-centos-os\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"like\": \"7*\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11ac78e3-31bc-4f0c-8434-37ab963cea07\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Develop business classification schemes\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0155 - Develop business classification schemes\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0155\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11ba0508-58a8-44de-5f3a-9e05d80571da\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11ba0508-58a8-44de-5f3a-9e05d80571da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Function app slots should disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling public network access improves security by ensuring that the Function app is not exposed on the public internet. Creating private endpoints can limit exposure of a Function App. Learn more at: https://aka.ms/app-service-private-endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\",\r\n              \"Deny\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites/slots\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"workflowapp\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/slots/publicNetworkAccess\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/slots/publicNetworkAccess\",\r\n                    \"notEquals\": \"Disabled\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11c82d0c-db9f-4d7b-97c5-f3f9aa957da2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11c82d0c-db9f-4d7b-97c5-f3f9aa957da2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Recovery Services vaults should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Recovery Services vaults, data leakage risks are reduced. Learn more about private links for Azure Site Recovery at: https://aka.ms/HybridScenarios-PrivateLink and https://aka.ms/AzureToAzure-PrivateLink.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"Site Recovery\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.RecoveryServices/vaults\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.RecoveryServices/vaults/privateEndpointConnections[*]\",\r\n                  \"where\": {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.RecoveryServices/vaults/privateEndpointConnections[*].privateLinkServiceConnectionState.status\",\r\n                        \"equals\": \"Approved\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.RecoveryServices/vaults/privateEndpointConnections[*].provisioningState\",\r\n                        \"equals\": \"Succeeded\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.RecoveryServices/vaults/privateEndpointConnections[*].id\",\r\n                        \"contains\": \"SiteRecovery\"\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/11e3da8c-1d68-4392-badd-0ff3c43ab5b0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"11e3da8c-1d68-4392-badd-0ff3c43ab5b0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Security Options - System settings'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Security Options - System settings' for certificate rules on executables for SRP and optional subsystems. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"3.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SecurityOptionsSystemsettings\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\": \"System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\r\n              \"portalReview\": \"true\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies\",\r\n              \"description\": \"Specifies whether digital certificates are processed when software restriction policies are enabled and a user or process attempts to run software with an .exe file name extension. It enables or disables certificate rules (a type of software restriction policies rule). For certificate rules to take effect in software restriction policies, you must enable this policy setting.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"dsvm-win*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsSystemsettings\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue', '=', parameters('SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12017595-5a75-4bb1-9d97-4c2c939ea3c3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12017595-5a75-4bb1-9d97-4c2c939ea3c3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1655 - Voice Over Internet Protocol\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1655\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/121eab72-390e-4629-a7e2-6d6184f57c6b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"121eab72-390e-4629-a7e2-6d6184f57c6b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'Security Options - Network Security'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'Security Options - Network Security' for including Local System behavior, PKU2U, LAN Manager, LDAP client, and NTLM SSP. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"3.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SecurityOptionsNetworkSecurity\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\": \"Network Security: Configure encryption types allowed for Kerberos;ExpectedValue\",\r\n              \"NetworkSecurityLANManagerAuthenticationLevel\": \"Network security: LAN Manager authentication level;ExpectedValue\",\r\n              \"NetworkSecurityLDAPClientSigningRequirements\": \"Network security: LDAP client signing requirements;ExpectedValue\",\r\n              \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue\",\r\n              \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\r\n              \"portalReview\": \"true\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Security: Configure encryption types allowed for Kerberos\",\r\n              \"description\": \"Specifies the encryption types that Kerberos is allowed to use.\"\r\n            },\r\n            \"defaultValue\": \"2147483644\"\r\n          },\r\n          \"NetworkSecurityLANManagerAuthenticationLevel\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network security: LAN Manager authentication level\",\r\n              \"description\": \"Specify which challenge-response authentication protocol is used for network logons. This choice affects the level of authentication protocol used by clients, the level of session security negotiated, and the level of authentication accepted by servers.\"\r\n            },\r\n            \"defaultValue\": \"5\"\r\n          },\r\n          \"NetworkSecurityLDAPClientSigningRequirements\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network security: LDAP client signing requirements\",\r\n              \"description\": \"Specify the level of data signing that is requested on behalf of clients that issue LDAP BIND requests.\"\r\n            },\r\n            \"defaultValue\": \"1\"\r\n          },\r\n          \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) clients\",\r\n              \"description\": \"Specifies which behaviors are allowed by clients for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services. See https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-minimum-session-security-for-ntlm-ssp-based-including-secure-rpc-servers for more information.\"\r\n            },\r\n            \"defaultValue\": \"537395200\"\r\n          },\r\n          \"NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network security: Minimum session security for NTLM SSP based (including secure RPC) servers\",\r\n              \"description\": \"Specifies which behaviors are allowed by servers for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services.\"\r\n            },\r\n            \"defaultValue\": \"537395200\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"dsvm-win*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsNetworkSecurity\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Network Security: Configure encryption types allowed for Kerberos;ExpectedValue', '=', parameters('NetworkSecurityConfigureEncryptionTypesAllowedForKerberos'), ',', 'Network security: LAN Manager authentication level;ExpectedValue', '=', parameters('NetworkSecurityLANManagerAuthenticationLevel'), ',', 'Network security: LDAP client signing requirements;ExpectedValue', '=', parameters('NetworkSecurityLDAPClientSigningRequirements'), ',', 'Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue', '=', parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients'), ',', 'Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue', '=', parameters('NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1221c620-d201-468c-81e7-2817e6107e84\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1221c620-d201-468c-81e7-2817e6107e84\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowlist rules in your adaptive application control policy should be updated\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Monitor for changes in behavior on groups of machines configured for auditing by Azure Security Center's adaptive application controls. Security Center uses machine learning to analyze the running processes on your machines and suggest a list of known-safe applications. These are presented as recommended apps to allow in adaptive application control policies.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"1234abcd-1b53-4fd4-9835-2c2fa3935313\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/123a3936-f020-408a-ba0c-47873faf1534\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"123a3936-f020-408a-ba0c-47873faf1534\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Web Application Firewall (WAF) should use the specified mode for Application Gateway\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Mandates the use of 'Detection' or 'Prevention' mode to be active on all Web Application Firewall policies for Application Gateway.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"modeRequirement\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Mode Requirement\",\r\n              \"description\": \"Mode required for all WAF policies\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Prevention\",\r\n              \"Detection\"\r\n            ],\r\n            \"defaultValue\": \"Detection\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/applicationGatewayWebApplicationFirewallPolicies\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/applicationGatewayWebApplicationFirewallPolicies/policySettings.mode\",\r\n                \"notEquals\": \"[parameters('modeRequirement')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12430be1-6cc8-4527-a9a8-e3d38f250096\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12430be1-6cc8-4527-a9a8-e3d38f250096\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1681 - Malicious Code Protection | Automatic Updates\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1681\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12623e7e-4736-4b2e-b776-c1600f35f93a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12623e7e-4736-4b2e-b776-c1600f35f93a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1754 - Testing, Training, And Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1754\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12718e41-af09-43b9-b6e4-7caae73b410b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12718e41-af09-43b9-b6e4-7caae73b410b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Azure Data Factory linked services should use Key Vault for storing secrets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"To ensure secrets (such as connection strings) are managed securely, require users to provide secrets using an Azure Key Vault instead of specifying them inline in linked services.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"Data Factory\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataFactory/factories/linkedservices\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/typeProperties.connectionString\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.DataFactory/factories/linkedservices/typeProperties.connectionString\",\r\n                            \"contains\": \"AccountKey=\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.DataFactory/factories/linkedservices/typeProperties.connectionString\",\r\n                            \"contains\": \"PWD=\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.DataFactory/factories/linkedservices/typeProperties.connectionString\",\r\n                            \"contains\": \"Password=\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.DataFactory/factories/linkedservices/typeProperties.connectionString\",\r\n                            \"contains\": \"CredString=\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.DataFactory/factories/linkedservices/typeProperties.connectionString\",\r\n                            \"contains\": \"pwd=\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/SqlServer.typeProperties.password.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/SqlServer.typeProperties.password\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/SqlServer.typeProperties.password.type\",\r\n                        \"exists\": \"false\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/AzureSqlDW.typeProperties.servicePrincipalKey.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/AzureSearch.typeProperties.key.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/AzureStorage.typeProperties.sasUri\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/AzureStorage.typeProperties.sasUri.type\",\r\n                        \"notEquals\": \"AzureKeyVaultSecret\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/AzureBlobStorage.typeProperties.servicePrincipalKey\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/AzureBlobStorage.typeProperties.servicePrincipalKey.type\",\r\n                        \"notEquals\": \"AzureKeyVaultSecret\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/AzureStorage.typeProperties.accountKey\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/CosmosDb.typeProperties.accountKey.type\",\r\n                        \"notEquals\": \"AzureKeyVaultSecret\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/typeProperties.encryptedCredential\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/AmazonMWS.typeProperties.mwsAuthToken.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/AmazonMWS.typeProperties.secretKey.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/AmazonS3.typeProperties.secretAccessKey.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/Dynamics.typeProperties.servicePrincipalCredential\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/Dynamics.typeProperties.servicePrincipalCredential.type\",\r\n                        \"equals\": \"SecureString\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/Hubspot.typeProperties.accessToken\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/Hubspot.typeProperties.accessToken.type\",\r\n                        \"equals\": \"SecureString\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/Odbc.typeProperties.credential.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/GoogleAdWords.typeProperties.developerToken.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/GoogleBigQuery.typeProperties.clientSecret.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/GoogleBigQuery.typeProperties.refreshToken.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/type\",\r\n                        \"in\": [\r\n                          \"MongoDbAtlas\",\r\n                          \"MongoDbV2\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.DataFactory/factories/linkedservices/typeProperties.connectionString.type\",\r\n                        \"notEquals\": \"AzureKeyVaultSecret\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/OData.typeProperties.servicePrincipalEmbeddedCert.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/OData.typeProperties.servicePrincipalEmbeddedCertPassword.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/Sftp.typeProperties.privateKeyContent.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/Sftp.typeProperties.passPhrase.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DataFactory/factories/linkedservices/Salesforce.typeProperties.securityToken.type\",\r\n                    \"equals\": \"SecureString\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/127ef6d7-242f-43b3-9eef-947faf1725d0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"127ef6d7-242f-43b3-9eef-947faf1725d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Perform audit for configuration change control\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0390 - Perform audit for configuration change control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0390\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1282809c-9001-176b-4a81-260a085f4872\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1282809c-9001-176b-4a81-260a085f4872\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Configure ChangeTracking Extension for Linux virtual machine scale sets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configure Linux virtual machine scale sets to automatically install the ChangeTracking Extension to enable File Integrity Monitoring(FIM) in Azure Security Center. FIM examines operating system files, Windows registries, application software, Linux system files, and more, for changes that might indicate an attack. The extension can be installed in virtual machines and locations supported by Azure Monitor Agent.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0-preview\",\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"listOfApplicableLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Applicable Locations\",\r\n              \"description\": \"The list of locations where the policy should be applied.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"australiasoutheast\",\r\n              \"australiaeast\",\r\n              \"brazilsouth\",\r\n              \"canadacentral\",\r\n              \"centralindia\",\r\n              \"centralus\",\r\n              \"eastasia\",\r\n              \"eastus2euap\",\r\n              \"eastus\",\r\n              \"eastus2\",\r\n              \"francecentral\",\r\n              \"japaneast\",\r\n              \"koreacentral\",\r\n              \"northcentralus\",\r\n              \"northeurope\",\r\n              \"norwayeast\",\r\n              \"southcentralus\",\r\n              \"southeastasia\",\r\n              \"switzerlandnorth\",\r\n              \"uaenorth\",\r\n              \"uksouth\",\r\n              \"westcentralus\",\r\n              \"westeurope\",\r\n              \"westus\",\r\n              \"westus2\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"australiasoutheast\",\r\n              \"australiaeast\",\r\n              \"brazilsouth\",\r\n              \"canadacentral\",\r\n              \"centralindia\",\r\n              \"centralus\",\r\n              \"eastasia\",\r\n              \"eastus2euap\",\r\n              \"eastus\",\r\n              \"eastus2\",\r\n              \"francecentral\",\r\n              \"japaneast\",\r\n              \"koreacentral\",\r\n              \"northcentralus\",\r\n              \"northeurope\",\r\n              \"norwayeast\",\r\n              \"southcentralus\",\r\n              \"southeastasia\",\r\n              \"switzerlandnorth\",\r\n              \"uaenorth\",\r\n              \"uksouth\",\r\n              \"westcentralus\",\r\n              \"westeurope\",\r\n              \"westus\",\r\n              \"westus2\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('listOfApplicableLocations')]\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-SAP-HANA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"SLES\",\r\n                          \"SLES-HPC\",\r\n                          \"SLES-HPC-Priority\",\r\n                          \"SLES-SAP\",\r\n                          \"SLES-SAP-BYOS\",\r\n                          \"SLES-Priority\",\r\n                          \"SLES-BYOS\",\r\n                          \"SLES-SAPCAL\",\r\n                          \"SLES-Standard\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"15*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"14.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"16.04*LTS\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"18.04*LTS\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"0001-com-ubuntu-server-focal\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"20_04-lts*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"6.*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"8\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"like\": \"9\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"debian-10\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"like\": \"10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                    \"equals\": \"ChangeTracking-Linux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.ChangeTrackingAndInventory\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"ChangeTracking-Linux\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.ChangeTrackingAndInventory\",\r\n                      \"vmExtensionType\": \"ChangeTracking-Linux\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"2.0\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2019-03-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1288c8d7-4b05-4e3a-bc88-9053caefc021\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1288c8d7-4b05-4e3a-bc88-9053caefc021\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1240 - User-Installed Software\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1240\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/129eb39f-d79a-4503-84cd-92f036b5e429\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"129eb39f-d79a-4503-84cd-92f036b5e429\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1834 - Data Retention And Disposal\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Data Minimization and Retention control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1834\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12a4a4dd-6c65-4900-9d7e-63fed5da791e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12a4a4dd-6c65-4900-9d7e-63fed5da791e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'Security Options - System objects'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - System objects'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsSystemobjects\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SecurityOptionsSystemobjects\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12ae2d24-3805-4b37-9fa9-465968bfbcfa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12ae2d24-3805-4b37-9fa9-465968bfbcfa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure information system fails in known state\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1662 - Ensure information system fails in known state\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1662\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12af7c7a-92af-9e96-0d0c-5e732d1a3751\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12af7c7a-92af-9e96-0d0c-5e732d1a3751\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1666 - System And Information Integrity Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1666\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12e30ee3-61e6-4509-8302-a871e8ebb91e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12e30ee3-61e6-4509-8302-a871e8ebb91e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Arc-enabled kubernetes clusters should be configured with an Azure Arc Private Link Scope\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping Azure Arc-enabled servers to an Azure Arc Private Link Scope that is configured with a private endpoint, data leakage risks are reduced. Learn more about private links at: https://aka.ms/arc/privatelink.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Azure Arc\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Kubernetes/connectedClusters\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Kubernetes/connectedClusters/privateLinkScopeResourceId\",\r\n                \"exists\": false\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12e7176a-4919-47ef-922b-34eda4c7f0ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12e7176a-4919-47ef-922b-34eda4c7f0ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that do not have the specified applications installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"installedApplication\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Application names (supports wildcards)\",\r\n              \"description\": \"A semicolon-separated list of the names of the applications that should be installed. e.g. 'Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code' or 'Microsoft SQL Server 2014*' (to match any application starting with 'Microsoft SQL Server 2014')\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WhitelistedApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[InstalledApplication]bwhitelistedapp;Name', '=', parameters('installedApplication')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"WhitelistedApplication\"\r\n                    },\r\n                    \"installedApplication\": {\r\n                      \"value\": \"[parameters('installedApplication')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"installedApplication\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[InstalledApplication]bwhitelistedapp;Name\",\r\n                                \"value\": \"[parameters('installedApplication')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[InstalledApplication]bwhitelistedapp;Name\",\r\n                                \"value\": \"[parameters('installedApplication')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1347 - Identification And Authentication (Non-Organizational Users) | Acceptance Of Piv Credentials...\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1347\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/131a2706-61e9-4916-a164-00e052056462\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"131a2706-61e9-4916-a164-00e052056462\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Configure Azure Defender for Kubernetes to be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for Kubernetes provides real-time threat protection for containerized environments and generates alerts for suspicious activities.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"KubernetesService\",\r\n              \"deploymentScope\": \"subscription\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              },\r\n              \"deployment\": {\r\n                \"location\": \"westeurope\",\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {},\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {},\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Security/pricings\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"name\": \"KubernetesService\",\r\n                        \"properties\": {\r\n                          \"pricingTier\": \"Standard\"\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/133047bf-1369-41e3-a3be-74a11ed1395a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"133047bf-1369-41e3-a3be-74a11ed1395a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1450 - Physical Access Authorizations\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1450\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/134d7a13-ba3e-41e2-b236-91bfcfa24e01\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"134d7a13-ba3e-41e2-b236-91bfcfa24e01\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure your Storage account public access to be disallowed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Anonymous public read access to containers and blobs in Azure Storage is a convenient way to share data but might present security risks. To prevent data breaches caused by undesired anonymous access, Microsoft recommends preventing public access to a storage account unless your scenario requires it.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"value\": \"[requestContext().apiVersion]\",\r\n                        \"less\": \"2019-04-01\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Storage/storageAccounts/allowBlobPublicAccess\",\r\n                        \"exists\": \"true\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/allowBlobPublicAccess\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"conflictEffect\": \"audit\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2019-04-01')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/allowBlobPublicAccess\",\r\n                  \"value\": false\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13502221-8df0-4414-9937-de9c5c4e396b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1184 - Configuration Change Control\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1184\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13579d0e-0ab0-4b26-b0fb-d586f6d7ed20\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13579d0e-0ab0-4b26-b0fb-d586f6d7ed20\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Identify and mitigate potential issues at alternate storage site\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1271 - Identify and mitigate potential issues at alternate storage site\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1271\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13939f8c-4cd5-a6db-9af4-9dfec35e3722\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13939f8c-4cd5-a6db-9af4-9dfec35e3722\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Function app slots should use an Azure file share for its content directory\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"The content directory of a Function app should be located on an Azure file share. The storage account information for the file share must be provided before any publishing activity. To learn more about using Azure Files for hosting app service content refer to https://go.microsoft.com/fwlink/?linkid=2151594.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites/slots\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"workflowapp\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/slots/storageAccountRequired\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13bcff5d-f0eb-4ce7-913e-83ad6300376b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13bcff5d-f0eb-4ce7-913e-83ad6300376b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure machines to receive a vulnerability assessment provider\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Defender includes vulnerability scanning for your machines at no extra cost. You don't need a Qualys license or even a Qualys account - everything's handled seamlessly inside Security Center. When you enable this policy, Azure Defender automatically deploys the Qualys vulnerability assessment provider to all supported machines that don't already have it installed.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"4.0.0\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"vaType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Vulnerability assessment provider type\",\r\n              \"description\": \"Select the vulnerability assessment solution to provision to machines.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"default\",\r\n              \"mdeTvm\"\r\n            ],\r\n            \"defaultValue\": \"default\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"tags\",\r\n                    \"notContainsKey\": \"MDFCSecurityConnector\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"ffff0522-1e88-47fc-8382-2a80ba848f5d\",\r\n              \"evaluationDelay\": \"PT60M\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                    \"equals\": \"NotApplicable\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                        \"equals\": \"Healthy\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Security/assessments/status.cause\",\r\n                        \"equals\": \"[parameters('vaType')]\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"Incremental\",\r\n                  \"template\": {\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"vaType\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"resourceNameAndVaType\": \"[concat(parameters('vmName'), '/Microsoft.Security/', parameters('vaType'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('resourceType')), toLower('microsoft.compute/virtualmachines'))]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/serverVulnerabilityAssessments\",\r\n                        \"name\": \"[variables('resourceNameAndVaType')]\",\r\n                        \"apiVersion\": \"2020-01-01\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('resourceType')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/serverVulnerabilityAssessments\",\r\n                        \"name\": \"[variables('resourceNameAndVaType')]\",\r\n                        \"apiVersion\": \"2020-01-01\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"vaType\": {\r\n                      \"value\": \"[parameters('vaType')]\"\r\n                    }\r\n                  }\r\n                }\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13ce0167-8ca6-4048-8e6b-f996402e3c1b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13ce0167-8ca6-4048-8e6b-f996402e3c1b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1085 - Publicly Accessible Content\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1085\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13d117e0-38b0-4bbb-aaab-563be5dd10ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13d117e0-38b0-4bbb-aaab-563be5dd10ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1404 - Maintenance Tools\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1404\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13d8f903-0cd6-449f-a172-50f6579c182b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13d8f903-0cd6-449f-a172-50f6579c182b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Information flow control using security policy filters\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1029 - Information flow control using security policy filters\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1029\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13ef3484-3a51-785a-9c96-500f21f84edd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13ef3484-3a51-785a-9c96-500f21f84edd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Document security assurance requirements in acquisition contracts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0199 - Document security assurance requirements in acquisition contracts\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0199\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13efd2d7-3980-a2a4-39d0-527180c009e8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13efd2d7-3980-a2a4-39d0-527180c009e8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1695 - Information System Monitoring | Wireless Intrusion Detection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1695\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/13fcf812-ec82-4eda-9b89-498de9efd620\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"13fcf812-ec82-4eda-9b89-498de9efd620\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines that contain certificates expiring within the specified number of days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if certificates in the specified store have an expiration date out of range for the number of days given as parameter. The policy also provides the option to only check for specific certificates or exclude specific certificates, and whether to report on expired certificates.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"CertificateExpiration\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"CertificateStorePath\": \"[CertificateStore]CertificateStore1;CertificateStorePath\",\r\n              \"ExpirationLimitInDays\": \"[CertificateStore]CertificateStore1;ExpirationLimitInDays\",\r\n              \"CertificateThumbprintsToInclude\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\",\r\n              \"CertificateThumbprintsToExclude\": \"[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude\",\r\n              \"IncludeExpiredCertificates\": \"[CertificateStore]CertificateStore1;IncludeExpiredCertificates\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\r\n              \"portalReview\": \"true\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"CertificateStorePath\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate store path\",\r\n              \"description\": \"The path to the certificate store containing the certificates to check the expiration dates of. Default value is 'Cert:' which is the root certificate store path, so all certificates on the machine will be checked. Other example paths: 'Cert:\\\\LocalMachine', 'Cert:\\\\LocalMachine\\\\TrustedPublisher', 'Cert:\\\\CurrentUser'\"\r\n            },\r\n            \"defaultValue\": \"Cert:\"\r\n          },\r\n          \"ExpirationLimitInDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expiration limit in days\",\r\n              \"description\": \"An integer indicating the number of days within which to check for certificates that are expiring. For example, if this value is 30, any certificate expiring within the next 30 days will cause this policy to be non-compliant.\"\r\n            },\r\n            \"defaultValue\": \"30\"\r\n          },\r\n          \"CertificateThumbprintsToInclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints to include\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints to check under the specified path. If a value is not specified, all certificates under the certificate store path will be checked. If a value is specified, no certificates other than those with the thumbprints specified will be checked. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"CertificateThumbprintsToExclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Certificate thumbprints to exclude\",\r\n              \"description\": \"A semicolon-separated list of certificate thumbprints to ignore. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"IncludeExpiredCertificates\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include expired certificates\",\r\n              \"description\": \"Must be 'true' or 'false'. True indicates that any found certificates that have already expired will also make this policy non-compliant. False indicates that certificates that have expired will be be ignored.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"dsvm-win*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"CertificateExpiration\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('[CertificateStore]CertificateStore1;CertificateStorePath', '=', parameters('CertificateStorePath'), ',', '[CertificateStore]CertificateStore1;ExpirationLimitInDays', '=', parameters('ExpirationLimitInDays'), ',', '[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude', '=', parameters('CertificateThumbprintsToInclude'), ',', '[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude', '=', parameters('CertificateThumbprintsToExclude'), ',', '[CertificateStore]CertificateStore1;IncludeExpiredCertificates', '=', parameters('IncludeExpiredCertificates')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1417908b-4bff-46ee-a2a6-4acc899320ab\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1417908b-4bff-46ee-a2a6-4acc899320ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1872 - Information Sharing with Third Parties \",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Use Limitation control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1872\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1437bf9c-feef-4c82-a57a-22d1fcbcd247\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1437bf9c-feef-4c82-a57a-22d1fcbcd247\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs if the Administrators group contains any of the specified members\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group contains any of the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"MembersToExclude\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Members to exclude\",\r\n              \"description\": \"A semicolon-separated list of members that should be excluded in the Administrators local group. Ex: Administrator; myUser1; myUser2\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AdministratorsGroupMembersToExclude\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('[LocalGroup]AdministratorsGroup;MembersToExclude', '=', parameters('MembersToExclude')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AdministratorsGroupMembersToExclude\"\r\n                    },\r\n                    \"MembersToExclude\": {\r\n                      \"value\": \"[parameters('MembersToExclude')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"MembersToExclude\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[LocalGroup]AdministratorsGroup;MembersToExclude\",\r\n                                \"value\": \"[parameters('MembersToExclude')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"[LocalGroup]AdministratorsGroup;MembersToExclude\",\r\n                                \"value\": \"[parameters('MembersToExclude')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"144f1397-32f9-4598-8c88-118decc3ccba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Update contingency plan\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1248 - Update contingency plan\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1248\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/14a4fd0a-9100-1e12-1362-792014a28155\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"14a4fd0a-9100-1e12-1362-792014a28155\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Cognitive Services accounts to disable local authentication methods\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disable local authentication methods so that your Cognitive Services accounts require Azure Active Directory identities exclusively for authentication. Learn more at: https://aka.ms/cs/auth.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cognitive Services\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/disableLocalAuth\",\r\n                \"notEquals\": true\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"conflictEffect\": \"audit\",\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2021-04-30')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.CognitiveServices/accounts/disableLocalAuth\",\r\n                  \"value\": true\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/14de9e63-1b31-492e-a5a3-c3f7fd57f555\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"14de9e63-1b31-492e-a5a3-c3f7fd57f555\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Configure supported Windows machines to automatically install the Azure Security agent\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configure supported Windows machines to automatically install the Azure Security agent. Security Center collects events from the agent and uses them to provide security alerts and tailored hardening tasks (recommendations). Target virtual machines must be in a supported location.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"5.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2019\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2019-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"evaluationDelay\": \"AfterProvisioning\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"AzureSecurityWindowsAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/Publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/enableAutomaticUpgrade\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"in\": [\r\n                      \"Succeeded\",\r\n                      \"Provisioning succeeded\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', 'AzureSecurityWindowsAgent')]\",\r\n                        \"apiVersion\": \"2019-03-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Security.Monitoring\",\r\n                          \"type\": \"AzureSecurityWindowsAgent\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"enableAutomaticUpgrade\": true,\r\n                          \"settings\": {},\r\n                          \"protectedsettings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1537496a-b1e8-482b-a06a-1cc2415cdc7b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1537496a-b1e8-482b-a06a-1cc2415cdc7b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1157 - Plan Of Action And Milestones\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1157\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/15495367-cf68-464c-bbc3-f53ca5227b7a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"15495367-cf68-464c-bbc3-f53ca5227b7a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1491 - Security Planning Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1491\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1571dd40-dafc-4ef4-8f55-16eba27efc7b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1571dd40-dafc-4ef4-8f55-16eba27efc7b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1564 - System Development Life Cycle\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1564\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/157f0ef9-143f-496d-b8f9-f8c8eeaad801\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"157f0ef9-143f-496d-b8f9-f8c8eeaad801\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Log Analytics agent should be installed on your Cloud Services (extended support) role instances\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Security Center collects data from your Cloud Services (extended support) role instances to monitor for security vulnerabilities and threats.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/cloudServices\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"45cfe080-ceb1-a91e-9743-71551ed24e94\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/15fdbc87-8a47-4ee9-a2aa-9a2ea1f37554\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"15fdbc87-8a47-4ee9-a2aa-9a2ea1f37554\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that do not have a minimum password age of 1 day\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have a minimum password age of 1 day. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"2.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordAge\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"MinimumPasswordAge\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16390df4-2f73-4b42-af13-c801066763df\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Video Analyzer accounts should use customer-managed keys to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use customer-managed keys to manage the encryption at rest of your Video Analyzer accounts. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/videoanalyzerscmkdocs.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Video Analyzers\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Media/videoanalyzers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Media/videoanalyzers/encryption.type\",\r\n                \"notEquals\": \"CustomerKey\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/165a4137-c3ed-4fd0-a17f-1c8a80266580\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"165a4137-c3ed-4fd0-a17f-1c8a80266580\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1662 - Fail In Known State\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1662\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/165cb91f-7ea8-4ab7-beaf-8636b98c9d15\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"165cb91f-7ea8-4ab7-beaf-8636b98c9d15\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1684 - Information System Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1684\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16bfdb59-db38-47a5-88a9-2e9371a638cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16bfdb59-db38-47a5-88a9-2e9371a638cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Produce, control and distribute symmetric cryptographic keys\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1645 - Produce, control and distribute symmetric cryptographic keys\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1645\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16c54e01-9e65-7524-7c33-beda48a75779\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16c54e01-9e65-7524-7c33-beda48a75779\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure NetApp Files Volumes of type NFSv4.1 should use Kerberos data integrity or data privacy\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Ensure that at least either Kerberos integrity (krb5i) or Kerberos privacy (krb5p) is selected to ensure data integrity and data privacy.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/protocolTypes[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/protocolTypes[*]\",\r\n                    \"equals\": \"NFSv4.1\"\r\n                  }\r\n                },\r\n                \"greater\": 0\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/kerberosEnabled\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/kerberosEnabled\",\r\n                    \"equals\": \"false\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/kerberosEnabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"count\": {\r\n                          \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/exportPolicy.rules[*]\",\r\n                          \"where\": {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/exportPolicy.rules[*].kerberos5iReadWrite\",\r\n                                    \"equals\": \"false\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/exportPolicy.rules[*].kerberos5iReadOnly\",\r\n                                    \"equals\": \"false\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/exportPolicy.rules[*].kerberos5pReadWrite\",\r\n                                    \"equals\": \"false\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/exportPolicy.rules[*].kerberos5pReadOnly\",\r\n                                    \"equals\": \"false\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/exportPolicy.rules[*].kerberos5ReadOnly\",\r\n                                \"equals\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.NetApp/netAppAccounts/capacityPools/volumes/exportPolicy.rules[*].kerberos5ReadWrite\",\r\n                                \"equals\": \"true\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        },\r\n                        \"greater\": 0\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16f4af95-96b1-4220-805a-367ca59cd72e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16f4af95-96b1-4220-805a-367ca59cd72e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs that do not have the specified Windows PowerShell modules installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have the specified Windows PowerShell modules installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"WindowsPowerShellModules\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16f9b37c-4408-4c30-bc17-254958f2e2d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1103 - Audit Events\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1103\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/16feeb31-6377-437e-bbab-d7f73911896d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"16feeb31-6377-437e-bbab-d7f73911896d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Generate internal security alerts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1704 - Generate internal security alerts\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1704\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/171e377b-5224-4a97-1eaa-62a3b5231dac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"171e377b-5224-4a97-1eaa-62a3b5231dac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1007 - Account Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1007\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17200329-bf6c-46d8-ac6d-abf4641c2add\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17200329-bf6c-46d8-ac6d-abf4641c2add\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Batch pools should have disk encryption enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enabling Azure Batch disk encryption ensures that data is always encrypted at rest on your Azure Batch compute node. Learn more about disk encryption in Batch at https://docs.microsoft.com/azure/batch/disk-encryption.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Batch\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\",\r\n              \"Deny\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Batch/batchAccounts/pools\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Batch/batchAccounts/pools/deploymentConfiguration.virtualMachineConfiguration.diskEncryptionConfiguration.targets[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.Batch/batchAccounts/pools/deploymentConfiguration.virtualMachineConfiguration.diskEncryptionConfiguration.targets[*]\",\r\n                    \"contains\": \"TemporaryDisk\"\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1760f9d4-7206-436e-a28f-d9f3a5c8a227\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1760f9d4-7206-436e-a28f-d9f3a5c8a227\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1349 - Identification And Authentication (Non-Organizational Users) | Use Of Ficam-Approved Products\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1349\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17641f70-94cd-4a5d-a613-3d1143e20e34\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17641f70-94cd-4a5d-a613-3d1143e20e34\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy associations for a managed application\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys an association resource that associates selected resource types to the specified managed application.  This policy deployment does not support nested resource types.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Managed Application\"\r\n        },\r\n        \"parameters\": {\r\n          \"targetManagedApplicationId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Managed application ID\",\r\n              \"description\": \"Resource ID of the managed application to which resources need to be associated.\"\r\n            }\r\n          },\r\n          \"resourceTypesToAssociate\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource types to associate\",\r\n              \"description\": \"The list of resource types to be associated to the managed application.\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          },\r\n          \"associationNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Association name prefix\",\r\n              \"description\": \"Prefix to be added to the name of the association resource being created.\"\r\n            },\r\n            \"defaultValue\": \"DeployedByPolicy\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('resourceTypesToAssociate')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.CustomProviders/Associations\",\r\n              \"name\": \"[concat(parameters('associationNamePrefix'), '-', uniqueString(parameters('targetManagedApplicationId')))]\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"associatedResourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"resourceTypesToAssociate\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"targetManagedApplicationId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"associationNamePrefix\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"resourceType\": \"[concat(parameters('resourceTypesToAssociate'), '/providers/associations')]\",\r\n                      \"resourceName\": \"[concat(parameters('associatedResourceName'), '/microsoft.customproviders/', parameters('associationNamePrefix'), '-', uniqueString(parameters('targetManagedApplicationId')))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[concat(deployment().Name, '-2')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"[variables('resourceType')]\",\r\n                                \"name\": \"[variables('resourceName')]\",\r\n                                \"apiVersion\": \"2018-09-01-preview\",\r\n                                \"properties\": {\r\n                                  \"targetResourceId\": \"[parameters('targetManagedApplicationId')]\"\r\n                                }\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"resourceTypesToAssociate\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"associatedResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"targetManagedApplicationId\": {\r\n                      \"value\": \"[parameters('targetManagedApplicationId')]\"\r\n                    },\r\n                    \"associationNamePrefix\": {\r\n                      \"value\": \"[parameters('associationNamePrefix')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17763ad9-70c0-4794-9397-53d765932634\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17763ad9-70c0-4794-9397-53d765932634\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure alternate storage site safeguards are equivalent to primary site\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1268 - Ensure alternate storage site safeguards are equivalent to primary site\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1268\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/178c8b7e-1b6e-4289-44dd-2f1526b678a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"178c8b7e-1b6e-4289-44dd-2f1526b678a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Configure system-assigned managed identity to enable Azure Monitor assignments on VMs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configure system-assigned managed identity to virtual machines hosted in Azure that are supported by Azure Monitor and do not have a system-assigned managed identity. A system-assigned managed identity is a prerequisite for all Azure Monitor assignments and must be added to machines before using any Azure Monitor extension. Target virtual machines must be in a supported location.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\",\r\n          \"version\": \"6.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          },\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Additional Machine Images\",\r\n              \"description\": \"List of virtual machine scale set images that have supported OS to add to scope. Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"field\": \"identity.type\",\r\n                \"notContains\": \"SystemAssigned\"\r\n              },\r\n              {\r\n                \"value\": \"[requestContext().apiVersion]\",\r\n                \"greaterOrEquals\": \"2018-10-01\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"australiacentral\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"brazilsouth\",\r\n                  \"canadacentral\",\r\n                  \"canadaeast\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"centraluseuap\",\r\n                  \"eastasia\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"eastus2euap\",\r\n                  \"francecentral\",\r\n                  \"germanywestcentral\",\r\n                  \"japaneast\",\r\n                  \"japanwest\",\r\n                  \"jioindiawest\",\r\n                  \"koreacentral\",\r\n                  \"koreasouth\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"norwayeast\",\r\n                  \"qatarcentral\",\r\n                  \"southafricanorth\",\r\n                  \"southcentralus\",\r\n                  \"southeastasia\",\r\n                  \"southindia\",\r\n                  \"swedencentral\",\r\n                  \"switzerlandnorth\",\r\n                  \"uaenorth\",\r\n                  \"uksouth\",\r\n                  \"ukwest\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westindia\",\r\n                  \"westus\",\r\n                  \"westus2\",\r\n                  \"westus3\"\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-ARM64\",\r\n                          \"RHEL-BYOS\",\r\n                          \"RHEL-HA\",\r\n                          \"RHEL-SAP\",\r\n                          \"RHEL-SAP-APPS\",\r\n                          \"RHEL-SAP-HA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"8*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"rhel-lvm7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"rhel-lvm8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"in\": [\r\n                                  \"SLES\",\r\n                                  \"SLES-HPC\",\r\n                                  \"SLES-HPC-Priority\",\r\n                                  \"SLES-SAP\",\r\n                                  \"SLES-SAP-BYOS\",\r\n                                  \"SLES-Priority\",\r\n                                  \"SLES-BYOS\",\r\n                                  \"SLES-SAPCAL\",\r\n                                  \"SLES-Standard\"\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"12*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"15*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-12*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-15*\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"in\": [\r\n                                  \"gen1\",\r\n                                  \"gen2\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"UbuntuServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"0001-com-ubuntu-server-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"0001-com-ubuntu-pro-*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"14.04.0-lts\",\r\n                          \"14.04.1-lts\",\r\n                          \"14.04.2-lts\",\r\n                          \"14.04.3-lts\",\r\n                          \"14.04.4-lts\",\r\n                          \"14.04.5-lts\",\r\n                          \"16_04_0-lts-gen2\",\r\n                          \"16_04-lts-gen2\",\r\n                          \"16.04-lts\",\r\n                          \"16.04.0-lts\",\r\n                          \"18_04-lts-arm64\",\r\n                          \"18_04-lts-gen2\",\r\n                          \"18.04-lts\",\r\n                          \"20_04-lts-arm64\",\r\n                          \"20_04-lts-gen2\",\r\n                          \"20_04-lts\",\r\n                          \"22_04-lts-gen2\",\r\n                          \"22_04-lts\",\r\n                          \"pro-16_04-lts-gen2\",\r\n                          \"pro-16_04-lts\",\r\n                          \"pro-18_04-lts-gen2\",\r\n                          \"pro-18_04-lts\",\r\n                          \"pro-20_04-lts-gen2\",\r\n                          \"pro-20_04-lts\",\r\n                          \"pro-22_04-lts-gen2\",\r\n                          \"pro-22_04-lts\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"6*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"almalinux\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"almalinux\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"like\": \"8*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"ctrliqinc1648673227698\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"rocky-8*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"like\": \"rocky-8*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"Debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"equals\": \"9\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"debian-10\",\r\n                          \"debian-11\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"10\",\r\n                          \"10-gen2\",\r\n                          \"11\",\r\n                          \"11-gen2\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoftcblmariner\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cbl-mariner\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"1-gen2\",\r\n                          \"cbl-mariner-1\",\r\n                          \"cbl-mariner-2\",\r\n                          \"cbl-mariner-2-arm64\",\r\n                          \"cbl-mariner-2-gen2\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2008-R2-SP1*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2012-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2016-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2019-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2022-*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2022\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2022-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2019\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2019-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/e40ec5ca-96e0-45a2-b4ff-59039f2c2b59\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/f1a07417-d97a-45cb-824c-7a7467783830\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"identity.type\",\r\n                  \"value\": \"[if(contains(field('identity.type'), 'UserAssigned'), concat(field('identity.type'), ',SystemAssigned'), 'SystemAssigned')]\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17b3de92-f710-4cf4-aa55-0e7859f1ed7b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17b3de92-f710-4cf4-aa55-0e7859f1ed7b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Transparent Data Encryption on SQL databases should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Transparent data encryption should be enabled to protect data-at-rest and meet compliance requirements\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers/databases\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"master\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                    \"equals\": \"enabled\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/servers/databases/transparentDataEncryption/state\",\r\n                    \"equals\": \"enabled\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17k78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1325 - Authenticator Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1325\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1845796a-7581-49b2-ae20-443121538e19\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1845796a-7581-49b2-ae20-443121538e19\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1870 - Information Sharing with Third Parties \",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Use Limitation control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1870\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/18573dd5-899f-453d-b069-fa77b61fe257\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"18573dd5-899f-453d-b069-fa77b61fe257\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Resource logs should be enabled for Audit on supported resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Resource logs should be enabled to track activities and events that take place on your resources and give you visibility and insights into any changes that occur. The existence of a diagnostic setting for category group Audit on the selected resource types ensures that these logs are enabled and captured. Applicable resource types are those that support the \\\"Audit\\\" category group.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredLogLevel\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required Log Level\",\r\n              \"description\": \"Granularity of logging required to be enabled on a resource to meet compliance. Audit will check that the resource has a diagnostic setting enabled for categoryGroup audit or allLogs. Any will only check that a diagnostic setting exists for the resource.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Any\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"resourceTypeList\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Types\",\r\n              \"description\": \"List of Resource Types to be evaluated for diagnostic setting existence.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"microsoft.agfoodplatform/farmbeats\",\r\n              \"microsoft.apimanagement/service\",\r\n              \"microsoft.appconfiguration/configurationstores\",\r\n              \"microsoft.attestation/attestationproviders\",\r\n              \"microsoft.automation/automationaccounts\",\r\n              \"microsoft.avs/privateclouds\",\r\n              \"microsoft.cache/redis\",\r\n              \"microsoft.cdn/profiles\",\r\n              \"microsoft.cognitiveservices/accounts\",\r\n              \"microsoft.containerregistry/registries\",\r\n              \"microsoft.devices/iothubs\",\r\n              \"microsoft.eventgrid/topics\",\r\n              \"microsoft.eventgrid/domains\",\r\n              \"microsoft.eventgrid/partnernamespaces\",\r\n              \"microsoft.eventhub/namespaces\",\r\n              \"microsoft.keyvault/vaults\",\r\n              \"microsoft.keyvault/managedhsms\",\r\n              \"microsoft.machinelearningservices/workspaces\",\r\n              \"microsoft.media/mediaservices\",\r\n              \"microsoft.media/videoanalyzers\",\r\n              \"microsoft.netapp/netappaccounts/capacitypools/volumes\",\r\n              \"microsoft.network/publicipaddresses\",\r\n              \"microsoft.network/virtualnetworkgateways\",\r\n              \"microsoft.network/p2svpngateways\",\r\n              \"microsoft.network/frontdoors\",\r\n              \"microsoft.network/bastionhosts\",\r\n              \"microsoft.operationalinsights/workspaces\",\r\n              \"microsoft.purview/accounts\",\r\n              \"microsoft.servicebus/namespaces\",\r\n              \"microsoft.signalrservice/signalr\",\r\n              \"microsoft.signalrservice/webpubsub\",\r\n              \"microsoft.sql/servers/databases\",\r\n              \"microsoft.sql/managedinstances\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"microsoft.agfoodplatform/farmbeats\",\r\n              \"microsoft.apimanagement/service\",\r\n              \"microsoft.appconfiguration/configurationstores\",\r\n              \"microsoft.attestation/attestationproviders\",\r\n              \"microsoft.automation/automationaccounts\",\r\n              \"microsoft.avs/privateclouds\",\r\n              \"microsoft.cache/redis\",\r\n              \"microsoft.cdn/profiles\",\r\n              \"microsoft.cognitiveservices/accounts\",\r\n              \"microsoft.containerregistry/registries\",\r\n              \"microsoft.devices/iothubs\",\r\n              \"microsoft.eventgrid/topics\",\r\n              \"microsoft.eventgrid/domains\",\r\n              \"microsoft.eventgrid/partnernamespaces\",\r\n              \"microsoft.eventhub/namespaces\",\r\n              \"microsoft.keyvault/vaults\",\r\n              \"microsoft.keyvault/managedhsms\",\r\n              \"microsoft.machinelearningservices/workspaces\",\r\n              \"microsoft.media/mediaservices\",\r\n              \"microsoft.media/videoanalyzers\",\r\n              \"microsoft.netapp/netappaccounts/capacitypools/volumes\",\r\n              \"microsoft.network/publicipaddresses\",\r\n              \"microsoft.network/virtualnetworkgateways\",\r\n              \"microsoft.network/p2svpngateways\",\r\n              \"microsoft.network/frontdoors\",\r\n              \"microsoft.network/bastionhosts\",\r\n              \"microsoft.operationalinsights/workspaces\",\r\n              \"microsoft.purview/accounts\",\r\n              \"microsoft.servicebus/namespaces\",\r\n              \"microsoft.signalrservice/signalr\",\r\n              \"microsoft.signalrservice/webpubsub\",\r\n              \"microsoft.sql/servers/databases\",\r\n              \"microsoft.sql/managedinstances\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('resourceTypeList')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                  \"where\": {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].enabled\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"value\": \"[parameters('requiredLogLevel')]\",\r\n                            \"equals\": \"any\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/diagnosticSettings/logs[*].categoryGroup\",\r\n                            \"equals\": \"audit\"\r\n                          },\r\n                          {\r\n                            \"field\": \"microsoft.insights/diagnosticSettings/logs[*].categoryGroup\",\r\n                            \"equals\": \"allLogs\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"greater\": 0\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/187242f4-89c6-4c43-9a4e-188c0efacc5f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"187242f4-89c6-4c43-9a4e-188c0efacc5f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1480 - Temperature And Humidity Controls\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Physical and Environmental Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1480\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/18a767cc-1947-4338-a240-bc058c81164f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"18a767cc-1947-4338-a240-bc058c81164f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"PostgreSQL servers should use customer-managed keys to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use customer-managed keys to manage the encryption at rest of your PostgreSQL servers. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.4\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DBforPostgreSQL/servers/keys\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.DBforPostgreSQL/servers/keys/serverKeyType\",\r\n                    \"equals\": \"AzureKeyVault\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DBforPostgreSQL/servers/keys/uri\",\r\n                    \"notEquals\": \"\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DBforPostgreSQL/servers/keys/uri\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"18adea5e-f416-4d0f-8aa8-d24321e3e274\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1369 - Incident Monitoring\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1369\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/18cc35ed-a429-486d-8d59-cb47e87304ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"18cc35ed-a429-486d-8d59-cb47e87304ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Document process to ensure integrity of PII\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1827 - Document process to ensure integrity of PII\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1827\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/18e7906d-4197-20fa-2f14-aaac21864e71\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"18e7906d-4197-20fa-2f14-aaac21864e71\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Notify personnel of any failed security verification tests\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1710 - Notify personnel of any failed security verification tests\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1710\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/18e9d748-73d4-0c96-55ab-b108bfbd5bc3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"18e9d748-73d4-0c96-55ab-b108bfbd5bc3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Application Insights components should block non-Azure Active Directory based ingestion.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enforcing log ingestion to require Azure Active Directory authentication prevents unauthenticated logs from an attacker which could lead to incorrect status, false alerts, and incorrect logs stored in the system.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Deny\",\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Insights/components\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/components/DisableLocalAuth\",\r\n                \"notEquals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/199d5677-e4d9-4264-9465-efe1839c06bd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"199d5677-e4d9-4264-9465-efe1839c06bd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1269 - Alternate Storage Site | Separation From Primary Site\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1269\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/19b9439d-865d-4474-b17d-97d2702fdb66\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"19b9439d-865d-4474-b17d-97d2702fdb66\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'System Audit Policies - Logon-Logoff'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Logon-Logoff' for auditing IPSec, network policy, claims, account lockout, group membership, and logon/logoff events. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"3.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SystemAuditPoliciesLogonLogoff\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"AuditGroupMembership\": \"Audit Group Membership;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\r\n              \"portalReview\": \"true\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"AuditGroupMembership\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Group Membership\",\r\n              \"description\": \"Specifies whether audit events are generated when group memberships are enumerated on the client computer.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"Success\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"dsvm-win*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesLogonLogoff\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Audit Group Membership;ExpectedValue', '=', parameters('AuditGroupMembership')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/19be9779-c776-4dfa-8a15-a2fd5dc843d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"19be9779-c776-4dfa-8a15-a2fd5dc843d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Azure Key Vault Managed HSM should disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disable public network access for your Azure Key Vault Managed HSM so that it's not accessible over the public internet. This can reduce data leakage risks. Learn more at: https://docs.microsoft.com/azure/key-vault/managed-hsm/private-link#allow-trusted-services-to-access-managed-hsm.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"Key Vault\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/managedHSMs\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.KeyVault/managedHSMs/createMode\",\r\n                \"notEquals\": \"recover\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.KeyVault/managedHSMs/networkAcls.defaultAction\",\r\n                \"notEquals\": \"Deny\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/19ea9d63-adee-4431-a95e-1913c6c1c75f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"19ea9d63-adee-4431-a95e-1913c6c1c75f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Govern policies and procedures\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0292 - Govern policies and procedures\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0292\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1a2a03a4-9992-5788-5953-d8f6615306de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1a2a03a4-9992-5788-5953-d8f6615306de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1071 - Wireless Access Restrictions | Restrict Configurations By Users\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1071\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1a437f5b-9ad6-4f28-8861-de404d511ae4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1a437f5b-9ad6-4f28-8861-de404d511ae4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Monitor log profile should collect logs for categories 'write,' 'delete,' and 'action'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy ensures that a log profile collects logs for categories 'write,' 'delete,' and 'action'\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/logprofiles\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/categories[*]\",\r\n                      \"notEquals\": \"Write\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/categories[*]\",\r\n                      \"notEquals\": \"Delete\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Insights/logProfiles/categories[*]\",\r\n                      \"notEquals\": \"Action\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1a4e592a-6a6e-44a5-9814-e36264ca96e7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1a4e592a-6a6e-44a5-9814-e36264ca96e7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Access to App Services should be restricted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure security center has discovered that the networking configuration of some of your app services are overly permissive and allow inbound traffic from ranges that are too broad\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Web/sites\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"restrictAccessToAppServices\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1a833ff1-d297-4a0f-9944-888428f8e0ff\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Event Grid topics should disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling public network access improves security by ensuring that the resource isn't exposed on the public internet. You can limit exposure of your resources by creating private endpoints instead. Learn more at: https://aka.ms/privateendpoints.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Event Grid\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.EventGrid/topics\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notEquals\": \"AzureArc\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.EventGrid/topics/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1adadefe-5f21-44f7-b931-a59b54ccdb45\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1adadefe-5f21-44f7-b931-a59b54ccdb45\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Define acceptable and unacceptable mobile code technologies\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1651 - Define acceptable and unacceptable mobile code technologies\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1651\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1afada58-8b34-7ac2-a38a-983218635201\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1afada58-8b34-7ac2-a38a-983218635201\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Linux virtual machines should have Azure Monitor Agent installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Linux virtual machines should be monitored and secured through the deployed Azure Monitor Agent. The Azure Monitor Agent collects telemetry data from the guest OS. This policy will audit virtual machines with supported OS images in supported regions. Learn more: https://aka.ms/AMAOverview.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"listOfLinuxImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Additional Virtual Machine Images\",\r\n              \"description\": \"List of virtual machine images that have supported Linux OS to add to scope. Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"australiacentral\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"brazilsouth\",\r\n                  \"canadacentral\",\r\n                  \"canadaeast\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"centraluseuap\",\r\n                  \"eastasia\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"eastus2euap\",\r\n                  \"francecentral\",\r\n                  \"germanywestcentral\",\r\n                  \"japaneast\",\r\n                  \"japanwest\",\r\n                  \"jioindiawest\",\r\n                  \"koreacentral\",\r\n                  \"koreasouth\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"norwayeast\",\r\n                  \"qatarcentral\",\r\n                  \"southafricanorth\",\r\n                  \"southcentralus\",\r\n                  \"southeastasia\",\r\n                  \"southindia\",\r\n                  \"swedencentral\",\r\n                  \"switzerlandnorth\",\r\n                  \"uaenorth\",\r\n                  \"uksouth\",\r\n                  \"ukwest\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westindia\",\r\n                  \"westus\",\r\n                  \"westus2\",\r\n                  \"westus3\"\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfLinuxImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-ARM64\",\r\n                          \"RHEL-BYOS\",\r\n                          \"RHEL-HA\",\r\n                          \"RHEL-SAP\",\r\n                          \"RHEL-SAP-APPS\",\r\n                          \"RHEL-SAP-HA\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"8*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"rhel-lvm7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"rhel-lvm8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"SUSE\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"in\": [\r\n                                  \"SLES\",\r\n                                  \"SLES-HPC\",\r\n                                  \"SLES-HPC-Priority\",\r\n                                  \"SLES-SAP\",\r\n                                  \"SLES-SAP-BYOS\",\r\n                                  \"SLES-Priority\",\r\n                                  \"SLES-BYOS\",\r\n                                  \"SLES-SAPCAL\",\r\n                                  \"SLES-Standard\"\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"12*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"15*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-12*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"sles-15*\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"in\": [\r\n                                  \"gen1\",\r\n                                  \"gen2\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"UbuntuServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"0001-com-ubuntu-server-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"0001-com-ubuntu-pro-*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"14.04.0-lts\",\r\n                          \"14.04.1-lts\",\r\n                          \"14.04.2-lts\",\r\n                          \"14.04.3-lts\",\r\n                          \"14.04.4-lts\",\r\n                          \"14.04.5-lts\",\r\n                          \"16_04_0-lts-gen2\",\r\n                          \"16_04-lts-gen2\",\r\n                          \"16.04-lts\",\r\n                          \"16.04.0-lts\",\r\n                          \"18_04-lts-arm64\",\r\n                          \"18_04-lts-gen2\",\r\n                          \"18.04-lts\",\r\n                          \"20_04-lts-arm64\",\r\n                          \"20_04-lts-gen2\",\r\n                          \"20_04-lts\",\r\n                          \"22_04-lts-gen2\",\r\n                          \"22_04-lts\",\r\n                          \"pro-16_04-lts-gen2\",\r\n                          \"pro-16_04-lts\",\r\n                          \"pro-18_04-lts-gen2\",\r\n                          \"pro-18_04-lts\",\r\n                          \"pro-20_04-lts-gen2\",\r\n                          \"pro-20_04-lts\",\r\n                          \"pro-22_04-lts-gen2\",\r\n                          \"pro-22_04-lts\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Oracle\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Oracle-Linux\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"CentOS\",\r\n                          \"Centos-LVM\",\r\n                          \"CentOS-SRIOV\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"6*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"7*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"8*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"like\": \"7*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"almalinux\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"almalinux\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"like\": \"8*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"ctrliqinc1648673227698\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"rocky-8*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"like\": \"rocky-8*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"Debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"equals\": \"9\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Debian\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"debian-10\",\r\n                          \"debian-11\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"10\",\r\n                          \"10-gen2\",\r\n                          \"11\",\r\n                          \"11-gen2\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoftcblmariner\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cbl-mariner\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                        \"in\": [\r\n                          \"1-gen2\",\r\n                          \"cbl-mariner-1\",\r\n                          \"cbl-mariner-2\",\r\n                          \"cbl-mariner-2-arm64\",\r\n                          \"cbl-mariner-2-gen2\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"AzureMonitorLinuxAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitor\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1afdc4b6-581a-45fb-b630-f1e6051e3e7a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1afdc4b6-581a-45fb-b630-f1e6051e3e7a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"App Service apps should disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling public network access improves security by ensuring that the App Service is not exposed on the public internet. Creating private endpoints can limit exposure of an App Service. Learn more at: https://aka.ms/app-service-private-endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\",\r\n              \"Deny\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/publicNetworkAccess\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/publicNetworkAccess\",\r\n                    \"notEquals\": \"Disabled\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1b5ef780-c53c-4a64-87f3-bb9c8c8094ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Disable Command Invoke on Azure Kubernetes Service clusters\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling command invoke can enhance the security by rejecting invoke-command access to the cluster\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Kubernetes\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\",\r\n              \"portalReview\": true\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.ContainerService/managedClusters\",\r\n              \"name\": \"[field('name')]\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/ed7f3fbd-7b88-4dd4-9017-9adb7ce333f8\",\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/18ed5180-3e48-46fd-8541-4ea054d57064\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.ContainerService/managedClusters/apiServerAccessProfile.disableRunCommand\",\r\n                \"equals\": true\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"clusterName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"clusterResourceGroupName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"clusterGetDeploymentName\": \"[concat('PolicyDeployment-Get-', parameters('clusterName'))]\",\r\n                      \"clusterUpdateDeploymentName\": \"[concat('PolicyDeployment-Update-', parameters('clusterName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('clusterGetDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"resources\": [],\r\n                            \"outputs\": {\r\n                              \"aksCluster\": {\r\n                                \"type\": \"object\",\r\n                                \"value\": \"[reference(resourceId(parameters('clusterResourceGroupName'), 'Microsoft.ContainerService/managedClusters', parameters('clusterName')), '2021-08-01', 'Full')]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('clusterUpdateDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"aksClusterName\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"aksClusterContent\": {\r\n                                \"type\": \"object\"\r\n                              }\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"apiVersion\": \"2021-08-01\",\r\n                                \"type\": \"Microsoft.ContainerService/managedClusters\",\r\n                                \"name\": \"[parameters('aksClusterName')]\",\r\n                                \"location\": \"[parameters('aksClusterContent').location]\",\r\n                                \"sku\": \"[parameters('aksClusterContent').sku]\",\r\n                                \"tags\": \"[if(contains(parameters('aksClusterContent'), 'tags'), parameters('aksClusterContent').tags, json('null'))]\",\r\n                                \"properties\": {\r\n                                  \"kubernetesVersion\": \"[parameters('aksClusterContent').properties.kubernetesVersion]\",\r\n                                  \"dnsPrefix\": \"[parameters('aksClusterContent').properties.dnsPrefix]\",\r\n                                  \"agentPoolProfiles\": \"[if(contains(parameters('aksClusterContent').properties, 'agentPoolProfiles'), parameters('aksClusterContent').properties.agentPoolProfiles, json('null'))]\",\r\n                                  \"linuxProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'linuxProfile'), parameters('aksClusterContent').properties.linuxProfile, json('null'))]\",\r\n                                  \"windowsProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'windowsProfile'), parameters('aksClusterContent').properties.windowsProfile, json('null'))]\",\r\n                                  \"servicePrincipalProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'servicePrincipalProfile'), parameters('aksClusterContent').properties.servicePrincipalProfile, json('null'))]\",\r\n                                  \"nodeResourceGroup\": \"[parameters('aksClusterContent').properties.nodeResourceGroup]\",\r\n                                  \"enableRBAC\": \"[if(contains(parameters('aksClusterContent').properties, 'enableRBAC'), parameters('aksClusterContent').properties.enableRBAC, json('null'))]\",\r\n                                  \"enablePodSecurityPolicy\": \"[if(contains(parameters('aksClusterContent').properties, 'enablePodSecurityPolicy'), parameters('aksClusterContent').properties.enablePodSecurityPolicy, json('null'))]\",\r\n                                  \"networkProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'networkProfile'), parameters('aksClusterContent').properties.networkProfile, json('null'))]\",\r\n                                  \"addonProfiles\": \"[if(contains(parameters('aksClusterContent').properties, 'addonProfiles'), parameters('aksClusterContent').properties.addonProfiles, json('null'))]\",\r\n                                  \"aadProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'aadProfile'), parameters('aksClusterContent').properties.aadProfile, json('null'))]\",\r\n                                  \"autoScalerProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'autoScalerProfile'), parameters('aksClusterContent').properties.autoScalerProfile, json('null'))]\",\r\n                                  \"autoUpgradeProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'autoUpgradeProfile'), parameters('aksClusterContent').properties.autoUpgradeProfile, json('null'))]\",\r\n                                  \"apiServerAccessProfile\": {\r\n                                    \"authorizedIPRanges\": \"[if(contains(parameters('aksClusterContent').properties.apiServerAccessProfile, 'authorizedIPRanges'), parameters('aksClusterContent').properties.apiServerAccessProfile.authorizedIPRanges, json('null'))]\",\r\n                                    \"disableRunCommand\": true,\r\n                                    \"enablePrivateCluster\": \"[if(contains(parameters('aksClusterContent').properties.apiServerAccessProfile, 'enablePrivateCluster'), parameters('aksClusterContent').properties.apiServerAccessProfile.enablePrivateCluster, json('null'))]\",\r\n                                    \"enablePrivateClusterPublicFQDN\": \"[if(contains(parameters('aksClusterContent').properties.apiServerAccessProfile, 'enablePrivateClusterPublicFQDN'), parameters('aksClusterContent').properties.apiServerAccessProfile.enablePrivateClusterPublicFQDN, json('null'))]\",\r\n                                    \"privateDNSZone\": \"[if(contains(parameters('aksClusterContent').properties.apiServerAccessProfile, 'privateDNSZone'), parameters('aksClusterContent').properties.apiServerAccessProfile.privateDNSZone, json('null'))]\"\r\n                                  },\r\n                                  \"diskEncryptionSetID\": \"[if(contains(parameters('aksClusterContent').properties, 'diskEncryptionSetID'), parameters('aksClusterContent').properties.diskEncryptionSetID, json('null'))]\",\r\n                                  \"disableLocalAccounts\": \"[if(contains(parameters('aksClusterContent').properties, 'disableLocalAccounts'), parameters('aksClusterContent').properties.disableLocalAccounts, json('null'))]\",\r\n                                  \"fqdnSubdomain\": \"[if(contains(parameters('aksClusterContent').properties, 'fqdnSubdomain'), parameters('aksClusterContent').properties.fqdnSubdomain, json('null'))]\",\r\n                                  \"httpProxyConfig\": \"[if(contains(parameters('aksClusterContent').properties, 'httpProxyConfig'), parameters('aksClusterContent').properties.httpProxyConfig, json('null'))]\",\r\n                                  \"podIdentityProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'podIdentityProfile'), parameters('aksClusterContent').properties.podIdentityProfile, json('null'))]\",\r\n                                  \"privateLinkResources\": \"[if(contains(parameters('aksClusterContent').properties, 'privateLinkResources'), parameters('aksClusterContent').properties.privateLinkResources, json('null'))]\",\r\n                                  \"securityProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'securityProfile'), parameters('aksClusterContent').properties.securityProfile, json('null'))]\",\r\n                                  \"identityProfile\": \"[if(contains(parameters('aksClusterContent').properties, 'identityProfile'), parameters('aksClusterContent').properties.identityProfile, json('null'))]\"\r\n                                }\r\n                              }\r\n                            ],\r\n                            \"outputs\": {}\r\n                          },\r\n                          \"parameters\": {\r\n                            \"aksClusterName\": {\r\n                              \"value\": \"[parameters('clusterName')]\"\r\n                            },\r\n                            \"aksClusterContent\": {\r\n                              \"value\": \"[reference(variables('clusterGetDeploymentName')).outputs.aksCluster.value]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"clusterName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"clusterResourceGroupName\": {\r\n                      \"value\": \"[resourceGroup().name]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b708b0a-3380-40e9-8b79-821f9fa224cc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1b708b0a-3380-40e9-8b79-821f9fa224cc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Vulnerability assessment should be enabled on SQL Managed Instance\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit each SQL Managed Instance which doesn't have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/managedInstances\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/managedInstances/vulnerabilityAssessments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/managedInstances/vulnerabilityAssessments/recurringScans.isEnabled\",\r\n                \"equals\": \"True\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1b7aa243-30e4-4c9e-bca8-d0d3022b634a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Employ automatic shutdown/restart when violations are detected\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1715 - Employ automatic shutdown/restart when violations are detected\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1715\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b8a7ec3-11cc-a2d3-8cd0-eedf074424a4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1b8a7ec3-11cc-a2d3-8cd0-eedf074424a4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Public network access on Azure SQL Database should be disabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling the public network access property improves security by ensuring your Azure SQL Database can only be accessed from a private endpoint. This configuration denies all logins that match IP or virtual network based firewall rules.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/servers/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1b8ca024-1d5c-4dec-8995-b1a932b41780\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Web PubSub Service with private endpoints\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoints connect your virtual networks to Azure services without a public IP address at the source or destination. By mapping private endpoints to Azure Web PubSub service, you can reduce data leakage risks. Learn more about private links at: https://aka.ms/awps/privatelink. \",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Web PubSub\"\r\n        },\r\n        \"parameters\": {\r\n          \"privateEndpointSubnetId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Private Endpoint Subnet ID\",\r\n              \"description\": \"A subnet with private endpoint network policies disabled.\",\r\n              \"strongType\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.SignalRService/webPubSub\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.SignalRService/webPubSub/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.SignalRService/webPubSub/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\",\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/8cf5e20a-e4b2-4e9d-b3a1-5ceb692c2761\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"name\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"serviceId\": {\r\n                      \"value\": \"[field('id')]\"\r\n                    },\r\n                    \"privateEndpointSubnetId\": {\r\n                      \"value\": \"[parameters('privateEndpointSubnetId')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"name\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"serviceId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"privateEndpointSubnetId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"privateEndpointName\": \"[concat('pe-',substring(parameters('name'),0,min(length(parameters('name')),50)),'-',uniquestring(deployment().name))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('privateEndpointName')]\",\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"serviceId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"privateEndpointSubnetId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"subnetLocation\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"variables\": {\r\n                              \"privateEndpointName\": \"[deployment().name]\"\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"name\": \"[variables('privateEndpointName')]\",\r\n                                \"type\": \"Microsoft.Network/privateEndpoints\",\r\n                                \"apiVersion\": \"2020-07-01\",\r\n                                \"location\": \"[parameters('subnetLocation')]\",\r\n                                \"tags\": {},\r\n                                \"properties\": {\r\n                                  \"subnet\": {\r\n                                    \"id\": \"[parameters('privateEndpointSubnetId')]\"\r\n                                  },\r\n                                  \"privateLinkServiceConnections\": [\r\n                                    {\r\n                                      \"name\": \"[variables('privateEndpointName')]\",\r\n                                      \"properties\": {\r\n                                        \"privateLinkServiceId\": \"[parameters('serviceId')]\",\r\n                                        \"groupIds\": [\r\n                                          \"webpubsub\"\r\n                                        ],\r\n                                        \"requestMessage\": \"autoapprove\"\r\n                                      }\r\n                                    }\r\n                                  ],\r\n                                  \"manualPrivateLinkServiceConnections\": []\r\n                                }\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"parameters\": {\r\n                            \"serviceId\": {\r\n                              \"value\": \"[parameters('serviceId')]\"\r\n                            },\r\n                            \"privateEndpointSubnetId\": {\r\n                              \"value\": \"[parameters('privateEndpointSubnetId')]\"\r\n                            },\r\n                            \"subnetLocation\": {\r\n                              \"value\": \"[reference(first(take(split(parameters('privateEndpointSubnetId'),'/subnets'),1)),'2020-07-01','Full').location]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1b9c0b58-fc7b-42c8-8010-cdfa1d1b8544\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1b9c0b58-fc7b-42c8-8010-cdfa1d1b8544\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Application Insights components should block log ingestion and querying from public networks\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Improve Application Insights security by blocking log ingestion and querying from public networks. Only private-link connected networks will be able to ingest and query logs of this component. Learn more at https://aka.ms/AzMonPrivateLink#configure-application-insights.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"Audit\",\r\n              \"deny\",\r\n              \"Deny\",\r\n              \"disabled\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Insights/components\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/components/publicNetworkAccessForIngestion\",\r\n                    \"notEquals\": \"disabled\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/components/publicNetworkAccessForQuery\",\r\n                    \"notEquals\": \"disabled\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1bc02227-0cb6-4e11-8f53-eb0b22eab7e8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1bc02227-0cb6-4e11-8f53-eb0b22eab7e8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Ensure that 'PHP version' is the latest, if used as a part of the API app\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Periodically, newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for API apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version. We recommend all customers who are still using API Apps to implement the built-in policy called 'App Service apps that use PHP should use the latest 'PHP version'', which is scoped to include API apps.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.1.0-deprecated\",\r\n          \"category\": \"App Service\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"PHPLatestVersion\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Latest PHP version\",\r\n              \"description\": \"Latest supported PHP version for App Services\"\r\n            },\r\n            \"defaultValue\": \"7.4\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"*api\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"linux\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/web.linuxFxVersion\",\r\n                    \"notContains\": \"PHP\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/web.linuxFxVersion\",\r\n                    \"equals\": \"[concat('PHP|', parameters('PHPLatestVersion'))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Employ least privilege access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0212 - Employ least privilege access\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0212\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1bc7fd64-291f-028e-4ed6-6e07886e163f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1bc7fd64-291f-028e-4ed6-6e07886e163f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure privacy program information is publicly available\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1867 - Ensure privacy program information is publicly available\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1867\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1beb1269-62ee-32cd-21ad-43d6c9750eb6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1beb1269-62ee-32cd-21ad-43d6c9750eb6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Service Bus namespaces should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Service Bus namespaces, data leakage risks are reduced. Learn more at: https://docs.microsoft.com/azure/service-bus-messaging/private-link-service.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Service Bus\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ServiceBus/namespaces\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ServiceBus/namespaces/sku.tier\",\r\n                \"equals\": \"Premium\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.ServiceBus/namespaces/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.ServiceBus/namespaces/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c06e275-d63d-4540-b761-71f364c2111d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1c06e275-d63d-4540-b761-71f364c2111d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1749 - Mission/Business Process Definition\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1749\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c0b3710-03dc-450a-a56a-77b85e744f0d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1c0b3710-03dc-450a-a56a-77b85e744f0d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy - Configure Dependency agent to be enabled on Windows virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Dependency agent for Windows virtual machines if the virtual machine image is in the list defined and the agent is not installed.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.1.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of virtual machine images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2016-datacenter-gensecond\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\",\r\n                          \"2019-datacenter-gensecond\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-V4\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"DependencyAgentWindows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Monitoring.DependencyAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"vmExtensionName\": \"DependencyAgentWindows\",\r\n                      \"vmExtensionPublisher\": \"Microsoft.Azure.Monitoring.DependencyAgent\",\r\n                      \"vmExtensionType\": \"DependencyAgentWindows\",\r\n                      \"vmExtensionTypeHandlerVersion\": \"9.10\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', variables('vmExtensionName'))]\",\r\n                        \"apiVersion\": \"2021-04-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"[variables('vmExtensionPublisher')]\",\r\n                          \"type\": \"[variables('vmExtensionType')]\",\r\n                          \"typeHandlerVersion\": \"[variables('vmExtensionTypeHandlerVersion')]\",\r\n                          \"autoUpgradeMinorVersion\": true\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled extension for VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1c210e94-a481-4beb-95fa-1571b434fb04\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Develop security assessment plan\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1144 - Develop security assessment plan\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1144\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c258345-5cd4-30c8-9ef3-5ee4dd5231d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1c258345-5cd4-30c8-9ef3-5ee4dd5231d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: vTPM should be enabled on supported virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enable virtual TPM device on supported virtual machines to facilitate Measured Boot and other OS security features that require a TPM. Once enabled, vTPM can be used to attest boot integrity. This assessment only applies to trusted launch enabled virtual machines.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"2.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/securityProfile.securityType\",\r\n                \"equals\": \"TrustedLaunch\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings\",\r\n                \"exists\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings.vTpmEnabled\",\r\n                \"notequals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c30f9cd-b84c-49cc-aa2c-9288447cc3b3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1c30f9cd-b84c-49cc-aa2c-9288447cc3b3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Event Grid topics to disable local authentication\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disable local authentication methods so that your Azure Event Grid topics exclusively require Azure Active Directory identities for authentication. Learn more at: https://aka.ms/aeg-disablelocalauth.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Event Grid\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.EventGrid/topics\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.EventGrid/topics/disableLocalAuth\",\r\n                \"notEquals\": true\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"conflictEffect\": \"audit\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/1e241071-0855-49ea-94dc-649edcd759de\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2021-06-01-preview')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.EventGrid/topics/disableLocalAuth\",\r\n                  \"value\": true\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c8144d9-746a-4501-b08c-093c8d29ad04\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1c8144d9-746a-4501-b08c-093c8d29ad04\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Defender for Containers should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Microsoft Defender for Containers provides hardening, vulnerability assessment and run-time protections for your Azure, hybrid, and multi-cloud Kubernetes environments.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"Containers\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1c988dd6-ade4-430f-a608-2a3e5b0a6d38\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1c988dd6-ade4-430f-a608-2a3e5b0a6d38\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1072 - Wireless Access Restrictions | Antennas / Transmission Power Levels\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1072\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1ca29e41-34ec-4e70-aba9-6248aca18c31\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1ca29e41-34ec-4e70-aba9-6248aca18c31\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1656 - Secure Name / Address Resolution Service (Authoritative Source)\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1656\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1cb067d5-c8b5-4113-a7ee-0a493633924b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1cb067d5-c8b5-4113-a7ee-0a493633924b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Guest Attestation extension should be installed on supported Windows virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Install Guest Attestation extension on supported virtual machines to allow Azure Security Center to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment applies to Trusted Launch and Confidential Windows virtual machines.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"4.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.imageReference.offer\",\r\n                    \"like\": \"windows*\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                    \"like\": \"Windows*\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/securityProfile.securityType\",\r\n                \"in\": [\r\n                  \"TrustedLaunch\",\r\n                  \"ConfidentialVM\"\r\n                ]\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings\",\r\n                \"exists\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings.secureBootEnabled\",\r\n                \"equals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/securityProfile.uefiSettings.vTpmEnabled\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security.WindowsAttestation\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"GuestAttestation\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"in\": [\r\n                      \"Succeeded\",\r\n                      \"Provisioning succeeded\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1cb4d9c2-f88f-4069-bee0-dba239a57b09\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1cb4d9c2-f88f-4069-bee0-dba239a57b09\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Provide security training for new users\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0419 - Provide security training for new users\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0419\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1cb7bf71-841c-4741-438a-67c65fdd7194\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1cb7bf71-841c-4741-438a-67c65fdd7194\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Public network access on Azure Data Factory should be disabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling the public network access property improves security by ensuring your Azure Data Factory can only be accessed from a private endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Data Factory\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataFactory/factories\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DataFactory/factories/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1cf164be-6819-4a50-b8fa-4bcaa4f98fb6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1cf164be-6819-4a50-b8fa-4bcaa4f98fb6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1592 - External Information System Services | Consistent Interests Of Consumers And Providers\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1592\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d01ba6c-289f-42fd-a408-494b355b6222\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d01ba6c-289f-42fd-a408-494b355b6222\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure File Sync should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Creating a private endpoint for the indicated Storage Sync Service resource allows you to address your Storage Sync Service resource from within the private IP address space of your organization's network, rather than through the internet-accessible public endpoint. Creating a private endpoint by itself does not disable the public endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.StorageSync/storageSyncServices\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.StorageSync/storageSyncServices/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.StorageSync/storageSyncServices/privateEndpointConnections/privateEndpoint\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.StorageSync/storageSyncServices/privateEndpointConnections/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.StorageSync/storageSyncServices/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d320205-c6a1-4ac6-873d-46224024e8e2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d320205-c6a1-4ac6-873d-46224024e8e2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Support personal verification credentials issued by legal authorities\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0507 - Support personal verification credentials issued by legal authorities\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0507\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d39b5d9-0392-8954-8359-575ce1957d1a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d39b5d9-0392-8954-8359-575ce1957d1a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1088 - Security Awareness And Training Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Awareness and Training control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1088\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d50f99d-1356-49c0-934a-45f742ba7783\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d50f99d-1356-49c0-934a-45f742ba7783\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Kubernetes clusters with specified GitOps configuration using no secrets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy a 'sourceControlConfiguration' to Kubernetes clusters to assure that the clusters get their source of truth for workloads and configurations from the defined git repo. This definition requires no secrets. For instructions, visit https://aka.ms/K8sGitOpsPolicy.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Kubernetes\"\r\n        },\r\n        \"parameters\": {\r\n          \"configurationResourceName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Configuration resource name\",\r\n              \"description\": \"The name for the sourceControlConfiguration.  Learn more about setting up GitOps configuration: https://aka.ms/AzureArcK8sUsingGitOps.\"\r\n            }\r\n          },\r\n          \"operatorInstanceName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator instance name\",\r\n              \"description\": \"Name used in the operator instances. Maximum of 23 lowercase alphanumeric characters or hyphen. Must start and end with an alphanumeric character.\"\r\n            }\r\n          },\r\n          \"operatorNamespace\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator namespace\",\r\n              \"description\": \"Namespace within which the operators will be installed. Maximum of 23 lowercase alphanumeric characters or hyphen. Must start and end with an alphanumeric character.\"\r\n            }\r\n          },\r\n          \"operatorScope\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator scope\",\r\n              \"description\": \"The permission scope for the operator. Possible values are 'cluster' (full access) or 'namespace' (restricted access).\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"cluster\",\r\n              \"namespace\"\r\n            ],\r\n            \"defaultValue\": \"namespace\"\r\n          },\r\n          \"operatorType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator type\",\r\n              \"description\": \"The type of operator to install. Currently, 'Flux' is supported.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Flux\"\r\n            ],\r\n            \"defaultValue\": \"Flux\"\r\n          },\r\n          \"operatorParams\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator parameters\",\r\n              \"description\": \"Parameters to set on the Flux operator, separated by spaces.  For example, --git-readonly --sync-garbage-collection.  Learn more: http://aka.ms/AzureArcK8sFluxOperatorParams.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"repositoryUrl\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Repository Url\",\r\n              \"description\": \"The URL for the source control repository. Learn more about URL formats: https://aka.ms/GitOpsRepoUrlParameters\"\r\n            }\r\n          },\r\n          \"enableHelmOperator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable Helm\",\r\n              \"description\": \"Indicate whether to enable Helm for this instance of Flux. Learn more: http://aka.ms/AzureArcK8sGitOpsWithHelm.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"true\"\r\n          },\r\n          \"chartVersion\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Helm chart version for installing Flux Helm\",\r\n              \"description\": \"The version of the Helm chart for installing Flux Helm. For example, 1.2.0\"\r\n            },\r\n            \"defaultValue\": \"1.2.0\"\r\n          },\r\n          \"chartValues\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Helm chart parameters for installing Flux Helm\",\r\n              \"description\": \"Parameters for the Helm chart for installing Flux Helm, separated by spaces. For example, --set helm.versions=v3\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"auditIfNotExists\",\r\n              \"AuditIfNotExists\",\r\n              \"deployIfNotExists\",\r\n              \"DeployIfNotExists\",\r\n              \"disabled\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Kubernetes/connectedClusters\",\r\n              \"Microsoft.ContainerService/managedClusters\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations\",\r\n              \"name\": \"[parameters('configurationResourceName')]\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deploymentScope\": \"ResourceGroup\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/operatorParams\",\r\n                    \"in\": [\r\n                      \"[parameters('operatorParams')]\",\r\n                      \"[concat('--git-readonly ',parameters('operatorParams'))]\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/repositoryUrl\",\r\n                    \"equals\": \"[parameters('repositoryUrl')]\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/enableHelmOperator\",\r\n                        \"equals\": \"false\"\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/enableHelmOperator\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/helmOperatorProperties.chartVersion\",\r\n                            \"equals\": \"[parameters('chartVersion')]\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.KubernetesConfiguration/sourceControlConfigurations/helmOperatorProperties.chartValues\",\r\n                            \"equals\": \"[parameters('chartValues')]\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"configurationResourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"clusterLocation\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"clusterName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorInstanceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorNamespace\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorScope\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorType\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"operatorParams\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"repositoryUrl\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"enableHelmOperator\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"chartVersion\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"chartValues\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"clusterResourceType\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[contains(toLower(parameters('clusterResourceType')), toLower('connectedclusters'))]\",\r\n                        \"type\": \"Microsoft.Kubernetes/connectedClusters/providers/sourceControlConfigurations\",\r\n                        \"name\": \"[concat(parameters('clusterName'), '/Microsoft.KubernetesConfiguration/', parameters('configurationResourceName'))]\",\r\n                        \"apiVersion\": \"2021-03-01\",\r\n                        \"properties\": {\r\n                          \"operatorInstanceName\": \"[parameters('operatorInstanceName')]\",\r\n                          \"operatorNamespace\": \"[parameters('operatorNamespace')]\",\r\n                          \"operatorScope\": \"[parameters('operatorScope')]\",\r\n                          \"operatorType\": \"[parameters('operatorType')]\",\r\n                          \"operatorParams\": \"[parameters('operatorParams')]\",\r\n                          \"repositoryUrl\": \"[parameters('repositoryUrl')]\",\r\n                          \"enableHelmOperator\": \"[parameters('enableHelmOperator')]\",\r\n                          \"helmOperatorProperties\": {\r\n                            \"chartVersion\": \"[parameters('chartVersion')]\",\r\n                            \"chartValues\": \"[parameters('chartValues')]\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[contains(toLower(parameters('clusterResourceType')), toLower('managedclusters'))]\",\r\n                        \"type\": \"Microsoft.ContainerService/managedClusters/providers/sourceControlConfigurations\",\r\n                        \"name\": \"[concat(parameters('clusterName'), '/Microsoft.KubernetesConfiguration/', parameters('configurationResourceName'))]\",\r\n                        \"apiVersion\": \"2021-03-01\",\r\n                        \"properties\": {\r\n                          \"operatorInstanceName\": \"[parameters('operatorInstanceName')]\",\r\n                          \"operatorNamespace\": \"[parameters('operatorNamespace')]\",\r\n                          \"operatorScope\": \"[parameters('operatorScope')]\",\r\n                          \"operatorType\": \"[parameters('operatorType')]\",\r\n                          \"operatorParams\": \"[parameters('operatorParams')]\",\r\n                          \"repositoryUrl\": \"[parameters('repositoryUrl')]\",\r\n                          \"enableHelmOperator\": \"[parameters('enableHelmOperator')]\",\r\n                          \"helmOperatorProperties\": {\r\n                            \"chartVersion\": \"[parameters('chartVersion')]\",\r\n                            \"chartValues\": \"[parameters('chartValues')]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"clusterLocation\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"clusterName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"configurationResourceName\": {\r\n                      \"value\": \"[parameters('configurationResourceName')]\"\r\n                    },\r\n                    \"operatorInstanceName\": {\r\n                      \"value\": \"[parameters('operatorInstanceName')]\"\r\n                    },\r\n                    \"operatorNamespace\": {\r\n                      \"value\": \"[parameters('operatorNamespace')]\"\r\n                    },\r\n                    \"operatorScope\": {\r\n                      \"value\": \"[parameters('operatorScope')]\"\r\n                    },\r\n                    \"operatorType\": {\r\n                      \"value\": \"[parameters('operatorType')]\"\r\n                    },\r\n                    \"operatorParams\": {\r\n                      \"value\": \"[parameters('operatorParams')]\"\r\n                    },\r\n                    \"repositoryUrl\": {\r\n                      \"value\": \"[parameters('repositoryUrl')]\"\r\n                    },\r\n                    \"enableHelmOperator\": {\r\n                      \"value\": \"[parameters('enableHelmOperator')]\"\r\n                    },\r\n                    \"chartVersion\": {\r\n                      \"value\": \"[parameters('chartVersion')]\"\r\n                    },\r\n                    \"chartValues\": {\r\n                      \"value\": \"[parameters('chartValues')]\"\r\n                    },\r\n                    \"clusterResourceType\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d61c4d2-aef2-432b-87fc-7f96b019b7e1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d61c4d2-aef2-432b-87fc-7f96b019b7e1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1538 - Security Categorization\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1538\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d7658b2-e827-49c3-a2ae-6d2bd0b45874\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d7658b2-e827-49c3-a2ae-6d2bd0b45874\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Virtual machines should be migrated to new Azure Resource Manager resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use new Azure Resource Manager for your virtual machines to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.ClassicCompute/virtualMachines\",\r\n                  \"Microsoft.Compute/virtualMachines\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"[field('type')]\",\r\n                \"equals\": \"Microsoft.ClassicCompute/virtualMachines\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1d84d5fb-01f6-4d12-ba4f-4a26081d403d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Conduct risk assessment and document its results\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1542 - Conduct risk assessment and document its results\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1542\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1dbd51c2-2bd1-5e26-75ba-ed075d8f0d68\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1dbd51c2-2bd1-5e26-75ba-ed075d8f0d68\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1298 - Identification And Authentication Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1298\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1dc784b5-4895-4d27-9d40-a06b032bd1ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1dc784b5-4895-4d27-9d40-a06b032bd1ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Applications that are not using latest supported .NET Framework\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use the latest supported .NET Framework version for the latest security classes. Using older classes and types can make your application vulnerable.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UseLatestDotNet\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1de7b11d-1870-41a5-8181-507e7c663cfb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1595 - Developer Configuration Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1595\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e0414e7-6ef5-4182-8076-aa82fbb53341\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e0414e7-6ef5-4182-8076-aa82fbb53341\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Include dynamic reconfig of customer deployed resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1364 - Include dynamic reconfig of customer deployed resources\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1364\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e0d5ba8-a433-01aa-829c-86b06c9631ec\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e0d5ba8-a433-01aa-829c-86b06c9631ec\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require a tag and its value on resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enforces a required tag and its value. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Tags\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e30110a-5ceb-460c-a204-c1c3969c6d62\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cloud Services (extended support) role instances should have an endpoint protection solution installed\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Protect your Cloud Services (extended support) role instances from threats and vulnerabilities by ensuring an endpoint protection solution is installed on them.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/cloudServices\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"e71020c2-860c-3235-cd39-04f3f8c936d2\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e378679-f122-4a96-a739-a7729c46e1aa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e378679-f122-4a96-a739-a7729c46e1aa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Synapse workspaces to use private DNS zones\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use private DNS zones to override the DNS resolution for a private endpoint. A private DNS zone links to your virtual network to resolve to Azure Synapse workspace. Learn more at: https://docs.microsoft.com/azure/synapse-analytics/security/how-to-connect-to-workspace-from-restricted-network#appendix-dns-registration-for-private-endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Synapse\"\r\n        },\r\n        \"parameters\": {\r\n          \"privateDnsZoneId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Private DNS Zone id\",\r\n              \"description\": \"A private DNS zone Id\",\r\n              \"strongType\": \"Microsoft.Network/privateDnsZones\"\r\n            }\r\n          },\r\n          \"targetSubResource\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Target sub-resource\",\r\n              \"description\": \"Target sub resource the private endpoint connects to\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Dev\",\r\n              \"Sql\",\r\n              \"SqlOnDemand\"\r\n            ],\r\n            \"defaultValue\": \"Dev\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/privateEndpoints\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*]\",\r\n                  \"where\": {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].privateLinkServiceId\",\r\n                        \"contains\": \"Microsoft.Synapse/workspaces\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]\",\r\n                        \"equals\": \"[parameters('targetSubResource')]\"\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"privateDnsZoneId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"privateEndpointName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('privateEndpointName'), '/deployedByPolicy')]\",\r\n                        \"type\": \"Microsoft.Network/privateEndpoints/privateDnsZoneGroups\",\r\n                        \"apiVersion\": \"2020-03-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"privateDnsZoneConfigs\": [\r\n                            {\r\n                              \"name\": \"synapse-privateDnsZone\",\r\n                              \"properties\": {\r\n                                \"privateDnsZoneId\": \"[parameters('privateDnsZoneId')]\"\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"privateDnsZoneId\": {\r\n                      \"value\": \"[parameters('privateDnsZoneId')]\"\r\n                    },\r\n                    \"privateEndpointName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e5ed725-f16c-478b-bd4b-7bfa2f7940b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e5ed725-f16c-478b-bd4b-7bfa2f7940b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Key vaults should have soft delete enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deleting a key vault without soft delete enabled permanently deletes all secrets, keys, and certificates stored in the key vault. Accidental deletion of a key vault can lead to permanent data loss. Soft delete allows you to recover an accidentally deleted key vault for a configurable retention period.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Key Vault\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/vaults\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.KeyVault/vaults/createMode\",\r\n                  \"equals\": \"recover\"\r\n                }\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"value\": \"[requestContext().apiVersion]\",\r\n                        \"less\": \"2019-09-01\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\r\n                            \"equals\": \"false\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\r\n                            \"exists\": \"false\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"value\": \"[requestContext().apiVersion]\",\r\n                        \"greaterOrEquals\": \"2019-09-01\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.KeyVault/vaults/enableSoftDelete\",\r\n                        \"equals\": \"false\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Linux machines should have Log Analytics agent installed on Azure Arc\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Machines are non-compliant if Log Analytics agent is not installed on Azure Arc enabled Linux server.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.1.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"LinuxLogAnalyticsAgentInstalled\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\r\n              \"portalReview\": \"true\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                \"equals\": \"true\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HybridCompute/machines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                \"like\": \"linux*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"LinuxLogAnalyticsAgentInstalled\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e7fed80-8321-4605-b42c-65fc300f23a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e7fed80-8321-4605-b42c-65fc300f23a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Review development process, standards and tools\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1610 - Review development process, standards and tools\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1610\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e876c5c-0f2a-8eb6-69f7-5f91e7918ed6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e876c5c-0f2a-8eb6-69f7-5f91e7918ed6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Microsoft Defender for Endpoint agent on Windows virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys Microsoft Defender for Endpoint on applicable Windows VM images.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"2.0.1-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"PublishersToExclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List Of Image Publishers to exclude\",\r\n              \"description\": \"List of Windows image Publishers to exclude from MDE provision\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"ImageIdsToExclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of virtual machine images to exclude\",\r\n              \"description\": \"Example value: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                \"like\": \"Windows*\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Compute/virtualMachines/imagePublisher\",\r\n                      \"in\": \"[parameters('PublishersToExclude')]\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"value\": \"[empty(parameters('PublishersToExclude'))]\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.imageReference.id\",\r\n                      \"in\": \"[parameters('ImageIdsToExclude')]\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"value\": \"[empty(parameters('ImageIdsToExclude'))]\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"anyOf\": [\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"contains\": \"win7\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"contains\": \"win8\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"contains\": \"2008\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"contains\": \"win10\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageSKU\",\r\n                          \"contains\": \"windows-10\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imageOffer\",\r\n                          \"contains\": \"windows-10\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"MicrosoftWindowsDesktop\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"azureopenshift\"\r\n                        },\r\n                        {\r\n                          \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                          \"equals\": \"AzureDatabricks\"\r\n                        }\r\n                      ]\r\n                    }\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"contains\": \"evd\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"name\": \"MDE.Windows\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.AzureDefenderForServers\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"MDE.Windows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"azureResourceId\": {\r\n                      \"value\": \"[concat('/subscriptions/', subscription().subscriptionId, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/',field('name'))]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"azureResourceId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/MDE.Windows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"publisher\": \"Microsoft.Azure.AzureDefenderForServers\",\r\n                          \"type\": \"MDE.Windows\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"settings\": {\r\n                            \"azureResourceId\": \"[parameters('azureResourceId')]\",\r\n                            \"vNextEnabled\": \"true\",\r\n                            \"installedBy\": \"Policy\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"defenderForEndpointOnboardingScript\": \"[reference(subscriptionResourceId('Microsoft.Security/mdeOnboardings', 'Windows'), '2021-10-01-preview', 'full').properties.onboardingPackageWindows]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1ec9c2c2-6d64-656d-6465-3ec3309b8579\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1ec9c2c2-6d64-656d-6465-3ec3309b8579\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Adhere to retention periods defined\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0004 - Adhere to retention periods defined\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0004\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1ecb79d7-1a06-9a3b-3be8-f434d04d1ec1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1ecb79d7-1a06-9a3b-3be8-f434d04d1ec1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Use system clocks for audit records\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0535 - Use system clocks for audit records\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0535\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1ee4c7eb-480a-0007-77ff-4ba370776266\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1ee4c7eb-480a-0007-77ff-4ba370776266\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure API for FHIR should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure API for FHIR should have at least one approved private endpoint connection. Clients in a virtual network can securely access resources that have private endpoint connections through private links. For more information, visit: https://aka.ms/fhir-privatelink.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"API for FHIR\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HealthcareApis/services\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.HealthcareApis/services/privateEndpointConnections[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.HealthcareApis/services/privateEndpointConnections[*].privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1ee56206-5dd1-42ab-b02d-8aae8b1634ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1ee56206-5dd1-42ab-b02d-8aae8b1634ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1738 - Plan Of Action And Milestones Process\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1738\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f01608c-5f35-492d-8763-8edf0080cc38\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f01608c-5f35-492d-8763-8edf0080cc38\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Function apps to use the latest TLS version\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Periodically, newer versions are released for TLS either due to security flaws, include additional functionality, and enhance speed. Upgrade to the latest TLS version for Function apps to take advantage of security fixes, if any, and/or new functionalities of the latest version.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"workflowapp\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/minTlsVersion\",\r\n                \"equals\": \"1.2\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"siteName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"siteName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Web/sites/config\",\r\n                        \"apiVersion\": \"2021-02-01\",\r\n                        \"name\": \"[concat(parameters('siteName'), '/web')]\",\r\n                        \"properties\": {\r\n                          \"minTlsVersion\": \"1.2\"\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f01f1c7-539c-49b5-9ef4-d4ffa37d22e0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f01f1c7-539c-49b5-9ef4-d4ffa37d22e0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Azure Security agent should be installed on your Linux Arc machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Install the Azure Security agent on your Linux Arc machines in order to monitor your machines for security configurations and vulnerabilities. Results of the assessments can seen and managed in Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"1.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HybridCompute/machines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                \"like\": \"linux*\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.HybridCompute/machines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/type\",\r\n                    \"equals\": \"AzureSecurityLinuxAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/Publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security.Monitoring\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/machines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f300abb-f5a0-41c3-a163-91bd3ed35de7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f300abb-f5a0-41c3-a163-91bd3ed35de7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"An Azure Active Directory administrator should be provisioned for SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit provisioning of an Azure Active Directory administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/administrators\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f314764-cb73-4fc9-b863-8eca98ac36e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Monitor Logs clusters should be encrypted with customer-managed key\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Create Azure Monitor logs cluster with customer-managed keys encryption. By default, the log data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance. Customer-managed key in Azure Monitor gives you more control over the access to you data, see https://docs.microsoft.com/azure/azure-monitor/platform/customer-managed-keys.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"Audit\",\r\n              \"deny\",\r\n              \"Deny\",\r\n              \"disabled\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.OperationalInsights/clusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.OperationalInsights/clusters/keyVaultProperties.keyVaultUri\",\r\n                        \"equals\": \"\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.OperationalInsights/clusters/keyVaultProperties.keyVaultUri\",\r\n                        \"exists\": \"false\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.OperationalInsights/clusters/keyVaultProperties.keyName\",\r\n                        \"equals\": \"\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.OperationalInsights/clusters/keyVaultProperties.keyName\",\r\n                        \"exists\": \"false\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.OperationalInsights/clusters/keyVaultProperties.keyVersion\",\r\n                      \"exists\": \"true\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f68a601-6e6d-4e42-babf-3f643a047ea2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f68a601-6e6d-4e42-babf-3f643a047ea2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Event Hub to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Event Hub to stream to a regional Log Analytics workspace when any Event Hub which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.EventHub/namespaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"value\": \"[parameters('logsEnabled')]\",\r\n                            \"equals\": \"false\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                            \"equals\": \"false\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"value\": \"[parameters('logsEnabled')]\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"count\": {\r\n                                  \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                                  \"where\": {\r\n                                    \"allOf\": [\r\n                                      {\r\n                                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].enabled\",\r\n                                        \"equals\": \"[parameters('logsEnabled')]\"\r\n                                      },\r\n                                      {\r\n                                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].category\",\r\n                                        \"in\": [\r\n                                          \"ArchiveLogs\",\r\n                                          \"OperationalLogs\",\r\n                                          \"AutoScaleLogs\",\r\n                                          \"KafkaCoordinatorLogs\",\r\n                                          \"KafkaUserErrorLogs\",\r\n                                          \"EventHubVNetConnectionEvent\",\r\n                                          \"CustomerManagedKeyUserLogs\",\r\n                                          \"RuntimeAuditLogs\",\r\n                                          \"ApplicationMetricsLogs\"\r\n                                        ]\r\n                                      }\r\n                                    ]\r\n                                  }\r\n                                },\r\n                                \"equals\": 9\r\n                              },\r\n                              {\r\n                                \"count\": {\r\n                                  \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                                  \"where\": {\r\n                                    \"allOf\": [\r\n                                      {\r\n                                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].enabled\",\r\n                                        \"equals\": \"[parameters('logsEnabled')]\"\r\n                                      },\r\n                                      {\r\n                                        \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].categoryGroup\",\r\n                                        \"equals\": \"AllLogs\"\r\n                                      }\r\n                                    ]\r\n                                  }\r\n                                },\r\n                                \"equals\": 1\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics[*].enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.EventHub/namespaces/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2021-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"ArchiveLogs\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            },\r\n                            {\r\n                              \"category\": \"OperationalLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"AutoScaleLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"KafkaCoordinatorLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"KafkaUserErrorLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"EventHubVNetConnectionEvent\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"CustomerManagedKeyUserLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"RuntimeAuditLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"ApplicationMetricsLogs\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f6e93e8-6b31-41b1-83f6-36e449a42579\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Defender for Key Vaults to be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for Key Vault provides an additional layer of protection and security intelligence by detecting unusual and potentially harmful attempts to access or exploit key vault accounts.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"KeyVaults\",\r\n              \"deploymentScope\": \"subscription\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              },\r\n              \"deployment\": {\r\n                \"location\": \"westeurope\",\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {},\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {},\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Security/pricings\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"name\": \"KeyVaults\",\r\n                        \"properties\": {\r\n                          \"pricingTier\": \"Standard\"\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f725891-01c0-420a-9059-4fa46cb770b7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Endpoint protection should be installed on your machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"To protect your machines from threats and vulnerabilities, install a supported endpoint protection solution.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.ClassicCompute/virtualMachines\",\r\n                  \"Microsoft.HybridCompute/machines\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"4fb67663-9ab9-475d-b026-8c544cced439\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f7c564c-0a90-4d44-b7e1-9d456cffaee8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f7c564c-0a90-4d44-b7e1-9d456cffaee8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs configurations in 'Security Options - Shutdown'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - Shutdown'. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Shutdown: Allow system to be shut down without having to log on\",\r\n              \"description\": \"Specifies whether a computer can be shut down when a user is not logged on. If this policy setting is enabled, the shutdown command is available on the Windows logon screen.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          },\r\n          \"ShutdownClearVirtualMemoryPagefile\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Shutdown: Clear virtual memory pagefile\",\r\n              \"description\": \"Specifies whether the virtual memory pagefile is cleared when the system is shut down. When this policy setting is enabled, the system pagefile is cleared each time that the system shuts down properly. For systems with large amounts of RAM, this could result in substantial time needed to complete the shutdown.\"\r\n            },\r\n            \"defaultValue\": \"0\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsShutdown\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                \"equals\": \"[base64(concat('Shutdown: Allow system to be shut down without having to log on;ExpectedValue', '=', parameters('ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn'), ',', 'Shutdown: Clear virtual memory pagefile;ExpectedValue', '=', parameters('ShutdownClearVirtualMemoryPagefile')))]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"AzureBaseline_SecurityOptionsShutdown\"\r\n                    },\r\n                    \"ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\": {\r\n                      \"value\": \"[parameters('ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn')]\"\r\n                    },\r\n                    \"ShutdownClearVirtualMemoryPagefile\": {\r\n                      \"value\": \"[parameters('ShutdownClearVirtualMemoryPagefile')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ShutdownClearVirtualMemoryPagefile\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Shutdown: Allow system to be shut down without having to log on;ExpectedValue\",\r\n                                \"value\": \"[parameters('ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Shutdown: Clear virtual memory pagefile;ExpectedValue\",\r\n                                \"value\": \"[parameters('ShutdownClearVirtualMemoryPagefile')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\",\r\n                            \"configurationParameter\": [\r\n                              {\r\n                                \"name\": \"Shutdown: Allow system to be shut down without having to log on;ExpectedValue\",\r\n                                \"value\": \"[parameters('ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn')]\"\r\n                              },\r\n                              {\r\n                                \"name\": \"Shutdown: Clear virtual memory pagefile;ExpectedValue\",\r\n                                \"value\": \"[parameters('ShutdownClearVirtualMemoryPagefile')]\"\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f8c20ce-3414-4496-8b26-0e902a1541da\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f8c20ce-3414-4496-8b26-0e902a1541da\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use customer-managed keys to manage the encryption at rest of your Azure Cosmos DB. By default, the data is encrypted at rest with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/cosmosdb-cmk.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Cosmos DB\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The desired effect of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"Audit\",\r\n              \"deny\",\r\n              \"Deny\",\r\n              \"disabled\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/keyVaultKeyUri\",\r\n                \"exists\": false\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f905d99-2ab7-462c-a6b0-f709acca6c8f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Defender CSPM should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Defender Cloud Security Posture Management (CSPM) provides enhanced posture capabilities and a new intelligent cloud security graph to help identify, prioritize, and reduce risk. Defender CSPM is available in addition to the free foundational security posture capabilities turned on by default in Defender for Cloud.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"CloudPosture\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1f90fc71-a595-4066-8974-d4d0802e8ef0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f90fc71-a595-4066-8974-d4d0802e8ef0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1730 - Information Security Program Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1730\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1fa50212-51a9-471b-95cf-3a23410ec9e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1fa50212-51a9-471b-95cf-3a23410ec9e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Logic Apps Integration Service Environment should be encrypted with customer-managed keys\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy into Integration Service Environment to manage encryption at rest of Logic Apps data using customer-managed keys. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Logic Apps\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Logic/integrationServiceEnvironments\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Logic/integrationServiceEnvironments/encryptionConfiguration\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Manage nonlocal maintenance and diagnostic activities\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0364 - Manage nonlocal maintenance and diagnostic activities\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0364\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1fb1cb0e-1936-6f32-42fd-89970b535855\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1fb1cb0e-1936-6f32-42fd-89970b535855\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure HDInsight clusters should use encryption at host to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enabling encryption at host helps protect and safeguard your data to meet your organizational security and compliance commitments. When you enable encryption at host, data stored on the VM host is encrypted at rest and flows encrypted to the Storage service.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"HDInsight\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HDInsight/clusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.HDInsight/clusters/diskEncryptionProperties.encryptionAtHost\",\r\n                    \"exists\": false\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HDInsight/clusters/diskEncryptionProperties.encryptionAtHost\",\r\n                    \"equals\": false\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Incorporate simulated events into incident response training\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1356 - Incorporate simulated events into incident response training\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1356\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1fdeb7c4-4c93-8271-a135-17ebe85f1cc7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1fdeb7c4-4c93-8271-a135-17ebe85f1cc7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure security safeguards not needed when the individuals return\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1183 - Ensure security safeguards not needed when the individuals return\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1183\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1fdf0b24-4043-3c55-357e-036985d50b52\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1fdf0b24-4043-3c55-357e-036985d50b52\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Obscure feedback information during authentication process\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1344 - Obscure feedback information during authentication process\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1344\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1ff03f2a-974b-3272-34f2-f6cd51420b30\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1ff03f2a-974b-3272-34f2-f6cd51420b30\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Review and update risk assessment policies and procedures\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1537 - Review and update risk assessment policies and procedures\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1537\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/20012034-96f0-85c2-4a86-1ae1eb457802\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"20012034-96f0-85c2-4a86-1ae1eb457802\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1616 - System And Communications Protection Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1616\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2006457a-48b3-4f7b-8d2e-1532287f9929\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2006457a-48b3-4f7b-8d2e-1532287f9929\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1650 - Public Key Infrastructure Certificates\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1650\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/201d3740-bd16-4baf-b4b8-7cda352228b7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"201d3740-bd16-4baf-b4b8-7cda352228b7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Web ports should be restricted on Network Security Groups associated to your VM\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure security center has discovered that some of your virtual machines are running web applications, and the NSGs associated to these virtual machines are overly permissive with regards to the web application ports\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"201ea587-7c90-41c3-910f-c280ae01cfd6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Conduct a security impact analysis\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0057 - Conduct a security impact analysis\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0057\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/203101f5-99a3-1491-1b56-acccd9b66a9e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"203101f5-99a3-1491-1b56-acccd9b66a9e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Review and update system maintenance policies and procedures\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1395 - Review and update system maintenance policies and procedures\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1395\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2067b904-9552-3259-0cdd-84468e284b7c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2067b904-9552-3259-0cdd-84468e284b7c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Reveal error messages\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1725 - Reveal error messages\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1725\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/20762f1e-85fb-31b0-a600-e833633f10fe\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"20762f1e-85fb-31b0-a600-e833633f10fe\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1815 - Privacy Awareness And Training \",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Accountability, Audit, and Risk Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1815\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/20ea0798-d19e-4925-afd0-53d583815818\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"20ea0798-d19e-4925-afd0-53d583815818\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Compile Audit records into system wide audit\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1140 - Compile Audit records into system wide audit\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1140\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/214ea241-010d-8926-44cc-b90a96d52adc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"214ea241-010d-8926-44cc-b90a96d52adc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"VM Image Builder templates should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your VM Image Builder building resources, data leakage risks are reduced. Learn more about private links at: https://docs.microsoft.com/azure/virtual-machines/linux/image-builder-networking#deploy-using-an-existing-vnet.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"VM Image Builder\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\",\r\n              \"Deny\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.VirtualMachineImages/imageTemplates\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.VirtualMachineImages/imageTemplates/vmProfile.vnetConfig\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2154edb9-244f-4741-9970-660785bccdaa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2154edb9-244f-4741-9970-660785bccdaa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Synapse Workspaces should use only Azure Active Directory identities for authentication\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Active Directory (AAD) only authentication methods improves security by ensuring that Synapse Workspaces exclusively require AAD identities for authentication. Learn more at: https://aka.ms/Synapse.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Synapse\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Synapse/workspaces\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Synapse/workspaces/extraProperties\",\r\n                    \"exists\": false\r\n                  },\r\n                  {\r\n                    \"value\": \"[if(empty(field('Microsoft.Synapse/workspaces/extraProperties')), 0, length(intersection(field('Microsoft.Synapse/workspaces/extraProperties'), createObject('WorkspaceType', 'Normal'))))]\",\r\n                    \"equals\": 1\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Synapse/workspaces/azureADOnlyAuthentication\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"value\": \"[field('Microsoft.Synapse/workspaces/azureADOnlyAuthentication')]\",\r\n                    \"notEquals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Synapse/workspaces/settings\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"value\": \"[if(empty(field('Microsoft.Synapse/workspaces/settings')), 0, length(intersection(field('Microsoft.Synapse/workspaces/settings'), createObject('azureADOnlyAuthentication', createObject('value', 'true', 'state', 'Inconsistent')))))]\",\r\n                        \"equals\": 1\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2158ddbe-fefa-408e-b43f-d4faef8ff3b8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2158ddbe-fefa-408e-b43f-d4faef8ff3b8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Provide capability to process customer-controlled audit records\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1126 - Provide capability to process customer-controlled audit records\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1126\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21633c09-804e-7fcd-78e3-635c6bfe2be7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21633c09-804e-7fcd-78e3-635c6bfe2be7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Implement security testing, training, and monitoring plans\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1753 - Implement security testing, training, and monitoring plans\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1753\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21832235-7a07-61f4-530d-d596f76e5b95\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21832235-7a07-61f4-530d-d596f76e5b95\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1181 - Baseline Configuration | Retention Of Previous Configurations\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1181\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21839937-d241-4fa5-95c6-b669253d9ab9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21839937-d241-4fa5-95c6-b669253d9ab9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"VPN gateways should use only Azure Active Directory (Azure AD) authentication for point-to-site users\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling local authentication methods improves security by ensuring that VPN Gateways use only Azure Active Directory identities for authentication. Learn more about Azure AD authentication at https://docs.microsoft.com/azure/vpn-gateway/openvpn-azure-ad-tenant\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworkGateways\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/virtualNetworkGateways/vpnClientConfiguration.vpnClientAddressPool.addressPrefixes\",\r\n                \"exists\": \"true\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Network/virtualNetworkGateways/vpnClientConfiguration.vpnAuthenticationTypes[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.Network/virtualNetworkGateways/vpnClientConfiguration.vpnAuthenticationTypes[*]\",\r\n                    \"notcontains\": \"AAD\"\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21a6bc25-125e-4d13-b82d-2e19b7208ab7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Public network access should be disabled for Azure File Sync\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling the public endpoint allows you to restrict access to your Storage Sync Service resource to requests destined to approved private endpoints on your organization's network. There is nothing inherently insecure about allowing requests to the public endpoint, however, you may wish to disable it to meet regulatory, legal, or organizational policy requirements. You can disable the public endpoint for a Storage Sync Service by setting the incomingTrafficPolicy of the resource to AllowVirtualNetworksOnly.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.StorageSync/storageSyncServices\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.StorageSync/storageSyncServices/incomingTrafficPolicy\",\r\n                \"notEquals\": \"AllowVirtualNetworksOnly\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21a8cd35-125e-4d13-b82d-2e19b7208bb7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure SignalR Service should disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"To improve the security of Azure SignalR Service resource, ensure that it isn't exposed to the public internet and can only be accessed from a private endpoint. Disable the public network access property as described in https://aka.ms/asrs/networkacls. This option disables access from any public address space outside the Azure IP range, and denies all logins that match IP or virtual network-based firewall rules. This reduces data leakage risks.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SignalR\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.SignalRService/SignalR\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.SignalRService/SignalR/networkACLs.defaultAction\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.SignalRService/SignalR/networkACLs.publicNetwork.allow\",\r\n                    \"exists\": false\r\n                  },\r\n                  {\r\n                    \"count\": {\r\n                      \"field\": \"Microsoft.SignalRService/SignalR/networkACLs.publicNetwork.allow[*]\"\r\n                    },\r\n                    \"greater\": 0\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21a9766a-82a5-4747-abb5-650b6dbba6d0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21a9766a-82a5-4747-abb5-650b6dbba6d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1111 - Response To Audit Processing Failures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1111\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21de687c-f15e-4e51-bf8d-f35c8619965b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21de687c-f15e-4e51-bf8d-f35c8619965b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1596 - Developer Configuration Management\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1596\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21e25e01-0ae0-41be-919e-04ce92b8e8b8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21e25e01-0ae0-41be-919e-04ce92b8e8b8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs configurations in 'Security Options - Audit'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - Audit'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsAudit\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21e2995e-683e-497a-9e81-2f42ad07050a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21e2995e-683e-497a-9e81-2f42ad07050a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1426 - Media Protection Policy And Procedures\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1426\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/21f639bc-f42b-46b1-8f40-7a2a389c291a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"21f639bc-f42b-46b1-8f40-7a2a389c291a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: ChangeTracking extension should be installed on your Windows virtual machine\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Install ChangeTracking Extension on Windows virtual machines to enable File Integrity Monitoring(FIM) in Azure Security Center. FIM examines operating system files, Windows registries, application software, Linux system files, and more, for changes that might indicate an attack. The extension can be installed in virtual machines and locations supported by Azure Monitoring Agent.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"listOfApplicableLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Applicable Locations\",\r\n              \"description\": \"The list of locations where the policy should be applied.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"australiasoutheast\",\r\n              \"australiaeast\",\r\n              \"brazilsouth\",\r\n              \"canadacentral\",\r\n              \"centralindia\",\r\n              \"centralus\",\r\n              \"eastasia\",\r\n              \"eastus2euap\",\r\n              \"eastus\",\r\n              \"eastus2\",\r\n              \"francecentral\",\r\n              \"japaneast\",\r\n              \"koreacentral\",\r\n              \"northcentralus\",\r\n              \"northeurope\",\r\n              \"norwayeast\",\r\n              \"southcentralus\",\r\n              \"southeastasia\",\r\n              \"switzerlandnorth\",\r\n              \"uaenorth\",\r\n              \"uksouth\",\r\n              \"westcentralus\",\r\n              \"westeurope\",\r\n              \"westus\",\r\n              \"westus2\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"australiasoutheast\",\r\n              \"australiaeast\",\r\n              \"brazilsouth\",\r\n              \"canadacentral\",\r\n              \"centralindia\",\r\n              \"centralus\",\r\n              \"eastasia\",\r\n              \"eastus2euap\",\r\n              \"eastus\",\r\n              \"eastus2\",\r\n              \"francecentral\",\r\n              \"japaneast\",\r\n              \"koreacentral\",\r\n              \"northcentralus\",\r\n              \"northeurope\",\r\n              \"norwayeast\",\r\n              \"southcentralus\",\r\n              \"southeastasia\",\r\n              \"switzerlandnorth\",\r\n              \"uaenorth\",\r\n              \"uksouth\",\r\n              \"westcentralus\",\r\n              \"westeurope\",\r\n              \"westus\",\r\n              \"westus2\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('listOfApplicableLocations')]\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"2008-R2-SP1\",\r\n                          \"2008-R2-SP1-smalldisk\",\r\n                          \"2012-Datacenter\",\r\n                          \"2012-Datacenter-smalldisk\",\r\n                          \"2012-R2-Datacenter\",\r\n                          \"2012-R2-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter\",\r\n                          \"2016-Datacenter-Server-Core\",\r\n                          \"2016-Datacenter-Server-Core-smalldisk\",\r\n                          \"2016-Datacenter-smalldisk\",\r\n                          \"2016-Datacenter-with-Containers\",\r\n                          \"2016-Datacenter-with-RDSH\",\r\n                          \"2019-Datacenter\",\r\n                          \"2019-Datacenter-Core\",\r\n                          \"2019-Datacenter-Core-smalldisk\",\r\n                          \"2019-Datacenter-Core-with-Containers\",\r\n                          \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-smalldisk\",\r\n                          \"2019-Datacenter-with-Containers\",\r\n                          \"2019-Datacenter-with-Containers-smalldisk\",\r\n                          \"2019-Datacenter-zhcn\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2019\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2019-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"ChangeTracking-Windows\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/Publisher\",\r\n                    \"equals\": \"Microsoft.Azure.ChangeTrackingAndInventory\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/221aac80-54d8-484b-83d7-24f4feac2ce0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"221aac80-54d8-484b-83d7-24f4feac2ce0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1860 - Privacy Notice\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Transparency control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1860\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2234feec-08c6-4fc9-af78-df0dcc482efd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2234feec-08c6-4fc9-af78-df0dcc482efd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Isolate information spills\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0346 - Isolate information spills\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0346\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22457e81-3ec6-5271-a786-c3ca284601dd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22457e81-3ec6-5271-a786-c3ca284601dd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Audit API Apps that are not using custom domains\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Use of custom domains protects a API app from common attacks such as phishing and other DNS-related attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Security Center\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"api\"\r\n                  },\r\n                  {\r\n                    \"field\": \"kind\",\r\n                    \"equals\": \"apiApp\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"UsedCustomDomains\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"in\": [\r\n                  \"OffByPolicy\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"224da9fe-0d38-4e79-adb3-0a6e2af942ac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1399 - Controlled Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1399\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2256e638-eb23-480f-9e15-6cf1af0a76b3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2256e638-eb23-480f-9e15-6cf1af0a76b3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1221 - Least Functionality | Authorized Software / Whitelisting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1221\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22589a07-0007-486a-86ca-95355081ae2a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22589a07-0007-486a-86ca-95355081ae2a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs configurations in 'System Audit Policies - Account Management'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: 'System Audit Policies - Account Management'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesAccountManagement\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/225e937e-d32e-4713-ab74-13ce95b3519a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"225e937e-d32e-4713-ab74-13ce95b3519a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Management ports should be closed on your virtual machines\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Open remote management ports are exposing your VM to a high level of risk from Internet-based attacks. These attacks attempt to brute force credentials to gain admin access to the machine.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"bc303248-3d14-44c2-96a0-55f5c326b5fe\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22730e10-96f6-4aac-ad84-9383d35b5917\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Obtain design and implementation information for the security controls\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1576 - Obtain design and implementation information for the security controls\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1576\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22a02c9a-49e4-5dc9-0d14-eb35ad717154\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22a02c9a-49e4-5dc9-0d14-eb35ad717154\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1493 - System Security Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1493\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22b469b3-fccf-42da-aa3b-a28e6fb113ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22b469b3-fccf-42da-aa3b-a28e6fb113ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Only secure connections to your Azure Cache for Redis should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit enabling of only connections via SSL to Azure Cache for Redis. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Cache\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Cache/redis\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Cache/Redis/enableNonSslPort\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22bee202-a82f-4305-9a2a-6d7f44d4dedb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Disable user accounts posing a significant risk\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1026 - Disable user accounts posing a significant risk\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1026\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/22c16ae4-19d0-29cb-422f-cb44061180ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"22c16ae4-19d0-29cb-422f-cb44061180ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Deploy prerequisites to audit Windows VMs that do not restrict the minimum password length to 14 characters\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not restrict the minimum password length to 14 characters. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"2.2.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordLength\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"MinimumPasswordLength\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('microsoft.hybridcompute/machines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2018-11-20\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/Microsoft.GuestConfiguration/', parameters('configurationName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"guestConfiguration\": {\r\n                            \"name\": \"[parameters('configurationName')]\",\r\n                            \"version\": \"1.*\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines\",\r\n                        \"identity\": {\r\n                          \"type\": \"SystemAssigned\"\r\n                        },\r\n                        \"name\": \"[parameters('vmName')]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), toLower('Microsoft.Compute/virtualMachines'))]\",\r\n                        \"apiVersion\": \"2019-07-01\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/AzurePolicyforWindows')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.GuestConfiguration\",\r\n                          \"type\": \"ConfigurationforWindows\",\r\n                          \"typeHandlerVersion\": \"1.1\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {},\r\n                          \"protectedSettings\": {}\r\n                        },\r\n                        \"dependsOn\": [\r\n                          \"[concat('Microsoft.Compute/virtualMachines/',parameters('vmName'),'/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/',parameters('configurationName'))]\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"23020aa6-1135-4be2-bae2-149982b06eca\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1256 - Contingency Plan | Identify Critical Assets\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1256\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/232ab24b-810b-4640-9019-74a7d0d6a980\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"232ab24b-810b-4640-9019-74a7d0d6a980\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Service Bus should use a virtual network service endpoint\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy audits any Service Bus not configured to use a virtual network service endpoint. The resource type Microsoft.ServiceBus/namespaces/virtualNetworkRules is deprecated in the latest API version.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Network\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ServiceBus/namespaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.ServiceBus/namespaces/virtualNetworkRules\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.ServiceBus/namespaces/virtualNetworkRules/virtualNetworkSubnetId\",\r\n                \"exists\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/235359c5-7c52-4b82-9055-01c75cf9f60e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"235359c5-7c52-4b82-9055-01c75cf9f60e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Defender for DNS to be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for DNS provides an additional layer of protection for your cloud resources by continuously monitoring all DNS queries from your Azure resources. Azure Defender alerts you about suspicious activity at the DNS layer. Learn more about the capabilities of Azure Defender for DNS at https://aka.ms/defender-for-dns . Enabling this Azure Defender plan results in charges. Learn about the pricing details per region on Security Center's pricing page: https://aka.ms/pricing-security-center .\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"Dns\",\r\n              \"deploymentScope\": \"subscription\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              },\r\n              \"deployment\": {\r\n                \"location\": \"westeurope\",\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {},\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {},\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Security/pricings\",\r\n                        \"apiVersion\": \"2018-06-01\",\r\n                        \"name\": \"Dns\",\r\n                        \"properties\": {\r\n                          \"pricingTier\": \"Standard\"\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2370a3c1-4a25-4283-a91a-c9c1a145fb2f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure App Service apps to disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disable public network access for your App Services so that it is not accessible over the public internet. This can reduce data leakage risks. Learn more at: https://aka.ms/app-service-private-endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/publicNetworkAccess\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/publicNetworkAccess\",\r\n                    \"notEquals\": \"Disabled\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"\r\n              ],\r\n              \"conflictEffect\": \"audit\",\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2022-03-01')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.Web/sites/publicNetworkAccess\",\r\n                  \"value\": \"Disabled\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2374605e-3e0b-492b-9046-229af202562c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2374605e-3e0b-492b-9046-229af202562c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit Windows machines that do not have a minimum password age of 1 day\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Requires that prerequisites are deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol. Machines are non-compliant if Windows machines that do not have a minimum password age of 1 day\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"2.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"MinimumPasswordAge\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\r\n              \"portalReview\": \"true\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"dsvm-win*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MinimumPasswordAge\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/237b38db-ca4d-4259-9e47-7882441ca2c0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"237b38db-ca4d-4259-9e47-7882441ca2c0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Stream Analytics to stream to a regional Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.StreamAnalytics/streamingjobs\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"Execution\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Authoring\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"237e0f7e-b0e8-4ec4-ad46-8c12cb66d673\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1821 - Data Quality\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Data Quality and Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1821\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/238cef2f-9f76-41fa-be5e-0899a7aad0d8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"238cef2f-9f76-41fa-be5e-0899a7aad0d8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure SignalR Service should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The private link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your Azure SignalR Service resource instead of the entire service, you'll reduce your data leakage risks. Learn more about private links at: https://aka.ms/asrs/privatelink.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SignalR\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.SignalRService/SignalR\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.SignalRService/SignalR/privateEndpointConnections[*]\",\r\n                  \"where\": {\r\n                    \"field\": \"Microsoft.SignalRService/SignalR/privateEndpointConnections[*].privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                },\r\n                \"less\": 1\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2393d2cf-a342-44cd-a2e2-fe0188fd1234\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2393d2cf-a342-44cd-a2e2-fe0188fd1234\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Automation accounts to disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disable public network access for Azure Automation account so that it isn't accessible over the public internet. This configuration helps protect them against data leakage risks. You can limit exposure of the your Automation account resources by creating private endpoints instead. Learn more at: https://aka.ms/privateendpoints.\",\r\n        \"metadata\": {\r\n          \"category\": \"Automation\",\r\n          \"version\": \"1.0.0\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Automation/automationAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Automation/automationAccounts/publicNetworkAccess\",\r\n                \"notEquals\": false\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"conflictEffect\": \"audit\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.Automation/automationAccounts/publicNetworkAccess\",\r\n                  \"value\": false\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/23b36a7c-9d26-4288-a8fd-c1d2fa284d8c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"23b36a7c-9d26-4288-a8fd-c1d2fa284d8c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Identify classes of Incidents and Actions taken\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1365 - Identify classes of Incidents and Actions taken\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1365\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/23d1a569-2d1e-7f43-9e22-1f94115b7dd5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"23d1a569-2d1e-7f43-9e22-1f94115b7dd5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1268 - Alternate Storage Site\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1268\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/23f6e984-3053-4dfc-ab48-543b764781f5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"23f6e984-3053-4dfc-ab48-543b764781f5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Protect incident response plan\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0405 - Protect incident response plan\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0405\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2401b496-7f23-79b2-9f80-89bb5abf3d4a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2401b496-7f23-79b2-9f80-89bb5abf3d4a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Function app slots to disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disable public network access for your Function apps so that it is not accessible over the public internet. This can reduce data leakage risks. Learn more at: https://aka.ms/app-service-private-endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites/slots\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"workflowapp\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/slots/publicNetworkAccess\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/slots/publicNetworkAccess\",\r\n                    \"notEquals\": \"Disabled\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"\r\n              ],\r\n              \"conflictEffect\": \"audit\",\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2022-03-01')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.Web/sites/slots/publicNetworkAccess\",\r\n                  \"value\": \"Disabled\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/242222f3-4985-4e99-b5ef-086d6a6cb01c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"242222f3-4985-4e99-b5ef-086d6a6cb01c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1122 - Audit Review, Analysis, And Reporting | Permitted Actions\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Audit and Accountability control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1122\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/243ec95e-800c-49d4-ba52-1fdd9f6b8b57\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"243ec95e-800c-49d4-ba52-1fdd9f6b8b57\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1231 - Configuration Management Plan\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1231\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/244e0c05-cc45-4fe7-bf36-42dcf01f457d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"244e0c05-cc45-4fe7-bf36-42dcf01f457d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Windows Virtual Machines to be associated with a Data Collection Rule\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Association to link Windows virtual machines to specified Data Collection Rule. The list of locations and OS images are updated over time as support is increased.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"listOfWindowsImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Optional: List of virtual machine images that have supported Windows OS to add to scope\",\r\n              \"description\": \"Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"dcrResourceId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Data Collection Rule Resource Id\",\r\n              \"description\": \"Resource Id of the Data Collection Rule to be applied on the virtual machines in scope.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"australiacentral\",\r\n                  \"australiacentral2\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"brazilsouth\",\r\n                  \"brazilsoutheast\",\r\n                  \"canadacentral\",\r\n                  \"canadaeast\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"eastasia\",\r\n                  \"eastus2euap\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"francecentral\",\r\n                  \"francesouth\",\r\n                  \"germanywestcentral\",\r\n                  \"japaneast\",\r\n                  \"japanwest\",\r\n                  \"jioindiawest\",\r\n                  \"koreacentral\",\r\n                  \"koreasouth\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"norwayeast\",\r\n                  \"norwaywest\",\r\n                  \"southafricanorth\",\r\n                  \"southcentralus\",\r\n                  \"southeastasia\",\r\n                  \"southindia\",\r\n                  \"switzerlandnorth\",\r\n                  \"switzerlandwest\",\r\n                  \"uaenorth\",\r\n                  \"uksouth\",\r\n                  \"ukwest\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westindia\",\r\n                  \"westus\",\r\n                  \"westus2\"\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imageId\",\r\n                    \"in\": \"[parameters('listOfWindowsImageIdToInclude')]\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2008-R2-SP1*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2012-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2016-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2019-*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                            \"like\": \"2022-*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerSemiAnnual\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"in\": [\r\n                          \"Datacenter-Core-1709-smalldisk\",\r\n                          \"Datacenter-Core-1709-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1803-with-Containers-smalldisk\",\r\n                          \"Datacenter-Core-1809-with-Containers-smalldisk\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServerHPCPack\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"WindowsServerHPCPack\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2016-BYOL\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"*-WS2012R2-BYOL\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftRServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"MLServer-WS2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftVisualStudio\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"VisualStudio\",\r\n                          \"Windows\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftDynamicsAX\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Dynamics\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"equals\": \"Pre-Req-AX7-Onebox-U8\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"windows-data-science-vm\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsDesktop\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"Windows-10\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Insights/dataCollectionRuleAssociations/dataCollectionRuleId\",\r\n                \"equals\": \"[parameters('dcrResourceId')]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"dcrResourceId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"associationName\": \"[concat('assoc-', uniqueString(parameters('dcrResourceId')))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('associationName')]\",\r\n                        \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n                        \"apiVersion\": \"2021-04-01\",\r\n                        \"properties\": {\r\n                          \"dataCollectionRuleId\": \"[parameters('dcrResourceId')]\"\r\n                        },\r\n                        \"scope\": \"[concat('Microsoft.Compute/virtualMachines/', parameters('resourceName'))]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"dcrResourceId\": {\r\n                      \"value\": \"[parameters('dcrResourceId')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/244efd75-0d92-453c-b9a3-7d73ca36ed52\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"244efd75-0d92-453c-b9a3-7d73ca36ed52\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should use the default NTP server\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Setup the 'time.windows.com' as the default NTP Server for all Windows machines to ensure logs across all systems have system clocks that are all in sync. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For more information on Guest Configuration, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"1.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"InternetTimeDefaultNtpServer\",\r\n            \"version\": \"1.*\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"InternetTimeDefaultNtpServer\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2454bbee-dc19-442f-83fc-7f3114cafd91\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2454bbee-dc19-442f-83fc-7f3114cafd91\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Resource logs in Azure Kubernetes Service should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Kubernetes Service's resource logs can help recreate activity trails when investigating security incidents. Enable it to make sure the logs will exist when needed\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Kubernetes\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"requiredRetentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Required retention (days)\",\r\n              \"description\": \"The required resource logs retention (in days)\"\r\n            },\r\n            \"defaultValue\": \"365\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.ContainerService/managedClusters\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*]\",\r\n                  \"where\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\",\r\n                                \"equals\": \"0\"\r\n                              },\r\n                              {\r\n                                \"value\": \"[padLeft(current('Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days'), 3, '0')]\",\r\n                                \"greaterOrEquals\": \"[padLeft(parameters('requiredRetentionDays'), 3, '0')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                            \"equals\": \"true\"\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\",\r\n                                \"notEquals\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Insights/diagnosticSettings/storageAccountId\",\r\n                                \"exists\": false\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"greaterOrEquals\": 1\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/245fc9df-fa96-4414-9a0b-3738c2f7341c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"245fc9df-fa96-4414-9a0b-3738c2f7341c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Establish alternate storage site that facilitates recovery operations\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1270 - Establish alternate storage site that facilitates recovery operations\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1270\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/245fe58b-96f8-9f1e-48c5-7f49903f66fd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"245fe58b-96f8-9f1e-48c5-7f49903f66fd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Activity logs to stream to specified Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deploys the diagnostic settings for Azure Activity to stream subscriptions audit logs to a Log Analytics workspace to monitor subscription-level events\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Primary Log Analytics workspace\",\r\n              \"description\": \"If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"deploymentScope\": \"Subscription\",\r\n              \"existenceScope\": \"Subscription\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\r\n                    \"equals\": \"[parameters('logAnalytics')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"location\": \"northeurope\",\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"subscriptionToLa\",\r\n                        \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"location\": \"Global\",\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"Administrative\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Security\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"ServiceHealth\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Alert\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Recommendation\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Policy\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Autoscale\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"ResourceHealth\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    }\r\n                  }\r\n                }\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2465583e-4e78-4c15-b6be-a36cbc7c8b0f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2465583e-4e78-4c15-b6be-a36cbc7c8b0f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"App Service app slots should be injected into a virtual network\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Injecting App Service Apps in a virtual network unlocks advanced App Service networking and security features and provides you with greater control over your network security configuration. Learn more at: https://docs.microsoft.com/azure/app-service/web-sites-integrate-with-vnet.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites/slots\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/sites/slots/virtualNetworkSubnetId\",\r\n                \"equals\": \"\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/24b7a1c6-44fe-40cc-a2e6-242d2ef70e98\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24b7a1c6-44fe-40cc-a2e6-242d2ef70e98\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1082 - Information Sharing\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1082\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/24d480ef-11a0-4b1b-8e70-4e023bf2be23\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24d480ef-11a0-4b1b-8e70-4e023bf2be23\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs that do not have a maximum password age of 70 days\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have a maximum password age of 70 days. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"MaximumPasswordAge\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24dde96d-f0b1-425e-884f-4a1421e2dcdc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Infrastructure encryption should be enabled for Azure Database for PostgreSQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enable infrastructure encryption for Azure Database for PostgreSQL servers to have higher level of assurance that the data is secure. When infrastructure encryption is enabled, the data at rest is encrypted twice using FIPS 140-2 compliant Microsoft managed keys\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DBforPostgreSQL/servers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DBforPostgreSQL/servers/infrastructureEncryption\",\r\n                \"notEquals\": \"Enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/24fba194-95d6-48c0-aea7-f65bf859c598\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24fba194-95d6-48c0-aea7-f65bf859c598\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Diagnostic Settings for Data Lake Storage Gen1 to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploys the diagnostic settings for Data Lake Storage Gen1 to stream to a regional Log Analytics workspace when any Data Lake Storage Gen1 which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"setbypolicy_logAnalytics\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"False\"\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"True\",\r\n              \"False\"\r\n            ],\r\n            \"defaultValue\": \"True\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.DataLakeStore/accounts/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\",\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"Audit\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"Requests\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25763a0a-5783-4f14-969e-79d4933eb74b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"25763a0a-5783-4f14-969e-79d4933eb74b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Define requirements for managing assets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0125 - Define requirements for managing assets\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0125\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25a1f840-65d0-900a-43e4-bee253de04de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"25a1f840-65d0-900a-43e4-bee253de04de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Function apps to turn off remote debugging\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Remote debugging requires inbound ports to be opened on Function apps. Remote debugging should be turned off.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"contains\": \"functionapp\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"workflowapp\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/config/web.remoteDebuggingEnabled\",\r\n                \"equals\": \"false\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"siteName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"siteName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Web/sites/config\",\r\n                        \"apiVersion\": \"2021-02-01\",\r\n                        \"name\": \"[concat(parameters('siteName'), '/web')]\",\r\n                        \"properties\": {\r\n                          \"remoteDebuggingEnabled\": \"false\"\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25a5046c-c423-4805-9235-e844ae9ef49b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"25a5046c-c423-4805-9235-e844ae9ef49b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure diagnostic settings for File Services to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deploys the diagnostic settings for File Services to stream resource logs to a Log Analytics workspace when any file Service which is missing this diagnostic settings is created or updated.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\",\r\n          \"version\": \"4.0.0\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"profileName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Profile name\",\r\n              \"description\": \"The diagnostic settings profile name\"\r\n            },\r\n            \"defaultValue\": \"fileServicesDiagnosticsLogsToWorkspace\"\r\n          },\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"metricsEnabled\": {\r\n            \"type\": \"Boolean\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable metrics\",\r\n              \"description\": \"Whether to enable metrics stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              true,\r\n              false\r\n            ],\r\n            \"defaultValue\": true\r\n          },\r\n          \"logsEnabled\": {\r\n            \"type\": \"Boolean\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable logs\",\r\n              \"description\": \"Whether to enable logs stream to the Log Analytics workspace - True or False\"\r\n            },\r\n            \"allowedValues\": [\r\n              true,\r\n              false\r\n            ],\r\n            \"defaultValue\": true\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Storage/storageAccounts/fileServices\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"[parameters('profileName')]\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"[parameters('logsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"[parameters('metricsEnabled')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/workspaceId\",\r\n                    \"equals\": \"[parameters('logAnalytics')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"metricsEnabled\": {\r\n                        \"type\": \"bool\"\r\n                      },\r\n                      \"logsEnabled\": {\r\n                        \"type\": \"bool\"\r\n                      },\r\n                      \"profileName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Storage/storageAccounts/fileServices/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2021-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [],\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalytics')]\",\r\n                          \"metrics\": [\r\n                            {\r\n                              \"category\": \"AllMetrics\",\r\n                              \"enabled\": \"[parameters('metricsEnabled')]\"\r\n                            }\r\n                          ],\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"StorageRead\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"StorageWrite\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            },\r\n                            {\r\n                              \"category\": \"StorageDelete\",\r\n                              \"enabled\": \"[parameters('logsEnabled')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {}\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    },\r\n                    \"metricsEnabled\": {\r\n                      \"value\": \"[parameters('metricsEnabled')]\"\r\n                    },\r\n                    \"logsEnabled\": {\r\n                      \"value\": \"[parameters('logsEnabled')]\"\r\n                    },\r\n                    \"profileName\": {\r\n                      \"value\": \"[parameters('profileName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25a70cc8-2bd4-47f1-90b6-1478e4662c96\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"25a70cc8-2bd4-47f1-90b6-1478e4662c96\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1372 - Incident Reporting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1372\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25b96717-c912-4c00-9143-4e487f411726\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"25b96717-c912-4c00-9143-4e487f411726\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure SQL servers to have auditing enabled to Log Analytics workspace\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"To ensure the operations performed against your SQL assets are captured, SQL servers should have auditing enabled. If auditing is not enabled, this policy will configure auditing events to flow to the specified Log Analytics workspace.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"logAnalyticsWorkspaceId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics Workspace ID\",\r\n              \"description\": \"Auditing will write database events to this Log Analytics Workspace. This should be in the following format '/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/{resourcegroup}/providers/Microsoft.OperationalInsights/workspaces/{logAnalyticsWorkspaceName}'\",\r\n              \"strongType\": \"omsWorkspace\",\r\n              \"assignPermissions\": true\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/servers/auditingSettings/state\",\r\n                \"equals\": \"Enabled\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\",\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"logAnalyticsWorkspaceId\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 90\r\n                      },\r\n                      \"serverName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 3\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Sql/servers/databases/providers/diagnosticSettings\",\r\n                        \"apiVersion\": \"2021-05-01-preview\",\r\n                        \"name\": \"[concat(parameters('serverName'),'/master/microsoft.insights/SQLSecurityAuditEvents_3d229c42-c7e7-4c97-9a99-ec0d0d8b86c1')]\",\r\n                        \"properties\": {\r\n                          \"workspaceId\": \"[parameters('logAnalyticsWorkspaceId')]\",\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"SQLSecurityAuditEvents\",\r\n                              \"enabled\": true\r\n                            }\r\n                          ]\r\n                        }\r\n                      },\r\n                      {\r\n                        \"name\": \"[concat(parameters('serverName'),'/default')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n                        \"apiVersion\": \"2017-03-01-preview\",\r\n                        \"properties\": {\r\n                          \"State\": \"Enabled\",\r\n                          \"isAzureMonitorTargetEnabled\": true\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"serverName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"logAnalyticsWorkspaceId\": {\r\n                      \"value\": \"[parameters('logAnalyticsWorkspaceId')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/25da7dfb-0666-4a15-a8f5-402127efd8bb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"25da7dfb-0666-4a15-a8f5-402127efd8bb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Kubernetes clusters with Flux v2 configuration using Git repository and HTTPS CA Certificate\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy a 'fluxConfiguration' to Kubernetes clusters to assure that the clusters get their source of truth for workloads and configurations from the defined Git repository. This definition requires a HTTPS CA Certificate. For instructions, visit https://aka.ms/GitOpsFlux2Policy.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Kubernetes\"\r\n        },\r\n        \"parameters\": {\r\n          \"configurationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Configuration Instance Name\",\r\n              \"description\": \"The name for the fluxConfigurations resource in Azure. Maximum of 30 lowercase alphanumeric characters or hyphens. Must start and end with an alphanumeric character. Learn more about setting up GitOps configuration: https://aka.ms/doc-use-flux2.\"\r\n            }\r\n          },\r\n          \"configurationNamespace\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Configuration Namespace\",\r\n              \"description\": \"The namespace in the cluster within which the Flux custom resources will be installed for this configuration. This can be an existing namespace or a new one that will be created when the configuration is deployed. Maximum of 63 lowercase alphanumeric characters or hyphens. Must start and end with an alphanumeric character.\"\r\n            },\r\n            \"defaultValue\": \"default\"\r\n          },\r\n          \"configurationScope\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Configuration Scope\",\r\n              \"description\": \"The permission scope for the Flux configuration. Possible values are 'cluster' (create resources throughout cluster) or 'namespace' (create resources only in namespace).\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"cluster\",\r\n              \"namespace\"\r\n            ],\r\n            \"defaultValue\": \"cluster\"\r\n          },\r\n          \"repositoryUrl\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Repository Url\",\r\n              \"description\": \"The URL for the Git repository. Formats supported: http://, https://, ssh://.\"\r\n            }\r\n          },\r\n          \"repositoryTimeout\": {\r\n            \"type\": \"Integer\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Repository Timeout (seconds)\",\r\n              \"description\": \"The maximum allowed time, in seconds, for syncing the Git repository to the cluster, after which the sync fails and tries again in the next sync interval.\"\r\n            },\r\n            \"defaultValue\": 600\r\n          },\r\n          \"repositorySyncInterval\": {\r\n            \"type\": \"Integer\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Repository Sync Interval (seconds)\",\r\n              \"description\": \"The time period, in seconds, between attempted syncs of the Git repository to the cluster.\"\r\n            },\r\n            \"defaultValue\": 600\r\n          },\r\n          \"repositoryRefBranch\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Repository Reference Branch\",\r\n              \"description\": \"The branch within the GitRepository source to sync to the cluster.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"repositoryRefTag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Repository Tag\",\r\n              \"description\": \"The tag within the GitRepository source to sync to the cluster. Takes precedence over branch.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"repositoryRefSemver\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Repository Semver Range\",\r\n              \"description\": \"The tag semver range within the GitRepository source to reconcile with the cluster. Takes precedence over tag and branch.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"repositoryRefCommit\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Repository Commit SHA\",\r\n              \"description\": \"The commit SHA within the GitRepository source to sync to the cluster. Takes precedence over semver and tag. May be used with branch.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"repositoryHttpsCACert\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"HTTPS CA Cert\",\r\n              \"description\": \"The base64-encoded HTTPS certificate authority contents used to access private git repositories over HTTPS.\"\r\n            }\r\n          },\r\n          \"kustomizationName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Kustomization Name\",\r\n              \"description\": \"The name of the Kustomization. Maximum of 30 lowercase alphanumeric characters or hyphen. Must start and end with an alphanumeric character.\"\r\n            },\r\n            \"defaultValue\": \"kustomization-1\"\r\n          },\r\n          \"kustomizationPath\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Kustomization Path\",\r\n              \"description\": \"The path within the source where the Kustomization will begin looking for manifests to reconcile. If left blank, the root path of the repository will be used.\"\r\n            },\r\n            \"defaultValue\": \"./\"\r\n          },\r\n          \"kustomizationTimeout\": {\r\n            \"type\": \"Integer\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Kustomization Timeout (seconds)\",\r\n              \"description\": \"The sync timeout, in seconds, defines how long a Kustomization reconciliation will be allowed to continue before timing out.\"\r\n            },\r\n            \"defaultValue\": 600\r\n          },\r\n          \"kustomizationSyncInterval\": {\r\n            \"type\": \"Integer\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Kustomization Sync Interval (seconds)\",\r\n              \"description\": \"The sync interval, in seconds, defines how often the Kustomization reconciles the cluster with the manifests to ensure that the cluster remains in sync with the GitRepository or Bucket source. A Kustomization sync interval more frequent than the source sync interval can be used to catch and reconcile any cluster drift.\"\r\n            },\r\n            \"defaultValue\": 600\r\n          },\r\n          \"kustomizationRetryInterval\": {\r\n            \"type\": \"Integer\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Kustomization Retry Interval (seconds)\",\r\n              \"description\": \"The retry interval, in seconds, specifies how often the Kustomization will retry a previously failed reconciliation. If left blank, the value of the sync interval will be used.\"\r\n            },\r\n            \"defaultValue\": 600\r\n          },\r\n          \"kustomizationPrune\": {\r\n            \"type\": \"Boolean\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Kustomization Prune\",\r\n              \"description\": \"Enable prune to assure that objects are removed from the cluster if they are removed from the GitRepository or Bucket source or when this Kustomization or GitOps configuration is removed from the cluster.\"\r\n            },\r\n            \"defaultValue\": false\r\n          },\r\n          \"kustomizationForce\": {\r\n            \"type\": \"Boolean\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Kustomization Force\",\r\n              \"description\": \"Enable force to instruct the controller to recreate resources if they can't be changed due to an immutable field change.\"\r\n            },\r\n            \"defaultValue\": false\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Kubernetes/connectedClusters\",\r\n              \"Microsoft.ContainerService/managedClusters\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.KubernetesConfiguration/fluxConfigurations\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/scope\",\r\n                    \"equals\": \"[parameters('configurationScope')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/namespace\",\r\n                    \"equals\": \"[parameters('configurationNamespace')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/gitRepository.url\",\r\n                    \"equals\": \"[parameters('repositoryUrl')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/gitRepository.timeoutInSeconds\",\r\n                    \"equals\": \"[parameters('repositoryTimeout')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/gitRepository.syncIntervalInSeconds\",\r\n                    \"equals\": \"[parameters('repositorySyncInterval')]\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/gitRepository.repositoryRef.branch\",\r\n                        \"equals\": \"[parameters('repositoryRefBranch')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/gitRepository.repositoryRef.tag\",\r\n                        \"equals\": \"[parameters('repositoryRefTag')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/gitRepository.repositoryRef.semver\",\r\n                        \"equals\": \"[parameters('repositoryRefSemver')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/gitRepository.repositoryRef.commit\",\r\n                        \"equals\": \"[parameters('repositoryRefCommit')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.KubernetesConfiguration/fluxConfigurations/gitRepository.httpsCAFile\",\r\n                    \"equals\": \"[parameters('repositoryhttpsCACert')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"clusterResourceType\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"clusterName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationNamespace\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationScope\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"sourceKind\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"repositoryUrl\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"repositoryTimeout\": {\r\n                        \"type\": \"int\"\r\n                      },\r\n                      \"repositorySyncInterval\": {\r\n                        \"type\": \"int\"\r\n                      },\r\n                      \"repositoryRefBranch\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"repositoryRefTag\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"repositoryRefSemver\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"repositoryRefCommit\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"repositoryhttpsCACert\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"kustomizationName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"kustomizationPath\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"kustomizationTimeout\": {\r\n                        \"type\": \"int\"\r\n                      },\r\n                      \"kustomizationSyncInterval\": {\r\n                        \"type\": \"int\"\r\n                      },\r\n                      \"kustomizationRetryInterval\": {\r\n                        \"type\": \"int\"\r\n                      },\r\n                      \"kustomizationPrune\": {\r\n                        \"type\": \"bool\"\r\n                      },\r\n                      \"kustomizationForce\": {\r\n                        \"type\": \"bool\"\r\n                      },\r\n                      \"suspend\": {\r\n                        \"type\": \"bool\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"comments\": \"Create a Flux configuration with GitRepository source in the connected (ARC) or managed (AKS) cluster and authenticating with an HTTPs CA certificate.\",\r\n                        \"type\": \"Microsoft.KubernetesConfiguration/fluxConfigurations\",\r\n                        \"name\": \"[parameters('configurationName')]\",\r\n                        \"apiVersion\": \"2022-03-01\",\r\n                        \"properties\": {\r\n                          \"scope\": \"[parameters('configurationScope')]\",\r\n                          \"namespace\": \"[parameters('configurationNamespace')]\",\r\n                          \"sourceKind\": \"[parameters('sourceKind')]\",\r\n                          \"gitRepository\": {\r\n                            \"url\": \"[parameters('repositoryUrl')]\",\r\n                            \"timeoutInSeconds\": \"[parameters('repositoryTimeout')]\",\r\n                            \"syncIntervalInSeconds\": \"[parameters('repositorySyncInterval')]\",\r\n                            \"repositoryRef\": {\r\n                              \"branch\": \"[if(not(empty(parameters('repositoryRefBranch'))), parameters('repositoryRefBranch'), json('null'))]\",\r\n                              \"tag\": \"[if(not(empty(parameters('repositoryRefTag'))), parameters('repositoryRefTag'), json('null'))]\",\r\n                              \"semver\": \"[if(not(empty(parameters('repositoryRefSemver'))), parameters('repositoryRefSemver'), json('null'))]\",\r\n                              \"commit\": \"[if(not(empty(parameters('repositoryRefCommit'))), parameters('repositoryRefCommit'), json('null'))]\"\r\n                            },\r\n                            \"httpsCACert\": \"[if(not(empty(parameters('repositoryhttpsCACert'))), parameters('repositoryhttpsCACert'), json('null'))]\"\r\n                          },\r\n                          \"kustomizations\": {\r\n                            \"[parameters('kustomizationName')]\": {\r\n                              \"path\": \"[parameters('kustomizationPath')]\",\r\n                              \"timeoutInSeconds\": \"[parameters('kustomizationTimeout')]\",\r\n                              \"syncIntervalInSeconds\": \"[parameters('kustomizationSyncInterval')]\",\r\n                              \"retryIntervalInSeconds\": \"[parameters('kustomizationRetryInterval')]\",\r\n                              \"prune\": \"[parameters('kustomizationPrune')]\",\r\n                              \"force\": \"[parameters('kustomizationForce')]\"\r\n                            }\r\n                          },\r\n                          \"suspend\": \"[parameters('suspend')]\"\r\n                        },\r\n                        \"scope\": \"[concat(if(contains(toLower(parameters('clusterResourceType')), toLower('connectedclusters')),'Microsoft.Kubernetes/connectedClusters/','Microsoft.ContainerService/managedClusters/'),parameters('clusterName'))]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"clusterName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"clusterResourceType\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    },\r\n                    \"configurationName\": {\r\n                      \"value\": \"[parameters('configurationName')]\"\r\n                    },\r\n                    \"configurationNamespace\": {\r\n                      \"value\": \"[parameters('configurationNamespace')]\"\r\n                    },\r\n                    \"configurationScope\": {\r\n                      \"value\": \"[parameters('configurationScope')]\"\r\n                    },\r\n                    \"sourceKind\": {\r\n                      \"value\": \"GitRepository\"\r\n                    },\r\n                    \"repositoryUrl\": {\r\n                      \"value\": \"[parameters('repositoryUrl')]\"\r\n                    },\r\n                    \"repositoryTimeout\": {\r\n                      \"value\": \"[parameters('repositoryTimeout')]\"\r\n                    },\r\n                    \"repositorySyncInterval\": {\r\n                      \"value\": \"[parameters('repositorySyncInterval')]\"\r\n                    },\r\n                    \"repositoryRefBranch\": {\r\n                      \"value\": \"[parameters('repositoryRefBranch')]\"\r\n                    },\r\n                    \"repositoryRefTag\": {\r\n                      \"value\": \"[parameters('repositoryRefTag')]\"\r\n                    },\r\n                    \"repositoryRefSemver\": {\r\n                      \"value\": \"[parameters('repositoryRefSemver')]\"\r\n                    },\r\n                    \"repositoryRefCommit\": {\r\n                      \"value\": \"[parameters('repositoryRefCommit')]\"\r\n                    },\r\n                    \"repositoryhttpsCACert\": {\r\n                      \"value\": \"[parameters('repositoryhttpsCACert')]\"\r\n                    },\r\n                    \"kustomizationName\": {\r\n                      \"value\": \"[parameters('kustomizationName')]\"\r\n                    },\r\n                    \"kustomizationPath\": {\r\n                      \"value\": \"[parameters('kustomizationPath')]\"\r\n                    },\r\n                    \"kustomizationTimeout\": {\r\n                      \"value\": \"[parameters('kustomizationTimeout')]\"\r\n                    },\r\n                    \"kustomizationSyncInterval\": {\r\n                      \"value\": \"[parameters('kustomizationSyncInterval')]\"\r\n                    },\r\n                    \"kustomizationRetryInterval\": {\r\n                      \"value\": \"[parameters('kustomizationRetryInterval')]\"\r\n                    },\r\n                    \"kustomizationPrune\": {\r\n                      \"value\": \"[parameters('kustomizationPrune')]\"\r\n                    },\r\n                    \"kustomizationForce\": {\r\n                      \"value\": \"[parameters('kustomizationForce')]\"\r\n                    },\r\n                    \"suspend\": {\r\n                      \"value\": false\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2630c91f-8a20-8f43-14a2-2485b648e2a9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2630c91f-8a20-8f43-14a2-2485b648e2a9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1038 - Least Privilege | Privileged Accounts\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1038\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26692e88-71b7-4a5f-a8ac-9f31dd05bd8e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26692e88-71b7-4a5f-a8ac-9f31dd05bd8e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure HDInsight clusters with private endpoints\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoints connect your virtual networks to Azure services without a public IP address at the source or destination. By mapping private endpoints to Azure HDInsight clusters, you can reduce data leakage risks. Learn more about private links at: https://aka.ms/hdi.pl.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"HDInsight\"\r\n        },\r\n        \"parameters\": {\r\n          \"privateEndpointSubnetId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Private endpoint subnet ID\",\r\n              \"description\": \"A subnet with private endpoint network policies disabled.\",\r\n              \"strongType\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n            }\r\n          },\r\n          \"groupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Group ID\",\r\n              \"description\": \"Target group id (sub resource type) for the private endpoint.\"\r\n            }\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.HDInsight/clusters\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.HDInsight/clusters/networkProperties.privateLink\",\r\n                    \"equals\": \"Enabled\"\r\n                  },\r\n                  {\r\n                    \"count\": {\r\n                      \"field\": \"Microsoft.HDInsight/clusters/privateLinkConfigurations[*]\"\r\n                    },\r\n                    \"greaterOrEquals\": 1\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.HDInsight/clusters/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.HDInsight/clusters/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"name\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"serviceId\": {\r\n                      \"value\": \"[field('id')]\"\r\n                    },\r\n                    \"groupId\": {\r\n                      \"value\": \"[parameters('groupId')]\"\r\n                    },\r\n                    \"privateEndpointSubnetId\": {\r\n                      \"value\": \"[parameters('privateEndpointSubnetId')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"name\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"serviceId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"groupId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"privateEndpointSubnetId\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"privateEndpointName\": \"[concat('pe-',substring(parameters('name'),0,min(length(parameters('name')),50)),'-',uniquestring(deployment().name))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('privateEndpointName')]\",\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"serviceId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"privateEndpointSubnetId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"groupId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"subnetLocation\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"variables\": {\r\n                              \"privateEndpointName\": \"[deployment().name]\"\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"name\": \"[variables('privateEndpointName')]\",\r\n                                \"type\": \"Microsoft.Network/privateEndpoints\",\r\n                                \"apiVersion\": \"2020-07-01\",\r\n                                \"location\": \"[parameters('subnetLocation')]\",\r\n                                \"tags\": {},\r\n                                \"properties\": {\r\n                                  \"subnet\": {\r\n                                    \"id\": \"[parameters('privateEndpointSubnetId')]\"\r\n                                  },\r\n                                  \"privateLinkServiceConnections\": [\r\n                                    {\r\n                                      \"name\": \"[variables('privateEndpointName')]\",\r\n                                      \"properties\": {\r\n                                        \"privateLinkServiceId\": \"[parameters('serviceId')]\",\r\n                                        \"groupIds\": [\r\n                                          \"[parameters('groupId')]\"\r\n                                        ],\r\n                                        \"requestMessage\": \"Request to auto approve.\"\r\n                                      }\r\n                                    }\r\n                                  ],\r\n                                  \"manualPrivateLinkServiceConnections\": []\r\n                                }\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"parameters\": {\r\n                            \"serviceId\": {\r\n                              \"value\": \"[parameters('serviceId')]\"\r\n                            },\r\n                            \"groupId\": {\r\n                              \"value\": \"[parameters('groupId')]\"\r\n                            },\r\n                            \"privateEndpointSubnetId\": {\r\n                              \"value\": \"[parameters('privateEndpointSubnetId')]\"\r\n                            },\r\n                            \"subnetLocation\": {\r\n                              \"value\": \"[reference(first(take(split(parameters('privateEndpointSubnetId'),'/subnets'),1)),'2020-07-01','Full').location]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2676090a-4baf-46ac-9085-4ac02cc50e3e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2676090a-4baf-46ac-9085-4ac02cc50e3e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Endpoint protection solution should be installed on virtual machine scale sets\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit the existence and health of an endpoint protection solution on your virtual machines scale sets, to protect them from threats and vulnerabilities.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/assessments\",\r\n              \"name\": \"e71020c2-860c-3235-cd39-04f3f8c936d2\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/assessments/status.code\",\r\n                \"in\": [\r\n                  \"NotApplicable\",\r\n                  \"Healthy\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26a828e1-e88f-464e-bbb3-c134a282b9de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Implement security directives\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1706 - Implement security directives\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1706\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26d178a4-9261-6f04-a100-47ed85314c6e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26d178a4-9261-6f04-a100-47ed85314c6e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1649 - Collaborative Computing Devices\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1649\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26d292cc-b0b8-4c29-9337-68abc758bf7b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26d292cc-b0b8-4c29-9337-68abc758bf7b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure workstations to check for digital certificates\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0073 - Configure workstations to check for digital certificates\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0073\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26daf649-22d1-97e9-2a8a-01b182194d59\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26daf649-22d1-97e9-2a8a-01b182194d59\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Metric alert rules should be configured on Batch accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit configuration of metric alert rules on Batch account to enable the required metric\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Batch\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name that an alert rule must be enabled on\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Batch/batchAccounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/alertRules\",\r\n              \"existenceScope\": \"Subscription\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/alertRules/isEnabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/alertRules/condition.dataSource.metricName\",\r\n                    \"equals\": \"[parameters('metricName')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/alertRules/condition.dataSource.resourceUri\",\r\n                    \"equals\": \"[concat('/subscriptions/', subscription().subscriptionId, '/resourcegroups/', resourceGroup().name, '/providers/Microsoft.Batch/batchAccounts/', field('name'))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Configure virtual machines to be onboarded to Azure Automanage\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Automanage enrolls, configures, and monitors virtual machines with best practice as defined in the Microsoft Cloud Adoption Framework for Azure. Use this policy to apply Automanage to your selected scope.\",\r\n        \"metadata\": {\r\n          \"version\": \"4.1.1-deprecated\",\r\n          \"category\": \"Automanage\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"automanageAccount\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Automanage account\",\r\n              \"description\": \"The Automanage account is an Azure managed identity under which virtual machine operations are performed. If this account is outside of the scope of the assignment you must manually grant 'Contributor' permissions (or similar) on the account to the policy assignment's principal ID.\",\r\n              \"strongType\": \"Microsoft.Automanage/accounts\",\r\n              \"assignPermissions\": true\r\n            }\r\n          },\r\n          \"configurationProfileAssignment\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Configuration profile\",\r\n              \"description\": \"The management services provided are based on whether the machine is intended to be used in a dev/test environment or production.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Azure virtual machine best practices – Production\",\r\n              \"Azure virtual machine best practices – Dev/test\"\r\n            ],\r\n            \"defaultValue\": \"Azure virtual machine best practices – Production\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"westus\",\r\n                  \"westus2\",\r\n                  \"centralus\",\r\n                  \"southcentralus\",\r\n                  \"westcentralus\",\r\n                  \"northeurope\",\r\n                  \"westeurope\",\r\n                  \"canadacentral\",\r\n                  \"japaneast\",\r\n                  \"uksouth\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"southeastasia\"\r\n                ]\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"esri\",\r\n                      \"incredibuild\",\r\n                      \"MicrosoftDynamicsAX\",\r\n                      \"MicrosoftSharepoint\",\r\n                      \"MicrosoftVisualStudio\",\r\n                      \"MicrosoftWindowsDesktop\",\r\n                      \"MicrosoftWindowsServerHPCPack\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftWindowsServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"MicrosoftSQLServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"notLike\": \"SQL2008*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"dsvm-windows\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"standard-data-science-vm\",\r\n                          \"windows-data-science-vm\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"batch\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"rendering-windows2016\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"cis-windows-server-201*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"pivotal\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"bosh-windows-server*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloud-infrastructure-services\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"ad*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                            \"like\": \"Windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.imageReference.id\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.imageReference.sku\",\r\n                        \"exists\": \"false\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"in\": [\r\n                      \"microsoft-aks\",\r\n                      \"qubole-inc\",\r\n                      \"datastax\",\r\n                      \"couchbase\",\r\n                      \"scalegrid\",\r\n                      \"checkpoint\",\r\n                      \"paloaltonetworks\",\r\n                      \"debian\"\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"CentOS*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"OpenLogic\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"CentOS*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"8*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-HA\",\r\n                          \"RHEL-SAP\",\r\n                          \"RHEL-SAP-APPS\",\r\n                          \"RHEL-SAP-HA\",\r\n                          \"RHEL-SAP-HANA\",\r\n                          \"rhel-raw\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"RHEL\",\r\n                          \"RHEL-HA\",\r\n                          \"RHEL-SAP\",\r\n                          \"RHEL-SAP-APPS\",\r\n                          \"RHEL-SAP-HA\",\r\n                          \"RHEL-SAP-HANA\",\r\n                          \"rhel-raw\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"8*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"RedHat\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"osa\",\r\n                          \"rhel-byos\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"center-for-internet-security-inc\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"cis-centos-7-l1\",\r\n                          \"cis-centos-7-v2-1-1-l1\",\r\n                          \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                          \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                          \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                          \"cis-rhel-7-l2\",\r\n                          \"cis-rhel-7-v2-2-0-l1\",\r\n                          \"cis-suse-linux-12-v2-0-0-l1\",\r\n                          \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                          \"cis-ubuntu-linux-1804-l1\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"credativ\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Suse\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"SLES*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"11*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Suse\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"SLES*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"15*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"Canonical\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"UbuntuServer\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"12*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-dsvm\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"in\": [\r\n                          \"linux-data-science-vm-ubuntu\",\r\n                          \"azureml\"\r\n                        ]\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-centos-os\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageSKU\",\r\n                        \"notLike\": \"6*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"cloudera\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"equals\": \"cloudera-altus-centos-os\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"equals\": \"microsoft-ads\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                        \"like\": \"linux*\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                            \"like\": \"Linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.imageReference.id\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.imageReference.sku\",\r\n                        \"exists\": \"false\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"type\": \"Microsoft.Automanage/configurationProfileAssignments\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Automanage/configurationProfileAssignments/configurationProfile\",\r\n                    \"equals\": \"[parameters('configurationProfileAssignment')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Automanage/configurationProfileAssignments/accountId\",\r\n                    \"equals\": \"[parameters('automanageAccount')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"machineName\": {\r\n                      \"value\": \"[field('Name')]\"\r\n                    },\r\n                    \"automanageAccount\": {\r\n                      \"value\": \"[parameters('automanageAccount')]\"\r\n                    },\r\n                    \"configurationProfileAssignment\": {\r\n                      \"value\": \"[parameters('configurationProfileAssignment')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"machineName\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"automanageAccount\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"configurationProfileAssignment\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/providers/configurationProfileAssignments\",\r\n                        \"apiVersion\": \"2020-06-30-preview\",\r\n                        \"name\": \"[concat(parameters('machineName'), '/Microsoft.Automanage/', 'default')]\",\r\n                        \"properties\": {\r\n                          \"configurationProfile\": \"[parameters('configurationProfileAssignment')]\",\r\n                          \"accountId\": \"[parameters('automanageAccount')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/270610db-8c04-438a-a739-e8e6745b22d3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"270610db-8c04-438a-a739-e8e6745b22d3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Document personnel acceptance of privacy requirements\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0193 - Document personnel acceptance of privacy requirements\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0193\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/271a3e58-1b38-933d-74c9-a580006b80aa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"271a3e58-1b38-933d-74c9-a580006b80aa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Device Update for IoT Hub accounts to disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling the public network access property improves security by ensuring your Device Update for IoT Hub can only be accessed from a private endpoint. This policy disables public network access on Device Update for IoT Hub resources.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Internet of Things\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DeviceUpdate/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DeviceUpdate/accounts/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"conflictEffect\": \"audit\",\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2020-03-01-preview')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.DeviceUpdate/accounts/publicNetworkAccess\",\r\n                  \"value\": \"Disabled\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/27573ebe-7ef3-4472-a8e1-33aef9ea65c5\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"27573ebe-7ef3-4472-a8e1-33aef9ea65c5\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1396 - Controlled Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1396\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/276af98f-4ff9-4e69-99fb-c9b2452fb85f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"276af98f-4ff9-4e69-99fb-c9b2452fb85f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Identify contaminated systems and components\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0300 - Identify contaminated systems and components\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0300\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/279052a0-8238-694d-9661-bf649f951747\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"279052a0-8238-694d-9661-bf649f951747\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Flow logs should be enabled for every network security group\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit for flow log resources to verify if flow log status is enabled. Enabling flow logs allows to log information about IP traffic flowing through network security group. It can be used for optimizing network flows, monitoring throughput, verifying compliance, detecting intrusions and more.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkWatchers/flowLogs\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/networkWatchers/flowLogs/enabled\",\r\n                \"equals\": false\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/27960feb-a23c-4577-8d36-ef8b5f35e0be\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"27960feb-a23c-4577-8d36-ef8b5f35e0be\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Establish and maintain an asset inventory\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0266 - Establish and maintain an asset inventory\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0266\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/27965e62-141f-8cca-426f-d09514ee5216\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"27965e62-141f-8cca-426f-d09514ee5216\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1074 - Access Control for Portable And Mobile Systems\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1074\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/27a69937-af92-4198-9b86-08d355c7e59a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"27a69937-af92-4198-9b86-08d355c7e59a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Respond to rectification requests\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0442 - Respond to rectification requests\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0442\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/27ab3ac0-910d-724d-0afa-1a2a01e996c0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"27ab3ac0-910d-724d-0afa-1a2a01e996c0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure audit records are not altered\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1125 - Ensure audit records are not altered\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1125\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/27ce30dd-3d56-8b54-6144-e26d9a37a541\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"27ce30dd-3d56-8b54-6144-e26d9a37a541\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Device Update for IoT Hub accounts should use private link\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Device Update for IoT Hub accounts, data leakage risks are reduced.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Internet of Things\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.DeviceUpdate/accounts\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.DeviceUpdate/accounts/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.DeviceUpdate/accounts/privateEndpointConnections/privateEndpoint\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DeviceUpdate/accounts/privateEndpointConnections/provisioningState\",\r\n                    \"equals\": \"Succeeded\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.DeviceUpdate/accounts/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                    \"equals\": \"Approved\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/27d4c5ec-8820-443f-91fe-1215e96f64b2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"27d4c5ec-8820-443f-91fe-1215e96f64b2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1527 - Access Agreements\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1527\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2823de66-332f-4bfd-94a3-3eb036cd3b67\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2823de66-332f-4bfd-94a3-3eb036cd3b67\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy default Microsoft IaaSAntimalware extension for Windows Server\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys a Microsoft IaaSAntimalware extension with a default configuration when a VM is not configured with the antimalware extension.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"MicrosoftWindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"WindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"2008-R2-SP1\",\r\n                  \"2008-R2-SP1-smalldisk\",\r\n                  \"2012-Datacenter\",\r\n                  \"2012-Datacenter-smalldisk\",\r\n                  \"2012-R2-Datacenter\",\r\n                  \"2012-R2-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter\",\r\n                  \"2016-Datacenter-Server-Core\",\r\n                  \"2016-Datacenter-Server-Core-smalldisk\",\r\n                  \"2016-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter-with-Containers\",\r\n                  \"2016-Datacenter-with-RDSH\",\r\n                  \"2019-Datacenter\",\r\n                  \"2019-Datacenter-Core\",\r\n                  \"2019-Datacenter-Core-smalldisk\",\r\n                  \"2019-Datacenter-Core-with-Containers\",\r\n                  \"2019-Datacenter-Core-with-Containers-smalldisk\",\r\n                  \"2019-datacenter-gensecond\",\r\n                  \"2019-Datacenter-smalldisk\",\r\n                  \"2019-Datacenter-with-Containers\",\r\n                  \"2019-Datacenter-with-Containers-smalldisk\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"IaaSAntimalware\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security\"\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ExclusionsPaths\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file paths or locations to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsExtensions\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file extensions to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsProcesses\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of process names to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"RealtimeProtectionEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not real time protection is enabled (default is true)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsIsEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"false\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not custom scheduled scan settings are enabled (default is false)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsScanType\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Quick\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether scheduled scan setting type is set to Quick or Full (default is Quick)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsDay\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"7\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Day of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsTime\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"120\",\r\n                        \"metadata\": {\r\n                          \"description\": \"When to perform the scheduled scan, measured in minutes from midnight (0-1440). For example: 0 = 12AM, 60 = 1AM, 120 = 2AM.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/IaaSAntimalware')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Security\",\r\n                          \"type\": \"IaaSAntimalware\",\r\n                          \"typeHandlerVersion\": \"1.3\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"AntimalwareEnabled\": true,\r\n                            \"RealtimeProtectionEnabled\": \"[parameters('RealtimeProtectionEnabled')]\",\r\n                            \"ScheduledScanSettings\": {\r\n                              \"isEnabled\": \"[parameters('ScheduledScanSettingsIsEnabled')]\",\r\n                              \"day\": \"[parameters('ScheduledScanSettingsDay')]\",\r\n                              \"time\": \"[parameters('ScheduledScanSettingsTime')]\",\r\n                              \"scanType\": \"[parameters('ScheduledScanSettingsScanType')]\"\r\n                            },\r\n                            \"Exclusions\": {\r\n                              \"Extensions\": \"[parameters('ExclusionsExtensions')]\",\r\n                              \"Paths\": \"[parameters('ExclusionsPaths')]\",\r\n                              \"Processes\": \"[parameters('ExclusionsProcesses')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"RealtimeProtectionEnabled\": {\r\n                      \"value\": \"true\"\r\n                    },\r\n                    \"ScheduledScanSettingsIsEnabled\": {\r\n                      \"value\": \"true\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2835b622-407b-4114-9198-6f7064cbe0dc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1342 - Authenticator Management | Hardware Token-Based Authentication\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1342\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/283a4e29-69d5-4c94-b99e-29acf003c899\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"283a4e29-69d5-4c94-b99e-29acf003c899\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Review and update planning policies and procedures\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1491 - Review and update planning policies and procedures\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1491\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28aa060e-25c7-6121-05d8-a846f11433df\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28aa060e-25c7-6121-05d8-a846f11433df\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1436 - Media Transport\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1436\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28aab8b4-74fd-4b7c-9080-5a7be525d574\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28aab8b4-74fd-4b7c-9080-5a7be525d574\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure SQL Server to disable public network access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling the public network access property shuts down public connectivity such that Azure SQL Server can only be accessed from a private endpoint. This configuration disables the public network access for all databases under the Azure SQL Server.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\",\r\n          \"version\": \"1.0.0\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/servers/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"conflictEffect\": \"audit\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/6d8ee4ec-f05a-4a1d-8b00-a9b17e38b437\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.Sql/servers/publicNetworkAccess\",\r\n                  \"value\": \"Disabled\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28b0b1e5-17ba-4963-a7a4-5a1ab4400a0b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28b0b1e5-17ba-4963-a7a4-5a1ab4400a0b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1224 - Information System Component Inventory | Updates During Installations / Removals\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1224\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28cfa30b-7f72-47ce-ba3b-eed26c8d2c82\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28cfa30b-7f72-47ce-ba3b-eed26c8d2c82\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1148 - Security Assessments | Independent Assessors\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1148\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28e62650-c7c2-4786-bdfa-17edc1673902\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28e62650-c7c2-4786-bdfa-17edc1673902\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1418 - Remote Maintenance | Comparable Security / Sanitization\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1418\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/28e633fd-284e-4ea7-88b4-02ca157ed713\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"28e633fd-284e-4ea7-88b4-02ca157ed713\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Defender for App Service should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Azure Defender for App Service leverages the scale of the cloud, and the visibility that Azure has as a cloud provider, to monitor for common web app attacks.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.3\",\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/pricings\",\r\n              \"name\": \"AppServices\",\r\n              \"existenceScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/pricings/pricingTier\",\r\n                \"equals\": \"Standard\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2913021d-f2fd-4f3d-b958-22354e2bdbcb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Authorize, monitor, and control usage of mobile code technologies\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1653 - Authorize, monitor, and control usage of mobile code technologies\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1653\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/291f20d4-8d93-1d73-89f3-6ce28b825563\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"291f20d4-8d93-1d73-89f3-6ce28b825563\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure BotService resources with private endpoints\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Private endpoints connect your virtual network to Azure services without a public IP address at the source or destination. By mapping private endpoints to your BotService resource, you can reduce data leakage risks.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Bot Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"privateEndpointSubnetId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Private Endpoint Subnet Id\",\r\n              \"description\": \"A subnet with private endpoint network policies disabled.\",\r\n              \"strongType\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n            }\r\n          },\r\n          \"privateEndpointGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Private Endpoint Group Id\",\r\n              \"description\": \"A group Id for the private endpoint for a BotService resource.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Bot\",\r\n              \"Token\"\r\n            ],\r\n            \"defaultValue\": \"Bot\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.BotService/botServices\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.BotService/botServices/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.BotService/botServices/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"name\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"serviceId\": {\r\n                      \"value\": \"[field('id')]\"\r\n                    },\r\n                    \"privateEndpointSubnetId\": {\r\n                      \"value\": \"[parameters('privateEndpointSubnetId')]\"\r\n                    },\r\n                    \"privateEndpointGroupId\": {\r\n                      \"value\": \"[parameters('privateEndpointGroupId')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"name\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"serviceId\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"privateEndpointSubnetId\": {\r\n                        \"type\": \"String\"\r\n                      },\r\n                      \"privateEndpointGroupId\": {\r\n                        \"type\": \"String\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"privateEndpointName\": \"[concat('pe-',substring(parameters('name'),0,min(length(parameters('name')),50)),'-',uniquestring(deployment().name))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('privateEndpointName')]\",\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"serviceId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"privateEndpointSubnetId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"privateEndpointGroupId\": {\r\n                                \"type\": \"String\"\r\n                              },\r\n                              \"subnetLocation\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"variables\": {\r\n                              \"privateEndpointName\": \"[deployment().name]\"\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"name\": \"[variables('privateEndpointName')]\",\r\n                                \"type\": \"Microsoft.Network/privateEndpoints\",\r\n                                \"apiVersion\": \"2020-07-01\",\r\n                                \"location\": \"[parameters('subnetLocation')]\",\r\n                                \"tags\": {},\r\n                                \"properties\": {\r\n                                  \"subnet\": {\r\n                                    \"id\": \"[parameters('privateEndpointSubnetId')]\"\r\n                                  },\r\n                                  \"privateLinkServiceConnections\": [\r\n                                    {\r\n                                      \"name\": \"[variables('privateEndpointName')]\",\r\n                                      \"properties\": {\r\n                                        \"privateLinkServiceId\": \"[parameters('serviceId')]\",\r\n                                        \"groupIds\": [\r\n                                          \"[parameters('privateEndpointGroupId')]\"\r\n                                        ],\r\n                                        \"requestMessage\": \"autoapprove\"\r\n                                      }\r\n                                    }\r\n                                  ],\r\n                                  \"manualPrivateLinkServiceConnections\": []\r\n                                }\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"parameters\": {\r\n                            \"serviceId\": {\r\n                              \"value\": \"[parameters('serviceId')]\"\r\n                            },\r\n                            \"privateEndpointSubnetId\": {\r\n                              \"value\": \"[parameters('privateEndpointSubnetId')]\"\r\n                            },\r\n                            \"privateEndpointGroupId\": {\r\n                              \"value\": \"[parameters('privateEndpointGroupId')]\"\r\n                            },\r\n                            \"subnetLocation\": {\r\n                              \"value\": \"[reference(first(take(split(parameters('privateEndpointSubnetId'),'/subnets'),1)),'2020-07-01','Full').location]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/29261f8e-efdb-4255-95b8-8215414515d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"29261f8e-efdb-4255-95b8-8215414515d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure detection whitelist\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0068 - Configure detection whitelist\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0068\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2927e340-60e4-43ad-6b5f-7a1468232cc2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2927e340-60e4-43ad-6b5f-7a1468232cc2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1634 - Boundary Protection | Prevent Unauthorized Exfiltration\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Communications Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1634\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/292a7c44-37fa-4c68-af7c-9d836955ded2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"292a7c44-37fa-4c68-af7c-9d836955ded2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Manage authenticator lifetime and reuse\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0355 - Manage authenticator lifetime and reuse\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0355\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/29363ae1-68cd-01ca-799d-92c9197c8404\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"29363ae1-68cd-01ca-799d-92c9197c8404\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Service Bus Premium namespaces should use a customer-managed key for encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Service Bus supports the option of encrypting data at rest with either Microsoft-managed keys (default) or customer-managed keys. Choosing to encrypt data using customer-managed keys enables you to assign, rotate, disable, and revoke access to the keys that Service Bus will use to encrypt data in your namespace. Note that Service Bus only supports encryption with customer-managed keys for premium namespaces.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Service Bus\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.ServiceBus/namespaces\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.ServiceBus/namespaces/sku.tier\",\r\n                \"equals\": \"Premium\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.ServiceBus/namespaces/encryption.keySource\",\r\n                  \"equals\": \"Microsoft.Keyvault\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/295fc8b1-dc9f-4f53-9c61-3f313ceab40a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"295fc8b1-dc9f-4f53-9c61-3f313ceab40a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs configurations in 'Security Options - User Account Control'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: 'Security Options - User Account Control'. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SecurityOptionsUserAccountControl\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/29829ec2-489d-4925-81b7-bda06b1718e0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"29829ec2-489d-4925-81b7-bda06b1718e0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Review and update identification and authentication policies and procedures\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1299 - Review and update identification and authentication policies and procedures\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1299\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/29acfac0-4bb4-121b-8283-8943198b1549\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"29acfac0-4bb4-121b-8283-8943198b1549\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append a tag and its value to resources\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Appends the specified tag and value when any resource which is missing this tag is created or updated. Does not modify the tags of resources created before this policy was applied until those resources are changed. Does not apply to resource groups. New 'modify' effect policies are available that support remediation of tags on existing resources (see https://aka.ms/modifydoc).\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Tags\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a0e14a6-b0a6-4fab-991a-187a4f81c498\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage accounts should restrict network access using virtual network rules\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Protect your storage accounts from potential threats using virtual network rules as a preferred method instead of IP-based filtering. Disabling IP-based filtering prevents public IPs from accessing your storage accounts.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the audit policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.defaultAction\",\r\n                    \"notEquals\": \"Deny\"\r\n                  },\r\n                  {\r\n                    \"count\": {\r\n                      \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.ipRules[*]\"\r\n                    },\r\n                    \"greaterOrEquals\": 1\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a1a9cdf-e04d-429a-8416-3bfb72a1b26f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1219 - Least Functionality | Authorized Software / Whitelisting\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Configuration Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1219\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a39ac75-622b-4c88-9a3f-45b7373f7ef7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a39ac75-622b-4c88-9a3f-45b7373f7ef7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Windows machines should meet requirements for 'System Audit Policies - Policy Change'\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Windows machines should have the specified Group Policy settings in the category 'System Audit Policies - Policy Change' for auditing changes to system audit policies. This policy requires that the Guest Configuration prerequisites have been deployed to the policy assignment scope. For details, visit https://aka.ms/gcpol.\",\r\n        \"metadata\": {\r\n          \"category\": \"Guest Configuration\",\r\n          \"version\": \"3.0.0\",\r\n          \"requiredProviders\": [\r\n            \"Microsoft.GuestConfiguration\"\r\n          ],\r\n          \"guestConfiguration\": {\r\n            \"name\": \"AzureBaseline_SystemAuditPoliciesPolicyChange\",\r\n            \"version\": \"1.*\",\r\n            \"configurationParameter\": {\r\n              \"AuditAuthenticationPolicyChange\": \"Audit Authentication Policy Change;ExpectedValue\",\r\n              \"AuditAuthorizationPolicyChange\": \"Audit Authorization Policy Change;ExpectedValue\"\r\n            }\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"IncludeArcMachines\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Include Arc connected servers\",\r\n              \"description\": \"By selecting this option, you agree to be charged monthly per Arc connected machine.\",\r\n              \"portalReview\": \"true\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"false\"\r\n          },\r\n          \"AuditAuthenticationPolicyChange\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Authentication Policy Change\",\r\n              \"description\": \"Specifies whether audit events are generated when changes are made to authentication policy. This setting is useful for tracking changes in domain-level and forest-level trust and privileges that are granted to user accounts or groups.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"Success\"\r\n          },\r\n          \"AuditAuthorizationPolicyChange\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Authorization Policy Change\",\r\n              \"description\": \"Specifies whether audit events are generated for assignment and removal of user rights in user right policies, changes in security token object permission, resource attributes changes and Central Access Policy changes for file system objects.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"No Auditing\",\r\n              \"Success\",\r\n              \"Failure\",\r\n              \"Success and Failure\"\r\n            ],\r\n            \"defaultValue\": \"No Auditing\"\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of this policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"dsvm-win*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"value\": \"[parameters('IncludeArcMachines')]\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.ConnectedVMwarevSphere/virtualMachines/osProfile.osType\",\r\n                            \"like\": \"windows*\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"AzureBaseline_SystemAuditPoliciesPolicyChange\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                    \"equals\": \"Compliant\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\",\r\n                    \"equals\": \"[base64(concat('Audit Authentication Policy Change;ExpectedValue', '=', parameters('AuditAuthenticationPolicyChange'), ',', 'Audit Authorization Policy Change;ExpectedValue', '=', parameters('AuditAuthorizationPolicyChange')))]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a7a701e-dff3-4da9-9ec5-42cb98594c0b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a7a701e-dff3-4da9-9ec5-42cb98594c0b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1746 - Security Authorization Process\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1746\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2ab0c8e3-b8ef-48e9-b6ac-a0c5e713a757\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2ab0c8e3-b8ef-48e9-b6ac-a0c5e713a757\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Configure Azure Defender for SQL agent on virtual machine\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Configure Windows machines to automatically install the Azure Defender for SQL agent where the Azure Monitor Agent is installed. Security Center collects events from the agent and uses them to provide security alerts and tailored hardening tasks (recommendations). Creates a resource group and Log Analytics workspace in the same region as the machine. Target virtual machines must be in a supported location.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"version\": \"1.0.0-preview\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"enableCollectionOfSqlQueriesForSecurityResearch\": {\r\n            \"type\": \"Boolean\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable collection of SQL queries for security research\",\r\n              \"description\": \"Enable or disable the collection of SQL queries for security research.\"\r\n            },\r\n            \"allowedValues\": [\r\n              true,\r\n              false\r\n            ],\r\n            \"defaultValue\": true\r\n          },\r\n          \"azureDefenderForSqlExtensionTypeToInstall\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Azure Defender For SQL extension type to install\",\r\n              \"description\": \"The type of the Azure Defender For SQL extension needed to be installed.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AdvancedThreatProtection.Windows\",\r\n              \"VulnerabilityAssessment.Windows\"\r\n            ]\r\n          },\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines/extensions\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"australiacentral\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"brazilsouth\",\r\n                  \"canadacentral\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"eastasia\",\r\n                  \"eastus2euap\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"francecentral\",\r\n                  \"germanywestcentral\",\r\n                  \"japaneast\",\r\n                  \"koreacentral\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"norwayeast\",\r\n                  \"southcentralus\",\r\n                  \"southeastasia\",\r\n                  \"switzerlandnorth\",\r\n                  \"switzerlandwest\",\r\n                  \"southafricanorth\",\r\n                  \"swedencentral\",\r\n                  \"uaenorth\",\r\n                  \"uksouth\",\r\n                  \"ukwest\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westus\",\r\n                  \"westus2\"\r\n                ]\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"AzureMonitorWindowsAgent\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                \"equals\": \"Microsoft.Azure.Monitor\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"name\": \"[concat(first(split(field('fullName'), '/')), '/Microsoft.Azure.AzureDefenderForSQL.', parameters('azureDefenderForSqlExtensionTypeToInstall'))]\",\r\n              \"deploymentScope\": \"subscription\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"[parameters('azureDefenderForSqlExtensionTypeToInstall')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.AzureDefenderForSQL\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/provisioningState\",\r\n                    \"in\": [\r\n                      \"Succeeded\",\r\n                      \"Provisioning succeeded\"\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n              ],\r\n              \"deployment\": {\r\n                \"location\": \"eastus\",\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"resourceGroup\": {\r\n                      \"value\": \"[resourceGroup().name]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"vmName\": {\r\n                      \"value\": \"[first(split(field('fullName'), '/'))]\"\r\n                    },\r\n                    \"enableCollectionOfSqlQueriesForSecurityResearch\": {\r\n                      \"value\": \"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"\r\n                    },\r\n                    \"azureDefenderForSqlExtensionTypeToInstall\": {\r\n                      \"value\": \"[parameters('azureDefenderForSqlExtensionTypeToInstall')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceGroup\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"enableCollectionOfSqlQueriesForSecurityResearch\": {\r\n                        \"type\": \"bool\"\r\n                      },\r\n                      \"azureDefenderForSqlExtensionTypeToInstall\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"locationLongNameToShortMap\": {\r\n                        \"australiacentral\": \"CAU\",\r\n                        \"australiaeast\": \"EAU\",\r\n                        \"australiasoutheast\": \"SEAU\",\r\n                        \"brazilsouth\": \"CQ\",\r\n                        \"canadacentral\": \"CCA\",\r\n                        \"centralindia\": \"CIN\",\r\n                        \"centralus\": \"CUS\",\r\n                        \"eastasia\": \"EA\",\r\n                        \"eastus2euap\": \"eus2p\",\r\n                        \"eastus\": \"EUS\",\r\n                        \"eastus2\": \"EUS2\",\r\n                        \"francecentral\": \"PAR\",\r\n                        \"germanywestcentral\": \"DEWC\",\r\n                        \"japaneast\": \"EJP\",\r\n                        \"koreacentral\": \"SE\",\r\n                        \"northcentralus\": \"NCUS\",\r\n                        \"northeurope\": \"NEU\",\r\n                        \"norwayeast\": \"NOE\",\r\n                        \"southcentralus\": \"SCUS\",\r\n                        \"southeastasia\": \"SEA\",\r\n                        \"switzerlandnorth\": \"CHN\",\r\n                        \"switzerlandwest\": \"CHW\",\r\n                        \"southafricanorth\": \"JNB\",\r\n                        \"swedencentral\": \"SEC\",\r\n                        \"uaenorth\": \"DXB\",\r\n                        \"uksouth\": \"SUK\",\r\n                        \"ukwest\": \"WUK\",\r\n                        \"westcentralus\": \"WCUS\",\r\n                        \"westeurope\": \"WEU\",\r\n                        \"westus\": \"WUS\",\r\n                        \"westus2\": \"WUS2\"\r\n                      },\r\n                      \"locationCode\": \"[variables('locationLongNameToShortMap')[parameters('location')]]\",\r\n                      \"subscriptionId\": \"[subscription().subscriptionId]\",\r\n                      \"defaultRGName\": \"[concat('DefaultResourceGroup-', variables('locationCode'))]\",\r\n                      \"defaultRGLocation\": \"[parameters('location')]\",\r\n                      \"workspaceName\": \"[concat('defaultWorkspace-', variables('subscriptionId'),'-', variables('locationCode'))]\",\r\n                      \"dcrName\": \"Microsoft-AzureDefenderForSQL\",\r\n                      \"dcrId\": \"[concat('/subscriptions/', variables('subscriptionId'), '/resourceGroups/', variables('defaultRGName'), '/providers/Microsoft.Insights/dataCollectionRules/', variables('dcrName'))]\",\r\n                      \"dcraName\": \"[concat(parameters('vmName'),'/Microsoft.Insights/AzureDefenderForSQL-RulesAssociation')]\",\r\n                      \"deployAzureDefenderForSqlExtensions\": \"[concat('deployAzureDefenderForSqlExtensions-', uniqueString(deployment().name))]\",\r\n                      \"deployDefaultAscResourceGroup\": \"[concat('deployDefaultAscResourceGroup-', uniqueString(deployment().name))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                        \"name\": \"[variables('defaultRGName')]\",\r\n                        \"apiVersion\": \"2020-10-01\",\r\n                        \"location\": \"[variables('defaultRGLocation')]\"\r\n                      },\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('deployDefaultAscResourceGroup')]\",\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"resourceGroup\": \"[variables('defaultRGName')]\",\r\n                        \"dependsOn\": [\r\n                          \"[resourceId('Microsoft.Resources/resourceGroups', variables('defaultRGName'))]\"\r\n                        ],\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"defaultRGLocation\": {\r\n                              \"value\": \"[variables('defaultRGLocation')]\"\r\n                            },\r\n                            \"workspaceName\": {\r\n                              \"value\": \"[variables('workspaceName')]\"\r\n                            },\r\n                            \"dcrName\": {\r\n                              \"value\": \"[variables('dcrName')]\"\r\n                            },\r\n                            \"enableCollectionOfSqlQueriesForSecurityResearch\": {\r\n                              \"value\": \"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"\r\n                            }\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"defaultRGLocation\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"workspaceName\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"dcrName\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"enableCollectionOfSqlQueriesForSecurityResearch\": {\r\n                                \"type\": \"bool\"\r\n                              }\r\n                            },\r\n                            \"variables\": {},\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.OperationalInsights/workspaces\",\r\n                                \"name\": \"[parameters('workspaceName')]\",\r\n                                \"apiVersion\": \"2015-11-01-preview\",\r\n                                \"location\": \"[parameters('defaultRGLocation')]\",\r\n                                \"properties\": {\r\n                                  \"sku\": {\r\n                                    \"name\": \"pernode\"\r\n                                  },\r\n                                  \"retentionInDays\": 30,\r\n                                  \"features\": {\r\n                                    \"searchVersion\": 1\r\n                                  }\r\n                                }\r\n                              },\r\n                              {\r\n                                \"type\": \"Microsoft.Insights/dataCollectionRules\",\r\n                                \"name\": \"[parameters('dcrName')]\",\r\n                                \"apiVersion\": \"2019-11-01-preview\",\r\n                                \"location\": \"[parameters('defaultRGLocation')]\",\r\n                                \"dependsOn\": [\r\n                                  \"[parameters('workspaceName')]\"\r\n                                ],\r\n                                \"properties\": {\r\n                                  \"description\": \"Data collection rule for Azure Defender for SQL. Deleting this rule will break the detection of Azure Defender for SQL.\",\r\n                                  \"dataSources\": {\r\n                                    \"extensions\": [\r\n                                      {\r\n                                        \"streams\": [\r\n                                          \"Microsoft-DefenderForSqlAlerts\",\r\n                                          \"Microsoft-DefenderForSqlLogins\",\r\n                                          \"Microsoft-DefenderForSqlTelemetry\",\r\n                                          \"Microsoft-SqlAtpStatus-DefenderForSql\"\r\n                                        ],\r\n                                        \"extensionName\": \"AdvancedThreatProtection\",\r\n                                        \"extensionSettings\": {\r\n                                          \"enableCollectionOfSqlQueriesForSecurityResearch\": \"[parameters('enableCollectionOfSqlQueriesForSecurityResearch')]\"\r\n                                        },\r\n                                        \"name\": \"AdvancedThreatProtection\"\r\n                                      },\r\n                                      {\r\n                                        \"streams\": [\r\n                                          \"Microsoft-DefenderForSqlScanEvents\",\r\n                                          \"Microsoft-DefenderForSqlScanResults\",\r\n                                          \"Microsoft-DefenderForSqlTelemetry\"\r\n                                        ],\r\n                                        \"extensionName\": \"VulnerabilityAssessment\",\r\n                                        \"name\": \"VulnerabilityAssessment\"\r\n                                      }\r\n                                    ]\r\n                                  },\r\n                                  \"destinations\": {\r\n                                    \"logAnalytics\": [\r\n                                      {\r\n                                        \"workspaceResourceId\": \"[resourceId('Microsoft.OperationalInsights/workspaces/', parameters('workspaceName'))]\",\r\n                                        \"name\": \"LogAnalyticsDest\"\r\n                                      }\r\n                                    ]\r\n                                  },\r\n                                  \"dataFlows\": [\r\n                                    {\r\n                                      \"streams\": [\r\n                                        \"Microsoft-DefenderForSqlAlerts\",\r\n                                        \"Microsoft-DefenderForSqlLogins\",\r\n                                        \"Microsoft-DefenderForSqlTelemetry\",\r\n                                        \"Microsoft-DefenderForSqlScanEvents\",\r\n                                        \"Microsoft-DefenderForSqlScanResults\"\r\n                                      ],\r\n                                      \"destinations\": [\r\n                                        \"LogAnalyticsDest\"\r\n                                      ]\r\n                                    }\r\n                                  ]\r\n                                }\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('deployAzureDefenderForSqlExtensions')]\",\r\n                        \"apiVersion\": \"2020-06-01\",\r\n                        \"resourceGroup\": \"[parameters('resourceGroup')]\",\r\n                        \"dependsOn\": [\r\n                          \"[variables('deployDefaultAscResourceGroup')]\"\r\n                        ],\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"expressionEvaluationOptions\": {\r\n                            \"scope\": \"inner\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"dcrId\": {\r\n                              \"value\": \"[variables('dcrId')]\"\r\n                            },\r\n                            \"dcraName\": {\r\n                              \"value\": \"[variables('dcraName')]\"\r\n                            },\r\n                            \"vmName\": {\r\n                              \"value\": \"[parameters('vmName')]\"\r\n                            },\r\n                            \"azureDefenderForSqlExtensionTypeToInstall\": {\r\n                              \"value\": \"[parameters('azureDefenderForSqlExtensionTypeToInstall')]\"\r\n                            }\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"location\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"dcrId\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"dcraName\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"vmName\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"azureDefenderForSqlExtensionTypeToInstall\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"variables\": {},\r\n                            \"resources\": [\r\n                              {\r\n                                \"type\": \"Microsoft.Compute/virtualMachines/providers/dataCollectionRuleAssociations\",\r\n                                \"name\": \"[parameters('dcraName')]\",\r\n                                \"apiVersion\": \"2019-11-01-preview\",\r\n                                \"properties\": {\r\n                                  \"description\": \"Association of data collection rule for Azure Defender for SQL. Deleting this association will break the detection of Azure Defender for SQL for this virtual machine.\",\r\n                                  \"dataCollectionRuleId\": \"[parameters('dcrId')]\"\r\n                                }\r\n                              },\r\n                              {\r\n                                \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                                \"name\": \"[concat(parameters('vmName'), '/', 'Microsoft.Azure.AzureDefenderForSQL.', parameters('azureDefenderForSqlExtensionTypeToInstall'))]\",\r\n                                \"apiVersion\": \"2020-12-01\",\r\n                                \"location\": \"[parameters('location')]\",\r\n                                \"properties\": {\r\n                                  \"publisher\": \"Microsoft.Azure.AzureDefenderForSQL\",\r\n                                  \"type\": \"[parameters('azureDefenderForSqlExtensionTypeToInstall')]\",\r\n                                  \"typeHandlerVersion\": \"1.0\",\r\n                                  \"autoUpgradeMinorVersion\": true\r\n                                }\r\n                              }\r\n                            ]\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2ada9901-073c-444a-9a9a-91865174f0aa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2ada9901-073c-444a-9a9a-91865174f0aa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1274 - Alternate Processing Site\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Contingency Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1274\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2aee175f-cd16-4825-939a-a85349d96210\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2aee175f-cd16-4825-939a-a85349d96210\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Define and enforce inactivity log policy\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1017 - Define and enforce inactivity log policy\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1017\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2af4640d-11a6-a64b-5ceb-a468f4341c0c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2af4640d-11a6-a64b-5ceb-a468f4341c0c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Limit privileges to make changes in production environment\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1206 - Limit privileges to make changes in production environment\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1206\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2af551d5-1775-326a-0589-590bfb7e9eb2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2af551d5-1775-326a-0589-590bfb7e9eb2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Provide security training before providing access\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0418 - Provide security training before providing access\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0418\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2b05dca2-25ec-9335-495c-29155f785082\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b05dca2-25ec-9335-495c-29155f785082\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Synapse workspace auditing settings should have action groups configured to capture critical activities\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"To ensure your audit logs are as thorough as possible, the AuditActionsAndGroups property should include all the relevant groups. We recommend adding at least SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP, FAILED_DATABASE_AUTHENTICATION_GROUP, and BATCH_COMPLETED_GROUP. This is sometimes required for compliance with regulatory standards.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Synapse\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Synapse/workspaces\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Synapse/workspaces/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Synapse/workspaces/auditingSettings/auditActionsAndGroups[*]\",\r\n                      \"notEquals\": \"SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Synapse/workspaces/auditingSettings/auditActionsAndGroups[*]\",\r\n                      \"notEquals\": \"FAILED_DATABASE_AUTHENTICATION_GROUP\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Synapse/workspaces/auditingSettings/auditActionsAndGroups[*]\",\r\n                      \"notEquals\": \"BATCH_COMPLETED_GROUP\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2b18f286-371e-4b80-9887-04759970c0d3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b18f286-371e-4b80-9887-04759970c0d3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Define requirements for supplying goods and services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0126 - Define requirements for supplying goods and services\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0126\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2b2f3a72-9e68-3993-2b69-13dcdecf8958\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b2f3a72-9e68-3993-2b69-13dcdecf8958\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Develop an incident response plan\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0145 - Develop an incident response plan\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0145\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2b4e134f-1e4c-2bff-573e-082d85479b6e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b4e134f-1e4c-2bff-573e-082d85479b6e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Authentication should be enabled on Container Apps\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Container Apps Authentication is a feature that can prevent anonymous HTTP requests from reaching the Container App, or authenticate those that have tokens before they reach the Container App\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Container Apps\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.App/containerApps\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.App/containerApps/authConfigs\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.App/containerApps/authConfigs/platform.enabled\",\r\n                \"equals\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2b585559-a78e-4cc4-b1aa-fb169d2f6b96\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b585559-a78e-4cc4-b1aa-fb169d2f6b96\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1603 - Developer Security Testing And Evaluation\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1603\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2b909c26-162f-47ce-8e15-0c1f55632eac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b909c26-162f-47ce-8e15-0c1f55632eac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"App Service apps should use managed identity\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use a managed identity for enhanced authentication security\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"functionapp\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/config\",\r\n              \"name\": \"web\",\r\n              \"existenceCondition\": {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/managedServiceIdentityId\",\r\n                    \"exists\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/config/xmanagedServiceIdentityId\",\r\n                    \"exists\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b9ad585-36bc-4615-b300-fd4435808332\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Cognitive Services accounts should enable data encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy is deprecated. Cognitive Services have data encryption enforced.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0-deprecated\",\r\n          \"category\": \"Cognitive Services\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect determines what happens when the policy rule is evaluated to match\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Disabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.CognitiveServices/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/encryption.keySource\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.CognitiveServices/accounts/encryption\",\r\n                \"exists\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2bdd0062-9d75-436e-89df-487dd8e4b3c7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2bdd0062-9d75-436e-89df-487dd8e4b3c7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1758 - Threat Awareness Program\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1758\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2bfea08c-2567-4f29-aad7-0f238ce655ea\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2bfea08c-2567-4f29-aad7-0f238ce655ea\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure App Service app slots to disable local authentication for SCM sites\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disable local authentication methods for SCM sites so that your App Services slots exclusively require Azure Active Directory identities for authentication. Learn more at: https://aka.ms/app-service-disable-basic-auth.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Web/sites/slots\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"name\": \"scm\",\r\n              \"type\": \"Microsoft.Web/sites/slots/basicPublishingCredentialsPolicies\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/slots/basicPublishingCredentialsPolicies/allow\",\r\n                \"equals\": \"false\"\r\n              },\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/Microsoft.Authorization/roleDefinitions/de139f84-1756-47ae-9be6-808fbbe84772\"\r\n              ],\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"parameters\": {\r\n                    \"siteName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  },\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"siteName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {},\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Web/sites/slots/basicPublishingCredentialsPolicies\",\r\n                        \"name\": \"[concat(parameters('siteName'), '/scm')]\",\r\n                        \"apiVersion\": \"2021-02-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"allow\": \"false\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c034a29-2a5f-4857-b120-f800fe5549ae\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c034a29-2a5f-4857-b120-f800fe5549ae\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1434 - Media Transport\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Media Protection control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1434\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c18f06b-a68d-41c3-8863-b8cd3acb5f8f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c18f06b-a68d-41c3-8863-b8cd3acb5f8f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1343 - Authenticator Management | Expiration Of Cached Authenticators\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1343\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c251a55-31eb-4e53-99c6-e9c43c393ac2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c251a55-31eb-4e53-99c6-e9c43c393ac2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Document security operations\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0202 - Document security operations\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0202\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c6bee3a-2180-2430-440d-db3c7a849870\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c6bee3a-2180-2430-440d-db3c7a849870\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1388 - Information Spillage Response\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Incident Response control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1388\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c7c575a-d4c5-4f6f-bd49-dee97a8cba55\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c7c575a-d4c5-4f6f-bd49-dee97a8cba55\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enable dual or joint authorization\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0226 - Enable dual or joint authorization\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0226\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c843d78-8f64-92b5-6a9b-e8186c0e7eb6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c843d78-8f64-92b5-6a9b-e8186c0e7eb6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1344 - Authenticator Feedback\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Identification and Authentication control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1344\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c895fe7-2d8e-43a2-838c-3a533a5b355e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c895fe7-2d8e-43a2-838c-3a533a5b355e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: SSH access from the Internet should be blocked\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy is deprecated. This policy audits any network security rule that allows SSH access from Internet\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0-deprecated\",\r\n          \"category\": \"Network\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"equals\": \"*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"equals\": \"22\"\r\n                      },\r\n                      {\r\n                        \"value\": \"[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),22),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),22)), 'false')]\",\r\n                        \"equals\": \"true\"\r\n                      },\r\n                      {\r\n                        \"count\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"where\": {\r\n                            \"value\": \"[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),22),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),22)) , 'false')]\",\r\n                            \"equals\": \"true\"\r\n                          }\r\n                        },\r\n                        \"greater\": 0\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notEquals\": \"*\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notEquals\": \"22\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"equals\": \"*\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"equals\": \"Internet\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                          \"notEquals\": \"*\"\r\n                        }\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                          \"notEquals\": \"Internet\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fab\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c89a2e5-7285-40fe-afe0-ae8654b92fab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Unattached disks should be encrypted\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy audits any unattached disk without encryption enabled.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Compute\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/disks\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/disks/diskState\",\r\n                \"equals\": \"Unattached\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/disks/encryptionSettingsCollection.enabled\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/disks/encryptionSettingsCollection.enabled\",\r\n                    \"equals\": \"false\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fb2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2c89a2e5-7285-40fe-afe0-ae8654b92fb2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Automate account management\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0026 - Automate account management\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0026\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2cc9c165-46bd-9762-5739-d2aae5ba90a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2cc9c165-46bd-9762-5739-d2aae5ba90a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1593 - External Information System Services | Processing, Storage, And Service Location\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Services Acquisition control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1593\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2cd0a426-b5f5-4fe0-9539-a6043cdbc6fa\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2cd0a426-b5f5-4fe0-9539-a6043cdbc6fa\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1546 - Vulnerability Scanning\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Risk Assessment control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1546\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2ce1ea7e-4038-4e53-82f4-63e8859333c1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2ce1ea7e-4038-4e53-82f4-63e8859333c1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1414 - Remote Maintenance\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Maintenance control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1414\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2ce63a52-e47b-4ae2-adbb-6e40d967f9e6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2ce63a52-e47b-4ae2-adbb-6e40d967f9e6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1679 - Malicious Code Protection\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1679\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2cf42a28-193e-41c5-98df-7688e7ef0a88\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2cf42a28-193e-41c5-98df-7688e7ef0a88\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1068 - Wireless Access Restrictions\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1068\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d045bca-a0fd-452e-9f41-4ec33769717c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d045bca-a0fd-452e-9f41-4ec33769717c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"App Service Environment apps should not be reachable over public internet\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"To ensure apps deployed in an App Service Environment are not accessible over public internet, one should deploy App Service Environment with an IP address in virtual network. To set the IP address to a virtual network IP, the App Service Environment must be deployed with an internal load balancer.\",\r\n        \"metadata\": {\r\n          \"version\": \"3.0.0\",\r\n          \"category\": \"App Service\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/hostingEnvironments\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"like\": \"ASE*\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/HostingEnvironments/internalLoadBalancingMode\",\r\n                \"notContains\": \"2\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/HostingEnvironments/internalLoadBalancingMode\",\r\n                \"notContains\": \"3\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/HostingEnvironments/internalLoadBalancingMode\",\r\n                \"notContains\": \"Web\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/HostingEnvironments/internalLoadBalancingMode\",\r\n                \"notContains\": \"Publishing\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d048aca-6479-4923-88f5-e2ac295d9af3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Employ business case to record the resources required\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1735 - Employ business case to record the resources required\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1735\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d14ff7e-6ff9-838c-0cde-4962ccdb1689\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d14ff7e-6ff9-838c-0cde-4962ccdb1689\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"App Service apps should use a virtual network service endpoint\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use virtual network service endpoints to restrict access to your app from selected subnets from an Azure virtual network. To learn more about App Service service endpoints, visit https://aks.ms/appservice-vnet-service-endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"2.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"field\": \"kind\",\r\n                \"notContains\": \"functionapp\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Web/sites/virtualNetworkConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Web/sites/virtualnetworkconnections/vnetResourceId\",\r\n                \"exists\": \"true\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d21331d-a4c2-4def-a9ad-ee4e1e023beb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d21331d-a4c2-4def-a9ad-ee4e1e023beb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Accept only FICAM-approved third-party credentials\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1348 - Accept only FICAM-approved third-party credentials\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1348\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d2ca910-7957-23ee-2945-33f401606efc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d2ca910-7957-23ee-2945-33f401606efc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1704 - Security Alerts & Advisories\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this System and Information Integrity control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1704\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d44b6fa-1134-4ea6-ad4e-9edb68f65429\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d44b6fa-1134-4ea6-ad4e-9edb68f65429\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Provide information spillage training\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_0413 - Provide information spillage training\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_0413\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d4d0e90-32d9-4deb-2166-a00d51ed57c0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d4d0e90-32d9-4deb-2166-a00d51ed57c0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1856 - Privacy Incident Response \",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1856\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d5600ed-575a-4723-9ff4-52d694be0a59\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d5600ed-575a-4723-9ff4-52d694be0a59\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Windows VMs that do not store passwords using reversible encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not store passwords using reversible encryption. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"esri\",\r\n                          \"incredibuild\",\r\n                          \"MicrosoftDynamicsAX\",\r\n                          \"MicrosoftSharepoint\",\r\n                          \"MicrosoftVisualStudio\",\r\n                          \"MicrosoftWindowsDesktop\",\r\n                          \"MicrosoftWindowsServerHPCPack\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftWindowsServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"MicrosoftSQLServer\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"notLike\": \"SQL2008*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"dsvm-windows\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"standard-data-science-vm\",\r\n                              \"windows-data-science-vm\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"batch\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"rendering-windows2016\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"cis-windows-server-201*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"pivotal\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"bosh-windows-server*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloud-infrastructure-services\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"ad*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Windows*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSKU\",\r\n                                    \"notLike\": \"2008*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"notLike\": \"SQL2008*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"windows*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"StorePasswordsUsingReversibleEncryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d60d3b7-aa10-454c-88a8-de39d99d17c6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Deprecated]: Show audit results from Linux VMs that allow remote connections from accounts without passwords\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that allow remote connections from accounts without passwords. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\",\r\n        \"metadata\": {\r\n          \"version\": \"4.0.0-deprecated\",\r\n          \"category\": \"Guest Configuration\",\r\n          \"deprecated\": true\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                        \"in\": [\r\n                          \"microsoft-aks\",\r\n                          \"qubole-inc\",\r\n                          \"datastax\",\r\n                          \"couchbase\",\r\n                          \"scalegrid\",\r\n                          \"checkpoint\",\r\n                          \"paloaltonetworks\",\r\n                          \"debian\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"OpenLogic\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"CentOS*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Oracle\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Oracle-Linux\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"RHEL\",\r\n                              \"RHEL-HA\",\r\n                              \"RHEL-SAP\",\r\n                              \"RHEL-SAP-APPS\",\r\n                              \"RHEL-SAP-HA\",\r\n                              \"RHEL-SAP-HANA\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"RedHat\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"osa\",\r\n                              \"rhel-byos\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"center-for-internet-security-inc\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"cis-centos-7-l1\",\r\n                              \"cis-centos-7-v2-1-1-l1\",\r\n                              \"cis-centos-8-l1\",\r\n                              \"cis-debian-linux-8-l1\",\r\n                              \"cis-debian-linux-9-l1\",\r\n                              \"cis-nginx-centos-7-v1-1-0-l1\",\r\n                              \"cis-oracle-linux-7-v2-0-0-l1\",\r\n                              \"cis-oracle-linux-8-l1\",\r\n                              \"cis-postgresql-11-centos-linux-7-level-1\",\r\n                              \"cis-rhel-7-l2\",\r\n                              \"cis-rhel-7-v2-2-0-l1\",\r\n                              \"cis-rhel-8-l1\",\r\n                              \"cis-suse-linux-12-v2-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1604-v1-0-0-l1\",\r\n                              \"cis-ubuntu-linux-1804-l1\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"credativ\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"Debian\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"7*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Suse\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"SLES*\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"11*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"Canonical\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"contains\": \"Ubuntu\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"12*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-dsvm\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"in\": [\r\n                              \"linux-data-science-vm-ubuntu\",\r\n                              \"azureml\",\r\n                              \"ubuntu-hpc\",\r\n                              \"ubuntu-1804\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-centos-os\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageSKU\",\r\n                            \"notLike\": \"6*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"cloudera\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"equals\": \"cloudera-altus-centos-os\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                            \"equals\": \"microsoft-ads\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                            \"like\": \"linux*\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\",\r\n                                \"exists\": \"true\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\",\r\n                                \"like\": \"Linux*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"anyOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"exists\": \"false\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"notIn\": [\r\n                                  \"OpenLogic\",\r\n                                  \"RedHat\",\r\n                                  \"credativ\",\r\n                                  \"Suse\",\r\n                                  \"Canonical\",\r\n                                  \"microsoft-dsvm\",\r\n                                  \"cloudera\",\r\n                                  \"microsoft-ads\",\r\n                                  \"center-for-internet-security-inc\",\r\n                                  \"Oracle\",\r\n                                  \"AzureDatabricks\",\r\n                                  \"azureopenshift\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.HybridCompute/imageOffer\",\r\n                    \"like\": \"linux*\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments\",\r\n              \"name\": \"PasswordPolicy_msid110\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\",\r\n                \"equals\": \"Compliant\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d67222d-05fd-4526-a171-2ee132ad9e83\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Public network access on Azure IoT Hub should be disabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disabling the public network access property improves security by ensuring your Azure IoT Hub can only be accessed from a private endpoint.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Internet of Things\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Devices/IotHubs\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Devices/IotHubs/publicNetworkAccess\",\r\n                \"notEquals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d6830fb-07eb-48e7-8c4d-2a442b35f0fb\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d6830fb-07eb-48e7-8c4d-2a442b35f0fb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Azure IoT Hub should use customer-managed key to encrypt data at rest\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Encryption of data at rest in IoT Hub with customer-managed key adds a second layer of encryption on top of the default service-managed keys, enables customer control of keys, custom rotation policies, and ability to manage access to data through key access control. Customer-managed keys must be configured during creation of IoT Hub. For more information on how to configure customer-managed keys, see https://aka.ms/iotcmk.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"category\": \"Internet of Things\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The desired effect of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Devices/IotHubs\"\r\n              },\r\n              {\r\n                \"count\": {\r\n                  \"field\": \"Microsoft.Devices/IotHubs/encryption.keyVaultProperties[*]\",\r\n                  \"where\": {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Devices/IotHubs/encryption.keyVaultProperties[*].keyIdentifier\",\r\n                        \"exists\": \"true\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Devices/IotHubs/encryption.keyVaultProperties[*].keyIdentifier\",\r\n                        \"notequals\": \"\"\r\n                      }\r\n                    ]\r\n                  }\r\n                },\r\n                \"lessOrEquals\": 0\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d7e144b-159c-44fc-95c1-ac3dbf5e6e54\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d7e144b-159c-44fc-95c1-ac3dbf5e6e54\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Managed workspace virtual network on Azure Synapse workspaces should be enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enabling a managed workspace virtual network ensures that your workspace is network isolated from other workspaces. Data integration and Spark resources deployed in this virtual network also provides user level isolation for Spark activities.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Synapse\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Synapse/workspaces\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Synapse/workspaces/managedVirtualNetwork\",\r\n                \"notEquals\": \"default\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2d9dbfa3-927b-4cf0-9d0f-08747f971650\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2d9dbfa3-927b-4cf0-9d0f-08747f971650\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1077 - Use Of External Information Systems\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1077\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2dad3668-797a-412e-a798-07d3849a7a79\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2dad3668-797a-412e-a798-07d3849a7a79\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Azure Event Grid partner namespaces to disable local authentication\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Disable local authentication methods so that your Azure Event Grid partner namespaces exclusively require Azure Active Directory identities for authentication. Learn more at: https://aka.ms/aeg-disablelocalauth.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Event Grid\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Modify\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Modify\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.EventGrid/partnerNamespaces\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.EventGrid/partnerNamespaces/disableLocalAuth\",\r\n                \"notEquals\": true\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"conflictEffect\": \"audit\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/1e241071-0855-49ea-94dc-649edcd759de\"\r\n              ],\r\n              \"operations\": [\r\n                {\r\n                  \"condition\": \"[greaterOrEquals(requestContext().apiVersion, '2021-06-01-preview')]\",\r\n                  \"operation\": \"addOrReplace\",\r\n                  \"field\": \"Microsoft.EventGrid/partnerNamespaces/disableLocalAuth\",\r\n                  \"value\": true\r\n                }\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2dd0e8b9-4289-4bb0-b813-1883298e9924\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2dd0e8b9-4289-4bb0-b813-1883298e9924\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1751 - Insider Threat Program\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Program Management control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1751\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2e0ffcf5-c19e-4e04-ad0f-2db9b15ab126\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2e0ffcf5-c19e-4e04-ad0f-2db9b15ab126\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1149 - Security Assessments | Specialized Assessments\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Security Assessment and Authorization control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1149\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2e1b855b-a013-481a-aeeb-2bcb129fd35d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2e1b855b-a013-481a-aeeb-2bcb129fd35d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1497 - System Security Plan | Plan / Coordinate With Other Organizational Entities\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Planning control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1497\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2e3c5583-1729-4d36-8771-59c32f090a22\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2e3c5583-1729-4d36-8771-59c32f090a22\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1845 - Consent | Mechanisms Supporting Itemized or Tiered Consent \",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Individual Participation and Redress control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1845\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2e5cd188-7fa8-41fc-87ff-0ac7475ccb25\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2e5cd188-7fa8-41fc-87ff-0ac7475ccb25\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Protect the information security program plan\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"CMA_C1732 - Protect the information security program plan\",\r\n        \"metadata\": {\r\n          \"version\": \"1.1.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/CMA_C1732\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Manual\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Manual\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"defaultState\": \"Unknown\"\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2e7a98c9-219f-0d58-38dc-d69038224442\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2e7a98c9-219f-0d58-38dc-d69038224442\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Active Directory should use private link to access Azure services\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure AD, you can reduce data leakage risks. Learn more at: https://aka.ms/privateLinkforAzureADDocs. It should be only used from isolated VNETs to Azure services, with no access to the Internet or other services (M365).\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Azure Active Directory\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"microsoft.aadiam/privateLinkForAzureAD\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"microsoft.aadiam/privateLinkForAzureAD/privateEndpointConnections\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"microsoft.aadiam/privateLinkForAzureAD/privateEndpointConnections/privateLinkServiceConnectionState.status\",\r\n                \"equals\": \"Approved\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2e9411a0-0c5a-44b3-9ddb-ff10a1a2bf28\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2e9411a0-0c5a-44b3-9ddb-ff10a1a2bf28\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Azure Recovery Services vaults should use customer-managed keys for encrypting backup data\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Use customer-managed keys to manage the encryption at rest of your backup data. By default, customer data is encrypted with service-managed keys, but customer-managed keys are commonly required to meet regulatory compliance standards. Customer-managed keys enable the data to be encrypted with an Azure Key Vault key created and owned by you. You have full control and responsibility for the key lifecycle, including rotation and management. Learn more at https://aka.ms/AB-CmkEncryption.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0-preview\",\r\n          \"preview\": true,\r\n          \"category\": \"Backup\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Deny\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"enableDoubleEncryption\": {\r\n            \"type\": \"Boolean\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Double encryption should be enabled on Recovery Services vaults for Backup\",\r\n              \"description\": \"Check if double encryption is enabled on Recovery Services vaults for Backup.  For more details refer to https://aka.ms/AB-InfraEncryption.\"\r\n            },\r\n            \"allowedValues\": [\r\n              true,\r\n              false\r\n            ],\r\n            \"defaultValue\": false\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.RecoveryServices/vaults\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.RecoveryServices/vaults/encryption.keyVaultProperties.keyUri\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"value\": \"[parameters('enableDoubleEncryption')]\",\r\n                        \"equals\": true\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.RecoveryServices/vaults/encryption.infrastructureEncryption\",\r\n                        \"notEquals\": \"Enabled\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2e94d99a-8a36-4563-bc77-810d8893b671\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2e94d99a-8a36-4563-bc77-810d8893b671\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configure Linux Machines to be associated with a Data Collection Rule\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Deploy Association to link Linux virtual machines, virtual machine scale sets, and Arc machines to the specified Data Collection Rule. The list of locations and OS images are updated over time as support is increased.\",\r\n        \"metadata\": {\r\n          \"version\": \"5.0.0\",\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"DeployIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"DeployIfNotExists\"\r\n          },\r\n          \"listOfLinuxImageIdToInclude\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Additional Linux Machine Images\",\r\n              \"description\": \"List of machine images that have supported Linux OS to add to scope. Example values: '/subscriptions/<subscriptionId>/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage'\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"dcrResourceId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Data Collection Rule Resource Id\",\r\n              \"description\": \"Resource Id of the Data Collection Rule to be applied on the Linux machines in scope.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": [\r\n                  \"australiacentral\",\r\n                  \"australiacentral2\",\r\n                  \"australiaeast\",\r\n                  \"australiasoutheast\",\r\n                  \"brazilsouth\",\r\n                  \"brazilsoutheast\",\r\n                  \"canadacentral\",\r\n                  \"canadaeast\",\r\n                  \"centralindia\",\r\n                  \"centralus\",\r\n                  \"eastasia\",\r\n                  \"eastus2euap\",\r\n                  \"eastus\",\r\n                  \"eastus2\",\r\n                  \"francecentral\",\r\n                  \"francesouth\",\r\n                  \"germanywestcentral\",\r\n                  \"japaneast\",\r\n                  \"japanwest\",\r\n                  \"jioindiawest\",\r\n                  \"koreacentral\",\r\n                  \"koreasouth\",\r\n                  \"northcentralus\",\r\n                  \"northeurope\",\r\n                  \"norwayeast\",\r\n                  \"norwaywest\",\r\n                  \"southafricanorth\",\r\n                  \"southcentralus\",\r\n                  \"southeastasia\",\r\n                  \"southindia\",\r\n                  \"switzerlandnorth\",\r\n                  \"switzerlandwest\",\r\n                  \"uaenorth\",\r\n                  \"uksouth\",\r\n                  \"ukwest\",\r\n                  \"westcentralus\",\r\n                  \"westeurope\",\r\n                  \"westindia\",\r\n                  \"westus\",\r\n                  \"westus2\"\r\n                ]\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"field\": \"type\",\r\n                        \"equals\": \"Microsoft.HybridCompute/machines\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.HybridCompute/machines/osName\",\r\n                        \"equals\": \"linux\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"allOf\": [\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                          },\r\n                          {\r\n                            \"field\": \"type\",\r\n                            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"anyOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Compute/imageId\",\r\n                            \"in\": \"[parameters('listOfLinuxImageIdToInclude')]\"\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"RedHat\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"in\": [\r\n                                  \"RHEL\",\r\n                                  \"RHEL-ARM64\",\r\n                                  \"RHEL-BYOS\",\r\n                                  \"RHEL-HA\",\r\n                                  \"RHEL-SAP\",\r\n                                  \"RHEL-SAP-APPS\",\r\n                                  \"RHEL-SAP-HA\"\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"7*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"8*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"rhel-lvm7*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"rhel-lvm8*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"SUSE\"\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"allOf\": [\r\n                                      {\r\n                                        \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                        \"in\": [\r\n                                          \"SLES\",\r\n                                          \"SLES-HPC\",\r\n                                          \"SLES-HPC-Priority\",\r\n                                          \"SLES-SAP\",\r\n                                          \"SLES-SAP-BYOS\",\r\n                                          \"SLES-Priority\",\r\n                                          \"SLES-BYOS\",\r\n                                          \"SLES-SAPCAL\",\r\n                                          \"SLES-Standard\"\r\n                                        ]\r\n                                      },\r\n                                      {\r\n                                        \"anyOf\": [\r\n                                          {\r\n                                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                                            \"like\": \"12*\"\r\n                                          },\r\n                                          {\r\n                                            \"field\": \"Microsoft.Compute/imageSku\",\r\n                                            \"like\": \"15*\"\r\n                                          }\r\n                                        ]\r\n                                      }\r\n                                    ]\r\n                                  },\r\n                                  {\r\n                                    \"allOf\": [\r\n                                      {\r\n                                        \"anyOf\": [\r\n                                          {\r\n                                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                            \"like\": \"sles-12*\"\r\n                                          },\r\n                                          {\r\n                                            \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                            \"like\": \"sles-15*\"\r\n                                          }\r\n                                        ]\r\n                                      },\r\n                                      {\r\n                                        \"field\": \"Microsoft.Compute/imageSku\",\r\n                                        \"in\": [\r\n                                          \"gen1\",\r\n                                          \"gen2\"\r\n                                        ]\r\n                                      }\r\n                                    ]\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"Canonical\"\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"equals\": \"UbuntuServer\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"0001-com-ubuntu-server-*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                    \"like\": \"0001-com-ubuntu-pro-*\"\r\n                                  }\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"in\": [\r\n                                  \"14.04.0-lts\",\r\n                                  \"14.04.1-lts\",\r\n                                  \"14.04.2-lts\",\r\n                                  \"14.04.3-lts\",\r\n                                  \"14.04.4-lts\",\r\n                                  \"14.04.5-lts\",\r\n                                  \"16_04_0-lts-gen2\",\r\n                                  \"16_04-lts-gen2\",\r\n                                  \"16.04-lts\",\r\n                                  \"16.04.0-lts\",\r\n                                  \"18_04-lts-arm64\",\r\n                                  \"18_04-lts-gen2\",\r\n                                  \"18.04-lts\",\r\n                                  \"20_04-lts-arm64\",\r\n                                  \"20_04-lts-gen2\",\r\n                                  \"20_04-lts\",\r\n                                  \"22_04-lts-gen2\",\r\n                                  \"22_04-lts\",\r\n                                  \"pro-16_04-lts-gen2\",\r\n                                  \"pro-16_04-lts\",\r\n                                  \"pro-18_04-lts-gen2\",\r\n                                  \"pro-18_04-lts\",\r\n                                  \"pro-20_04-lts-gen2\",\r\n                                  \"pro-20_04-lts\",\r\n                                  \"pro-22_04-lts-gen2\",\r\n                                  \"pro-22_04-lts\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"Oracle\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"equals\": \"Oracle-Linux\"\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"7*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"8*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"OpenLogic\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"in\": [\r\n                                  \"CentOS\",\r\n                                  \"Centos-LVM\",\r\n                                  \"CentOS-SRIOV\"\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"anyOf\": [\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"6*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"7*\"\r\n                                  },\r\n                                  {\r\n                                    \"field\": \"Microsoft.Compute/imageSku\",\r\n                                    \"like\": \"8*\"\r\n                                  }\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"cloudera\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"equals\": \"cloudera-centos-os\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"like\": \"7*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"almalinux\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"equals\": \"almalinux\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"like\": \"8*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"ctrliqinc1648673227698\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"like\": \"rocky-8*\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"like\": \"rocky-8*\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"credativ\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"in\": [\r\n                                  \"Debian\"\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"equals\": \"9\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"Debian\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"in\": [\r\n                                  \"debian-10\",\r\n                                  \"debian-11\"\r\n                                ]\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"in\": [\r\n                                  \"10\",\r\n                                  \"10-gen2\",\r\n                                  \"11\",\r\n                                  \"11-gen2\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"allOf\": [\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                                \"equals\": \"microsoftcblmariner\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                                \"equals\": \"cbl-mariner\"\r\n                              },\r\n                              {\r\n                                \"field\": \"Microsoft.Compute/imageSku\",\r\n                                \"in\": [\r\n                                  \"1-gen2\",\r\n                                  \"cbl-mariner-1\",\r\n                                  \"cbl-mariner-2\",\r\n                                  \"cbl-mariner-2-arm64\",\r\n                                  \"cbl-mariner-2-gen2\"\r\n                                ]\r\n                              }\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n              \"roleDefinitionIds\": [\r\n                \"/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\",\r\n                \"/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\"\r\n              ],\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Insights/dataCollectionRuleAssociations/dataCollectionRuleId\",\r\n                \"equals\": \"[parameters('dcrResourceId')]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"dcrResourceId\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"type\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"associationName\": \"[concat('assoc-', uniqueString(parameters('dcrResourceId')))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), 'microsoft.compute/virtualmachines')]\",\r\n                        \"name\": \"[variables('associationName')]\",\r\n                        \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n                        \"apiVersion\": \"2021-04-01\",\r\n                        \"properties\": {\r\n                          \"dataCollectionRuleId\": \"[parameters('dcrResourceId')]\"\r\n                        },\r\n                        \"scope\": \"[concat('Microsoft.Compute/virtualMachines/', parameters('resourceName'))]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), 'microsoft.compute/virtualmachinescalesets')]\",\r\n                        \"name\": \"[variables('associationName')]\",\r\n                        \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n                        \"apiVersion\": \"2021-04-01\",\r\n                        \"properties\": {\r\n                          \"dataCollectionRuleId\": \"[parameters('dcrResourceId')]\"\r\n                        },\r\n                        \"scope\": \"[concat('Microsoft.Compute/virtualMachineScaleSets/', parameters('resourceName'))]\"\r\n                      },\r\n                      {\r\n                        \"condition\": \"[equals(toLower(parameters('type')), 'microsoft.hybridcompute/machines')]\",\r\n                        \"name\": \"[variables('associationName')]\",\r\n                        \"type\": \"Microsoft.Insights/dataCollectionRuleAssociations\",\r\n                        \"apiVersion\": \"2021-04-01\",\r\n                        \"properties\": {\r\n                          \"dataCollectionRuleId\": \"[parameters('dcrResourceId')]\"\r\n                        },\r\n                        \"scope\": \"[concat('Microsoft.HybridCompute/machines/', parameters('resourceName'))]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"dcrResourceId\": {\r\n                      \"value\": \"[parameters('dcrResourceId')]\"\r\n                    },\r\n                    \"type\": {\r\n                      \"value\": \"[field('type')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2ea82cdd-f2e8-4500-af75-67a2e084ca74\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2ea82cdd-f2e8-4500-af75-67a2e084ca74\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1000 - Access Control Policy And Procedures Requirements\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Access Control control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.1\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1000\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2ef3cc79-733e-48ed-ab6f-7bf439e9b406\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2ef3cc79-733e-48ed-ab6f-7bf439e9b406\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Network Watcher flow logs should have traffic analytics enabled\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Traffic analytics analyzes Network Watcher network security group flow logs to provide insights into traffic flow in your Azure cloud. It can be used to visualize network activity across your Azure subscriptions and identify hot spots, identify security threats, understand traffic flow patterns, pinpoint network misconfigurations and more.\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkWatchers/flowLogs\"\r\n              },\r\n              {\r\n                \"anyof\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled\",\r\n                    \"equals\": false\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.trafficAnalyticsInterval\",\r\n                    \"notin\": [\r\n                      \"10\",\r\n                      \"60\"\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2f080164-9f4d-497e-9db6-416dc9f7b48a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2f080164-9f4d-497e-9db6-416dc9f7b48a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Microsoft Managed Control 1519 - Personnel Termination\",\r\n        \"policyType\": \"Static\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Microsoft implements this Personnel Security control\",\r\n        \"metadata\": {\r\n          \"version\": \"1.0.0\",\r\n          \"category\": \"Regulatory Compliance\",\r\n          \"additionalMetadataId\": \"/providers/Microsoft.PolicyInsights/policyMetadata/ACF1519\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Resources/subscriptions\",\r\n                  \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n                ]\r\n              },\r\n              {\r\n                \"value\": \"false\",\r\n                \"equals\": \"true\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2f13915a-324c-4ab8-b45c-2eefeeefb098\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2f13915a-324c-4ab8-b45c-2eefeeefb098\"\r\n    }\r\n  ],\r\n  \"nextLink\": \"https://management.azure.com/providers/Microsoft.Authorization/policyDefinitions?api-version=2021-06-01&$skiptoken=eyJuZXh0UG9saWN5U3RvcmUiOiJDb250cm9sUGxhbmVCdWlsdEluRGVmaW5pdGlvbiIsImNhY2hlU2tpcFRva2VuIjp7Im5leHRJbmRleCI6NTAwLCJuZXh0UG9saWN5TmFtZSI6IjJmMjA0ZTcyLTE4OTYtM2JmOC03NWM5LTkxMjhiODY4M2EzNiIsImNhY2hlTGVuZ3RoIjoyNjQyfX0%3D\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "//providers/Microsoft.Management/managementGroups/azsmnet9706/providers/Microsoft.Authorization/policyAssignments/azsmnet7785?api-version=2022-06-01",
      "EncodedRequestUri": "Ly9wcm92aWRlcnMvTWljcm9zb2Z0Lk1hbmFnZW1lbnQvbWFuYWdlbWVudEdyb3Vwcy9henNtbmV0OTcwNi9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDc3ODU/YXBpLXZlcnNpb249MjAyMi0wNi0wMQ==",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignmentAtManagementGroup Policy Assignment\",\r\n    \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0004bbf0-5099-4179-869e-e9ffe5fb0945\"\r\n  }\r\n}",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "364c9fba-99bf-4e85-97e1-d341de67e172"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.700.22.51102",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.22621",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.17.4.0"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "229"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "Server": [
          "Kestrel"
        ],
        "x-ms-ratelimit-remaining-tenant-writes": [
          "1199"
        ],
        "x-ms-request-id": [
          "04eb3475-d0d0-4d89-b8fa-f4fc8cfd1719"
        ],
        "x-ms-correlation-request-id": [
          "04eb3475-d0d0-4d89-b8fa-f4fc8cfd1719"
        ],
        "x-ms-routing-request-id": [
          "WESTCENTRALUS:20221117T033411Z:04eb3475-d0d0-4d89-b8fa-f4fc8cfd1719"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 17 Nov 2022 03:34:11 GMT"
        ],
        "Content-Length": [
          "924"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignmentAtManagementGroup Policy Assignment\",\r\n    \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0004bbf0-5099-4179-869e-e9ffe5fb0945\",\r\n    \"scope\": \"/providers/Microsoft.Management/managementGroups/azsmnet9706\",\r\n    \"metadata\": {\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2022-11-17T03:34:11.0397278Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"enforcementMode\": \"Default\"\r\n  },\r\n  \"id\": \"/providers/Microsoft.Management/managementGroups/azsmnet9706/providers/Microsoft.Authorization/policyAssignments/azsmnet7785\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet7785\",\r\n  \"systemData\": {\r\n    \"createdBy\": \"0dbeb0b7-4e61-4e1f-8b58-d6fcca269d88\",\r\n    \"createdByType\": \"Application\",\r\n    \"createdAt\": \"2022-11-17T03:34:10.955143Z\",\r\n    \"lastModifiedBy\": \"0dbeb0b7-4e61-4e1f-8b58-d6fcca269d88\",\r\n    \"lastModifiedByType\": \"Application\",\r\n    \"lastModifiedAt\": \"2022-11-17T03:34:10.955143Z\"\r\n  }\r\n}",
      "StatusCode": 201
    },
    {
      "RequestUri": "//providers/Microsoft.Management/managementGroups/azsmnet9706/providers/Microsoft.Authorization/policyAssignments/azsmnet7785?api-version=2022-06-01",
      "EncodedRequestUri": "Ly9wcm92aWRlcnMvTWljcm9zb2Z0Lk1hbmFnZW1lbnQvbWFuYWdlbWVudEdyb3Vwcy9henNtbmV0OTcwNi9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDc3ODU/YXBpLXZlcnNpb249MjAyMi0wNi0wMQ==",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "4493138c-f2e9-4a32-b947-4154a5e7b290"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.700.22.51102",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.22621",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.17.4.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "Server": [
          "Kestrel"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-request-id": [
          "8eafa186-5c87-4847-8d57-4bc671e752ab"
        ],
        "x-ms-correlation-request-id": [
          "8eafa186-5c87-4847-8d57-4bc671e752ab"
        ],
        "x-ms-routing-request-id": [
          "WESTCENTRALUS:20221117T033411Z:8eafa186-5c87-4847-8d57-4bc671e752ab"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 17 Nov 2022 03:34:11 GMT"
        ],
        "Content-Length": [
          "924"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignmentAtManagementGroup Policy Assignment\",\r\n    \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0004bbf0-5099-4179-869e-e9ffe5fb0945\",\r\n    \"scope\": \"/providers/Microsoft.Management/managementGroups/azsmnet9706\",\r\n    \"metadata\": {\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2022-11-17T03:34:11.0397278Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"enforcementMode\": \"Default\"\r\n  },\r\n  \"id\": \"/providers/Microsoft.Management/managementGroups/azsmnet9706/providers/Microsoft.Authorization/policyAssignments/azsmnet7785\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet7785\",\r\n  \"systemData\": {\r\n    \"createdBy\": \"0dbeb0b7-4e61-4e1f-8b58-d6fcca269d88\",\r\n    \"createdByType\": \"Application\",\r\n    \"createdAt\": \"2022-11-17T03:34:10.955143Z\",\r\n    \"lastModifiedBy\": \"0dbeb0b7-4e61-4e1f-8b58-d6fcca269d88\",\r\n    \"lastModifiedByType\": \"Application\",\r\n    \"lastModifiedAt\": \"2022-11-17T03:34:10.955143Z\"\r\n  }\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "//providers/Microsoft.Management/managementGroups/azsmnet9706/providers/Microsoft.Authorization/policyAssignments/azsmnet7785?api-version=2022-06-01",
      "EncodedRequestUri": "Ly9wcm92aWRlcnMvTWljcm9zb2Z0Lk1hbmFnZW1lbnQvbWFuYWdlbWVudEdyb3Vwcy9henNtbmV0OTcwNi9wcm92aWRlcnMvTWljcm9zb2Z0LkF1dGhvcml6YXRpb24vcG9saWN5QXNzaWdubWVudHMvYXpzbW5ldDc3ODU/YXBpLXZlcnNpb249MjAyMi0wNi0wMQ==",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "474a4800-08e5-4e8d-89a0-b9d4969ebc31"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.700.22.51102",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.22621",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/3.17.4.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "Server": [
          "Kestrel"
        ],
        "x-ms-ratelimit-remaining-tenant-deletes": [
          "14999"
        ],
        "x-ms-request-id": [
          "63bcf641-ff26-485b-925b-bfb9e5e5ff62"
        ],
        "x-ms-correlation-request-id": [
          "63bcf641-ff26-485b-925b-bfb9e5e5ff62"
        ],
        "x-ms-routing-request-id": [
          "WESTCENTRALUS:20221117T033412Z:63bcf641-ff26-485b-925b-bfb9e5e5ff62"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 17 Nov 2022 03:34:11 GMT"
        ],
        "Content-Length": [
          "924"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicyAssignmentAtManagementGroup Policy Assignment\",\r\n    \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0004bbf0-5099-4179-869e-e9ffe5fb0945\",\r\n    \"scope\": \"/providers/Microsoft.Management/managementGroups/azsmnet9706\",\r\n    \"metadata\": {\r\n      \"createdBy\": \"9d6d6799-f94d-4ccf-a96d-67761f19626b\",\r\n      \"createdOn\": \"2022-11-17T03:34:11.0397278Z\",\r\n      \"updatedBy\": null,\r\n      \"updatedOn\": null\r\n    },\r\n    \"enforcementMode\": \"Default\"\r\n  },\r\n  \"id\": \"/providers/Microsoft.Management/managementGroups/azsmnet9706/providers/Microsoft.Authorization/policyAssignments/azsmnet7785\",\r\n  \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n  \"name\": \"azsmnet7785\",\r\n  \"systemData\": {\r\n    \"createdBy\": \"0dbeb0b7-4e61-4e1f-8b58-d6fcca269d88\",\r\n    \"createdByType\": \"Application\",\r\n    \"createdAt\": \"2022-11-17T03:34:10.955143Z\",\r\n    \"lastModifiedBy\": \"0dbeb0b7-4e61-4e1f-8b58-d6fcca269d88\",\r\n    \"lastModifiedByType\": \"Application\",\r\n    \"lastModifiedAt\": \"2022-11-17T03:34:10.955143Z\"\r\n  }\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/providers/Microsoft.Management/managementGroups/azsmnet9706?api-version=2021-04-01",
      "EncodedRequestUri": "L3Byb3ZpZGVycy9NaWNyb3NvZnQuTWFuYWdlbWVudC9tYW5hZ2VtZW50R3JvdXBzL2F6c21uZXQ5NzA2P2FwaS12ZXJzaW9uPTIwMjEtMDQtMDE=",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "7788c390-937c-4a0b-8683-6957b693db5d"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Accept-Language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.700.22.51102",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.22621",
          "Microsoft.Azure.Management.ManagementGroups.ManagementGroupsAPIClient/1.1.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Location": [
          "https://management.azure.com/providers/Microsoft.Management/operationResults/delete/managementGroups/azsmnet9706?api-version=2021-04-01"
        ],
        "Retry-After": [
          "10"
        ],
        "Azure-AsyncOperation": [
          "https://management.azure.com/providers/Microsoft.Management/operationResults/delete/asyncOperation/status/managementGroups/azsmnet9706?api-version=2021-04-01"
        ],
        "x-ms-ratelimit-remaining-managementgroups-requests": [
          "59"
        ],
        "x-ms-request-id": [
          "westcentralus:507a7f23-f1a6-4270-bf1a-d7569e29fed0"
        ],
        "x-ba-restapi": [
          "0.0.0.0"
        ],
        "client-request-id": [
          "507a7f23-f1a6-4270-bf1a-d7569e29fed0"
        ],
        "request-id": [
          "507a7f23-f1a6-4270-bf1a-d7569e29fed0"
        ],
        "Server": [
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-ratelimit-remaining-tenant-deletes": [
          "14999"
        ],
        "x-ms-correlation-request-id": [
          "507a7f23-f1a6-4270-bf1a-d7569e29fed0"
        ],
        "x-ms-routing-request-id": [
          "WESTCENTRALUS:20221117T033413Z:507a7f23-f1a6-4270-bf1a-d7569e29fed0"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 17 Nov 2022 03:34:13 GMT"
        ],
        "Content-Length": [
          "159"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"id\": \"/providers/Microsoft.Management/managementGroups/azsmnet9706\",\r\n  \"type\": \"Microsoft.Management/managementGroups\",\r\n  \"name\": \"azsmnet9706\",\r\n  \"status\": \"NotStarted\"\r\n}",
      "StatusCode": 202
    },
    {
      "RequestUri": "/providers/Microsoft.Management/operationResults/delete/asyncOperation/status/managementGroups/azsmnet9706?api-version=2021-04-01",
      "EncodedRequestUri": "L3Byb3ZpZGVycy9NaWNyb3NvZnQuTWFuYWdlbWVudC9vcGVyYXRpb25SZXN1bHRzL2RlbGV0ZS9hc3luY09wZXJhdGlvbi9zdGF0dXMvbWFuYWdlbWVudEdyb3Vwcy9henNtbmV0OTcwNj9hcGktdmVyc2lvbj0yMDIxLTA0LTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "FxVersion/4.700.22.51102",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.22621",
          "Microsoft.Azure.Management.ManagementGroups.ManagementGroupsAPIClient/1.1.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westcentralus:cff7a75d-de74-4c99-ae24-7780d0b49bf4"
        ],
        "x-ba-restapi": [
          "0.0.0.0"
        ],
        "client-request-id": [
          "cff7a75d-de74-4c99-ae24-7780d0b49bf4"
        ],
        "request-id": [
          "cff7a75d-de74-4c99-ae24-7780d0b49bf4"
        ],
        "Server": [
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11998"
        ],
        "x-ms-correlation-request-id": [
          "cff7a75d-de74-4c99-ae24-7780d0b49bf4"
        ],
        "x-ms-routing-request-id": [
          "WESTCENTRALUS:20221117T033423Z:cff7a75d-de74-4c99-ae24-7780d0b49bf4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 17 Nov 2022 03:34:23 GMT"
        ],
        "Content-Length": [
          "157"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"id\": \"/providers/Microsoft.Management/operationResults/delete/asyncOperation/status/managementGroups/azsmnet9706\",\r\n  \"name\": \"azsmnet9706\",\r\n  \"status\": \"Succeeded\"\r\n}",
      "StatusCode": 200
    },
    {
      "RequestUri": "/providers/Microsoft.Management/operationResults/delete/managementGroups/azsmnet9706?api-version=2021-04-01",
      "EncodedRequestUri": "L3Byb3ZpZGVycy9NaWNyb3NvZnQuTWFuYWdlbWVudC9vcGVyYXRpb25SZXN1bHRzL2RlbGV0ZS9tYW5hZ2VtZW50R3JvdXBzL2F6c21uZXQ5NzA2P2FwaS12ZXJzaW9uPTIwMjEtMDQtMDE=",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "User-Agent": [
          "FxVersion/4.700.22.51102",
          "OSName/Windows",
          "OSVersion/Microsoft.Windows.10.0.22621",
          "Microsoft.Azure.Management.ManagementGroups.ManagementGroupsAPIClient/1.1.1.0"
        ]
      },
      "ResponseHeaders": {
        "Cache-Control": [
          "no-cache"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westcentralus:426cebbd-dcb1-4b86-9a2a-4b511c79b3b5"
        ],
        "x-ba-restapi": [
          "0.0.0.0"
        ],
        "client-request-id": [
          "426cebbd-dcb1-4b86-9a2a-4b511c79b3b5"
        ],
        "request-id": [
          "426cebbd-dcb1-4b86-9a2a-4b511c79b3b5"
        ],
        "Server": [
          "Microsoft-HTTPAPI/2.0"
        ],
        "x-ms-ratelimit-remaining-tenant-reads": [
          "11997"
        ],
        "x-ms-correlation-request-id": [
          "426cebbd-dcb1-4b86-9a2a-4b511c79b3b5"
        ],
        "x-ms-routing-request-id": [
          "WESTCENTRALUS:20221117T033423Z:426cebbd-dcb1-4b86-9a2a-4b511c79b3b5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ],
        "Date": [
          "Thu, 17 Nov 2022 03:34:23 GMT"
        ],
        "Content-Length": [
          "158"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ]
      },
      "ResponseBody": "{\r\n  \"id\": \"/providers/Microsoft.Management/managementGroups/azsmnet9706\",\r\n  \"type\": \"Microsoft.Management/managementGroups\",\r\n  \"name\": \"azsmnet9706\",\r\n  \"status\": \"Succeeded\"\r\n}",
      "StatusCode": 200
    }
  ],
  "Names": {
    "CanCrudPolicyAssignmentAtManagementGroup": [
      "azsmnet7785"
    ]
  },
  "Variables": {
    "SubscriptionId": "f67cc918-f64f-4c3f-aa24-a855465f9d41"
  }
}