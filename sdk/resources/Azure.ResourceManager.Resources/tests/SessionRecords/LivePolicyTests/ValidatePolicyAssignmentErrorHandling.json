{
  "Entries": [
    {
      "RequestUri": "https://management.azure.com/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/9500?api-version=2019-09-01",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Authorization": "Sanitized",
        "Content-Length": "251",
        "Content-Type": "application/json",
        "traceparent": "00-28a2b8a0c577214fa605af8dd511ff49-d01482a9bea16741-00",
        "User-Agent": [
          "azsdk-net-Management.Resources/1.0.0-dev.20200529.1",
          "(.NET Framework 4.8.4180.0; Microsoft Windows 10.0.19041 )"
        ],
        "x-ms-client-request-id": "6278d5e0a6042ed12667c492cd35141d",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": {
        "properties": {
          "displayName": "ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]",
          "policyRule": {
            "if": {
              "source": "action",
              "equals": "ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write"
            },
            "then": {
              "effect": "deny"
            }
          }
        }
      },
      "StatusCode": 201,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "612",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Fri, 29 May 2020 05:36:01 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "a6c89304-0097-41f4-b1d7-9be6ab29cb0a",
        "x-ms-ratelimit-remaining-subscription-writes": "1176",
        "x-ms-request-id": "koreasouth:c58e75e8-478d-4a44-a011-d339b4aef499",
        "x-ms-routing-request-id": "KOREASOUTH:20200529T053602Z:a6c89304-0097-41f4-b1d7-9be6ab29cb0a"
      },
      "ResponseBody": {
        "properties": {
          "displayName": "ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]",
          "policyType": "Custom",
          "mode": "Indexed",
          "metadata": {
            "createdBy": "30aa469e-e248-40b6-bc03-e320b05037b9",
            "createdOn": "2020-05-29T05:36:02.7257841Z",
            "updatedBy": null,
            "updatedOn": null
          },
          "policyRule": {
            "if": {
              "source": "action",
              "equals": "ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write"
            },
            "then": {
              "effect": "deny"
            }
          }
        },
        "id": "/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/9500",
        "type": "Microsoft.Authorization/policyDefinitions",
        "name": "9500"
      }
    },
    {
      "RequestUri": "https://management.azure.com//subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyAssignments/9526?api-version=2019-09-01",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Authorization": "Sanitized",
        "Content-Length": "162",
        "Content-Type": "application/json",
        "traceparent": "00-953973745599954888873f8cb9e229f5-09a8f4b287ba8b4f-00",
        "User-Agent": [
          "azsdk-net-Management.Resources/1.0.0-dev.20200529.1",
          "(.NET Framework 4.8.4180.0; Microsoft Windows 10.0.19041 )"
        ],
        "x-ms-client-request-id": "daee80f21118355c3016d8c5fa53139f",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": {
        "sku": {
          "name": "A0",
          "tier": "Free"
        },
        "properties": {
          "displayName": "ValidatePolicyAssignmentErrorHandling Bad Assignment - Missing Policy Definition Id [Auto Test]"
        }
      },
      "StatusCode": 400,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "219",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Fri, 29 May 2020 05:36:02 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "bcdf911d-0e08-41d7-b99e-310e14505c73",
        "x-ms-ratelimit-remaining-subscription-writes": "1175",
        "x-ms-request-id": "koreasouth:858b0306-0e07-464d-b093-aa9cb6238855",
        "x-ms-routing-request-id": "KOREASOUTH:20200529T053603Z:bcdf911d-0e08-41d7-b99e-310e14505c73"
      },
      "ResponseBody": "{\u0022error\u0022:{\u0022code\u0022:\u0022InvalidRequestContent\u0022,\u0022message\u0022:\u0022The request content was invalid and could not be deserialized: \u0027Required property \u0027policyDefinitionId\u0027 not found in JSON. Path \u0027properties\u0027, line 1, position 161.\u0027.\u0022}}"
    },
    {
      "RequestUri": "https://management.azure.com//subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyAssignments/9526?api-version=2019-09-01",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Authorization": "Sanitized",
        "Content-Length": "289",
        "Content-Type": "application/json",
        "traceparent": "00-f0379dd235d28c40912d1991b08646e0-b31c707e980aea4a-00",
        "User-Agent": [
          "azsdk-net-Management.Resources/1.0.0-dev.20200529.1",
          "(.NET Framework 4.8.4180.0; Microsoft Windows 10.0.19041 )"
        ],
        "x-ms-client-request-id": "70af6b6432efb9dc900e7286fcdebafc",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": {
        "sku": {
          "name": "A0",
          "tier": "Free"
        },
        "properties": {
          "displayName": "ValidatePolicyAssignmentErrorHandling Bad Assignment - Bad Policy Definition Id [Auto Test]",
          "policyDefinitionId": "/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/698"
        }
      },
      "StatusCode": 400,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "258",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Fri, 29 May 2020 05:36:02 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "9f5702af-0eae-4f9f-b329-1024cfd03c3f",
        "x-ms-ratelimit-remaining-subscription-writes": "1174",
        "x-ms-request-id": "koreasouth:4df1f1e1-5356-47e9-80b1-a79a7db0d6d6",
        "x-ms-routing-request-id": "KOREASOUTH:20200529T053603Z:9f5702af-0eae-4f9f-b329-1024cfd03c3f"
      },
      "ResponseBody": "{\u0022error\u0022:{\u0022code\u0022:\u0022PolicyDefinitionNotFound\u0022,\u0022message\u0022:\u0022The policy assignment create request is invalid. The policy definition \u0027/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/698\u0027 could not be found.\u0022}}"
    },
    {
      "RequestUri": "https://management.azure.com//subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyAssignments/9526?api-version=2019-09-01",
      "RequestMethod": "PUT",
      "RequestHeaders": {
        "Authorization": "Sanitized",
        "Content-Length": "280",
        "Content-Type": "application/json",
        "traceparent": "00-82e5dfdfb6afb942bb4ee3c8881b3128-f334dc8d04e3f648-00",
        "User-Agent": [
          "azsdk-net-Management.Resources/1.0.0-dev.20200529.1",
          "(.NET Framework 4.8.4180.0; Microsoft Windows 10.0.19041 )"
        ],
        "x-ms-client-request-id": "55724ea2c87e1cc42dd38ff9692c14b1",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": {
        "sku": {
          "name": "A2",
          "tier": "Free"
        },
        "properties": {
          "displayName": "ValidatePolicyAssignmentErrorHandling Bad Assignment - Bad Policy Sku [Auto Test]",
          "policyDefinitionId": "/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/9500"
        }
      },
      "StatusCode": 400,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "202",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Fri, 29 May 2020 05:36:02 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "a93c3849-4231-4f5e-bdae-1a96be552cfd",
        "x-ms-ratelimit-remaining-subscription-writes": "1173",
        "x-ms-request-id": "koreasouth:bb4bc06d-b629-4b57-b15f-8c90621c9ae6",
        "x-ms-routing-request-id": "KOREASOUTH:20200529T053603Z:a93c3849-4231-4f5e-bdae-1a96be552cfd"
      },
      "ResponseBody": "{\u0022error\u0022:{\u0022code\u0022:\u0022InvalidPolicySku\u0022,\u0022message\u0022:\u0022The policy assignment \u00279526\u0027 request is invalid. The supported SKUs are \u0027[{\\\u0022name\\\u0022:\\\u0022A0\\\u0022,\\\u0022tier\\\u0022:\\\u0022Free\\\u0022},{\\\u0022name\\\u0022:\\\u0022A1\\\u0022,\\\u0022tier\\\u0022:\\\u0022Standard\\\u0022}]\u0027.\u0022}}"
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/9500?api-version=2019-09-01",
      "RequestMethod": "DELETE",
      "RequestHeaders": {
        "Authorization": "Sanitized",
        "traceparent": "00-fcc48eadb1da2840b43ddf930dbedced-d612db3352a7da4d-00",
        "User-Agent": [
          "azsdk-net-Management.Resources/1.0.0-dev.20200529.1",
          "(.NET Framework 4.8.4180.0; Microsoft Windows 10.0.19041 )"
        ],
        "x-ms-client-request-id": "a9d0a6f21e6e4e0311208702e9af3338",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "612",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Fri, 29 May 2020 05:36:04 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "Vary": "Accept-Encoding",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "3cf14e00-1293-4a56-8570-aae7d6481cb3",
        "x-ms-ratelimit-remaining-subscription-deletes": "14887",
        "x-ms-request-id": "koreasouth:4509c690-d19b-4bfb-be21-ff1d1111c3a6",
        "x-ms-routing-request-id": "KOREASOUTH:20200529T053604Z:3cf14e00-1293-4a56-8570-aae7d6481cb3"
      },
      "ResponseBody": {
        "properties": {
          "displayName": "ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]",
          "policyType": "Custom",
          "mode": "Indexed",
          "metadata": {
            "createdBy": "30aa469e-e248-40b6-bc03-e320b05037b9",
            "createdOn": "2020-05-29T05:36:02.7257841Z",
            "updatedBy": null,
            "updatedOn": null
          },
          "policyRule": {
            "if": {
              "source": "action",
              "equals": "ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write"
            },
            "then": {
              "effect": "deny"
            }
          }
        },
        "id": "/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/9500",
        "type": "Microsoft.Authorization/policyDefinitions",
        "name": "9500"
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/9500?api-version=2019-09-01",
      "RequestMethod": "GET",
      "RequestHeaders": {
        "Authorization": "Sanitized",
        "traceparent": "00-8d1785c1cd102a46a2d8954c32940f19-bb15eda76f90ec4d-00",
        "User-Agent": [
          "azsdk-net-Management.Resources/1.0.0-dev.20200529.1",
          "(.NET Framework 4.8.4180.0; Microsoft Windows 10.0.19041 )"
        ],
        "x-ms-client-request-id": "0458c81e49a09ca8a792421ba3e35064",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": null,
      "StatusCode": 404,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "106",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Fri, 29 May 2020 05:36:04 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "03c5114a-552c-43fe-b48b-66f69b705040",
        "x-ms-ratelimit-remaining-subscription-reads": "11864",
        "x-ms-request-id": "koreasouth:f5af7bda-8ee2-475f-8d04-a7431f40d2d8",
        "x-ms-routing-request-id": "KOREASOUTH:20200529T053604Z:03c5114a-552c-43fe-b48b-66f69b705040"
      },
      "ResponseBody": "{\u0022error\u0022:{\u0022code\u0022:\u0022PolicyDefinitionNotFound\u0022,\u0022message\u0022:\u0022The policy definition \u00279500\u0027 could not be found.\u0022}}"
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions?api-version=2019-09-01",
      "RequestMethod": "GET",
      "RequestHeaders": {
        "Authorization": "Sanitized",
        "User-Agent": [
          "azsdk-net-Management.Resources/1.0.0-dev.20200529.1",
          "(.NET Framework 4.8.4180.0; Microsoft Windows 10.0.19041 )"
        ],
        "x-ms-client-request-id": "5693c0fa100e838e4b24435e40c1327e",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "1896888",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Fri, 29 May 2020 05:36:05 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "Vary": "Accept-Encoding",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "48e27a9f-129e-4d97-a846-cdcd8ec83555",
        "x-ms-ratelimit-remaining-subscription-reads": "11863",
        "x-ms-request-id": "koreasouth:1f272ee0-14af-4eef-a06b-d0a12b164c79",
        "x-ms-routing-request-id": "KOREASOUTH:20200529T053605Z:48e27a9f-129e-4d97-a846-cdcd8ec83555"
      },
      "ResponseBody": "{\u0022value\u0022:[{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1599 - Developer Configuration Management | Software / Firmware Integrity Verification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1599\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0004bbf0-5099-4179-869e-e9ffe5fb0945\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220004bbf0-5099-4179-869e-e9ffe5fb0945\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit virtual machines without disaster recovery configured\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Audit virtual machines which do not have disaster recovery configured. To learn more about disaster recovery, visit https://aka.ms/asr-doc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Resources/links\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022name\u0022,\u0022like\u0022:\u0022ASR-Protect-*\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220015ea4d-51ff-4ce3-8d8c-f3f8f0179a56\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Web Sockets state for a Function App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within an Function app must be carefully reviewed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022DisableWebSockets\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/001802d1-4969-4c82-a700-c29c6c6f9bbd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022001802d1-4969-4c82-a700-c29c6c6f9bbd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1375 - Incident Response Assistance | Automation Support For Availability Of Information / Support\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1375\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/00379355-8932-4b52-b63a-3bc6daf3451a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002200379355-8932-4b52-b63a-3bc6daf3451a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1605 - Developer Security Testing And Evaluation | Static Code Analysis\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1605\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0062eb8b-dc75-4718-8ea5-9bb4a9606655\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220062eb8b-dc75-4718-8ea5-9bb4a9606655\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Backup should be enabled for Virtual Machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy helps audit if Azure Backup service is enabled for all Virtual machines. Azure Backup is a cost-effective, one-click backup solution simplifies data recovery and is easier to enable than other cloud backup services.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Backup\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.RecoveryServices/backupprotecteditems\u0022}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/013e242c-8828-4970-87b3-ab247555486d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022013e242c-8828-4970-87b3-ab247555486d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1142 - Security Assessment And Authorization Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1142\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/01524fa8-4555-48ce-ba5f-c3b8dcef5147\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002201524fa8-4555-48ce-ba5f-c3b8dcef5147\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1099 - Security Training Records\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1099\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/01910bab-8639-4bd0-84ef-cc53b24d79ba\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002201910bab-8639-4bd0-84ef-cc53b24d79ba\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1285 - Telecommunications Services | Provider Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1285\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/01f7726b-db54-45c2-bcb5-9bd7a43796ee\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002201f7726b-db54-45c2-bcb5-9bd7a43796ee\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1709 - Security Function Verification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1709\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/025992d6-7fee-4137-9bbf-2ffc39c0686c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022025992d6-7fee-4137-9bbf-2ffc39c0686c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1052 - Session Lock\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1052\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/027cae1c-ec3e-4492-9036-4168d540c42a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022027cae1c-ec3e-4492-9036-4168d540c42a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1034 - Least Privilege\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1034\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/02a5ed00-6d2e-4e97-9a98-46c32c057329\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002202a5ed00-6d2e-4e97-9a98-46c32c057329\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs on which the remote host connection status does not match the specified one\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines on which the remote host connection status does not match the specified one. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsRemoteConnection\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/02a84be7-c304-421f-9bb7-5d2c26af54ad\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002202a84be7-c304-421f-9bb7-5d2c26af54ad\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1623 - Boundary Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1623\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/02ce1b22-412a-4528-8630-c42146f917ed\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002202ce1b22-412a-4528-8630-c42146f917ed\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1515 - Personnel Termination\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1515\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/02dd141a-a2b2-49a7-bcbd-ca31142f6211\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002202dd141a-a2b2-49a7-bcbd-ca31142f6211\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1327 - Authenticator Management | Password-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1327\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/03188d8f-1ae5-4fe1-974d-2d7d32ef937d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002203188d8f-1ae5-4fe1-974d-2d7d32ef937d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1229 - Information System Component Inventory | No Duplicate Accounting Of Components\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1229\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/03752212-103c-4ab8-a306-7e813022ca9d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002203752212-103c-4ab8-a306-7e813022ca9d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Cognitive Services accounts should restrict network access\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Network access to Cognitive Services accounts should be restricted. Configure network rules so only applications from allowed networks can access the Cognitive Services account. To allow connections from specific internet or on-premises clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Cognitive Services\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.CognitiveServices/accounts\u0022},{\u0022field\u0022:\u0022Microsoft.CognitiveServices/accounts/networkAcls.defaultAction\u0022,\u0022notEquals\u0022:\u0022Deny\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022037eea7a-bd0a-46c5-9a66-03aea78705d3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1123 - Audit Review, Analysis, And Reporting | Audit Level Adjustment\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1123\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/03996055-37a4-45a5-8b70-3f1caa45f87d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002203996055-37a4-45a5-8b70-3f1caa45f87d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1474 - Emergency Power | Long-Term Alternate Power Supply - Minimal Operational Capability\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1474\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/03ad326e-d7a1-44b1-9a76-e17492efc9e4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002203ad326e-d7a1-44b1-9a76-e17492efc9e4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1227 - Information System Component Inventory | Automated Unauthorized Component Detection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1227\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/03b78f5e-4877-4303-b0f4-eb6583f25768\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002203b78f5e-4877-4303-b0f4-eb6583f25768\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1361 - Incident Handling\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1361\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/03ed3be1-7276-4452-9a5d-e4168565ac67\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002203ed3be1-7276-4452-9a5d-e4168565ac67\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1594 - Developer Configuration Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1594\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/042ba2a1-8bb8-45f4-b080-c78cf62b90e9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022042ba2a1-8bb8-45f4-b080-c78cf62b90e9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Cosmos DB allowed locations\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy enables you to restrict the locations your organization can specify when deploying Azure Cosmos DB resources. Use to enforce your geo-compliance requirements.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Cosmos DB\u0022},\u0022parameters\u0022:{\u0022listOfAllowedLocations\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Allowed locations\u0022,\u0022description\u0022:\u0022The list of locations that can be specified when deploying Azure Cosmos DB resources.\u0022,\u0022strongType\u0022:\u0022location\u0022}},\u0022policyEffect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Policy Effect\u0022,\u0022description\u0022:\u0022The desired effect of the policy.\u0022},\u0022allowedValues\u0022:[\u0022deny\u0022,\u0022audit\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022deny\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DocumentDB/databaseAccounts\u0022},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/Locations[*]\u0022,\u0022where\u0022:{\u0022value\u0022:\u0022[replace(toLower(first(field(\u0027Microsoft.DocumentDB/databaseAccounts/Locations[*].locationName\u0027))), \u0027 \u0027, \u0027\u0027)]\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfAllowedLocations\u0027)]\u0022}},\u0022notEquals\u0022:\u0022[length(field(\u0027Microsoft.DocumentDB/databaseAccounts/Locations[*]\u0027))]\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027policyEffect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0473574d-2d43-4217-aefe-941fcdf7e684\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220473574d-2d43-4217-aefe-941fcdf7e684\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022SQL managed instance TDE protector should be encrypted with your own key\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Transparent Data Encryption (TDE) with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/managedInstances\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/managedInstances/encryptionProtector\u0022,\u0022name\u0022:\u0022current\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Sql/managedInstances/encryptionProtector/serverKeyType\u0022,\u0022equals\u0022:\u0022AzureKeyVault\u0022},{\u0022field\u0022:\u0022Microsoft.Sql/managedInstances/encryptionProtector/uri\u0022,\u0022notEquals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Sql/managedInstances/encryptionProtector/uri\u0022,\u0022exists\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022048248b0-55cd-46da-b1ff-39efd52db260\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network traffic data collection agent should be installed on Linux virtual machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Security Center uses the Microsoft Monitoring Dependency Agent to collect network traffic data from your Azure virtual machines to enable advanced network protection features such as traffic visualization on the network map, network hardening recommendations and specific network threats.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Monitoring\u0022,\u0022preview\u0022:\u0022true\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable Dependency Agent for Linux VMs monitoring\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002214.04.0-LTS\u0022,\u002214.04.1-LTS\u0022,\u002214.04.5-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002216.04-LTS\u0022,\u002216.04.0-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002218.04-LTS\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002212-SP2\u0022,\u002212-SP3\u0022,\u002212-SP4\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022CentOS\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022DependencyAgentLinux\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002204c4380f-3fae-46e8-96c9-30193528f602\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Service Bus to Log Analytics workspace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Service Bus to stream to a regional Log Analytics workspace when any Service Bus which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ServiceBus/namespaces\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.ServiceBus/namespaces/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022OperationalLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/04d53d87-841c-4f23-8a5b-21564380b55e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002204d53d87-841c-4f23-8a5b-21564380b55e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1572 - Acquisition Process\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1572\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/04f5fb00-80bb-48a9-a75b-4cb4d4c97c36\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002204f5fb00-80bb-48a9-a75b-4cb4d4c97c36\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Log Analytics agent for Linux VMs\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploy Log Analytics agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022listOfImageIdToInclude\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Linux OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude\u0027)]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002212*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002214.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002216.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002218.04*LTS\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Oracle\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Oracle-Linux\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227.*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022CentOS\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022OmsAgentForLinux\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022MMAExtension\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022,\u0022vmExtensionType\u0022:\u0022OmsAgentForLinux\u0022,\u0022vmExtensionTypeHandlerVersion\u0022:\u00221.7\u0022},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022apiVersion\u0022:\u00222018-06-01\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022typeHandlerVersion\u0022:\u0022[variables(\u0027vmExtensionTypeHandlerVersion\u0027)]\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{\u0022workspaceId\u0022:\u0022[reference(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).customerId]\u0022,\u0022stopOnMultipleConnections\u0022:\u0022true\u0022},\u0022protectedSettings\u0022:{\u0022workspaceKey\u0022:\u0022[listKeys(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).primarySharedKey]\u0022}}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for VM\u0027, \u0027: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/053d3325-282c-4e5c-b944-24faffd30d77\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022053d3325-282c-4e5c-b944-24faffd30d77\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1331 - Authenticator Management | Password-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1331\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/05460fe2-301f-4ed1-8174-d62c8bb92ff4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002205460fe2-301f-4ed1-8174-d62c8bb92ff4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Private endpoint should be enabled for PostgreSQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits PostgreSQL servers not configured to use a private endpoint. For more details, visit https://aka.ms/pgprivatelink.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforPostgreSQL/servers/privateEndpointConnections\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\u0022,\u0022equals\u0022:\u0022Approved\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0564d078-92f5-4f97-8398-b9f58a51f70b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220564d078-92f5-4f97-8398-b9f58a51f70b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Vulnerability Assessment settings for SQL server should contain an email address to receive scan reports\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Ensure that an email address is provided for the \u0027Send scan reports to\u0027 field in the Vulnerability Assessment settings. This email address receives scan result summary after a periodic scan runs on SQL servers.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/vulnerabilityAssessments\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/vulnerabilityAssessments/default.recurringScans.emails[*]\u0022,\u0022notEquals\u0022:\u0022\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022057d6cfe-9c4f-4a6d-bc60-14420ea1f1a9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Azure Data Lake Store should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Data Lake\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DataLakeStore/accounts\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022057ef27e-665e-4328-8ea3-04b3122bd9fb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1132 - Protection Of Audit Information | Audit Backup On Separate Physical Systems / Components\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1132\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/05938e10-cdbd-4a54-9b2b-1cbcfc141ad0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002205938e10-cdbd-4a54-9b2b-1cbcfc141ad0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1223 - Information System Component Inventory\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1223\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/05a1bb01-ad5a-49c1-aad3-b0c893b2ec3a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002205a1bb01-ad5a-49c1-aad3-b0c893b2ec3a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1640 - Transmission Confidentiality And Integrity\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1640\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/05a289ce-6a20-4b75-a0f3-dc8601b6acd0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002205a289ce-6a20-4b75-a0f3-dc8601b6acd0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1420 - Maintenance Personnel\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1420\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/05ae08cc-a282-413b-90c7-21a2c60b8404\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002205ae08cc-a282-413b-90c7-21a2c60b8404\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1658 - Secure Name / Address Resolution Service (Recursive Or Caching Resolver)\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1658\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/063b540e-4bdc-4e7a-a569-3a42ddf22098\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022063b540e-4bdc-4e7a-a569-3a42ddf22098\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1688 - Information System Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1688\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/063c3f09-e0f0-4587-8fd5-f4276fae675f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022063c3f09-e0f0-4587-8fd5-f4276fae675f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1332 - Authenticator Management | Password-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1332\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/068260be-a5e6-4b0a-a430-cd27071c226a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022068260be-a5e6-4b0a-a430-cd27071c226a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1455 - Physical Access Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1455\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/068a88d4-e520-434e-baf0-9005a8164e6a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022068a88d4-e520-434e-baf0-9005a8164e6a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit SQL DB Level Audit Setting\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Audit DB level audit setting for SQL databases\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022SQL\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022setting\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Setting\u0022},\u0022allowedValues\u0022:[\u0022enabled\u0022,\u0022disabled\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers/databases\u0022},{\u0022field\u0022:\u0022name\u0022,\u0022notEquals\u0022:\u0022master\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022AuditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/databases/auditingSettings\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Sql/auditingSettings.state\u0022,\u0022equals\u0022:\u0022[parameters(\u0027setting\u0027)]\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002206a78e20-9358-41c9-923c-fb736d382a12\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit VMs that do not use managed disks\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy audits VMs that do not use managed disks\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osDisk.uri\u0022,\u0022exists\u0022:\u0022True\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/VirtualMachineScaleSets\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\u0022,\u0022exists\u0022:\u0022True\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\u0022,\u0022exists\u0022:\u0022True\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002206a78e20-9358-41c9-923c-fb736d382a4d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1366 - Incident Handling | Information Correlation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1366\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/06c45c30-ae44-4f0f-82be-41331da911cc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002206c45c30-ae44-4f0f-82be-41331da911cc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1633 - Boundary Protection | Route Traffic To Authenticated Proxy Servers\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1633\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/07557aa0-e02f-4460-9a81-8ecd2fed601a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002207557aa0-e02f-4460-9a81-8ecd2fed601a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022CORS should not allow every resource to access your Function Apps\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Cross-Origin Resource Sharing (CORS) should not allow all domains to access your Function app. Allow only required domains to interact with your Function app.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.cors.allowedOrigins[*]\u0022,\u0022notEquals\u0022:\u0022*\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220820b7b9-23aa-4725-a1ce-ae4558f718e5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Log Analytics agent for Windows VMs\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploy Log Analytics agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022listOfImageIdToInclude\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Windows OS to add to scope\u0022,\u0022description\u0022:\u0022Example values: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude\u0027)]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022MicrosoftMonitoringAgent\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022MMAExtension\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022,\u0022vmExtensionType\u0022:\u0022MicrosoftMonitoringAgent\u0022,\u0022vmExtensionTypeHandlerVersion\u0022:\u00221.0\u0022},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022apiVersion\u0022:\u00222018-06-01\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022typeHandlerVersion\u0022:\u0022[variables(\u0027vmExtensionTypeHandlerVersion\u0027)]\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{\u0022workspaceId\u0022:\u0022[reference(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).customerId]\u0022,\u0022stopOnMultipleConnections\u0022:\u0022true\u0022},\u0022protectedSettings\u0022:{\u0022workspaceKey\u0022:\u0022[listKeys(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).primarySharedKey]\u0022}}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for VM\u0027, \u0027: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220868462e-646c-4fe3-9ced-a733534b6a2c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1583 - Information System Documentation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1583\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0882d488-8e80-4466-bc0f-0cd15b6cb66d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220882d488-8e80-4466-bc0f-0cd15b6cb66d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Web Applications that are not using latest supported PHP Framework\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use the latest supported PHP version for the latest security classes. Using older classes and types can make your application vulnerable.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022WebApp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UseLatestPHP\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/08b17839-76c6-4015-90e0-33d9d54d219c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002208b17839-76c6-4015-90e0-33d9d54d219c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Search Services to Log Analytics workspace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Search Services to stream to a regional Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Search/searchServices\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Search/searchServices/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022OperationLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/08ba64b8-738f-4918-9686-730d2ed79c7d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002208ba64b8-738f-4918-9686-730d2ed79c7d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Adaptive Network Hardening recommendations should be applied on internet facing virtual machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Azure Security Center analyzes the traffic patterns of Internet facing virtual machines and provides Network Security Group rule recommendations that reduce the potential attack surface\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022adaptiveNetworkHardenings\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002208e6af2d-db70-460a-bfe9-d5bd474ba9d6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022There should be more than one owner assigned to your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022It is recommended to designate more than one subscription owner in order to have administrator access redundancy.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022DesignateMoreThanOneOwner\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002209024ccc-0c5f-475e-9457-b7c0d9ed487b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1159 - Security Authorization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1159\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0925f098-7877-450b-8ba4-d1e55f2d8795\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220925f098-7877-450b-8ba4-d1e55f2d8795\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Disk encryption should be applied on virtual machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022VMs without an enabled disk encryption will be monitored by Azure Security Center as recommendations\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022encryption\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220961003e-5a0a-4549-abde-af6a37f2724d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1302 - Identification And Authentication (Org. Users) | Network Access To Non-Privileged Accounts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1302\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/09828c65-e323-422b-9774-9d5c646124da\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002209828c65-e323-422b-9774-9d5c646124da\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Configure backup on VMs of a location to an existing central Vault in the same location\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy configures Azure Backup protection on VMs in a given location to an existing central vault in the same location. It applies to only those VMs that are not already configured for backup. It is recommended that this policy is assigned to not more than 200 VMs. If the policy is assigned for more than 200 VMs, it can result in the backup getting triggered a few hours beyond the defined schedule. This policy will be enhanced to support more VM images.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Backup\u0022},\u0022parameters\u0022:{\u0022vaultLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Location (Specify the location of the VMs that you want to protect)\u0022,\u0022description\u0022:\u0022Specify the location of the VMs that you want to protect. VMs should be backed up to a vault in the same location.\\nFor example - southeastasia\u0022,\u0022strongType\u0022:\u0022location\u0022}},\u0022backupPolicyId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Backup Policy (of type Azure VM from a vault in the location chosen above)\u0022,\u0022description\u0022:\u0022Specify the id of the Azure backup policy to configure backup of the virtual machines. The selected Azure backup policy should be of type Azure virtual machine. This policy needs to be in a vault that is present in the location chosen above.\\nFor example - /subscriptions/\u003CSubscriptionId\u003E/resourceGroups/\u003CresourceGroupName\u003E/providers/Microsoft.RecoveryServices/vaults/\u003CVaultName\u003E/backupPolicies/\u003CBackupPolicyName\u003E\u0022,\u0022strongType\u0022:\u0022Microsoft.RecoveryServices/vaults/backupPolicies\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022deployIfNotExists\u0022,\u0022auditIfNotExists\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022deployIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027vaultLocation\u0027)]\u0022},{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002212*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002214.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002216.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002218.04*LTS\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Oracle\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Oracle-Linux\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227.*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022CentOS\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/5e467623-bb1f-42f4-a55d-6e525e11384b\u0022],\u0022type\u0022:\u0022Microsoft.RecoveryServices/backupprotecteditems\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022backupPolicyId\u0022:{\u0022type\u0022:\u0022String\u0022},\u0022fabricName\u0022:{\u0022type\u0022:\u0022String\u0022},\u0022protectionContainers\u0022:{\u0022type\u0022:\u0022String\u0022},\u0022protectedItems\u0022:{\u0022type\u0022:\u0022String\u0022},\u0022sourceResourceId\u0022:{\u0022type\u0022:\u0022String\u0022}},\u0022resources\u0022:[{\u0022apiVersion\u0022:\u00222017-05-10\u0022,\u0022name\u0022:\u0022[concat(\u0027DeployProtection-\u0027,uniqueString(parameters(\u0027protectedItems\u0027)))]\u0022,\u0022type\u0022:\u0022Microsoft.Resources/deployments\u0022,\u0022resourceGroup\u0022:\u0022[first(skip(split(parameters(\u0027backupPolicyId\u0027), \u0027/\u0027), 4))]\u0022,\u0022subscriptionId\u0022:\u0022[first(skip(split(parameters(\u0027backupPolicyId\u0027), \u0027/\u0027), 2))]\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022Incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022backupPolicyId\u0022:{\u0022type\u0022:\u0022String\u0022},\u0022fabricName\u0022:{\u0022type\u0022:\u0022String\u0022},\u0022protectionContainers\u0022:{\u0022type\u0022:\u0022String\u0022},\u0022protectedItems\u0022:{\u0022type\u0022:\u0022String\u0022},\u0022sourceResourceId\u0022:{\u0022type\u0022:\u0022String\u0022}},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.RecoveryServices/vaults/backupFabrics/protectionContainers/protectedItems\u0022,\u0022name\u0022:\u0022[concat(first(skip(split(parameters(\u0027backupPolicyId\u0027), \u0027/\u0027), 8)), \u0027/\u0027, parameters(\u0027fabricName\u0027), \u0027/\u0027,parameters(\u0027protectionContainers\u0027), \u0027/\u0027, parameters(\u0027protectedItems\u0027))]\u0022,\u0022apiVersion\u0022:\u00222016-06-01\u0022,\u0022properties\u0022:{\u0022protectedItemType\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022policyId\u0022:\u0022[parameters(\u0027backupPolicyId\u0027)]\u0022,\u0022sourceResourceId\u0022:\u0022[parameters(\u0027sourceResourceId\u0027)]\u0022}}]},\u0022parameters\u0022:{\u0022backupPolicyId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027backupPolicyId\u0027)]\u0022},\u0022fabricName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027fabricName\u0027)]\u0022},\u0022protectionContainers\u0022:{\u0022value\u0022:\u0022[parameters(\u0027protectionContainers\u0027)]\u0022},\u0022protectedItems\u0022:{\u0022value\u0022:\u0022[parameters(\u0027protectedItems\u0027)]\u0022},\u0022sourceResourceId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027sourceResourceId\u0027)]\u0022}}}}]},\u0022parameters\u0022:{\u0022backupPolicyId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027backupPolicyId\u0027)]\u0022},\u0022fabricName\u0022:{\u0022value\u0022:\u0022Azure\u0022},\u0022protectionContainers\u0022:{\u0022value\u0022:\u0022[concat(\u0027iaasvmcontainer;iaasvmcontainerv2;\u0027, resourceGroup().name, \u0027;\u0027 ,field(\u0027name\u0027))]\u0022},\u0022protectedItems\u0022:{\u0022value\u0022:\u0022[concat(\u0027vm;iaasvmcontainerv2;\u0027, resourceGroup().name, \u0027;\u0027 ,field(\u0027name\u0027))]\u0022},\u0022sourceResourceId\u0022:{\u0022value\u0022:\u0022[concat(\u0027/subscriptions/\u0027, subscription().subscriptionId, \u0027/resourceGroups/\u0027, resourceGroup().name, \u0027/providers/Microsoft.Compute/virtualMachines/\u0027,field(\u0027name\u0027))]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/09ce66bc-1220-4153-8104-e3f51c936913\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002209ce66bc-1220-4153-8104-e3f51c936913\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Private endpoint should be enabled for MariaDB servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits MariaDB servers not configured to use a private endpoint. For more details, visit https://aka.ms/mariadbprivatelink.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMariaDB/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforMariaDB/servers/privateEndpointConnections\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforMariaDB/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\u0022,\u0022equals\u0022:\u0022Approved\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0a1302fb-a631-4106-9753-f3d494733990\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220a1302fb-a631-4106-9753-f3d494733990\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1654 - Voice Over Internet Protocol\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1654\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0a2ee16e-ab1f-414a-800b-d1608835862b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220a2ee16e-ab1f-414a-800b-d1608835862b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1402 - Controlled Maintenance | Automated Maintenance Activities\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1402\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0a560d32-8075-4fec-9615-9f7c853f4ea9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220a560d32-8075-4fec-9615-9f7c853f4ea9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1428 - Media Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1428\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0a77fcc7-b8d8-451a-ab52-56197913c0c7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220a77fcc7-b8d8-451a-ab52-56197913c0c7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit resource location matches resource group location\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit that the resource location matches its resource group location\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022General\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022notIn\u0022:[\u0022[resourcegroup().location]\u0022,\u0022global\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220a914e76-4921-4c19-b460-a2d36003525a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027System Audit Policies - Account Management\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Account Management\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesAccountManagement\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SystemAuditPoliciesAccountManagement\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0a9991e6-21be-49f9-8916-a06d934bcf29\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220a9991e6-21be-49f9-8916-a06d934bcf29\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1044 - Unsuccessful Logon Attempts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1044\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0abbac52-57cf-450d-8408-1208d0dd9e90\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220abbac52-57cf-450d-8408-1208d0dd9e90\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1253 - Contingency Plan | Resume Essential Missions / Business Functions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1253\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0afce0b3-dd9f-42bb-af28-1e4284ba8311\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220afce0b3-dd9f-42bb-af28-1e4284ba8311\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Email notification to subscription owner for high severity alerts should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enable emailing security alerts to the subscription owner, in order to have them receive security alert emails from Microsoft. This ensures that they are aware of any potential security issues and can mitigate the risk in a timely fashion\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/securityContacts\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/securityContacts/alertsToAdmins\u0022,\u0022notEquals\u0022:\u0022Off\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220b15565f-aa9e-48ba-8619-45960f2c314d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1046 - Automatic Account Lock | Purge / Wipe Mobile Device\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1046\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0b1aa965-7502-41f9-92be-3e2fe7cc392a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220b1aa965-7502-41f9-92be-3e2fe7cc392a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1020 - Account Management | Role-Based Schemes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1020\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0b291ee8-3140-4cad-beb7-568c077c78ce\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220b291ee8-3140-4cad-beb7-568c077c78ce\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Key Vault objects should be recoverable\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits if key vault objects are not recoverable. Soft Delete feature helps to effectively hold the resources for a given retention period (90 days) even after a DELETE operation, while giving the appearance that the object is deleted. When \u0027Purge protection\u0027 is on, a vault or an object in deleted state cannot be purged until the retention period of 90 days has passed. These vaults and objects can still be recovered, assuring customers that the retention policy will be followed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Key Vault\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.KeyVault/vaults\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.KeyVault/vaults/enableSoftDelete\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.KeyVault/vaults/enablePurgeProtection\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.KeyVault/vaults/enableSoftDelete\u0022,\u0022equals\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.KeyVault/vaults/enablePurgeProtection\u0022,\u0022equals\u0022:\u0022false\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220b60c0b2-2dc2-4e1c-b5c9-abbed971de53\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1115 - Audit Review, Analysis, And Reporting\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1115\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0b653845-2ad9-4e09-a4f3-5a7c1d78353d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220b653845-2ad9-4e09-a4f3-5a7c1d78353d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Cosmos DB throughput should be limited\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy enables you to restrict the maximum throughput your organization can specify when creating Azure Cosmos DB databases and containers through the resource provider. It blocks the creation of autoscale resources.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Cosmos DB\u0022},\u0022parameters\u0022:{\u0022throughputMax\u0022:{\u0022type\u0022:\u0022Integer\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Max RUs\u0022,\u0022description\u0022:\u0022The maximum throughput (RU/s) that can be assigned to a container via the Resource Provider during create or update.\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Policy Effect\u0022,\u0022description\u0022:\u0022The desired effect of the policy.\u0022},\u0022allowedValues\u0022:[\u0022audit\u0022,\u0022deny\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022deny\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022like\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/*/throughputSettings\u0022},{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.DocumentDB/databaseAccounts/sqlDatabases\u0022,\u0022Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers\u0022,\u0022Microsoft.DocumentDB/databaseAccounts/mongodbDatabases\u0022,\u0022Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections\u0022,\u0022Microsoft.DocumentDB/databaseAccounts/gremlinDatabases\u0022,\u0022Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs\u0022,\u0022Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces\u0022,\u0022Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables\u0022,\u0022Microsoft.DocumentDB/databaseAccounts/tables\u0022]}]},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[requestContext().apiVersion]\u0022,\u0022less\u0022:\u00222019-08-01\u0022},{\u0022value\u0022:\u0022[if(equals(field(\u0027Microsoft.DocumentDB/databaseAccounts/sqlDatabases/options.throughput\u0027), \u0027\u0027), 0, int(field(\u0027Microsoft.DocumentDB/databaseAccounts/sqlDatabases/options.throughput\u0027)))]\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/sqlDatabases/options\u0022,\u0022containsKey\u0022:\u0022ProvisionedThroughputSettings\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/sqlDatabases/throughputSettings/default.resource.throughput\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/sqlDatabases/throughputSettings/default.resource.provisionedThroughputSettings\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022value\u0022:\u0022[if(equals(field(\u0027Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/options.throughput\u0027), \u0027\u0027), 0, int(field(\u0027Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/options.throughput\u0027)))]\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/options\u0022,\u0022containsKey\u0022:\u0022ProvisionedThroughputSettings\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/throughputSettings/default.resource.throughput\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers/throughputSettings/default.resource.provisionedThroughputSettings\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022value\u0022:\u0022[if(equals(field(\u0027Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/options.throughput\u0027), \u0027\u0027), 0, int(field(\u0027Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/options.throughput\u0027)))]\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/options\u0022,\u0022containsKey\u0022:\u0022ProvisionedThroughputSettings\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/throughputSettings/default.resource.throughput\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/throughputSettings/default.resource.provisionedThroughputSettings\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022value\u0022:\u0022[if(equals(field(\u0027Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/options.throughput\u0027), \u0027\u0027), 0, int(field(\u0027Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/options.throughput\u0027)))]\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/options\u0022,\u0022containsKey\u0022:\u0022ProvisionedThroughputSettings\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/throughputSettings/default.resource.throughput\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/cassandraKeyspaces/tables/throughputSettings/default.resource.provisionedThroughputSettings\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022value\u0022:\u0022[if(equals(field(\u0027Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/options.throughput\u0027), \u0027\u0027), 0, int(field(\u0027Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/options.throughput\u0027)))]\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/options\u0022,\u0022containsKey\u0022:\u0022ProvisionedThroughputSettings\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/throughputSettings/default.resource.throughput\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/throughputSettings/default.resource.provisionedThroughputSettings\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022value\u0022:\u0022[if(equals(field(\u0027Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/options.throughput\u0027), \u0027\u0027), 0, int(field(\u0027Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/options.throughput\u0027)))]\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/options\u0022,\u0022containsKey\u0022:\u0022ProvisionedThroughputSettings\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/throughputSettings/default.resource.throughput\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/gremlinDatabases/graphs/throughputSettings/default.resource.provisionedThroughputSettings\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022value\u0022:\u0022[if(equals(field(\u0027Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/options.throughput\u0027), \u0027\u0027), 0, int(field(\u0027Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/options.throughput\u0027)))]\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/options\u0022,\u0022containsKey\u0022:\u0022ProvisionedThroughputSettings\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/throughputSettings/default.resource.throughput\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/throughputSettings/default.resource.provisionedThroughputSettings\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022value\u0022:\u0022[if(equals(field(\u0027Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/options.throughput\u0027), \u0027\u0027), 0, int(field(\u0027Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/options.throughput\u0027)))]\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/options\u0022,\u0022containsKey\u0022:\u0022ProvisionedThroughputSettings\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/throughputSettings/default.resource.throughput\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/mongodbDatabases/collections/throughputSettings/default.resource.provisionedThroughputSettings\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022value\u0022:\u0022[if(equals(field(\u0027Microsoft.DocumentDB/databaseAccounts/tables/options.throughput\u0027), \u0027\u0027), 0, int(field(\u0027Microsoft.DocumentDB/databaseAccounts/tables/options.throughput\u0027)))]\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/tables/options\u0022,\u0022containsKey\u0022:\u0022ProvisionedThroughputSettings\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/tables/throughputSettings/default.resource.throughput\u0022,\u0022greater\u0022:\u0022[parameters(\u0027throughputMax\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/tables/throughputSettings/default.resource.provisionedThroughputSettings\u0022,\u0022exists\u0022:\u0022true\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0b7ef78e-a035-4f23-b9bd-aff122a1b1cf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220b7ef78e-a035-4f23-b9bd-aff122a1b1cf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1239 - User-Installed Software\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1239\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0be51298-f643-4556-88af-d7db90794879\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220be51298-f643-4556-88af-d7db90794879\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure API app has \u0027Client Certificates (Incoming client certificates)\u0027 set to \u0027On\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/clientCertEnabled\u0022,\u0022equals\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0c192fe8-9cbb-4516-85b3-0ade8bd03886\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220c192fe8-9cbb-4516-85b3-0ade8bd03886\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1496 - System Security Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1496\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0ca96127-2f87-46ab-a4fc-0d2a786df1c8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220ca96127-2f87-46ab-a4fc-0d2a786df1c8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022SQL server TDE protector should be encrypted with your own key\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Transparent Data Encryption (TDE) with your own key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/encryptionProtector\u0022,\u0022name\u0022:\u0022current\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Sql/servers/encryptionProtector/serverKeyType\u0022,\u0022equals\u0022:\u0022AzureKeyVault\u0022},{\u0022field\u0022:\u0022Microsoft.Sql/servers/encryptionProtector/uri\u0022,\u0022notEquals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Sql/servers/encryptionProtector/uri\u0022,\u0022exists\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220d134df8-db83-46fb-ad72-fe0c9428c8dd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1518 - Personnel Termination\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1518\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0d58f734-c052-40e9-8b2f-a1c2bff0b815\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220d58f734-c052-40e9-8b2f-a1c2bff0b815\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1713 - Software, Firmware, And Information Integrity | Integrity Checks\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1713\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0d87c70b-5012-48e9-994b-e70dd4b8def0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220d87c70b-5012-48e9-994b-e70dd4b8def0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1466 - Visitor Access Records\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1466\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0d943a9c-a6f1-401f-a792-740cdb09c451\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220d943a9c-a6f1-401f-a792-740cdb09c451\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Show audit results from Windows VMs on which Windows Defender Exploit Guard is not enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines on which Windows Defender Exploit Guard is not enabled. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022deprecated\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsDefenderExploitGuard\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0d9b45ff-9ddd-43fc-bf59-fbd1c8423053\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220d9b45ff-9ddd-43fc-bf59-fbd1c8423053\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Managed identity should be used in your Function App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Use a managed identity for enhanced authentication security\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/managedServiceIdentityId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220da106f2-4ca3-48e8-bc85-c638fe6aea8f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1718 - Software, Firmware, And Information Integrity | Binary Or Machine Executable Code\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1718\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0dced7ab-9ce5-4137-93aa-14c13e06ab17\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220dced7ab-9ce5-4137-93aa-14c13e06ab17\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Authorized IP ranges should be defined on Kubernetes Services\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Restrict access to the Kubernetes Service Management API by granting API access only to IP addresses in specific ranges. It is recommended to limit access to authorized IP ranges to ensure that only applications from allowed networks can access the cluster.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-preview\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/apiServerAccessProfile.authorizedIPRanges\u0022,\u0022exists\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220e246bcf-5f6f-4f87-bc6f-775d4712c7ea\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Remote debugging should be turned off for Function Apps\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Remote debugging requires inbound ports to be opened on function apps. Remote debugging should be turned off.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.remoteDebuggingEnabled\u0022,\u0022equals\u0022:\u0022false\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220e60b895-3786-45da-8377-9c6b4b6ac5f9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Geo-redundant backup should be enabled for Azure Database for MariaDB\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Azure Database for MariaDB with geo-redundant backup not enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMariaDB/servers\u0022},{\u0022field\u0022:\u0022Microsoft.DBforMariaDB/servers/storageProfile.geoRedundantBackup\u0022,\u0022notEquals\u0022:\u0022Enabled\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0ec47710-77ff-4a3d-9181-6aa50af424d0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220ec47710-77ff-4a3d-9181-6aa50af424d0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to enable Guest Configuration Policy on Windows VMs.\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a system-assigned managed identity and deploys the VM extension for Guest Configuration on Windows VMs. This is a prerequisite for Guest Configuration Policy and must be assigned to the scope before using any Guest Configuration policy. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022name\u0022:\u0022AzurePolicyforWindows\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.GuestConfiguration\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022ConfigurationforWindows\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}}}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0ecd903d-91e7-4726-83d3-a229d7f2e293\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220ecd903d-91e7-4726-83d3-a229d7f2e293\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1601 - Developer Security Testing And Evaluation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1601\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0ee79a0c-addf-4ce9-9b3c-d9576ed5e20e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220ee79a0c-addf-4ce9-9b3c-d9576ed5e20e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Azure Spring Cloud instances where distributed tracing is not enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Distributed tracing tools in Azure Spring Cloud allow debugging and monitoring the complex interconnections between microservices in an application. Distributed tracing tools should be enabled and in a healthy state.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022App Platform\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.AppPlatform/Spring\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.AppPlatform/Spring/trace.enabled\u0022,\u0022notEquals\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.AppPlatform/Spring/trace.state\u0022,\u0022notEquals\u0022:\u0022Succeeded\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0f2d8593-4667-4932-acca-6a9f187af109\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220f2d8593-4667-4932-acca-6a9f187af109\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1476 - Fire Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1476\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0f3c4ac2-3e35-4906-a80b-473b12a622d7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220f3c4ac2-3e35-4906-a80b-473b12a622d7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1204 - Access Restrictions For Change | Review System Changes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1204\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0f4f6750-d1ab-4a4c-8dfd-af3237682665\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220f4f6750-d1ab-4a4c-8dfd-af3237682665\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1430 - Media Marking\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1430\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0f559588-5e53-4b14-a7c4-85d28ebc2234\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220f559588-5e53-4b14-a7c4-85d28ebc2234\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1574 - Acquisition Process\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1574\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0f935dab-83d6-47b8-85ef-68b8584161b9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220f935dab-83d6-47b8-85ef-68b8584161b9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1164 - Continuous Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1164\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0fb8d3ce-9e96-481c-9c68-88d4e3019310\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220fb8d3ce-9e96-481c-9c68-88d4e3019310\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1017 - Account Management | Inactivity Logout\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1017\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0fc3db37-e59a-48c1-84e9-1780cedb409e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220fc3db37-e59a-48c1-84e9-1780cedb409e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1087 - Security Awareness And Training Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1087\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/100c82ba-42e9-4d44-a2ba-94b209248583\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022100c82ba-42e9-4d44-a2ba-94b209248583\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs that do not contain the specified certificates in Trusted Root\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022CertificateThumbprints\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Certificate thumbprints\u0022,\u0022description\u0022:\u0022A semicolon-separated list of certificate thumbprints that should exist under the Trusted Root certificate store (Cert:\\\\LocalMachine\\\\Root). e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsCertificateInTrustedRoot\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\u0027, \u0027=\u0027, parameters(\u0027CertificateThumbprints\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsCertificateInTrustedRoot\u0022},\u0022CertificateThumbprints\u0022:{\u0022value\u0022:\u0022[parameters(\u0027CertificateThumbprints\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022CertificateThumbprints\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027CertificateThumbprints\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027CertificateThumbprints\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/106ccbe4-a791-4f33-a44a-06796944b8d5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022106ccbe4-a791-4f33-a44a-06796944b8d5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1554 - Vulnerability Scanning | Discoverable Information\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1554\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/10984b4e-c93e-48d7-bf20-9c03b04e9eca\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002210984b4e-c93e-48d7-bf20-9c03b04e9eca\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027.NET Framework\u0027 version is the latest, if used as a part of the Function App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for .NET Framework software either due to security flaws or to include additional functionality. Using the latest .NET framework version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.netFrameworkVersion\u0022,\u0022in\u0022:[\u0022v3.0\u0022,\u0022v4.0\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/10c1859c-e1a7-4df3-ab97-a487fa8059f6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002210c1859c-e1a7-4df3-ab97-a487fa8059f6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Custom subscription owner roles should not exist\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy ensures that no custom subscription owner roles exist.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022General\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Authorization/roleDefinitions\u0022},{\u0022field\u0022:\u0022Microsoft.Authorization/roleDefinitions/type\u0022,\u0022equals\u0022:\u0022CustomRole\u0022},{\u0022anyOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Authorization/roleDefinitions/permissions[*].actions[*]\u0022,\u0022notEquals\u0022:\u0022*\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Authorization/roleDefinitions/permissions.actions[*]\u0022,\u0022notEquals\u0022:\u0022*\u0022}}]},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Authorization/roleDefinitions/assignableScopes[*]\u0022,\u0022notIn\u0022:[\u0022[concat(subscription().id,\u0027/\u0027)]\u0022,\u0022[subscription().id]\u0022,\u0022/\u0022]}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Authorization/roleDefinitions/assignableScopes[*]\u0022,\u0022notLike\u0022:\u0022/providers/Microsoft.Management/*\u0022}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/10ee2ea2-fb4d-45b8-a7e9-a2e770044cd9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002210ee2ea2-fb4d-45b8-a7e9-a2e770044cd9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1230 - Configuration Management Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1230\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/11158848-f679-4e9b-aa7b-9fb07d945071\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002211158848-f679-4e9b-aa7b-9fb07d945071\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1432 - Media Storage\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1432\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1140e542-b80d-4048-af45-3f7245be274b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221140e542-b80d-4048-af45-3f7245be274b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit Dependency agent deployment - VM Image (OS) unlisted\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022listOfImageIdToInclude_windows\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Windows OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]},\u0022listOfImageIdToInclude_linux\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Linux OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022not\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude_windows\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude_linux\u0027)]\u0022},{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002212-SP2\u0022,\u002212-SP3\u0022,\u002212-SP4\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002214.04.0-LTS\u0022,\u002214.04.1-LTS\u0022,\u002214.04.5-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002216.04-LTS\u0022,\u002216.04.0-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002218.04-LTS\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022Centos\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/11ac78e3-31bc-4f0c-8434-37ab963cea07\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002211ac78e3-31bc-4f0c-8434-37ab963cea07\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1655 - Voice Over Internet Protocol\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1655\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/121eab72-390e-4629-a7e2-6d6184f57c6b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022121eab72-390e-4629-a7e2-6d6184f57c6b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Whitelisting rules in your adaptive application control policy should be updated\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Monitor for changes in behavior on groups of machines configured for auditing by Azure Security Center\u0027s adaptive application controls. Security Center uses machine learning to analyze the running processes on your machines and suggest a list of known-safe applications. These are presented as recommended apps to whitelist in adaptive application control policies.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022applicationWhitelistingUpdate\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/123a3936-f020-408a-ba0c-47873faf1534\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022123a3936-f020-408a-ba0c-47873faf1534\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1681 - Malicious Code Protection | Automatic Updates\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1681\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/12623e7e-4736-4b2e-b776-c1600f35f93a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002212623e7e-4736-4b2e-b776-c1600f35f93a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1240 - User-Installed Software\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1240\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/129eb39f-d79a-4503-84cd-92f036b5e429\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022129eb39f-d79a-4503-84cd-92f036b5e429\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - System objects\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - System objects\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsSystemobjects\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsSystemobjects\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/12ae2d24-3805-4b37-9fa9-465968bfbcfa\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002212ae2d24-3805-4b37-9fa9-465968bfbcfa\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1666 - System And Information Integrity Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1666\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/12e30ee3-61e6-4509-8302-a871e8ebb91e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002212e30ee3-61e6-4509-8302-a871e8ebb91e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs that do not have the specified applications installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022installedApplication\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Application names (supports wildcards)\u0022,\u0022description\u0022:\u0022A semicolon-separated list of the names of the applications that should be installed. e.g. \u0027Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code\u0027 or \u0027Microsoft SQL Server 2014*\u0027 (to match any application starting with \u0027Microsoft SQL Server 2014\u0027)\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WhitelistedApplication\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[InstalledApplication]bwhitelistedapp;Name\u0027, \u0027=\u0027, parameters(\u0027installedApplication\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WhitelistedApplication\u0022},\u0022installedApplication\u0022:{\u0022value\u0022:\u0022[parameters(\u0027installedApplication\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022installedApplication\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[InstalledApplication]bwhitelistedapp;Name\u0022,\u0022value\u0022:\u0022[parameters(\u0027installedApplication\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[InstalledApplication]bwhitelistedapp;Name\u0022,\u0022value\u0022:\u0022[parameters(\u0027installedApplication\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/12f7e5d0-42a7-4630-80d8-54fb7cff9bd6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002212f7e5d0-42a7-4630-80d8-54fb7cff9bd6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1347 - Identification And Authentication (Non-Org. Users) | Acceptance Of PIV Creds. From Other Agys.\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1347\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/131a2706-61e9-4916-a164-00e052056462\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022131a2706-61e9-4916-a164-00e052056462\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1450 - Physical Access Authorizations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1450\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/134d7a13-ba3e-41e2-b236-91bfcfa24e01\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022134d7a13-ba3e-41e2-b236-91bfcfa24e01\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1184 - Configuration Change Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1184\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/13579d0e-0ab0-4b26-b0fb-d586f6d7ed20\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002213579d0e-0ab0-4b26-b0fb-d586f6d7ed20\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1085 - Publicly Accessible Content\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1085\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/13d117e0-38b0-4bbb-aaab-563be5dd10ba\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002213d117e0-38b0-4bbb-aaab-563be5dd10ba\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1404 - Maintenance Tools\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1404\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/13d8f903-0cd6-449f-a172-50f6579c182b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002213d8f903-0cd6-449f-a172-50f6579c182b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1695 - Information System Monitoring | Wireless Intrusion Detection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1695\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/13fcf812-ec82-4eda-9b89-498de9efd620\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002213fcf812-ec82-4eda-9b89-498de9efd620\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs in which the Administrators group contains any of the specified members\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group contains any of the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022MembersToExclude\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Members to exclude\u0022,\u0022description\u0022:\u0022A semicolon-separated list of members that should be excluded in the Administrators local group. Ex: Administrator; myUser1; myUser2\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AdministratorsGroupMembersToExclude\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[LocalGroup]AdministratorsGroup;MembersToExclude\u0027, \u0027=\u0027, parameters(\u0027MembersToExclude\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AdministratorsGroupMembersToExclude\u0022},\u0022MembersToExclude\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MembersToExclude\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MembersToExclude\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[LocalGroup]AdministratorsGroup;MembersToExclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027MembersToExclude\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[LocalGroup]AdministratorsGroup;MembersToExclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027MembersToExclude\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/144f1397-32f9-4598-8c88-118decc3ccba\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022144f1397-32f9-4598-8c88-118decc3ccba\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1157 - Plan Of Action And Milestones\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1157\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/15495367-cf68-464c-bbc3-f53ca5227b7a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002215495367-cf68-464c-bbc3-f53ca5227b7a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1491 - Security Planning Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1491\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1571dd40-dafc-4ef4-8f55-16eba27efc7b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221571dd40-dafc-4ef4-8f55-16eba27efc7b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1564 - System Development Life Cycle\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1564\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/157f0ef9-143f-496d-b8f9-f8c8eeaad801\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022157f0ef9-143f-496d-b8f9-f8c8eeaad801\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs that do not have a minimum password age of 1 day\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have a minimum password age of 1 day. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022MinimumPasswordAge\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022MinimumPasswordAge\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/16390df4-2f73-4b42-af13-c801066763df\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002216390df4-2f73-4b42-af13-c801066763df\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1662 - Fail In Known State\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1662\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/165cb91f-7ea8-4ab7-beaf-8636b98c9d15\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022165cb91f-7ea8-4ab7-beaf-8636b98c9d15\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1684 - Information System Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1684\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/16bfdb59-db38-47a5-88a9-2e9371a638cf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002216bfdb59-db38-47a5-88a9-2e9371a638cf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs that do not have the specified Windows PowerShell modules installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have the specified Windows PowerShell modules installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsPowerShellModules\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/16f9b37c-4408-4c30-bc17-254958f2e2d6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002216f9b37c-4408-4c30-bc17-254958f2e2d6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1103 - Audit Events\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1103\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/16feeb31-6377-437e-bbab-d7f73911896d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002216feeb31-6377-437e-bbab-d7f73911896d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1007 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1007\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/17200329-bf6c-46d8-ac6d-abf4641c2add\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002217200329-bf6c-46d8-ac6d-abf4641c2add\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1349 - Identification And Authentication (Non-Org. Users) | Use Of FICAM-Approved Products\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1349\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/17641f70-94cd-4a5d-a613-3d1143e20e34\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002217641f70-94cd-4a5d-a613-3d1143e20e34\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy associations for a managed application\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys an association resource that associates selected resource types to the specified managed application.  This policy deployment does not support nested resource types.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Managed Application\u0022},\u0022parameters\u0022:{\u0022targetManagedApplicationId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Managed application ID\u0022,\u0022description\u0022:\u0022Resource ID of the managed application to which resources need to be associated.\u0022}},\u0022resourceTypesToAssociate\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource types to associate\u0022,\u0022description\u0022:\u0022The list of resource types to be associated to the managed application.\u0022,\u0022strongType\u0022:\u0022resourceTypes\u0022}},\u0022associationNamePrefix\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Association name prefix\u0022,\u0022description\u0022:\u0022Prefix to be added to the name of the association resource being created.\u0022},\u0022defaultValue\u0022:\u0022DeployedByPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:\u0022[parameters(\u0027resourceTypesToAssociate\u0027)]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.CustomProviders/Associations\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027associationNamePrefix\u0027), \u0027-\u0027, uniqueString(parameters(\u0027targetManagedApplicationId\u0027)))]\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022associatedResourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022resourceTypesToAssociate\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022targetManagedApplicationId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022associationNamePrefix\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022resourceType\u0022:\u0022[concat(parameters(\u0027resourceTypesToAssociate\u0027), \u0027/providers/associations\u0027)]\u0022,\u0022resourceName\u0022:\u0022[concat(parameters(\u0027associatedResourceName\u0027), \u0027/microsoft.customproviders/\u0027, parameters(\u0027associationNamePrefix\u0027), \u0027-\u0027, uniqueString(parameters(\u0027targetManagedApplicationId\u0027)))]\u0022},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Resources/deployments\u0022,\u0022apiVersion\u0022:\u00222017-05-10\u0022,\u0022name\u0022:\u0022[concat(deployment().Name, \u0027-2\u0027)]\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022Incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022resources\u0022:[{\u0022type\u0022:\u0022[variables(\u0027resourceType\u0027)]\u0022,\u0022name\u0022:\u0022[variables(\u0027resourceName\u0027)]\u0022,\u0022apiVersion\u0022:\u00222018-09-01-preview\u0022,\u0022properties\u0022:{\u0022targetResourceId\u0022:\u0022[parameters(\u0027targetManagedApplicationId\u0027)]\u0022}}]}}}]},\u0022parameters\u0022:{\u0022resourceTypesToAssociate\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022associatedResourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022targetManagedApplicationId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027targetManagedApplicationId\u0027)]\u0022},\u0022associationNamePrefix\u0022:{\u0022value\u0022:\u0022[parameters(\u0027associationNamePrefix\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/17763ad9-70c0-4794-9397-53d765932634\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002217763ad9-70c0-4794-9397-53d765932634\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Transparent Data Encryption on SQL databases should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Transparent data encryption should be enabled to protect data-at-rest and meet compliance requirements\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers/databases\u0022},{\u0022field\u0022:\u0022name\u0022,\u0022notEquals\u0022:\u0022master\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/databases/transparentDataEncryption\u0022,\u0022name\u0022:\u0022current\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Sql/transparentDataEncryption.status\u0022,\u0022equals\u0022:\u0022enabled\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002217k78e20-9358-41c9-923c-fb736d382a12\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1325 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1325\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1845796a-7581-49b2-ae20-443121538e19\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221845796a-7581-49b2-ae20-443121538e19\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1480 - Temperature And Humidity Controls\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1480\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/18a767cc-1947-4338-a240-bc058c81164f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002218a767cc-1947-4338-a240-bc058c81164f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Bring your own key data protection should be enabled for PostgreSQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits PostgreSQL servers in your environment without bring your own key data protection enabled. For more details, visit https://aka.ms/postgresqlbyok.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforPostgreSQL/servers/keys\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/keys/serverKeyType\u0022,\u0022equals\u0022:\u0022AzureKeyVault\u0022},{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/keys/uri\u0022,\u0022notEquals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/keys/uri\u0022,\u0022exists\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002218adea5e-f416-4d0f-8aa8-d24321e3e274\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1369 - Incident Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1369\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/18cc35ed-a429-486d-8d59-cb47e87304ed\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002218cc35ed-a429-486d-8d59-cb47e87304ed\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1269 - Alternate Storage Site | Separation From Primary Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1269\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/19b9439d-865d-4474-b17d-97d2702fdb66\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002219b9439d-865d-4474-b17d-97d2702fdb66\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1071 - Wireless Access | Restrict Configurations By Users\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1071\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1a437f5b-9ad6-4f28-8861-de404d511ae4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221a437f5b-9ad6-4f28-8861-de404d511ae4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Monitor log profile should collect logs for categories \u0027write,\u0027 \u0027delete,\u0027 and \u0027action\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy ensures that a log profile collects logs for categories \u0027write,\u0027 \u0027delete,\u0027 and \u0027action\u0027\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/logprofiles\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/categories[*]\u0022,\u0022notEquals\u0022:\u0022Write\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/categories[*]\u0022,\u0022notEquals\u0022:\u0022Delete\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/categories[*]\u0022,\u0022notEquals\u0022:\u0022Action\u0022}}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1a4e592a-6a6e-44a5-9814-e36264ca96e7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221a4e592a-6a6e-44a5-9814-e36264ca96e7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Access to App Services should be restricted\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Azure security center has discovered that the networking configuration of some of your app services are overly permissive and allow inbound traffic from ranges that are too broad\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Disabled\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022restrictAccessToAppServices\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1a833ff1-d297-4a0f-9944-888428f8e0ff\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221a833ff1-d297-4a0f-9944-888428f8e0ff\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Vulnerability assessment should be enabled on your SQL managed instances\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit SQL managed instances which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/managedInstances\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/managedInstances/vulnerabilityAssessments\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/managedInstances/vulnerabilityAssessments/recurringScans.isEnabled\u0022,\u0022equals\u0022:\u0022True\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221b7aa243-30e4-4c9e-bca8-d0d3022b634a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027PHP version\u0027 is the latest, if used as a part of the Api app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for API apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022PHPLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Latest PHP version\u0022,\u0022description\u0022:\u0022Latest supported PHP version for App Services\u0022},\u0022defaultValue\u0022:\u00227.3\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022notContains\u0022:\u0022PHP\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.phpVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022[concat(\u0027PHP|\u0027, parameters(\u0027PHPLatestVersion\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.phpVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.phpVersion\u0022,\u0022equals\u0022:\u0022[parameters(\u0027PHPLatestVersion\u0027)]\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Dependency agent for Windows VMs\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploy Dependency agent for Windows VMs if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022listOfImageIdToInclude\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Windows OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude\u0027)]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022DependencyAgentWindows\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022DependencyAgent\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022,\u0022vmExtensionType\u0022:\u0022DependencyAgentWindows\u0022,\u0022vmExtensionTypeHandlerVersion\u0022:\u00229.6\u0022},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-06-01\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022typeHandlerVersion\u0022:\u0022[variables(\u0027vmExtensionTypeHandlerVersion\u0027)]\u0022,\u0022autoUpgradeMinorVersion\u0022:true}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for VM\u0027, \u0027: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1c210e94-a481-4beb-95fa-1571b434fb04\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221c210e94-a481-4beb-95fa-1571b434fb04\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1072 - Wireless Access | Antennas / Transmission Power Levels\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1072\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1ca29e41-34ec-4e70-aba9-6248aca18c31\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221ca29e41-34ec-4e70-aba9-6248aca18c31\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1656 - Secure Name / Address Resolution Service (Authoritative Source)\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1656\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1cb067d5-c8b5-4113-a7ee-0a493633924b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221cb067d5-c8b5-4113-a7ee-0a493633924b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1592 - External Information System Services | Consistent Interests Of Consumers And Providers\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1592\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1d01ba6c-289f-42fd-a408-494b355b6222\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221d01ba6c-289f-42fd-a408-494b355b6222\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1088 - Security Awareness And Training Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1088\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1d50f99d-1356-49c0-934a-45f742ba7783\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221d50f99d-1356-49c0-934a-45f742ba7783\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1538 - Security Categorization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1538\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1d7658b2-e827-49c3-a2ae-6d2bd0b45874\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221d7658b2-e827-49c3-a2ae-6d2bd0b45874\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Virtual machines should be migrated to new Azure Resource Manager resources\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use new Azure Resource Manager for your virtual machines to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.ClassicCompute/virtualMachines\u0022,\u0022Microsoft.Compute/virtualMachines\u0022]},{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022,\u0022equals\u0022:\u0022Microsoft.ClassicCompute/virtualMachines\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221d84d5fb-01f6-4d12-ba4f-4a26081d403d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1298 - Identification And Authentication Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1298\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1dc784b5-4895-4d27-9d40-a06b032bd1ee\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221dc784b5-4895-4d27-9d40-a06b032bd1ee\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit API Applications that are not using latest supported .NET Framework\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use the latest supported .NET Framework version for the latest security classes. Using older classes and types can make your application vulnerable.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022api\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022apiApp\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UseLatestDotNet\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1de7b11d-1870-41a5-8181-507e7c663cfb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221de7b11d-1870-41a5-8181-507e7c663cfb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1595 - Developer Configuration Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1595\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1e0414e7-6ef5-4182-8076-aa82fbb53341\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221e0414e7-6ef5-4182-8076-aa82fbb53341\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Require a tag and its value on resources\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Enforces a required tag and its value. Does not apply to resource groups.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}},\u0022tagValue\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Value\u0022,\u0022description\u0022:\u0022Value of the tag, such as \u0027production\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022equals\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221e30110a-5ceb-460c-a204-c1c3969c6d62\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022An Azure Active Directory administrator should be provisioned for SQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit provisioning of an Azure Active Directory administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/administrators\u0022}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221f314764-cb73-4fc9-b863-8eca98ac36e9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Event Hub to Log Analytics workspace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Event Hub to stream to a regional Log Analytics workspace when any Event Hub which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.EventHub/namespaces\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.EventHub/namespaces/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022ArchiveLogs\u0022,\u0022enabled\u0022:true,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}},{\u0022category\u0022:\u0022OperationalLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022AutoScaleLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022KafkaCoordinatorLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022EventHubVNetConnectionEvent\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022CustomerManagedKeyUserLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1f6e93e8-6b31-41b1-83f6-36e449a42579\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221f6e93e8-6b31-41b1-83f6-36e449a42579\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Shutdown\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Shutdown\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Shutdown: Allow system to be shut down without having to log on\u0022,\u0022description\u0022:\u0022Specifies whether a computer can be shut down when a user is not logged on. If this policy setting is enabled, the shutdown command is available on the Windows logon screen.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022ShutdownClearVirtualMemoryPagefile\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Shutdown: Clear virtual memory pagefile\u0022,\u0022description\u0022:\u0022Specifies whether the virtual memory pagefile is cleared when the system is shut down. When this policy setting is enabled, the system pagefile is cleared each time that the system shuts down properly. For systems with large amounts of RAM, this could result in substantial time needed to complete the shutdown.\u0022},\u0022defaultValue\u0022:\u00220\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsShutdown\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Shutdown: Allow system to be shut down without having to log on;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\u0027), \u0027,\u0027, \u0027Shutdown: Clear virtual memory pagefile;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027ShutdownClearVirtualMemoryPagefile\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsShutdown\u0022},\u0022ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\u0027)]\u0022},\u0022ShutdownClearVirtualMemoryPagefile\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ShutdownClearVirtualMemoryPagefile\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ShutdownClearVirtualMemoryPagefile\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Shutdown: Allow system to be shut down without having to log on;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\u0027)]\u0022},{\u0022name\u0022:\u0022Shutdown: Clear virtual memory pagefile;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ShutdownClearVirtualMemoryPagefile\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Shutdown: Allow system to be shut down without having to log on;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ShutdownAllowSystemToBeShutDownWithoutHavingToLogOn\u0027)]\u0022},{\u0022name\u0022:\u0022Shutdown: Clear virtual memory pagefile;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ShutdownClearVirtualMemoryPagefile\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1f8c20ce-3414-4496-8b26-0e902a1541da\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221f8c20ce-3414-4496-8b26-0e902a1541da\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1616 - System And Communications Protection Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1616\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2006457a-48b3-4f7b-8d2e-1532287f9929\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222006457a-48b3-4f7b-8d2e-1532287f9929\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1650 - Public Key Infrastructure Certificates\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1650\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/201d3740-bd16-4baf-b4b8-7cda352228b7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022201d3740-bd16-4baf-b4b8-7cda352228b7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Web ports should be restricted on Network Security Groups associated to your VM\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Azure security center has discovered that some of your virtual machines are running web applications, and the NSGs associated to these virtual machines are overly permissive with regards to the web application ports\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Disabled\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022unprotectedWebApplication\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022201ea587-7c90-41c3-910f-c280ae01cfd6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1181 - Baseline Configuration | Retention Of Previous Configurations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1181\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/21839937-d241-4fa5-95c6-b669253d9ab9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002221839937-d241-4fa5-95c6-b669253d9ab9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1111 - Response To Audit Processing Failures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1111\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/21de687c-f15e-4e51-bf8d-f35c8619965b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002221de687c-f15e-4e51-bf8d-f35c8619965b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1596 - Developer Configuration Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1596\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/21e25e01-0ae0-41be-919e-04ce92b8e8b8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002221e25e01-0ae0-41be-919e-04ce92b8e8b8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Audit\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Audit\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsAudit\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/21e2995e-683e-497a-9e81-2f42ad07050a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002221e2995e-683e-497a-9e81-2f42ad07050a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1426 - Media Protection Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1426\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/21f639bc-f42b-46b1-8f40-7a2a389c291a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002221f639bc-f42b-46b1-8f40-7a2a389c291a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit API Apps that are not using custom domains\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use of custom domains protects a API app from common attacks such as phishing and other DNS-related attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022api\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022apiApp\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UsedCustomDomains\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/224da9fe-0d38-4e79-adb3-0a6e2af942ac\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022224da9fe-0d38-4e79-adb3-0a6e2af942ac\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1399 - Controlled Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1399\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2256e638-eb23-480f-9e15-6cf1af0a76b3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222256e638-eb23-480f-9e15-6cf1af0a76b3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1221 - Least Functionality | Authorized Software / Whitelisting\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1221\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/22589a07-0007-486a-86ca-95355081ae2a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002222589a07-0007-486a-86ca-95355081ae2a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027System Audit Policies - Account Management\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Account Management\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesAccountManagement\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/225e937e-d32e-4713-ab74-13ce95b3519a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022225e937e-d32e-4713-ab74-13ce95b3519a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Management ports should be closed on your virtual machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Open remote management ports are exposing your VM to a high level of risk from Internet-based attacks. These attacks attempt to brute force credentials to gain admin access to the machine.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022restrictAccessToManagementPorts\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002222730e10-96f6-4aac-ad84-9383d35b5917\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1493 - System Security Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1493\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/22b469b3-fccf-42da-aa3b-a28e6fb113ce\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002222b469b3-fccf-42da-aa3b-a28e6fb113ce\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Only secure connections to your Redis Cache should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of only connections via SSL to Redis Cache. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Cache\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Cache/redis\u0022},{\u0022field\u0022:\u0022Microsoft.Cache/Redis/enableNonSslPort\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002222bee202-a82f-4305-9a2a-6d7f44d4dedb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs that do not restrict the minimum password length to 14 characters\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not restrict the minimum password length to 14 characters. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022MinimumPasswordLength\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022MinimumPasswordLength\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/23020aa6-1135-4be2-bae2-149982b06eca\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002223020aa6-1135-4be2-bae2-149982b06eca\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1256 - Contingency Plan | Identify Critical Assets\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1256\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/232ab24b-810b-4640-9019-74a7d0d6a980\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022232ab24b-810b-4640-9019-74a7d0d6a980\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Service Bus should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Service Bus not configured to use a virtual network service endpoint.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ServiceBus/namespaces\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.ServiceBus/namespaces/virtualNetworkRules\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.ServiceBus/namespaces/virtualNetworkRules/virtualNetworkSubnetId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/235359c5-7c52-4b82-9055-01c75cf9f60e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022235359c5-7c52-4b82-9055-01c75cf9f60e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Stream Analytics to stream to a regional Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.StreamAnalytics/streamingjobs\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022Execution\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Authoring\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/237e0f7e-b0e8-4ec4-ad46-8c12cb66d673\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022237e0f7e-b0e8-4ec4-ad46-8c12cb66d673\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1268 - Alternate Storage Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1268\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/23f6e984-3053-4dfc-ab48-543b764781f5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002223f6e984-3053-4dfc-ab48-543b764781f5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1122 - Audit Review, Analysis, And Reporting | Permitted Actions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1122\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/243ec95e-800c-49d4-ba52-1fdd9f6b8b57\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022243ec95e-800c-49d4-ba52-1fdd9f6b8b57\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1231 - Configuration Management Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1231\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/244e0c05-cc45-4fe7-bf36-42dcf01f457d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022244e0c05-cc45-4fe7-bf36-42dcf01f457d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1082 - Information Sharing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1082\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/24d480ef-11a0-4b1b-8e70-4e023bf2be23\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002224d480ef-11a0-4b1b-8e70-4e023bf2be23\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs that do not have a maximum password age of 70 days\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have a maximum password age of 70 days. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022MaximumPasswordAge\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/24dde96d-f0b1-425e-884f-4a1421e2dcdc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002224dde96d-f0b1-425e-884f-4a1421e2dcdc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Data Lake Storage Gen1 to Log Analytics workspace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Data Lake Storage Gen1 to stream to a regional Log Analytics workspace when any Data Lake Storage Gen1 which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DataLakeStore/accounts\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.DataLakeStore/accounts/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022Audit\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Requests\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/25763a0a-5783-4f14-969e-79d4933eb74b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002225763a0a-5783-4f14-969e-79d4933eb74b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1372 - Incident Reporting\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1372\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/25b96717-c912-4c00-9143-4e487f411726\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002225b96717-c912-4c00-9143-4e487f411726\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1038 - Least Privilege | Privileged Accounts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1038\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/26692e88-71b7-4a5f-a8ac-9f31dd05bd8e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002226692e88-71b7-4a5f-a8ac-9f31dd05bd8e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Endpoint protection solution should be installed on virtual machine scale sets\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit the existence and health of an endpoint protection solution on your virtual machines scale sets, to protect them from threats and vulnerabilities.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022EndpointProtection\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/26a828e1-e88f-464e-bbb3-c134a282b9de\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002226a828e1-e88f-464e-bbb3-c134a282b9de\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1649 - Collaborative Computing Devices\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1649\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/26d292cc-b0b8-4c29-9337-68abc758bf7b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002226d292cc-b0b8-4c29-9337-68abc758bf7b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Metric alert rules should be configured on Batch accounts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit configuration of metric alert rules on Batch account to enable the required metric\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Batch\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022metricName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Metric name\u0022,\u0022description\u0022:\u0022The metric name that an alert rule must be enabled on\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Batch/batchAccounts\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/alertRules\u0022,\u0022existenceScope\u0022:\u0022Subscription\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/alertRules/isEnabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/alertRules/condition.dataSource.metricName\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricName\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/alertRules/condition.dataSource.resourceUri\u0022,\u0022equals\u0022:\u0022[concat(\u0027/subscriptions/\u0027, subscription().subscriptionId, \u0027/resourcegroups/\u0027, resourceGroup().name, \u0027/providers/Microsoft.Batch/batchAccounts/\u0027, field(\u0027name\u0027))]\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/26ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002226ee67a2-f81a-4ba8-b9ce-8550bd5ee1a7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1396 - Controlled Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1396\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/276af98f-4ff9-4e69-99fb-c9b2452fb85f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022276af98f-4ff9-4e69-99fb-c9b2452fb85f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1074 - Access Control For Mobile Devices\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1074\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/27a69937-af92-4198-9b86-08d355c7e59a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002227a69937-af92-4198-9b86-08d355c7e59a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1527 - Access Agreements\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1527\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2823de66-332f-4bfd-94a3-3eb036cd3b67\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222823de66-332f-4bfd-94a3-3eb036cd3b67\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy default Microsoft IaaSAntimalware extension for Windows Server\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy deploys a Microsoft IaaSAntimalware extension with a default configuration when a VM is not configured with the antimalware extension.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022IaaSAntimalware\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Security\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ExclusionsPaths\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022Semicolon delimited list of file paths or locations to exclude from scanning\u0022}},\u0022ExclusionsExtensions\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022Semicolon delimited list of file extensions to exclude from scanning\u0022}},\u0022ExclusionsProcesses\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022Semicolon delimited list of process names to exclude from scanning\u0022}},\u0022RealtimeProtectionEnabled\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022true\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022Indicates whether or not real time protection is enabled (default is true)\u0022}},\u0022ScheduledScanSettingsIsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022false\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022Indicates whether or not custom scheduled scan settings are enabled (default is false)\u0022}},\u0022ScheduledScanSettingsScanType\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022Quick\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022Indicates whether scheduled scan setting type is set to Quick or Full (default is Quick)\u0022}},\u0022ScheduledScanSettingsDay\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u00227\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022Day of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)\u0022}},\u0022ScheduledScanSettingsTime\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022120\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022When to perform the scheduled scan, measured in minutes from midnight (0-1440). For example: 0 = 12AM, 60 = 1AM, 120 = 2AM.\u0022}}},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027),\u0027/IaaSAntimalware\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022apiVersion\u0022:\u00222017-12-01\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.Azure.Security\u0022,\u0022type\u0022:\u0022IaaSAntimalware\u0022,\u0022typeHandlerVersion\u0022:\u00221.3\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{\u0022AntimalwareEnabled\u0022:true,\u0022RealtimeProtectionEnabled\u0022:\u0022[parameters(\u0027RealtimeProtectionEnabled\u0027)]\u0022,\u0022ScheduledScanSettings\u0022:{\u0022isEnabled\u0022:\u0022[parameters(\u0027ScheduledScanSettingsIsEnabled\u0027)]\u0022,\u0022day\u0022:\u0022[parameters(\u0027ScheduledScanSettingsDay\u0027)]\u0022,\u0022time\u0022:\u0022[parameters(\u0027ScheduledScanSettingsTime\u0027)]\u0022,\u0022scanType\u0022:\u0022[parameters(\u0027ScheduledScanSettingsScanType\u0027)]\u0022},\u0022Exclusions\u0022:{\u0022Extensions\u0022:\u0022[parameters(\u0027ExclusionsExtensions\u0027)]\u0022,\u0022Paths\u0022:\u0022[parameters(\u0027ExclusionsPaths\u0027)]\u0022,\u0022Processes\u0022:\u0022[parameters(\u0027ExclusionsProcesses\u0027)]\u0022}}}}]},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022RealtimeProtectionEnabled\u0022:{\u0022value\u0022:\u0022true\u0022},\u0022ScheduledScanSettingsIsEnabled\u0022:{\u0022value\u0022:\u0022true\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222835b622-407b-4114-9198-6f7064cbe0dc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1342 - Authenticator Management | Hardware Token-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1342\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/283a4e29-69d5-4c94-b99e-29acf003c899\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022283a4e29-69d5-4c94-b99e-29acf003c899\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1436 - Media Transport\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1436\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/28aab8b4-74fd-4b7c-9080-5a7be525d574\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002228aab8b4-74fd-4b7c-9080-5a7be525d574\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1224 - Information System Component Inventory | Updates During Installations / Removals\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1224\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/28cfa30b-7f72-47ce-ba3b-eed26c8d2c82\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002228cfa30b-7f72-47ce-ba3b-eed26c8d2c82\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1148 - Security Assessments | Independent Assessors\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1148\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/28e62650-c7c2-4786-bdfa-17edc1673902\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002228e62650-c7c2-4786-bdfa-17edc1673902\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1418 - Nonlocal Maintenance | Comparable Security / Sanitization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1418\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/28e633fd-284e-4ea7-88b4-02ca157ed713\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002228e633fd-284e-4ea7-88b4-02ca157ed713\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1634 - Boundary Protection | Prevent Unauthorized Exfiltration\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1634\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/292a7c44-37fa-4c68-af7c-9d836955ded2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022292a7c44-37fa-4c68-af7c-9d836955ded2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - User Account Control\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - User Account Control\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsUserAccountControl\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/29829ec2-489d-4925-81b7-bda06b1718e0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002229829ec2-489d-4925-81b7-bda06b1718e0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Append a tag and its value to resources\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Appends the specified tag and value when any resource which is missing this tag is created or updated. Does not modify the tags of resources created before this policy was applied until those resources are changed. Does not apply to resource groups. New \u0027modify\u0027 effect policies are available that support remediation of tags on existing resources (see https://aka.ms/modifydoc).\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}},\u0022tagValue\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Value\u0022,\u0022description\u0022:\u0022Value of the tag, such as \u0027production\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022exists\u0022:\u0022false\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022append\u0022,\u0022details\u0022:[{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}]}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222a0e14a6-b0a6-4fab-991a-187a4f81c498\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1219 - Least Functionality | Authorized Software / Whitelisting\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1219\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2a39ac75-622b-4c88-9a3f-45b7373f7ef7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222a39ac75-622b-4c88-9a3f-45b7373f7ef7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1274 - Alternate Processing Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1274\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2aee175f-cd16-4825-939a-a85349d96210\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222aee175f-cd16-4825-939a-a85349d96210\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1603 - Developer Security Testing And Evaluation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1603\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2b909c26-162f-47ce-8e15-0c1f55632eac\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222b909c26-162f-47ce-8e15-0c1f55632eac\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Managed identity should be used in your Web App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Use a managed identity for enhanced authentication security\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/managedServiceIdentityId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222b9ad585-36bc-4615-b300-fd4435808332\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1434 - Media Transport\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1434\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2c18f06b-a68d-41c3-8863-b8cd3acb5f8f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222c18f06b-a68d-41c3-8863-b8cd3acb5f8f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1343 - Authenticator Management | Expiration Of Cached Authenticators\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1343\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2c251a55-31eb-4e53-99c6-e9c43c393ac2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222c251a55-31eb-4e53-99c6-e9c43c393ac2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1388 - Information Spillage Response\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1388\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2c7c575a-d4c5-4f6f-bd49-dee97a8cba55\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222c7c575a-d4c5-4f6f-bd49-dee97a8cba55\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1344 - Authenticator Feedback\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1344\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2c895fe7-2d8e-43a2-838c-3a533a5b355e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222c895fe7-2d8e-43a2-838c-3a533a5b355e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022SSH access from the Internet should be blocked\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy audits any network security rule that allows SSH access from Internet\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/access\u0022,\u0022equals\u0022:\u0022Allow\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/direction\u0022,\u0022equals\u0022:\u0022Inbound\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0022,\u0022equals\u0022:\u0022*\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0022,\u0022equals\u0022:\u002222\u0022},{\u0022value\u0022:\u0022[if(and(not(empty(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0027))), contains(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0027),\u0027-\u0027)), and(lessOrEquals(int(first(split(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0027), \u0027-\u0027))),22),greaterOrEquals(int(last(split(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0027), \u0027-\u0027))),22)), \u0027false\u0027)]\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0022,\u0022where\u0022:{\u0022value\u0022:\u0022[if(and(not(empty(first(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0027)))), contains(first(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0027)),\u0027-\u0027)), and(lessOrEquals(int(first(split(first(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0027)), \u0027-\u0027))),22),greaterOrEquals(int(last(split(first(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0027)), \u0027-\u0027))),22)) , \u0027false\u0027)]\u0022,\u0022equals\u0022:\u0022true\u0022}},\u0022greater\u0022:0},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0022,\u0022notEquals\u0022:\u0022*\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0022,\u0022notEquals\u0022:\u002222\u0022}}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\u0022,\u0022equals\u0022:\u0022*\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\u0022,\u0022equals\u0022:\u0022Internet\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\u0022,\u0022notEquals\u0022:\u0022*\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\u0022,\u0022notEquals\u0022:\u0022Internet\u0022}}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fab\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222c89a2e5-7285-40fe-afe0-ae8654b92fab\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Unattached disks should be encrypted\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any unattached disk without encryption enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/disks\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/disks/diskState\u0022,\u0022equals\u0022:\u0022Unattached\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/disks/encryptionSettingsCollection.enabled\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/disks/encryptionSettingsCollection.enabled\u0022,\u0022equals\u0022:\u0022false\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fb2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222c89a2e5-7285-40fe-afe0-ae8654b92fb2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1593 - External Information System Services | Processing, Storage, And Service Location\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1593\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2cd0a426-b5f5-4fe0-9539-a6043cdbc6fa\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222cd0a426-b5f5-4fe0-9539-a6043cdbc6fa\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1546 - Vulnerability Scanning\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1546\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2ce1ea7e-4038-4e53-82f4-63e8859333c1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222ce1ea7e-4038-4e53-82f4-63e8859333c1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1414 - Nonlocal Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1414\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2ce63a52-e47b-4ae2-adbb-6e40d967f9e6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222ce63a52-e47b-4ae2-adbb-6e40d967f9e6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1679 - Malicious Code Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1679\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2cf42a28-193e-41c5-98df-7688e7ef0a88\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222cf42a28-193e-41c5-98df-7688e7ef0a88\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1068 - Wireless Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1068\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2d045bca-a0fd-452e-9f41-4ec33769717c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222d045bca-a0fd-452e-9f41-4ec33769717c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022App Service should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any App Service not configured to use a virtual network service endpoint.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/virtualNetworkConnections\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/virtualnetworkconnections/vnetResourceId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2d21331d-a4c2-4def-a9ad-ee4e1e023beb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222d21331d-a4c2-4def-a9ad-ee4e1e023beb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1704 - Security Alerts, Advisories, And Directives\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1704\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2d44b6fa-1134-4ea6-ad4e-9edb68f65429\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222d44b6fa-1134-4ea6-ad4e-9edb68f65429\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs that do not store passwords using reversible encryption\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not store passwords using reversible encryption. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022StorePasswordsUsingReversibleEncryption\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2d60d3b7-aa10-454c-88a8-de39d99d17c6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222d60d3b7-aa10-454c-88a8-de39d99d17c6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Linux VMs that allow remote connections from accounts without passwords\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that allow remote connections from accounts without passwords. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022PasswordPolicy_msid110\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2d67222d-05fd-4526-a171-2ee132ad9e83\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222d67222d-05fd-4526-a171-2ee132ad9e83\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1077 - Use Of External Information Systems\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1077\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2dad3668-797a-412e-a798-07d3849a7a79\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222dad3668-797a-412e-a798-07d3849a7a79\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1149 - Security Assessments | Specialized Assessments\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1149\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2e1b855b-a013-481a-aeeb-2bcb129fd35d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222e1b855b-a013-481a-aeeb-2bcb129fd35d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1497 - System Security Plan | Plan / Coordinate With Other Organizational Entities\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1497\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2e3c5583-1729-4d36-8771-59c32f090a22\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222e3c5583-1729-4d36-8771-59c32f090a22\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1000 - Access Control Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1000\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2ef3cc79-733e-48ed-ab6f-7bf439e9b406\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222ef3cc79-733e-48ed-ab6f-7bf439e9b406\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1519 - Personnel Termination\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1519\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2f13915a-324c-4ab8-b45c-2eefeeefb098\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222f13915a-324c-4ab8-b45c-2eefeeefb098\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network traffic data collection agent should be installed on Windows virtual machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Security Center uses the Microsoft Monitoring Dependency Agent to collect network traffic data from your Azure virtual machines to enable advanced network protection features such as traffic visualization on the network map, network hardening recommendations and specific network threats.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Monitoring\u0022,\u0022preview\u0022:\u0022true\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable Dependency Agent for Windows VMs monitoring\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022DependencyAgentWindows\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2f2ee1de-44aa-4762-b6bd-0893fc3f306d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222f2ee1de-44aa-4762-b6bd-0893fc3f306d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1144 - Security Assessments\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1144\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2fa15ff1-a693-4ee4-b094-324818dc9a51\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222fa15ff1-a693-4ee4-b094-324818dc9a51\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1090 - Security Awareness Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1090\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2fb740e5-cbc7-4d10-8686-d1bf826652b1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222fb740e5-cbc7-4d10-8686-d1bf826652b1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Web Application should only be accessible over HTTPS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022WebApp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022OnlyHttpsForWebApplication\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2fde8a98-6892-426a-83ba-050e640c0ce0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222fde8a98-6892-426a-83ba-050e640c0ce0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Network Access\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Network Access\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsNetworkAccess\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/30040dab-4e75-4456-8273-14b8f75d91d9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002230040dab-4e75-4456-8273-14b8f75d91d9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs that are not joined to the specified domain\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that are not joined to the specified domain. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022DomainName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Domain Name (FQDN)\u0022,\u0022description\u0022:\u0022The fully qualified domain name (FQDN) that the Windows VMs should be joined to\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsDomainMembership\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[DomainMembership]WindowsDomainMembership;DomainName\u0027, \u0027=\u0027, parameters(\u0027DomainName\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsDomainMembership\u0022},\u0022DomainName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027DomainName\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022DomainName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[DomainMembership]WindowsDomainMembership;DomainName\u0022,\u0022value\u0022:\u0022[parameters(\u0027DomainName\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[DomainMembership]WindowsDomainMembership;DomainName\u0022,\u0022value\u0022:\u0022[parameters(\u0027DomainName\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/315c850a-272d-4502-8935-b79010405970\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022315c850a-272d-4502-8935-b79010405970\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1042 - Least Privilege | Auditing Use Of Privileged Functions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1042\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/319dc4f0-0fed-4ac9-8fc3-7aeddee82c07\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022319dc4f0-0fed-4ac9-8fc3-7aeddee82c07\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1698 - Information System Monitoring | Individuals Posing Greater Risk\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1698\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/31b752c1-05a9-432a-8fce-c39b56550119\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002231b752c1-05a9-432a-8fce-c39b56550119\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Log Analytics Agent Deployment - VM Image (OS) unlisted\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Reports VMs as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Monitoring\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022listOfImageIdToInclude_windows\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Optional: List of VM images that have supported Windows OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]},\u0022listOfImageIdToInclude_linux\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Optional: List of VM images that have supported Linux OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022not\u0022:{\u0022anyOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude_windows\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude_linux\u0027)]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002212*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002214.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002216.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002218.04*LTS\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Oracle\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Oracle-Linux\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227.*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022CentOS\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/32133ab0-ee4b-4b44-98d6-042180979d50\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002232133ab0-ee4b-4b44-98d6-042180979d50\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1587 - External Information System Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1587\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/32820956-9c6d-4376-934c-05cd8525be7c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002232820956-9c6d-4376-934c-05cd8525be7c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1333 - Authenticator Management | Pki-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1333\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3298d6bf-4bc6-4278-a95d-f7ef3ac6e594\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223298d6bf-4bc6-4278-a95d-f7ef3ac6e594\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs on which the specified services are not installed and \u0027Running\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines on which the specified services are not installed and \u0027Running\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022ServiceName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Service names (supports wildcards)\u0022,\u0022description\u0022:\u0022A semicolon-separated list of the names of the services that should be installed and \u0027Running\u0027. e.g. \u0027WinRm;Wi*\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsServiceStatus\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[WindowsServiceStatus]WindowsServiceStatus1;ServiceName\u0027, \u0027=\u0027, parameters(\u0027ServiceName\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsServiceStatus\u0022},\u0022ServiceName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ServiceName\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ServiceName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsServiceStatus]WindowsServiceStatus1;ServiceName\u0022,\u0022value\u0022:\u0022[parameters(\u0027ServiceName\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsServiceStatus]WindowsServiceStatus1;ServiceName\u0022,\u0022value\u0022:\u0022[parameters(\u0027ServiceName\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/32b1e4d4-6cd5-47b4-a935-169da8a5c262\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002232b1e4d4-6cd5-47b4-a935-169da8a5c262\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1445 - Physical And Environmental Protection Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1445\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/32d07d59-2716-4972-b37b-214a67ac4a37\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002232d07d59-2716-4972-b37b-214a67ac4a37\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022MySQL server should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits MySQL servers not configured to use a virtual network service endpoint. For more details, visit https://aka.ms/mysqlvnet.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMySQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforMySQL/servers/virtualNetworkRules\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforMySQL/servers/virtualNetworkRules/virtualNetworkSubnetId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3375856c-3824-4e0e-ae6a-79e011dd4c47\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223375856c-3824-4e0e-ae6a-79e011dd4c47\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1282 - Telecommunications Services | Single Points Of Failure\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1282\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/34042a97-ec6d-4263-93d2-8c1c46823b2a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002234042a97-ec6d-4263-93d2-8c1c46823b2a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Linux VMs that have accounts without passwords\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Linux virtual machines that have accounts without passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.2.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022PasswordPolicy_msid232\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022PasswordPolicy_msid232\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforLinux\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforLinux\u0022,\u0022typeHandlerVersion\u0022:\u00221.0\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3470477a-b35a-49db-aca5-1073d04524fe\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223470477a-b35a-49db-aca5-1073d04524fe\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1151 - System Interconnections\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1151\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/347e3b69-7fb7-47df-a8ef-71a1a7b44bca\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022347e3b69-7fb7-47df-a8ef-71a1a7b44bca\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1412 - Nonlocal Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1412\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3492d949-0dbb-4589-88b3-7b59601cc764\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223492d949-0dbb-4589-88b3-7b59601cc764\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1475 - Emergency Lighting\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1475\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/34a63848-30cf-4081-937e-ce1a1c885501\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002234a63848-30cf-4081-937e-ce1a1c885501\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1060 - Remote Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1060\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/34a987fd-2003-45de-a120-014956581f2b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002234a987fd-2003-45de-a120-014956581f2b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Storage accounts should restrict network access\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Network access to storage accounts should be restricted. Configure network rules so only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premise clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Storage\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Storage/storageAccounts\u0022},{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/networkAcls.defaultAction\u0022,\u0022notEquals\u0022:\u0022Deny\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002234c877ad-507e-4c82-993e-3452a6e0ad3c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1341 - Authenticator Management | Multiple Information System Accounts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1341\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/34cb7e92-fe4c-4826-b51e-8cd203fa5d35\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002234cb7e92-fe4c-4826-b51e-8cd203fa5d35\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Logic Apps should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Logic Apps\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Logic/workflows\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002234f95f76-5386-4de7-b824-0d8478470c9d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1210 - Configuration Settings\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1210\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3502c968-c490-4570-8167-1476f955e9b8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223502c968-c490-4570-8167-1476f955e9b8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs that do not have a maximum password age of 70 days\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have a maximum password age of 70 days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022MaximumPasswordAge\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022MaximumPasswordAge\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/356a906e-05e5-4625-8729-90771e0ee934\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022356a906e-05e5-4625-8729-90771e0ee934\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022CORS should not allow every resource to access your API App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Cross-Origin Resource Sharing (CORS) should not allow all domains to access your API app. Allow only required domains to interact with your API app.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.cors.allowedOrigins[*]\u0022,\u0022notEquals\u0022:\u0022*\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022358c20a6-3f9e-4f0e-97ff-c6ce485e2aac\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1659 - Architecture And Provisioning For Name / Address Resolution Service\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1659\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/35a4102f-a778-4a2e-98c2-971056288df8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002235a4102f-a778-4a2e-98c2-971056288df8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Gateway subnets should not be configured with a network security group\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy denies if a gateway subnet is configured with a network security group. Assigning a network security group to a gateway subnet will cause the gateway to stop functioning.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/virtualNetworks/subnets\u0022},{\u0022field\u0022:\u0022name\u0022,\u0022equals\u0022:\u0022GatewaySubnet\u0022},{\u0022field\u0022:\u0022Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\u0022,\u0022exists\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002235f9c03a-cc27-418e-9c0c-539ff999d010\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1043 - Least Privilege | Prohibit Non-Privileged Users From Executing Privileged Functions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1043\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/361a77f6-0f9c-4748-8eec-bc13aaaa2455\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022361a77f6-0f9c-4748-8eec-bc13aaaa2455\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Advanced Threat Protection on Storage Accounts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy enables Advanced Threat Protection on Storage Accounts.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Storage\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Storage/storageAccounts\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/advancedThreatProtectionSettings\u0022,\u0022name\u0022:\u0022current\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/advancedThreatProtectionSettings/isEnabled\u0022,\u0022equals\u0022:\u0022true\u0022},\u0022roleDefinitionIds\u0022:[\u0022/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022storageAccountName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022apiVersion\u0022:\u00222019-01-01\u0022,\u0022type\u0022:\u0022Microsoft.Storage/storageAccounts/providers/advancedThreatProtectionSettings\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027storageAccountName\u0027), \u0027/Microsoft.Security/current\u0027)]\u0022,\u0022properties\u0022:{\u0022isEnabled\u0022:true}}]},\u0022parameters\u0022:{\u0022storageAccountName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/361c2074-3595-4e5d-8cab-4f21dffc835c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022361c2074-3595-4e5d-8cab-4f21dffc835c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1313 - Identifier Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1313\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/36220f5b-79a1-4cdb-8c74-2d2449f9a510\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002236220f5b-79a1-4cdb-8c74-2d2449f9a510\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1630 - Boundary Protection | External Telecommunications Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1630\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3643717a-3897-4bfd-8530-c7c96b26b2a0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223643717a-3897-4bfd-8530-c7c96b26b2a0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Automation account variables should be encrypted\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022It is important to enable encryption of Automation account variable assets when storing sensitive data\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Automation\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Automation/automationAccounts/variables\u0022},{\u0022field\u0022:\u0022Microsoft.Automation/automationAccounts/variables/isEncrypted\u0022,\u0022notEquals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223657f5a0-770e-44a3-b44e-9431ba1e9735\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1339 - Authenticator Management | Protection Of Authenticators\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1339\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/367ae386-db7f-4167-b672-984ff86277c0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022367ae386-db7f-4167-b672-984ff86277c0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1685 - Information System Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1685\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/36b0ef30-366f-4b1b-8652-a3511df11f53\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002236b0ef30-366f-4b1b-8652-a3511df11f53\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Threat Detection on SQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy ensures that Threat Detection is enabled on SQL Servers.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022DeployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies\u0022,\u0022name\u0022:\u0022Default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/securityAlertPolicies.state\u0022,\u0022equals\u0022:\u0022Enabled\u0022},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022serverName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027serverName\u0027), \u0027/Default\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies\u0022,\u0022apiVersion\u0022:\u00222017-03-01-preview\u0022,\u0022properties\u0022:{\u0022state\u0022:\u0022Enabled\u0022,\u0022emailAccountAdmins\u0022:true}}]},\u0022parameters\u0022:{\u0022serverName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/36d49e87-48c4-4f2e-beed-ba4ed02b71f5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002236d49e87-48c4-4f2e-beed-ba4ed02b71f5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Network Security\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Network Security\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network Security: Configure encryption types allowed for Kerberos\u0022,\u0022description\u0022:\u0022Specifies the encryption types that Kerberos is allowed to use.\u0022},\u0022defaultValue\u0022:\u00222147483644\u0022},\u0022NetworkSecurityLANManagerAuthenticationLevel\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network security: LAN Manager authentication level\u0022,\u0022description\u0022:\u0022Specify which challenge-response authentication protocol is used for network logons. This choice affects the level of authentication protocol used by clients, the level of session security negotiated, and the level of authentication accepted by servers.\u0022},\u0022defaultValue\u0022:\u00225\u0022},\u0022NetworkSecurityLDAPClientSigningRequirements\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network security: LDAP client signing requirements\u0022,\u0022description\u0022:\u0022Specify the level of data signing that is requested on behalf of clients that issue LDAP BIND requests.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network security: Minimum session security for NTLM SSP based (including secure RPC) clients\u0022,\u0022description\u0022:\u0022Specifies which behaviors are allowed by clients for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services. See https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-minimum-session-security-for-ntlm-ssp-based-including-secure-rpc-servers for more information.\u0022},\u0022defaultValue\u0022:\u0022537395200\u0022},\u0022NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network security: Minimum session security for NTLM SSP based (including secure RPC) servers\u0022,\u0022description\u0022:\u0022Specifies which behaviors are allowed by servers for applications using the NTLM Security Support Provider (SSP). The SSP Interface (SSPI) is used by applications that need authentication services.\u0022},\u0022defaultValue\u0022:\u0022537395200\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsNetworkSecurity\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Network Security: Configure encryption types allowed for Kerberos;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\u0027), \u0027,\u0027, \u0027Network security: LAN Manager authentication level;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027NetworkSecurityLANManagerAuthenticationLevel\u0027), \u0027,\u0027, \u0027Network security: LDAP client signing requirements;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027NetworkSecurityLDAPClientSigningRequirements\u0027), \u0027,\u0027, \u0027Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\u0027), \u0027,\u0027, \u0027Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsNetworkSecurity\u0022},\u0022NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\u0027)]\u0022},\u0022NetworkSecurityLANManagerAuthenticationLevel\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityLANManagerAuthenticationLevel\u0027)]\u0022},\u0022NetworkSecurityLDAPClientSigningRequirements\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityLDAPClientSigningRequirements\u0027)]\u0022},\u0022NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\u0027)]\u0022},\u0022NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NetworkSecurityLANManagerAuthenticationLevel\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NetworkSecurityLDAPClientSigningRequirements\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Network Security: Configure encryption types allowed for Kerberos;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\u0027)]\u0022},{\u0022name\u0022:\u0022Network security: LAN Manager authentication level;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityLANManagerAuthenticationLevel\u0027)]\u0022},{\u0022name\u0022:\u0022Network security: LDAP client signing requirements;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityLDAPClientSigningRequirements\u0027)]\u0022},{\u0022name\u0022:\u0022Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\u0027)]\u0022},{\u0022name\u0022:\u0022Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Network Security: Configure encryption types allowed for Kerberos;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityConfigureEncryptionTypesAllowedForKerberos\u0027)]\u0022},{\u0022name\u0022:\u0022Network security: LAN Manager authentication level;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityLANManagerAuthenticationLevel\u0027)]\u0022},{\u0022name\u0022:\u0022Network security: LDAP client signing requirements;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityLDAPClientSigningRequirements\u0027)]\u0022},{\u0022name\u0022:\u0022Network security: Minimum session security for NTLM SSP based (including secure RPC) clients;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCClients\u0027)]\u0022},{\u0022name\u0022:\u0022Network security: Minimum session security for NTLM SSP based (including secure RPC) servers;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkSecurityMinimumSessionSecurityForNTLMSSPBasedIncludingSecureRPCServers\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/36e17963-7202-494a-80c3-f508211c826b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002236e17963-7202-494a-80c3-f508211c826b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1557 - Vulnerability Scanning | Review Historic Audit Logs\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1557\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/36fbe499-f2f2-41b6-880e-52d7ea1d94a5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002236fbe499-f2f2-41b6-880e-52d7ea1d94a5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Interactive Logon\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Interactive Logon\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsInteractiveLogon\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsInteractiveLogon\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3750712b-43d0-478e-9966-d2c26f6141b9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223750712b-43d0-478e-9966-d2c26f6141b9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1624 - Boundary Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1624\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/37d079e3-d6aa-4263-a069-dd7ac6dd9684\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002237d079e3-d6aa-4263-a069-dd7ac6dd9684\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Storage accounts should be migrated to new Azure Resource Manager resources\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use new Azure Resource Manager for your storage accounts to provide security enhancements such as: stronger access control (RBAC), better auditing, Azure Resource Manager based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Storage\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.ClassicStorage/storageAccounts\u0022,\u0022Microsoft.Storage/StorageAccounts\u0022]},{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022,\u0022equals\u0022:\u0022Microsoft.ClassicStorage/storageAccounts\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002237e0d2fe-28a5-43d6-a273-67d37d1f5606\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1335 - Authenticator Management | Pki-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1335\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/382016f3-d4ba-4e15-9716-55077ec4dc2a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022382016f3-d4ba-4e15-9716-55077ec4dc2a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in IoT Hub should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Internet of Things\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Devices/IotHubs\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022383856f8-de7f-44a2-81fc-e5135b5c2aa4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1081 - Information Sharing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1081\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3867f2a9-23bb-4729-851f-c3ad98580caf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223867f2a9-23bb-4729-851f-c3ad98580caf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1522 - Personnel Transfer\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1522\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/38b470cc-f939-4a15-80e0-9f0c74f2e2c9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002238b470cc-f939-4a15-80e0-9f0c74f2e2c9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1416 - Nonlocal Maintenance | Document Nonlocal Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1416\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/38dfd8a3-5290-4099-88b7-4081f4c4d8ae\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002238dfd8a3-5290-4099-88b7-4081f4c4d8ae\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1397 - Controlled Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1397\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/391af4ab-1117-46b9-b2c7-78bbd5cd995b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022391af4ab-1117-46b9-b2c7-78bbd5cd995b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1556 - Vulnerability Scanning | Automated Trend Analyses\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1556\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/391ff8b3-afed-405e-9f7d-ef2f8168d5da\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022391ff8b3-afed-405e-9f7d-ef2f8168d5da\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Advanced data security settings for SQL managed instance should contain an email address to receive security alerts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Ensure that an email address is provided for the \u0027Send alerts to\u0027 field in the Advanced Data Security server settings. This email address receives alert notifications when anomalous activities are detected on SQL managed instances.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/managedInstances\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/managedInstances/securityAlertPolicies\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]\u0022,\u0022notEquals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Sql/managedInstances/securityAlertPolicies/emailAddresses[*]\u0022,\u0022exists\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3965c43d-b5f4-482e-b74a-d89ee0e0b3a8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223965c43d-b5f4-482e-b74a-d89ee0e0b3a8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1232 - Configuration Management Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1232\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/396ba986-eac1-4d6d-85c4-d3fda6b78272\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022396ba986-eac1-4d6d-85c4-d3fda6b78272\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1246 - Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1246\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/398eb61e-8111-40d5-a0c9-003df28f1753\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022398eb61e-8111-40d5-a0c9-003df28f1753\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022FTPS only should be required in your Function App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Enable FTPS enforcement for enhanced security\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/ftpsState\u0022,\u0022equals\u0022:\u0022FtpsOnly\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022399b2637-a50f-4f95-96f8-3a145476eb15\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1680 - Malicious Code Protection | Central Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1680\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/399cd6ee-0e18-41db-9dea-cde3bd712f38\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022399cd6ee-0e18-41db-9dea-cde3bd712f38\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1228 - Information System Component Inventory | Accountability Information\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1228\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/39c54140-5902-4079-8bb5-ad31936fe764\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002239c54140-5902-4079-8bb5-ad31936fe764\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1039 - Least Privilege | Review Of User Privileges\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1039\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3a7b9de4-a8a2-4672-914d-c5f6752aa7f9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223a7b9de4-a8a2-4672-914d-c5f6752aa7f9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1648 - Collaborative Computing Devices\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1648\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3a9eb14b-495a-4ebb-933c-ce4ef5264e32\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223a9eb14b-495a-4ebb-933c-ce4ef5264e32\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1315 - Identifier Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1315\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3aa87116-f1a1-4edb-bfbf-14e036f8d454\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223aa87116-f1a1-4edb-bfbf-14e036f8d454\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Pod Security Policies should be defined on Kubernetes Services\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Define Pod Security Policies to reduce the attack vector by removing unnecessary application privileges. It is recommended to configure Pod Security Policies to only allow pods to access the resources which they have permissions to access.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/enablePodSecurityPolicy\u0022,\u0022equals\u0022:\u0022false\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3abeb944-26af-43ee-b83d-32aaf060fb94\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223abeb944-26af-43ee-b83d-32aaf060fb94\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1548 - Vulnerability Scanning\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1548\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3afe6c78-6124-4d95-b85c-eb8c0c9539cb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223afe6c78-6124-4d95-b85c-eb8c0c9539cb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1266 - Contingency Plan Testing | Alternate Processing Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1266\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3b4a3eb2-c25d-40bf-ad41-5094b6f59cee\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223b4a3eb2-c25d-40bf-ad41-5094b6f59cee\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1003 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1003\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3b68b179-3704-4ff7-b51d-7d65374d165d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223b68b179-3704-4ff7-b51d-7d65374d165d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022An activity log alert should exist for specific Security operations\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy audits specific Security operations with no activity log alerts configured.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022operationName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Operation Name\u0022,\u0022description\u0022:\u0022Security Operation name for which activity log alert should exist\u0022},\u0022allowedValues\u0022:[\u0022Microsoft.Security/policies/write\u0022,\u0022Microsoft.Security/securitySolutions/write\u0022,\u0022Microsoft.Security/securitySolutions/delete\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/ActivityLogAlerts\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022category\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\u0022,\u0022equals\u0022:\u0022Security\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022operationName\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\u0022,\u0022equals\u0022:\u0022[parameters(\u0027operationName\u0027)]\u0022}]}]}},\u0022equals\u0022:2},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022category\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022operationName\u0022}}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3b980d31-7904-4bb7-8575-5665739a8052\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223b980d31-7904-4bb7-8575-5665739a8052\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Dependency agent for Windows virtual machine scale sets\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploy Dependency agent for Windows virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022listOfImageIdToInclude\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Windows OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude\u0027)]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/type\u0022,\u0022equals\u0022:\u0022DependencyAgentWindows\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022DependencyAgent\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022,\u0022vmExtensionType\u0022:\u0022DependencyAgentWindows\u0022,\u0022vmExtensionTypeHandlerVersion\u0022:\u00229.7\u0022},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-06-01\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022typeHandlerVersion\u0022:\u0022[variables(\u0027vmExtensionTypeHandlerVersion\u0027)]\u0022,\u0022autoUpgradeMinorVersion\u0022:true}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3be22e3b-d919-47aa-805e-8985dbeb0ad9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223be22e3b-d919-47aa-805e-8985dbeb0ad9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022PostgreSQL server should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits PostgreSQL servers not configured to use a virtual network service endpoint. For more details, visit https://aka.ms/postgresqlvnet.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforPostgreSQL/servers/virtualNetworkRules\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/virtualNetworkRules/virtualNetworkSubnetId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3c14b034-bcb6-4905-94e7-5b8e98a47b65\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223c14b034-bcb6-4905-94e7-5b8e98a47b65\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Log Analytics agent for Windows virtual machine scale sets\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploy Log Analytics agent for Windows virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022listOfImageIdToInclude\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Windows OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude\u0027)]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/type\u0022,\u0022equals\u0022:\u0022MicrosoftMonitoringAgent\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022MMAExtension\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022,\u0022vmExtensionType\u0022:\u0022MicrosoftMonitoringAgent\u0022,\u0022vmExtensionTypeHandlerVersion\u0022:\u00221.0\u0022},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022apiVersion\u0022:\u00222018-06-01\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022typeHandlerVersion\u0022:\u0022[variables(\u0027vmExtensionTypeHandlerVersion\u0027)]\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{\u0022workspaceId\u0022:\u0022[reference(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).customerId]\u0022,\u0022stopOnMultipleConnections\u0022:\u0022true\u0022},\u0022protectedSettings\u0022:{\u0022workspaceKey\u0022:\u0022[listKeys(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).primarySharedKey]\u0022}}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223c1b3629-c8f8-4bf6-862c-037cb9094038\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Vulnerabilities in security configuration on your virtual machine scale sets should be remediated\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit the OS vulnerabilities on your virtual machine scale sets to protect them from attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022OsVulnerabilities\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223c735d8a-a4ba-4a3a-b7cf-db7754cf57f4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1621 - Resource Availability\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1621\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3cb9f731-744a-4691-a481-ca77b0411538\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223cb9f731-744a-4691-a481-ca77b0411538\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1521 - Personnel Termination | Automated Notification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1521\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3cbddf9c-a3aa-4330-a0f5-4c0c1f1862e5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223cbddf9c-a3aa-4330-a0f5-4c0c1f1862e5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1127 - Time Stamps\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1127\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3ce328db-aef3-48ed-9f81-2ab7cf839c66\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223ce328db-aef3-48ed-9f81-2ab7cf839c66\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Search Services to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Search Services to stream to a regional Event Hub when any Search Services which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_eventHub\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022eventHubLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Location\u0022,\u0022description\u0022:\u0022The location the Event Hub resides in. Only Search Services in this location will be linked to this Event Hub.\u0022,\u0022strongType\u0022:\u0022location\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Search/searchServices\u0022},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Search/searchServices/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022OperationLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3d5da587-71bd-41f5-ac95-dd3330c2d58d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223d5da587-71bd-41f5-ac95-dd3330c2d58d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Devices\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Devices\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsDevices\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3d7b154e-2700-4c8c-9e46-cb65ac1578c2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223d7b154e-2700-4c8c-9e46-cb65ac1578c2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Deploy default Log Analytics Agent for Ubuntu VMs\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy deploys the Log Analytics Agent on Ubuntu VMs, and connects to the selected Log Analytics workspace\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Compute\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002218.04-LTS\u0022,\u002216.04-LTS\u0022,\u002216.04.0-LTS\u0022,\u002214.04.2-LTS\u0022,\u002212.04.5-LTS\u0022]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022OmsAgentForLinux\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027),\u0027/omsPolicy\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022apiVersion\u0022:\u00222017-12-01\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022,\u0022type\u0022:\u0022OmsAgentForLinux\u0022,\u0022typeHandlerVersion\u0022:\u00221.4\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{\u0022workspaceId\u0022:\u0022[reference(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).customerId]\u0022},\u0022protectedSettings\u0022:{\u0022workspaceKey\u0022:\u0022[listKeys(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).primarySharedKey]\u0022}}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled monitoring for Linux VM\u0027, \u0027: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223d8640fc-63f6-4734-8dcb-cfd3d8c78f38\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1385 - Information Spillage Response\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1385\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3e495e65-8663-49ca-9b38-9f45e800bc58\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223e495e65-8663-49ca-9b38-9f45e800bc58\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Monitor solution \u0027Security and Audit\u0027 must be deployed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy ensures that Security and Audit is deployed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.OperationsManagement/solutions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.OperationsManagement/solutions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022},{\u0022field\u0022:\u0022name\u0022,\u0022like\u0022:\u0022Security(*)\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3e596b57-105f-48a6-be97-03e9243bad6e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223e596b57-105f-48a6-be97-03e9243bad6e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1160 - Security Authorization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1160\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3e797ca6-2aa8-4333-b335-7036f1110c05\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223e797ca6-2aa8-4333-b335-7036f1110c05\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1545 - Risk Assessment\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1545\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3f4b171a-a56b-4328-8112-32cf7f947ee1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223f4b171a-a56b-4328-8112-32cf7f947ee1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1179 - Baseline Configuration | Reviews And Updates\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1179\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3f9ce557-c8ab-4e6c-bb2c-9b8ed002c46c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223f9ce557-c8ab-4e6c-bb2c-9b8ed002c46c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit API Applications that are not using latest supported PHP Framework\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use the latest supported PHP version for the latest security classes. Using older classes and types can make your application vulnerable.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022api\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022apiApp\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UseLatestPHP\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3fe37002-5d00-4b37-a301-da09e3a0ca66\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223fe37002-5d00-4b37-a301-da09e3a0ca66\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1561 - Allocation Of Resources\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1561\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/40364c3f-c331-4e29-b1e3-2fbe998ba2f5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002240364c3f-c331-4e29-b1e3-2fbe998ba2f5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Secure transfer to storage accounts should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit requirement of Secure transfer in your storage account. Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Storage\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Storage/storageAccounts\u0022},{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022value\u0022:\u0022[requestContext().apiVersion]\u0022,\u0022less\u0022:\u00222019-04-01\u0022},{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\u0022,\u0022exists\u0022:\u0022false\u0022}]},{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\u0022,\u0022equals\u0022:\u0022false\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022404c3081-a854-4457-ae30-26a93ef643f9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1100 - Audit And Accountability Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1100\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4057863c-ca7d-47eb-b1e0-503580cba8a4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224057863c-ca7d-47eb-b1e0-503580cba8a4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1637 - Boundary Protection | Fail Secure\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1637\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4075bedc-c62a-4635-bede-a01be89807f3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224075bedc-c62a-4635-bede-a01be89807f3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Administrative Templates - System\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Administrative Templates - System\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022AlwaysUseClassicLogon\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Always use classic logon\u0022,\u0022description\u0022:\u0022Specifies whether to force the user to log on to the computer using the classic logon screen. This setting only works when the computer is not on a domain.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022BootStartDriverInitializationPolicy\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Boot-Start Driver Initialization Policy\u0022,\u0022description\u0022:\u0022Specifies which boot-start drivers are initialized based on a classification determined by an Early Launch Antimalware boot-start driver.\u0022},\u0022defaultValue\u0022:\u00223\u0022},\u0022EnableWindowsNTPClient\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Enable Windows NTP Client\u0022,\u0022description\u0022:\u0022Specifies whether the Windows NTP Client is enabled. Enabling the Windows NTP Client allows your computer to synchronize its computer clock with other NTP servers.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022TurnOnConveniencePINSignin\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Turn on convenience PIN sign-in\u0022,\u0022description\u0022:\u0022Specifies whether a domain user can sign in using a convenience PIN.\u0022},\u0022defaultValue\u0022:\u00220\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_AdministrativeTemplatesSystem\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Always use classic logon;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AlwaysUseClassicLogon\u0027), \u0027,\u0027, \u0027Boot-Start Driver Initialization Policy;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027BootStartDriverInitializationPolicy\u0027), \u0027,\u0027, \u0027Enable Windows NTP Client;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027EnableWindowsNTPClient\u0027), \u0027,\u0027, \u0027Turn on convenience PIN sign-in;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027TurnOnConveniencePINSignin\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_AdministrativeTemplatesSystem\u0022},\u0022AlwaysUseClassicLogon\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AlwaysUseClassicLogon\u0027)]\u0022},\u0022BootStartDriverInitializationPolicy\u0022:{\u0022value\u0022:\u0022[parameters(\u0027BootStartDriverInitializationPolicy\u0027)]\u0022},\u0022EnableWindowsNTPClient\u0022:{\u0022value\u0022:\u0022[parameters(\u0027EnableWindowsNTPClient\u0027)]\u0022},\u0022TurnOnConveniencePINSignin\u0022:{\u0022value\u0022:\u0022[parameters(\u0027TurnOnConveniencePINSignin\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AlwaysUseClassicLogon\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022BootStartDriverInitializationPolicy\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022EnableWindowsNTPClient\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022TurnOnConveniencePINSignin\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Always use classic logon;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AlwaysUseClassicLogon\u0027)]\u0022},{\u0022name\u0022:\u0022Boot-Start Driver Initialization Policy;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027BootStartDriverInitializationPolicy\u0027)]\u0022},{\u0022name\u0022:\u0022Enable Windows NTP Client;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027EnableWindowsNTPClient\u0027)]\u0022},{\u0022name\u0022:\u0022Turn on convenience PIN sign-in;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027TurnOnConveniencePINSignin\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Always use classic logon;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AlwaysUseClassicLogon\u0027)]\u0022},{\u0022name\u0022:\u0022Boot-Start Driver Initialization Policy;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027BootStartDriverInitializationPolicy\u0027)]\u0022},{\u0022name\u0022:\u0022Enable Windows NTP Client;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027EnableWindowsNTPClient\u0027)]\u0022},{\u0022name\u0022:\u0022Turn on convenience PIN sign-in;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027TurnOnConveniencePINSignin\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/40917425-69db-4018-8dae-2a0556cef899\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002240917425-69db-4018-8dae-2a0556cef899\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1202 - Access Restrictions For Change\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1202\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/40a2a83b-74f2-4c02-ae65-f460a5d2792a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002240a2a83b-74f2-4c02-ae65-f460a5d2792a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Inherit a tag from the subscription if missing\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Adds the specified tag with its value from the containing subscription when any resource missing this tag is created or updated. Existing resources can be remediated by triggering a remediation task. If the tag exists with a different value it will not be changed.\u0022,\u0022metadata\u0022:{\u0022category\u0022:\u0022Tags\u0022,\u0022version\u0022:\u00221.0.0\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022value\u0022:\u0022[subscription().tags[parameters(\u0027tagName\u0027)]]\u0022,\u0022notEquals\u0022:\u0022\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022modify\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022operations\u0022:[{\u0022operation\u0022:\u0022add\u0022,\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[subscription().tags[parameters(\u0027tagName\u0027)]]\u0022}]}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/40df99da-1232-49b1-a39a-6da8d878f469\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002240df99da-1232-49b1-a39a-6da8d878f469\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1438 - Media Sanitization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1438\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/40fcc635-52a2-4dbc-9523-80a1f4aa1de6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002240fcc635-52a2-4dbc-9523-80a1f4aa1de6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1365 - Incident Handling | Continuity Of Operations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1365\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4116891d-72f7-46ee-911c-8056cc8dcbd5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224116891d-72f7-46ee-911c-8056cc8dcbd5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1022 - Account Management | Shared / Group Account Credential Termination\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1022\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/411f7e2d-9a0b-4627-a0b9-1700432db47d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022411f7e2d-9a0b-4627-a0b9-1700432db47d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1464 - Monitoring Physical Access | Intrusion Alarms / Surveillance Equipment\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1464\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/41256567-1795-4684-b00b-a1308ce43cac\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002241256567-1795-4684-b00b-a1308ce43cac\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Monitor should collect activity logs from all regions\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy audits the Azure Monitor log profile which does not export activities from all Azure supported regions including global.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/logProfiles\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022australiacentral\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022australiacentral2\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022australiaeast\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022australiasoutheast\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022brazilsouth\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022canadacentral\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022canadaeast\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022centralindia\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022centralus\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022eastasia\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022eastus\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022eastus2\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022francecentral\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022francesouth\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022japaneast\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022japanwest\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022koreacentral\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022koreasouth\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022northcentralus\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022northeurope\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022southafricanorth\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022southafricawest\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022southcentralus\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022southindia\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022southeastasia\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022uaecentral\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022uaenorth\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022uksouth\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022ukwest\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022westcentralus\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022westeurope\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022westindia\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022westus\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022westus2\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/locations[*]\u0022,\u0022notEquals\u0022:\u0022global\u0022}}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/41388f1c-2db0-4c25-95b2-35d7f5ccbfa9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002241388f1c-2db0-4c25-95b2-35d7f5ccbfa9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1263 - Contingency Plan Testing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1263\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/41472613-3b05-49f6-8fe8-525af113ce17\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002241472613-3b05-49f6-8fe8-525af113ce17\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1096 - Role-Based Security Training | Practical Exercises\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1096\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/420c1477-aa43-49d0-bd7e-c4abdd9addff\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022420c1477-aa43-49d0-bd7e-c4abdd9addff\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1260 - Contingency Training | Simulated Events\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1260\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/42254fc4-2738-4128-9613-72aaa4f0d9c3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002242254fc4-2738-4128-9613-72aaa4f0d9c3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1694 - Information System Monitoring | Analyze Communications Traffic Anomalies\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1694\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/426c4ac9-ff17-49d0-acd7-a13c157081c0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022426c4ac9-ff17-49d0-acd7-a13c157081c0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Batch accounts should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Batch\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Batch/batchAccounts\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022428256e6-1fac-4f48-a757-df34c2b3336d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027System Audit Policies - Detailed Tracking\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Detailed Tracking\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022AuditProcessTermination\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Process Termination\u0022,\u0022description\u0022:\u0022Specifies whether audit events are generated when a process has exited. Recommended for monitoring termination of critical processes.\u0022},\u0022allowedValues\u0022:[\u0022No Auditing\u0022,\u0022Success\u0022,\u0022Failure\u0022,\u0022Success and Failure\u0022],\u0022defaultValue\u0022:\u0022No Auditing\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesDetailedTracking\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Audit Process Termination;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditProcessTermination\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SystemAuditPoliciesDetailedTracking\u0022},\u0022AuditProcessTermination\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditProcessTermination\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditProcessTermination\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Process Termination;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditProcessTermination\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Process Termination;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditProcessTermination\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/42a07bbf-ffcf-459a-b4b1-30ecd118a505\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002242a07bbf-ffcf-459a-b4b1-30ecd118a505\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1174 - Configuration Management Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1174\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/42a9a714-8fbb-43ac-b115-ea12d2bd652f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002242a9a714-8fbb-43ac-b115-ea12d2bd652f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1137 - Audit Generation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1137\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4344df62-88ab-4637-b97b-bcaf2ec97e7c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224344df62-88ab-4637-b97b-bcaf2ec97e7c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1367 - Incident Handling | Insider Threats - Specific Capabilities\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1367\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/435b2547-6374-4f87-b42d-6e8dbe6ae62a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022435b2547-6374-4f87-b42d-6e8dbe6ae62a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1552 - Vulnerability Scanning | Update By Frequency / Prior To New Scan / When Identified\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1552\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/43684572-e4f1-4642-af35-6b933bc506da\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002243684572-e4f1-4642-af35-6b933bc506da\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - System settings\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - System settings\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies\u0022,\u0022description\u0022:\u0022Specifies whether digital certificates are processed when software restriction policies are enabled and a user or process attempts to run software with an .exe file name extension. It enables or disables certificate rules (a type of software restriction policies rule). For certificate rules to take effect in software restriction policies, you must enable this policy setting.\u0022},\u0022defaultValue\u0022:\u00221\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsSystemsettings\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsSystemsettings\u0022},\u0022SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\u0022:{\u0022value\u0022:\u0022[parameters(\u0027SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022System settings: Use Certificate Rules on Windows Executables for Software Restriction Policies;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SystemSettingsUseCertificateRulesOnWindowsExecutablesForSoftwareRestrictionPolicies\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/437a1f8f-8552-47a8-8b12-a2fee3269dd5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022437a1f8f-8552-47a8-8b12-a2fee3269dd5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1544 - Risk Assessment\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1544\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/43ced7c9-cd53-456b-b0da-2522649a4271\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002243ced7c9-cd53-456b-b0da-2522649a4271\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1398 - Controlled Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1398\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/443e8f3d-b51a-45d8-95a7-18b0e42f4dc4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022443e8f3d-b51a-45d8-95a7-18b0e42f4dc4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Monitor permissive network access in Azure Security Center\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Network Security Groups with too permissive rules will be monitored by Azure Security Center as recommendations\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022permissiveNetworkAccess\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002244452482-524f-4bf4-b852-0bff7cc4a3ed\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1066 - Remote Access | Disconnect / Disable Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1066\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4455c2e8-c65d-4acf-895e-304916f90b36\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224455c2e8-c65d-4acf-895e-304916f90b36\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1720 - Spam Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1720\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/44b9a7cd-f36a-491a-a48b-6d04ae7c4221\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002244b9a7cd-f36a-491a-a48b-6d04ae7c4221\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1334 - Authenticator Management | Pki-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1334\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/44bfdadc-8c2e-4c30-9c99-f005986fabcd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002244bfdadc-8c2e-4c30-9c99-f005986fabcd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1604 - Developer Security Testing And Evaluation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1604\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/44dbba23-0b61-478e-89c7-b3084667782f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002244dbba23-0b61-478e-89c7-b3084667782f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1712 - Software, Firmware, And Information Integrity\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1712\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/44e543aa-41db-42aa-98eb-8a5eb1db53f0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002244e543aa-41db-42aa-98eb-8a5eb1db53f0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1310 - Device Identification And Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1310\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/450d7ede-823d-4931-a99d-57f6a38807dc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022450d7ede-823d-4931-a99d-57f6a38807dc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1559 - System And Services Acquisition Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1559\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/45692294-f074-42bd-ac54-16f1a3c07554\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002245692294-f074-42bd-ac54-16f1a3c07554\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1578 - Acquisition Process | Functions / Ports / Protocols / Services In Use\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1578\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/45b7b644-5f91-498e-9d89-7402532d3645\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002245b7b644-5f91-498e-9d89-7402532d3645\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1565 - System Development Life Cycle\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1565\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/45ce2396-5c76-4654-9737-f8792ab3d26b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002245ce2396-5c76-4654-9737-f8792ab3d26b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1337 - Authenticator Management | In-Person Or Trusted Third-Party Registration\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1337\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/463e5220-3f79-4e24-a63f-343e4096cd22\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022463e5220-3f79-4e24-a63f-343e4096cd22\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Require SQL Server version 12.0\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy ensures all SQL servers use version 12.0. This policy is deprecated because it is no longer possible to create an Azure SQL server with any version other than 12.0.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022SQL\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/version\u0022,\u0022equals\u0022:\u002212.0\u0022}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1346 - Identification And Authentication (Non-Organizational Users)\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1346\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/464dc8ce-2200-4720-87a5-dc5952924cc6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022464dc8ce-2200-4720-87a5-dc5952924cc6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Web Applications that are not using latest supported Python Framework\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use the latest supported Python version for the latest security classes. Using older classes and types can make your application vulnerable.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022WebApp\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UseLatestPython\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/46544d7b-1f0d-46f5-81da-5c1351de1b06\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002246544d7b-1f0d-46f5-81da-5c1351de1b06\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Require automatic OS image patching on Virtual Machine Scale Sets\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy enforces enabling automatic OS image patching on Virtual Machine Scale Sets to always keep Virtual Machines secure by safely applying latest security patches every month.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgradePolicy.enableAutomaticOSUpgrade\u0022,\u0022notEquals\u0022:\u0022True\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade\u0022,\u0022notEquals\u0022:\u0022True\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022465f0161-0087-490a-9ad9-ad6217f4f43a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1368 - Incident Handling | Correlation With External Organizations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1368\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/465f32da-0ace-4603-8d1b-7be5a3a702de\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022465f32da-0ace-4603-8d1b-7be5a3a702de\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1062 - Remote Access | Protection Of Confidentiality / Integrity Using Encryption\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1062\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4708723f-e099-4af1-bbf9-b6df7642e444\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224708723f-e099-4af1-bbf9-b6df7642e444\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Cosmos DB key based metadata write access should be disabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy enables you to ensure all Azure Cosmos DB accounts disable key based metadata write access.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Cosmos DB\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DocumentDB/databaseAccounts\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/disableKeyBasedMetadataWriteAccess\u0022,\u0022notEquals\u0022:true}]},\u0022then\u0022:{\u0022effect\u0022:\u0022append\u0022,\u0022details\u0022:[{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/disableKeyBasedMetadataWriteAccess\u0022,\u0022value\u0022:true}]}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4750c32b-89c0-46af-bfcb-2e4541a818d5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224750c32b-89c0-46af-bfcb-2e4541a818d5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Automatic provisioning of the Log Analytics monitoring agent should be enabled on your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enable automatic provisioning of the Log Analytics monitoring agent in order to collect security data\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/autoProvisioningSettings\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/autoProvisioningSettings/autoProvision\u0022,\u0022equals\u0022:\u0022On\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/475aae12-b88a-4572-8b36-9b712b2b3a17\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022475aae12-b88a-4572-8b36-9b712b2b3a17\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Adaptive Application Controls should be enabled on virtual machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Possible Application Whitelist configuration will be monitored by Azure Security Center\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022applicationWhitelisting\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002247a6b606-51aa-4496-8bb7-64b11cf66adc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1359 - Incident Response Testing | Coordination With Related Plans\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1359\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/47bc7ea0-7d13-4f7c-a154-b903f7194253\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002247bc7ea0-7d13-4f7c-a154-b903f7194253\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1165 - Continuous Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1165\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/47e10916-6c9e-446b-b0bd-ff5fd439d79d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002247e10916-6c9e-446b-b0bd-ff5fd439d79d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1048 - System Use Notification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1048\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/483e7ca9-82b3-45a2-be97-b93163a0deb7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022483e7ca9-82b3-45a2-be97-b93163a0deb7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1033 - Separation Of Duties\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1033\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/48540f01-fc11-411a-b160-42807c68896e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002248540f01-fc11-411a-b160-42807c68896e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1477 - Fire Protection | Detection Devices / Systems\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1477\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4862a63c-6c74-4a9d-a221-89af3c374503\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224862a63c-6c74-4a9d-a221-89af3c374503\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1484 - Water Damage Protection | Automation Support\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1484\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/486b006a-3653-45e8-b41c-a052d3e05456\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022486b006a-3653-45e8-b41c-a052d3e05456\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit IP restrictions configuration for an API App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects an API app from common attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022api\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022apiApp\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022ConfigureIPRestrictions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/48893b84-a2c8-4d9a-badf-835d5d1b7d53\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002248893b84-a2c8-4d9a-badf-835d5d1b7d53\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Geo-redundant backup should be enabled for Azure Database for PostgreSQL\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Azure Database for PostgreSQL with geo-redundant backup not enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/storageProfile.geoRedundantBackup\u0022,\u0022notEquals\u0022:\u0022Enabled\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/48af4db5-9b8b-401c-8e74-076be876a430\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002248af4db5-9b8b-401c-8e74-076be876a430\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1669 - Flaw Remediation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1669\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/48f2f62b-5743-4415-a143-288adc0e078d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002248f2f62b-5743-4415-a143-288adc0e078d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1376 - Incident Response Assistance | Coordination With External Providers\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1376\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/493a95f3-f2e3-47d0-af02-65e6d6decc2f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022493a95f3-f2e3-47d0-af02-65e6d6decc2f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027Java version\u0027 is the latest, if used as a part of the Web app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for Java software either due to security flaws or to include additional functionality. Using the latest Java version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022JavaLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Latest Java version\u0022,\u0022description\u0022:\u0022Latest supported Java version for App Services\u0022},\u0022defaultValue\u0022:\u002211\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022notContains\u0022:\u0022JAVA\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.javaVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022like\u0022:\u0022[concat(\u0027*\u0027, parameters(\u0027JavaLatestVersion\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.javaVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.javaVersion\u0022,\u0022like\u0022:\u0022[concat(parameters(\u0027JavaLatestVersion\u0027), \u0027*\u0027)]\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/496223c3-ad65-4ecd-878a-bae78737e9ed\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022496223c3-ad65-4ecd-878a-bae78737e9ed\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Audit\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Audit\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit: Shut down system immediately if unable to log security audits\u0022,\u0022description\u0022:\u0022Audits if the system will shut down when unable to log Security events.\u0022},\u0022defaultValue\u0022:\u00220\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsAudit\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Audit: Shut down system immediately if unable to log security audits;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsAudit\u0022},\u0022AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit: Shut down system immediately if unable to log security audits;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit: Shut down system immediately if unable to log security audits;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditShutDownSystemImmediatelyIfUnableToLogSecurityAudits\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/498b810c-59cd-4222-9338-352ba146ccf3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022498b810c-59cd-4222-9338-352ba146ccf3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1329 - Authenticator Management | Password-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1329\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/498f6234-3e20-4b6a-a880-cbd646d973bd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022498f6234-3e20-4b6a-a880-cbd646d973bd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1638 - Boundary Protection | Dynamic Isolation / Segregation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1638\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/49b99653-32cd-405d-a135-e7d60a9aae1f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002249b99653-32cd-405d-a135-e7d60a9aae1f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Append a tag and its value to resource groups\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Appends the specified tag and value when any resource group which is missing this tag is created or updated. Does not modify the tags of resource groups created before this policy was applied until those resource groups are changed. New \u0027modify\u0027 effect policies are available that support remediation of tags on existing resources (see https://aka.ms/modifydoc).\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}},\u0022tagValue\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Value\u0022,\u0022description\u0022:\u0022Value of the tag, such as \u0027production\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022},{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022exists\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022append\u0022,\u0022details\u0022:[{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}]}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002249c88fc8-6fd1-46fd-a676-f12d1d3a4c71\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1294 - Information System Backup | Transfer To Alternate Storage Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1294\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/49dbe627-2c1e-438c-979e-dd7a39bbf81d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002249dbe627-2c1e-438c-979e-dd7a39bbf81d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1218 - Least Functionality | Prevent Program Execution\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1218\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4a1d0394-b9f5-493e-9e83-563fd0ac4df8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224a1d0394-b9f5-493e-9e83-563fd0ac4df8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1677 - Malicious Code Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1677\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4a248e1e-040f-43e5-bff2-afc3a57a3923\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224a248e1e-040f-43e5-bff2-afc3a57a3923\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1094 - Role-Based Security Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1094\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4b1853e0-8973-446b-b567-09d901d31a09\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224b1853e0-8973-446b-b567-09d901d31a09\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Event Grid topics should use private links\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit Azure Event Grid topics that do not have at least one approved private endpoint connection. Clients in a virtual network can securely access resources that have private endpoint connections via private links. For more information, visit https://aka.ms/privateendpoints.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Event Grid\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.EventGrid/topics\u0022},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.EventGrid/topics/privateEndpointConnections[*]\u0022,\u0022where\u0022:{\u0022field\u0022:\u0022Microsoft.EventGrid/topics/privateEndpointConnections[*].privateLinkServiceConnectionState.status\u0022,\u0022equals\u0022:\u0022Approved\u0022}},\u0022less\u0022:1}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4b90e17e-8448-49db-875e-bd83fb6f804f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224b90e17e-8448-49db-875e-bd83fb6f804f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1114 - Response To Audit Processing Failures | Real-Time Alerts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1114\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4c090801-59bc-4454-bb33-e0455133486a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224c090801-59bc-4454-bb33-e0455133486a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1364 - Incident Handling | Dynamic Reconfiguration\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1364\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4c615c2a-dc83-4dda-8220-abce7b50c9bc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224c615c2a-dc83-4dda-8220-abce7b50c9bc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1661 - Session Authenticity | Invalidate Session Identifiers At Logout\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1661\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4c643c9a-1be7-4016-a5e7-e4bada052920\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224c643c9a-1be7-4016-a5e7-e4bada052920\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1373 - Incident Reporting | Automated Reporting\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1373\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4cca950f-c3b7-492a-8e8f-ea39663c14f9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224cca950f-c3b7-492a-8e8f-ea39663c14f9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1632 - Boundary Protection | Prevent Split Tunneling For Remote Devices\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1632\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4ce9073a-77fa-48f0-96b1-87aa8e6091c2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224ce9073a-77fa-48f0-96b1-87aa8e6091c2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Linux VMs that do not have the specified applications installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Linux virtual machines that do not have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.2.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022ApplicationName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Application names\u0022,\u0022description\u0022:\u0022A semicolon-separated list of the names of the applications that should be installed. e.g. \u0027python; powershell\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022installed_application_linux\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent\u0027, \u0027=\u0027, concat(\u0027packages: [\u0027, replace(parameters(\u0027ApplicationName\u0027), \u0027;\u0027, \u0027,\u0027), \u0027]\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022installed_application_linux\u0022},\u0022ApplicationName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ApplicationName\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ApplicationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent\u0022,\u0022value\u0022:\u0022[concat(\u0027packages: [\u0027, replace(parameters(\u0027ApplicationName\u0027), \u0027;\u0027, \u0027,\u0027), \u0027]\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[ChefInSpec]InstalledApplicationLinuxResource1;AttributesYmlContent\u0022,\u0022value\u0022:\u0022[concat(\u0027packages: [\u0027, replace(parameters(\u0027ApplicationName\u0027), \u0027;\u0027, \u0027,\u0027), \u0027]\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforLinux\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforLinux\u0022,\u0022typeHandlerVersion\u0022:\u00221.0\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4d1c04de-2172-403f-901b-90608c35c721\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224d1c04de-2172-403f-901b-90608c35c721\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022FTPS should be required in your Web App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Enable FTPS enforcement for enhanced security\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/ftpsState\u0022,\u0022equals\u0022:\u0022FtpsOnly\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224d24b6d4-5e53-4a4f-a7f4-618fa573ee4b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1155 - System Interconnections | Restrictions On External System Connections\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1155\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4d33f9f1-12d0-46ad-9fbd-8f8046694977\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224d33f9f1-12d0-46ad-9fbd-8f8046694977\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1156 - Plan Of Action And Milestones\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1156\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4d52e864-9a3b-41ee-8f03-520815fe5378\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224d52e864-9a3b-41ee-8f03-520815fe5378\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1312 - Identifier Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1312\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4d6a5968-9eef-4c18-8534-376790ab7274\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224d6a5968-9eef-4c18-8534-376790ab7274\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Dependency agent for Linux VMs\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploy Dependency agent for Linux VMs if the VM Image (OS) is in the list defined and the agent is not installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022listOfImageIdToInclude\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Linux OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude\u0027)]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002214.04.0-LTS\u0022,\u002214.04.1-LTS\u0022,\u002214.04.5-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002216.04-LTS\u0022,\u002216.04.0-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002218.04-LTS\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002212-SP2\u0022,\u002212-SP3\u0022,\u002212-SP4\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022CentOS\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022DependencyAgentLinux\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022DependencyAgent\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022,\u0022vmExtensionType\u0022:\u0022DependencyAgentLinux\u0022,\u0022vmExtensionTypeHandlerVersion\u0022:\u00229.6\u0022},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-06-01\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022typeHandlerVersion\u0022:\u0022[variables(\u0027vmExtensionTypeHandlerVersion\u0027)]\u0022,\u0022autoUpgradeMinorVersion\u0022:true}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for VM\u0027, \u0027: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4da21710-ce6f-4e06-8cdb-5cc4c93ffbee\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224da21710-ce6f-4e06-8cdb-5cc4c93ffbee\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Data Lake Analytics to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Data Lake Analytics to stream to a regional Event Hub when any Data Lake Analytics which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_eventHub\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022eventHubLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Location\u0022,\u0022description\u0022:\u0022The location the Event Hub resides in. Only Data Lake Analytics in this location will be linked to this Event Hub.\u0022,\u0022strongType\u0022:\u0022location\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DataLakeAnalytics/accounts\u0022},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022Audit\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Requests\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4daddf25-4823-43d4-88eb-2419eb6dcc08\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224daddf25-4823-43d4-88eb-2419eb6dcc08\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1394 - System Maintenance Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1394\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4db56f68-3f50-45ab-88f3-ca46f5379a94\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224db56f68-3f50-45ab-88f3-ca46f5379a94\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1702 - Information System Monitoring | Indicators Of Compromise\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1702\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4dfc0855-92c4-4641-b155-a55ddd962362\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224dfc0855-92c4-4641-b155-a55ddd962362\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1001 - Access Control Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1001\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4e26f8c3-4bf3-4191-b8fc-d888805101b7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224e26f8c3-4bf3-4191-b8fc-d888805101b7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1083 - Publicly Accessible Content\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1083\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4e319cb6-2ca3-4a58-ad75-e67f484e50ec\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224e319cb6-2ca3-4a58-ad75-e67f484e50ec\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1579 - Acquisition Process | Use Of Approved Piv Products\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1579\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4e54c7ef-7457-430b-9a3e-ef8881d4a8e0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224e54c7ef-7457-430b-9a3e-ef8881d4a8e0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1247 - Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1247\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4e666db5-b2ef-4b06-aac6-09bfce49151b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224e666db5-b2ef-4b06-aac6-09bfce49151b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1196 - Configuration Change Control | Automated Document / Notification / Prohibition Of Changes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1196\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4e7f4ea4-dd62-44f6-8886-ac6137cf52b0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224e7f4ea4-dd62-44f6-8886-ac6137cf52b0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1134 - Protection Of Audit Information | Access By Subset Of Privileged Users\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1134\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4e95f70e-181c-4422-9da2-43079710c789\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224e95f70e-181c-4422-9da2-43079710c789\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1267 - Alternate Storage Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1267\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4e97ba1d-be5d-4953-8da4-0cccf28f4805\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224e97ba1d-be5d-4953-8da4-0cccf28f4805\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1192 - Configuration Change Control | Automated Document / Notification / Prohibition Of Changes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1192\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4ebd97f7-b105-4f50-8daf-c51465991240\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224ebd97f7-b105-4f50-8daf-c51465991240\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1139 - Audit Generation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1139\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4ed62522-de00-4dda-9810-5205733d2f34\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224ed62522-de00-4dda-9810-5205733d2f34\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022A maximum of 3 owners should be designated for your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022It is recommended to designate up to 3 subscription owners in order to reduce the potential for breach by a compromised owner.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022DesignateLessThanXOwners\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224f11b553-d42e-4e3a-89be-32ca364cad4c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1442 - Media Sanitization | Nondestructive Techniques\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1442\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4f26049b-2c5a-4841-9ff3-d48a26aae475\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224f26049b-2c5a-4841-9ff3-d48a26aae475\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1182 - Baseline Configuration | Configure Systems, Components, Or Devices For High-Risk Areas\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1182\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4f34f554-da4b-4786-8d66-7915c90893da\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224f34f554-da4b-4786-8d66-7915c90893da\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022A security contact email address should be provided for your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enter an email address to receive notifications when Azure Security Center detects compromised resources\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/securityContacts\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/securityContacts/email\u0022,\u0022notEquals\u0022:\u0022\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224f4f78b8-e367-4b10-a341-d9a4ad5cf1c7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Add a tag to resources\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Adds the specified tag and value when any resource missing this tag is created or updated. Existing resources can be remediated by triggering a remediation task. If the tag exists with a different value it will not be changed. Does not modify tags on resource groups.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}},\u0022tagValue\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Value\u0022,\u0022description\u0022:\u0022Value of the tag, such as \u0027production\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022exists\u0022:\u0022false\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022modify\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022operations\u0022:[{\u0022operation\u0022:\u0022add\u0022,\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}]}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/4f9dc7db-30c1-420c-b61a-e1d640128d26\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00224f9dc7db-30c1-420c-b61a-e1d640128d26\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview] Vulnerability Assessment should be enabled on Virtual Machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Monitors vulnerabilities detected by Azure Security Center Vulnerability Assessment on Virtual Machines\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022serverVulnerabilityAssessment\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022NotApplicable\u0022,\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022501541f7-f7e7-4cd6-868c-4190fdad3ac9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1485 - Delivery And Removal\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1485\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/50301354-95d0-4a11-8af5-8039ecf6d38b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002250301354-95d0-4a11-8af5-8039ecf6d38b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1646 - Cryptographic Key Establishment And Management | Asymmetric Keys\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1646\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/506814fa-b930-4b10-894e-a45b98c40e1a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022506814fa-b930-4b10-894e-a45b98c40e1a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1566 - System Development Life Cycle\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1566\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/50ad3724-e2ac-4716-afcc-d8eabd97adb9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002250ad3724-e2ac-4716-afcc-d8eabd97adb9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022A custom IPsec/IKE policy must be applied to all Azure virtual network gateway connections\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy ensures that all Azure virtual network gateway connections use a custom Internet Protocol Security(Ipsec)/Internet Key Exchange(IKE) policy. Supported algorithms and key strengths - https://aka.ms/AA62kb0\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022},\u0022IPsecEncryption\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022IPsec Encryption\u0022,\u0022description\u0022:\u0022IPsec Encryption\u0022}},\u0022IPsecIntegrity\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022IPsec Integrity\u0022,\u0022description\u0022:\u0022IPsec Integrity\u0022}},\u0022IKEEncryption\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022IKE Encryption\u0022,\u0022description\u0022:\u0022IKE Encryption\u0022}},\u0022IKEIntegrity\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022IKE Integrity\u0022,\u0022description\u0022:\u0022IKE Integrity\u0022}},\u0022DHGroup\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022DH Group\u0022,\u0022description\u0022:\u0022DH Group\u0022}},\u0022PFSGroup\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022PFS Group\u0022,\u0022description\u0022:\u0022PFS Group\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/connections\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/connections/ipsecPolicies[*].ipsecEncryption\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027IPsecEncryption\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Network/connections/ipsecPolicies[*].ipsecIntegrity\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027IPsecIntegrity\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Network/connections/ipsecPolicies[*].ikeEncryption\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027IKEEncryption\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Network/connections/ipsecPolicies[*].ikeIntegrity\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027IKEIntegrity\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Network/connections/ipsecPolicies[*].dhGroup\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027DHGroup\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Network/connections/ipsecPolicies[*].pfsGroup\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027PFSGroup\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/50b83b09-03da-41c1-b656-c293c914862b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002250b83b09-03da-41c1-b656-c293c914862b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1248 - Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1248\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/50fc602d-d8e0-444b-a039-ad138ee5deb0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002250fc602d-d8e0-444b-a039-ad138ee5deb0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1386 - Information Spillage Response\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1386\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5120193e-91fd-4f9d-bc6d-194f94734065\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225120193e-91fd-4f9d-bc6d-194f94734065\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1352 - Incident Response Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1352\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/518cb545-bfa8-43f8-a108-3b7d5037469a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022518cb545-bfa8-43f8-a108-3b7d5037469a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1642 - Network Disconnect\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1642\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/53397227-5ee3-4b23-9e5e-c8a767ce6928\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002253397227-5ee3-4b23-9e5e-c8a767ce6928\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Connection throttling should be enabled for PostgreSQL database servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy helps audit any PostgreSQL databases in your environment without Connection throttling enabled. This setting enables temporary connection throttling per IP for too many invalid password login failures.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations\u0022,\u0022name\u0022:\u0022connection_throttling\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations/value\u0022,\u0022equals\u0022:\u0022ON\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5345bb39-67dc-4960-a1bf-427e16b9a0bd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225345bb39-67dc-4960-a1bf-427e16b9a0bd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1467 - Visitor Access Records\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1467\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5350cbf9-8bdd-4904-b22a-e88be84ca49d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225350cbf9-8bdd-4904-b22a-e88be84ca49d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1183 - Baseline Configuration | Configure Systems, Components, Or Devices For High-Risk Areas\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1183\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5352e3e0-e63a-452e-9e5f-9c1d181cff9c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225352e3e0-e63a-452e-9e5f-9c1d181cff9c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1029 - Information Flow Enforcement | Security Policy Filters\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1029\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/53ac8f8e-c2b5-4d44-8a2d-058e9ced9b69\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002253ac8f8e-c2b5-4d44-8a2d-058e9ced9b69\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1270 - Alternate Storage Site | Recovery Time / Point Objectives\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1270\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/53c76a39-2097-408a-b237-b279f7b4614d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002253c76a39-2097-408a-b237-b279f7b4614d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1040 - Least Privilege | Review Of User Privileges\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1040\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/54205576-cec9-463f-ba44-b4b3f5d0a84c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002254205576-cec9-463f-ba44-b4b3f5d0a84c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1015 - Account Management | Disable Inactive Accounts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1015\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/544a208a-9c3f-40bc-b1d1-d7e144495c14\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022544a208a-9c3f-40bc-b1d1-d7e144495c14\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1026 - Account Management | Disable Accounts For High-Risk Individuals\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1026\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/55419419-c597-4cd4-b51e-009fd2266783\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002255419419-c597-4cd4-b51e-009fd2266783\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1045 - Unsuccessful Logon Attempts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1045\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/554d2dd6-f3a8-4ad5-b66f-5ce23bd18892\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022554d2dd6-f3a8-4ad5-b66f-5ce23bd18892\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1523 - Personnel Transfer\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1523\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5577a310-2551-49c8-803b-36e0d5e55601\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225577a310-2551-49c8-803b-36e0d5e55601\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1113 - Response To Audit Processing Failures | Audit Storage Capacity\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1113\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/562afd61-56be-4313-8fe4-b9564aa4ba7d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022562afd61-56be-4313-8fe4-b9564aa4ba7d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1212 - Configuration Settings | Automated Central Management / Application / Verification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1212\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/56d970ee-4efc-49c8-8a4e-5916940d784c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002256d970ee-4efc-49c8-8a4e-5916940d784c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1403 - Controlled Maintenance | Automated Maintenance Activities\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1403\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/57149289-d52b-4f40-9fe6-5233c1ef80f7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002257149289-d52b-4f40-9fe6-5233c1ef80f7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022CORS should not allow every resource to access your Web Applications\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Cross-Origin Resource Sharing (CORS) should not allow all domains to access your web application. Allow only required domains to interact with your web app.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.cors.allowedOrigins[*]\u0022,\u0022notEquals\u0022:\u0022*\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225744710e-cc2f-4ee8-8809-3b11e89f4bc9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1162 - Continuous Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1162\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5770f3d6-8c2b-4f6f-bf0e-c8c8fc36d592\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225770f3d6-8c2b-4f6f-bf0e-c8c8fc36d592\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1054 - Session Termination\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1054\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5807e1b4-ba5e-4718-8689-a0ca05a191b2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225807e1b4-ba5e-4718-8689-a0ca05a191b2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1584 - Information System Documentation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1584\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5864522b-ff1d-4979-a9f8-58bee1fb174c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225864522b-ff1d-4979-a9f8-58bee1fb174c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1547 - Vulnerability Scanning\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1547\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/58abf9b8-c6d4-4b4b-bfb9-fe98fe295f52\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002258abf9b8-c6d4-4b4b-bfb9-fe98fe295f52\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1573 - Acquisition Process\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1573\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/58c93053-7b98-4cf0-b99f-1beb985416c2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002258c93053-7b98-4cf0-b99f-1beb985416c2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Ensure Function app is using the latest version of TLS encryption\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Please use /providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193 instead. The TLS(Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards, such as PCI DSS\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022App Service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.minTlsVersion\u0022,\u0022equals\u0022:\u00221.2\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/58d94fc1-a072-47c2-bd37-9cdb38e77453\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002258d94fc1-a072-47c2-bd37-9cdb38e77453\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1063 - Remote Access | Managed Access Control Points\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1063\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/593ce201-54b2-4dd0-b34f-c308005d7780\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022593ce201-54b2-4dd0-b34f-c308005d7780\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1463 - Monitoring Physical Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1463\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/59721f87-ae25-4db0-a2a4-77cc5b25d495\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002259721f87-ae25-4db0-a2a4-77cc5b25d495\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1425 - Timely Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1425\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5983d99c-f39b-4c32-a3dc-170f19f6941b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225983d99c-f39b-4c32-a3dc-170f19f6941b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1512 - Personnel Screening\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1512\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5a8324ad-f599-429b-aaed-f9c6e8c987a8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225a8324ad-f599-429b-aaed-f9c6e8c987a8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs that do not have a minimum password age of 1 day\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have a minimum password age of 1 day. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022MinimumPasswordAge\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5aa11bbc-5c76-4302-80e5-aba46a4282e7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225aa11bbc-5c76-4302-80e5-aba46a4282e7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1032 - Separation Of Duties\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1032\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5aa85661-d618-46b8-a20f-ca40a86f0751\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225aa85661-d618-46b8-a20f-ca40a86f0751\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs that do not restrict the minimum password length to 14 characters\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not restrict the minimum password length to 14 characters. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022MinimumPasswordLength\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5aebc8d1-020d-4037-89a0-02043a7524ec\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225aebc8d1-020d-4037-89a0-02043a7524ec\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1555 - Vulnerability Scanning | Privileged Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1555\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5afa8cab-1ed7-4e40-884c-64e0ac2059cc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225afa8cab-1ed7-4e40-884c-64e0ac2059cc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1205 - Access Restrictions For Change | Signed Components\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1205\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5b070cab-0fb8-4e48-ad29-fc90b4c2797c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225b070cab-0fb8-4e48-ad29-fc90b4c2797c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1005 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1005\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5b626abc-26d4-4e22-9de8-3831818526b1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225b626abc-26d4-4e22-9de8-3831818526b1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1105 - Audit Events\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1105\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5b73f57b-587d-4470-a344-0b0ae805f459\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225b73f57b-587d-4470-a344-0b0ae805f459\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Linux VMs that have the specified applications installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022not_installed_application_linux\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5b842acb-0fe7-41b0-9f40-880ec4ad84d8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225b842acb-0fe7-41b0-9f40-880ec4ad84d8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1433 - Media Transport\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1433\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5b879b41-2728-41c5-ad24-9ee2c37cbe65\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225b879b41-2728-41c5-ad24-9ee2c37cbe65\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Container Registries should be encrypted with a Customer-Managed Key (CMK)\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit Container Registries that do not have encryption enabled with Customer-Managed Keys (CMK). For more information on CMK encryption, please visit: https://aka.ms/acr/CMK.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Container Registry\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerRegistry/registries\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.ContainerRegistry/registries/encryption.status\u0022,\u0022equals\u0022:\u0022enabled\u0022}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225b9159ae-1701-4a6f-9a7a-aa9c8ddd0580\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure WEB app has \u0027Client Certificates (Incoming client certificates)\u0027 set to \u0027On\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/clientCertEnabled\u0022,\u0022equals\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5bb220d9-2698-4ee4-8404-b9c30c9df609\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225bb220d9-2698-4ee4-8404-b9c30c9df609\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs on which the remote host connection status does not match the specified one\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines on which the remote host connection status does not match the specified one. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022host\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Remote Host Name\u0022,\u0022description\u0022:\u0022Specifies the Domain Name System (DNS) name or IP address of the remote host machine.\u0022}},\u0022port\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Port\u0022,\u0022description\u0022:\u0022The TCP port number on the remote host name.\u0022}},\u0022shouldConnect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Should connect to remote host\u0022,\u0022description\u0022:\u0022Must be \u0027True\u0027 or \u0027False\u0027. \u0027True\u0027 indicates that the virtual machine should be able to establish a connection with the remote host specified, so the machine will be non-compliant if it cannot establish a connection. \u0027False\u0027 indicates that the virtual machine should not be able to establish a connection with the remote host specified, so the machine will be non-compliant if it can establish a connection.\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsRemoteConnection\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[WindowsRemoteConnection]WindowsRemoteConnection1;host\u0027, \u0027=\u0027, parameters(\u0027host\u0027), \u0027,\u0027, \u0027[WindowsRemoteConnection]WindowsRemoteConnection1;port\u0027, \u0027=\u0027, parameters(\u0027port\u0027), \u0027,\u0027, \u0027[WindowsRemoteConnection]WindowsRemoteConnection1;shouldConnect\u0027, \u0027=\u0027, parameters(\u0027shouldConnect\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsRemoteConnection\u0022},\u0022host\u0022:{\u0022value\u0022:\u0022[parameters(\u0027host\u0027)]\u0022},\u0022port\u0022:{\u0022value\u0022:\u0022[parameters(\u0027port\u0027)]\u0022},\u0022shouldConnect\u0022:{\u0022value\u0022:\u0022[parameters(\u0027shouldConnect\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022host\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022port\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022shouldConnect\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsRemoteConnection]WindowsRemoteConnection1;host\u0022,\u0022value\u0022:\u0022[parameters(\u0027host\u0027)]\u0022},{\u0022name\u0022:\u0022[WindowsRemoteConnection]WindowsRemoteConnection1;port\u0022,\u0022value\u0022:\u0022[parameters(\u0027port\u0027)]\u0022},{\u0022name\u0022:\u0022[WindowsRemoteConnection]WindowsRemoteConnection1;shouldConnect\u0022,\u0022value\u0022:\u0022[parameters(\u0027shouldConnect\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsRemoteConnection]WindowsRemoteConnection1;host\u0022,\u0022value\u0022:\u0022[parameters(\u0027host\u0027)]\u0022},{\u0022name\u0022:\u0022[WindowsRemoteConnection]WindowsRemoteConnection1;port\u0022,\u0022value\u0022:\u0022[parameters(\u0027port\u0027)]\u0022},{\u0022name\u0022:\u0022[WindowsRemoteConnection]WindowsRemoteConnection1;shouldConnect\u0022,\u0022value\u0022:\u0022[parameters(\u0027shouldConnect\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5bb36dda-8a78-4df9-affd-4f05a8612a8a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225bb36dda-8a78-4df9-affd-4f05a8612a8a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1551 - Vulnerability Scanning | Update Tool Capability\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1551\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5bbda922-0172-4095-89e6-5b4a0bf03af7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225bbda922-0172-4095-89e6-5b4a0bf03af7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Network Security\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Network Security\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsNetworkSecurity\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5c028d2a-1889-45f6-b821-31f42711ced8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225c028d2a-1889-45f6-b821-31f42711ced8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit Log Analytics agent deployment in virtual machine scale sets - VM Image (OS) unlisted\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Reports virtual machine scale sets as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022listOfImageIdToInclude_windows\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Windows OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]},\u0022listOfImageIdToInclude_linux\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Linux OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},{\u0022not\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude_windows\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude_linux\u0027)]\u0022},{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002212*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002214.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002216.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002218.04*LTS\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Oracle\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Oracle-Linux\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227.*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022CentOS\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225c3bc7b8-a64c-4e08-a9cd-7ff0f31e1138\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1671 - Flaw Remediation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1671\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5c5bbef7-a316-415b-9b38-29753ce8e698\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225c5bbef7-a316-415b-9b38-29753ce8e698\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1067 - Wireless Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1067\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5c5e54f6-0127-44d0-8b61-f31dc8dd6190\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225c5e54f6-0127-44d0-8b61-f31dc8dd6190\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022External accounts with write permissions should be removed from your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022External accounts with write privileges should be removed from your subscription in order to prevent unmonitored access.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022RemoveExternalAccountsWithWritePermissions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225c607a2e-c700-4744-8254-d77e7c9eb5e4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1483 - Water Damage Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1483\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5cb81060-3c8a-4968-bcdc-395a1801f6c1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225cb81060-3c8a-4968-bcdc-395a1801f6c1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1362 - Incident Handling\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1362\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5d169442-d6ef-439b-8dca-46c2c3248214\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225d169442-d6ef-439b-8dca-46c2c3248214\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1014 - Account Management | Removal Of Temporary / Emergency Accounts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1014\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5dee936c-8037-4df1-ab35-6635733da48c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225dee936c-8037-4df1-ab35-6635733da48c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1665 - Process Isolation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1665\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5df3a55c-8456-44d4-941e-175f79332512\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225df3a55c-8456-44d4-941e-175f79332512\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Function App should only be accessible over HTTPS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022OnlyHttpsForFunctionApp\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5df82f4f-773a-4a2d-97a2-422a806f1a55\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225df82f4f-773a-4a2d-97a2-422a806f1a55\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1251 - Contingency Plan | Coordinate With Related Plans\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1251\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5e2b3730-8c14-4081-8893-19dbb5de7348\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225e2b3730-8c14-4081-8893-19dbb5de7348\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Web Applications that are not using latest supported .NET Framework\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use the latest supported .NET Framework version for the latest security classes. Using older classes and types can make your application vulnerable.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022WebApp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UseLatestDotNet\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5e3315e0-a414-4efb-a4d2-c7bd2b0443d2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225e3315e0-a414-4efb-a4d2-c7bd2b0443d2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs that do not have the specified applications installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WhitelistedApplication\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5e393799-e3ca-4e43-a9a5-0ec4648a57d9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225e393799-e3ca-4e43-a9a5-0ec4648a57d9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1116 - Audit Review, Analysis, And Reporting\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1116\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5e47bc51-35d1-44b8-92af-e2f2d8b67635\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225e47bc51-35d1-44b8-92af-e2f2d8b67635\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1208 - Configuration Settings\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1208\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5ea87673-d06b-456f-a324-8abcee5c159f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225ea87673-d06b-456f-a324-8abcee5c159f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allow resource creation only in India data centers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Allows resource creation in the following locations only: West India, South India, Central India\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022General\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022in\u0022:[\u0022westindia\u0022,\u0022southindia\u0022,\u0022centralindia\u0022]}},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Log Analytics agent for Linux virtual machine scale sets\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploy Log Analytics agent for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022listOfImageIdToInclude\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Linux OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude\u0027)]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002212*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002214.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002216.04*LTS\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u002218.04*LTS\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Oracle\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Oracle-Linux\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227.*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022CentOS\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/type\u0022,\u0022equals\u0022:\u0022OmsAgentForLinux\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022MMAExtension\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022,\u0022vmExtensionType\u0022:\u0022OmsAgentForLinux\u0022,\u0022vmExtensionTypeHandlerVersion\u0022:\u00221.7\u0022},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022apiVersion\u0022:\u00222018-06-01\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022typeHandlerVersion\u0022:\u0022[variables(\u0027vmExtensionTypeHandlerVersion\u0027)]\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{\u0022workspaceId\u0022:\u0022[reference(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).customerId]\u0022,\u0022stopOnMultipleConnections\u0022:\u0022true\u0022},\u0022protectedSettings\u0022:{\u0022workspaceKey\u0022:\u0022[listKeys(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).primarySharedKey]\u0022}}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1576 - Acquisition Process | Design / Implementation Information For Security Controls\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1576\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5f18c885-ade3-48c5-80b1-8f9216019c18\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225f18c885-ade3-48c5-80b1-8f9216019c18\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022External accounts with read permissions should be removed from your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022External accounts with read privileges should be removed from your subscription in order to prevent unmonitored access.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022RemoveExternalAccountsWithReadPermissions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5f76cf89-fbf2-47fd-a3f4-b891fa780b60\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225f76cf89-fbf2-47fd-a3f4-b891fa780b60\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit prerequisites to enable Guest Configuration policies on Windows VMs.\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This definition allows Azure Policy to audit the Azure Policy for Windows extension on Windows VMs. The extension is a prerequisite for Guest Configuration policies. For more information on Guest Configuration policies, visit https://aka.ms/gcpol.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022name\u0022:\u0022AzurePolicyforWindows\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.GuestConfiguration\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022ConfigurationforWindows\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5fc23db3-dd4d-4c56-bcc7-43626243e601\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225fc23db3-dd4d-4c56-bcc7-43626243e601\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Add or replace a tag on resources\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Adds or replaces the specified tag and value when any resource is created or updated. Existing resources can be remediated by triggering a remediation task. Does not modify tags on resource groups.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}},\u0022tagValue\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Value\u0022,\u0022description\u0022:\u0022Value of the tag, such as \u0027production\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022notEquals\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022modify\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022operations\u0022:[{\u0022operation\u0022:\u0022addOrReplace\u0022,\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}]}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5ffd78d9-436d-4b41-a421-5baa819e3008\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225ffd78d9-436d-4b41-a421-5baa819e3008\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1663 - Protection Of Information At Rest\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1663\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/60171210-6dde-40af-a144-bf2670518bfa\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002260171210-6dde-40af-a144-bf2670518bfa\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027System Audit Policies - Object Access\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Object Access\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesObjectAccess\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/60aeaf73-a074-417a-905f-7ce9df0ff77b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002260aeaf73-a074-417a-905f-7ce9df0ff77b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Storage Accounts should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Storage Account not configured to use a virtual network service endpoint.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Storage/storageAccounts\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/networkAcls.defaultAction\u0022,\u0022notEquals\u0022:\u0022Deny\u0022},{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/networkAcls.virtualNetworkRules[*].id\u0022,\u0022exists\u0022:\u0022false\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/60d21c4f-21a3-4d94-85f4-b924e6aeeda4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002260d21c4f-21a3-4d94-85f4-b924e6aeeda4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows web servers that are not using secure communication protocols\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows web servers that are not using secure communication protocols (TLS 1.1 or TLS 1.2). For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AuditSecureProtocol\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/60ffe3e2-4604-4460-8f22-0f1da058266c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002260ffe3e2-4604-4460-8f22-0f1da058266c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Advanced Data Security on SQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy enables Advanced Data Security on SQL Servers. This includes turning on Threat Detection and Vulnerability Assessment. It will automatically create a storage account in the same region and resource group as the SQL server to store scan results, with a \u0027sqlva\u0027 prefix.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022DeployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies\u0022,\u0022name\u0022:\u0022Default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/securityAlertPolicies.state\u0022,\u0022equals\u0022:\u0022Enabled\u0022},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022serverName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022serverResourceGroupName\u0022:\u0022[resourceGroup().name]\u0022,\u0022subscriptionId\u0022:\u0022[subscription().subscriptionId]\u0022,\u0022uniqueStorage\u0022:\u0022[uniqueString(variables(\u0027subscriptionId\u0027), variables(\u0027serverResourceGroupName\u0027), parameters(\u0027location\u0027))]\u0022,\u0022storageName\u0022:\u0022[tolower(concat(\u0027sqlva\u0027, variables(\u0027uniqueStorage\u0027)))]\u0022},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Storage/storageAccounts\u0022,\u0022name\u0022:\u0022[variables(\u0027storageName\u0027)]\u0022,\u0022apiVersion\u0022:\u00222019-04-01\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022sku\u0022:{\u0022name\u0022:\u0022Standard_LRS\u0022},\u0022kind\u0022:\u0022StorageV2\u0022,\u0022properties\u0022:{}},{\u0022name\u0022:\u0022[concat(parameters(\u0027serverName\u0027), \u0027/Default\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies\u0022,\u0022apiVersion\u0022:\u00222017-03-01-preview\u0022,\u0022properties\u0022:{\u0022state\u0022:\u0022Enabled\u0022,\u0022emailAccountAdmins\u0022:true}},{\u0022name\u0022:\u0022[concat(parameters(\u0027serverName\u0027), \u0027/Default\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Sql/servers/vulnerabilityAssessments\u0022,\u0022apiVersion\u0022:\u00222018-06-01-preview\u0022,\u0022properties\u0022:{\u0022storageContainerPath\u0022:\u0022[concat(reference(resourceId(\u0027Microsoft.Storage/storageAccounts\u0027, variables(\u0027storageName\u0027))).primaryEndpoints.blob, \u0027vulnerability-assessment\u0027)]\u0022,\u0022storageAccountAccessKey\u0022:\u0022[listKeys(resourceId(\u0027Microsoft.Storage/storageAccounts\u0027, variables(\u0027storageName\u0027)), \u00272018-02-01\u0027).keys[0].value]\u0022,\u0022recurringScans\u0022:{\u0022isEnabled\u0022:true,\u0022emailSubscriptionAdmins\u0022:true,\u0022emails\u0022:[]}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Storage/storageAccounts/\u0027, variables(\u0027storageName\u0027))]\u0022,\u0022[concat(\u0027Microsoft.Sql/servers/\u0027, parameters(\u0027serverName\u0027), \u0027/securityAlertPolicies/Default\u0027)]\u0022]}]},\u0022parameters\u0022:{\u0022serverName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6134c3db-786f-471e-87bc-8f479dc890f6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226134c3db-786f-471e-87bc-8f479dc890f6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Configure time zone on Windows machines.\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to set specified time zone on Windows virtual machines.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022TimeZone\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Time zone\u0022,\u0022description\u0022:\u0022The expected time zone\u0022},\u0022allowedValues\u0022:[\u0022(UTC-12:00) International Date Line West\u0022,\u0022(UTC-11:00) Coordinated Universal Time-11\u0022,\u0022(UTC-10:00) Aleutian Islands\u0022,\u0022(UTC-10:00) Hawaii\u0022,\u0022(UTC-09:30) Marquesas Islands\u0022,\u0022(UTC-09:00) Alaska\u0022,\u0022(UTC-09:00) Coordinated Universal Time-09\u0022,\u0022(UTC-08:00) Baja California\u0022,\u0022(UTC-08:00) Coordinated Universal Time-08\u0022,\u0022(UTC-08:00) Pacific Time (US \u0026 Canada)\u0022,\u0022(UTC-07:00) Arizona\u0022,\u0022(UTC-07:00) Chihuahua, La Paz, Mazatlan\u0022,\u0022(UTC-07:00) Mountain Time (US \u0026 Canada)\u0022,\u0022(UTC-06:00) Central America\u0022,\u0022(UTC-06:00) Central Time (US \u0026 Canada)\u0022,\u0022(UTC-06:00) Easter Island\u0022,\u0022(UTC-06:00) Guadalajara, Mexico City, Monterrey\u0022,\u0022(UTC-06:00) Saskatchewan\u0022,\u0022(UTC-05:00) Bogota, Lima, Quito, Rio Branco\u0022,\u0022(UTC-05:00) Chetumal\u0022,\u0022(UTC-05:00) Eastern Time (US \u0026 Canada)\u0022,\u0022(UTC-05:00) Haiti\u0022,\u0022(UTC-05:00) Havana\u0022,\u0022(UTC-05:00) Indiana (East)\u0022,\u0022(UTC-05:00) Turks and Caicos\u0022,\u0022(UTC-04:00) Asuncion\u0022,\u0022(UTC-04:00) Atlantic Time (Canada)\u0022,\u0022(UTC-04:00) Caracas\u0022,\u0022(UTC-04:00) Cuiaba\u0022,\u0022(UTC-04:00) Georgetown, La Paz, Manaus, San Juan\u0022,\u0022(UTC-04:00) Santiago\u0022,\u0022(UTC-03:30) Newfoundland\u0022,\u0022(UTC-03:00) Araguaina\u0022,\u0022(UTC-03:00) Brasilia\u0022,\u0022(UTC-03:00) Cayenne, Fortaleza\u0022,\u0022(UTC-03:00) City of Buenos Aires\u0022,\u0022(UTC-03:00) Greenland\u0022,\u0022(UTC-03:00) Montevideo\u0022,\u0022(UTC-03:00) Punta Arenas\u0022,\u0022(UTC-03:00) Saint Pierre and Miquelon\u0022,\u0022(UTC-03:00) Salvador\u0022,\u0022(UTC-02:00) Coordinated Universal Time-02\u0022,\u0022(UTC-02:00) Mid-Atlantic - Old\u0022,\u0022(UTC-01:00) Azores\u0022,\u0022(UTC-01:00) Cabo Verde Is.\u0022,\u0022(UTC) Coordinated Universal Time\u0022,\u0022(UTC\u002B00:00) Dublin, Edinburgh, Lisbon, London\u0022,\u0022(UTC\u002B00:00) Monrovia, Reykjavik\u0022,\u0022(UTC\u002B00:00) Sao Tome\u0022,\u0022(UTC\u002B01:00) Casablanca\u0022,\u0022(UTC\u002B01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna\u0022,\u0022(UTC\u002B01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague\u0022,\u0022(UTC\u002B01:00) Brussels, Copenhagen, Madrid, Paris\u0022,\u0022(UTC\u002B01:00) Sarajevo, Skopje, Warsaw, Zagreb\u0022,\u0022(UTC\u002B01:00) West Central Africa\u0022,\u0022(UTC\u002B02:00) Amman\u0022,\u0022(UTC\u002B02:00) Athens, Bucharest\u0022,\u0022(UTC\u002B02:00) Beirut\u0022,\u0022(UTC\u002B02:00) Cairo\u0022,\u0022(UTC\u002B02:00) Chisinau\u0022,\u0022(UTC\u002B02:00) Damascus\u0022,\u0022(UTC\u002B02:00) Gaza, Hebron\u0022,\u0022(UTC\u002B02:00) Harare, Pretoria\u0022,\u0022(UTC\u002B02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius\u0022,\u0022(UTC\u002B02:00) Jerusalem\u0022,\u0022(UTC\u002B02:00) Kaliningrad\u0022,\u0022(UTC\u002B02:00) Khartoum\u0022,\u0022(UTC\u002B02:00) Tripoli\u0022,\u0022(UTC\u002B02:00) Windhoek\u0022,\u0022(UTC\u002B03:00) Baghdad\u0022,\u0022(UTC\u002B03:00) Istanbul\u0022,\u0022(UTC\u002B03:00) Kuwait, Riyadh\u0022,\u0022(UTC\u002B03:00) Minsk\u0022,\u0022(UTC\u002B03:00) Moscow, St. Petersburg\u0022,\u0022(UTC\u002B03:00) Nairobi\u0022,\u0022(UTC\u002B03:30) Tehran\u0022,\u0022(UTC\u002B04:00) Abu Dhabi, Muscat\u0022,\u0022(UTC\u002B04:00) Astrakhan, Ulyanovsk\u0022,\u0022(UTC\u002B04:00) Baku\u0022,\u0022(UTC\u002B04:00) Izhevsk, Samara\u0022,\u0022(UTC\u002B04:00) Port Louis\u0022,\u0022(UTC\u002B04:00) Saratov\u0022,\u0022(UTC\u002B04:00) Tbilisi\u0022,\u0022(UTC\u002B04:00) Volgograd\u0022,\u0022(UTC\u002B04:00) Yerevan\u0022,\u0022(UTC\u002B04:30) Kabul\u0022,\u0022(UTC\u002B05:00) Ashgabat, Tashkent\u0022,\u0022(UTC\u002B05:00) Ekaterinburg\u0022,\u0022(UTC\u002B05:00) Islamabad, Karachi\u0022,\u0022(UTC\u002B05:00) Qyzylorda\u0022,\u0022(UTC\u002B05:30) Chennai, Kolkata, Mumbai, New Delhi\u0022,\u0022(UTC\u002B05:30) Sri Jayawardenepura\u0022,\u0022(UTC\u002B05:45) Kathmandu\u0022,\u0022(UTC\u002B06:00) Astana\u0022,\u0022(UTC\u002B06:00) Dhaka\u0022,\u0022(UTC\u002B06:00) Omsk\u0022,\u0022(UTC\u002B06:30) Yangon (Rangoon)\u0022,\u0022(UTC\u002B07:00) Bangkok, Hanoi, Jakarta\u0022,\u0022(UTC\u002B07:00) Barnaul, Gorno-Altaysk\u0022,\u0022(UTC\u002B07:00) Hovd\u0022,\u0022(UTC\u002B07:00) Krasnoyarsk\u0022,\u0022(UTC\u002B07:00) Novosibirsk\u0022,\u0022(UTC\u002B07:00) Tomsk\u0022,\u0022(UTC\u002B08:00) Beijing, Chongqing, Hong Kong, Urumqi\u0022,\u0022(UTC\u002B08:00) Irkutsk\u0022,\u0022(UTC\u002B08:00) Kuala Lumpur, Singapore\u0022,\u0022(UTC\u002B08:00) Perth\u0022,\u0022(UTC\u002B08:00) Taipei\u0022,\u0022(UTC\u002B08:00) Ulaanbaatar\u0022,\u0022(UTC\u002B08:45) Eucla\u0022,\u0022(UTC\u002B09:00) Chita\u0022,\u0022(UTC\u002B09:00) Osaka, Sapporo, Tokyo\u0022,\u0022(UTC\u002B09:00) Pyongyang\u0022,\u0022(UTC\u002B09:00) Seoul\u0022,\u0022(UTC\u002B09:00) Yakutsk\u0022,\u0022(UTC\u002B09:30) Adelaide\u0022,\u0022(UTC\u002B09:30) Darwin\u0022,\u0022(UTC\u002B10:00) Brisbane\u0022,\u0022(UTC\u002B10:00) Canberra, Melbourne, Sydney\u0022,\u0022(UTC\u002B10:00) Guam, Port Moresby\u0022,\u0022(UTC\u002B10:00) Hobart\u0022,\u0022(UTC\u002B10:00) Vladivostok\u0022,\u0022(UTC\u002B10:30) Lord Howe Island\u0022,\u0022(UTC\u002B11:00) Bougainville Island\u0022,\u0022(UTC\u002B11:00) Chokurdakh\u0022,\u0022(UTC\u002B11:00) Magadan\u0022,\u0022(UTC\u002B11:00) Norfolk Island\u0022,\u0022(UTC\u002B11:00) Sakhalin\u0022,\u0022(UTC\u002B11:00) Solomon Is., New Caledonia\u0022,\u0022(UTC\u002B12:00) Anadyr, Petropavlovsk-Kamchatsky\u0022,\u0022(UTC\u002B12:00) Auckland, Wellington\u0022,\u0022(UTC\u002B12:00) Coordinated Universal Time\u002B12\u0022,\u0022(UTC\u002B12:00) Fiji\u0022,\u0022(UTC\u002B12:00) Petropavlovsk-Kamchatsky - Old\u0022,\u0022(UTC\u002B12:45) Chatham Islands\u0022,\u0022(UTC\u002B13:00) Coordinated Universal Time\u002B13\u0022,\u0022(UTC\u002B13:00) Nuku\u0027alofa\u0022,\u0022(UTC\u002B13:00) Samoa\u0022,\u0022(UTC\u002B14:00) Kiritimati Island\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022SetWindowsTimeZone\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[WindowsTimeZone]WindowsTimeZone1;TimeZone\u0027, \u0027=\u0027, parameters(\u0027TimeZone\u0027)))]\u0022},{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022SetWindowsTimeZone\u0022},\u0022TimeZone\u0022:{\u0022value\u0022:\u0022[parameters(\u0027TimeZone\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022TimeZone\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022assignmentType\u0022:\u0022DeployAndAutoCorrect\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsTimeZone]WindowsTimeZone1;TimeZone\u0022,\u0022value\u0022:\u0022[parameters(\u0027TimeZone\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022assignmentType\u0022:\u0022DeployAndAutoCorrect\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsTimeZone]WindowsTimeZone1;TimeZone\u0022,\u0022value\u0022:\u0022[parameters(\u0027TimeZone\u0027)]\u0022}]}}}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6141c932-9384-44c6-a395-59e4c057d7c9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226141c932-9384-44c6-a395-59e4c057d7c9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Service Fabric provides three levels of protection (None, Sign and EncryptAndSign) for node-to-node communication using a primary cluster certificate. Set the protection level to ensure that all node-to-node messages are encrypted and digitally signed\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Service Fabric\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ServiceFabric/clusters\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.ServiceFabric/clusters/fabricSettings[*].name\u0022,\u0022notEquals\u0022:\u0022Security\u0022},{\u0022field\u0022:\u0022Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].name\u0022,\u0022notEquals\u0022:\u0022ClusterProtectionLevel\u0022},{\u0022field\u0022:\u0022Microsoft.ServiceFabric/clusters/fabricSettings[*].parameters[*].value\u0022,\u0022notEquals\u0022:\u0022EncryptAndSign\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022617c02be-7f02-4efd-8836-3180d47b6c68\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1110 - Audit Storage Capacity\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1110\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6182bfa7-0f2a-43f5-834a-a2ddf31c13c7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226182bfa7-0f2a-43f5-834a-a2ddf31c13c7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1415 - Nonlocal Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1415\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/61a1dd98-b259-4840-abd5-fbba7ee0da83\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002261a1dd98-b259-4840-abd5-fbba7ee0da83\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1153 - System Interconnections\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1153\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/61cf3125-142c-4754-8a16-41ab4d529635\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002261cf3125-142c-4754-8a16-41ab4d529635\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - System objects\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - System objects\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsSystemobjects\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/620e58b5-ac75-49b4-993f-a9d4f0459636\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022620e58b5-ac75-49b4-993f-a9d4f0459636\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1682 - Malicious Code Protection | Nonsignature-Based Detection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1682\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/62b638c5-29d7-404b-8d93-f21e4b1ce198\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002262b638c5-29d7-404b-8d93-f21e4b1ce198\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1660 - Session Authenticity\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1660\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/63096613-ce83-43e5-96f4-e588e8813554\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002263096613-ce83-43e5-96f4-e588e8813554\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1002 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1002\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/632024c2-8079-439d-a7f6-90af1d78cc65\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022632024c2-8079-439d-a7f6-90af1d78cc65\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1498 - Rules Of Behavior\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1498\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/633988b9-cf2f-4323-8394-f0d2af9cd6e1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022633988b9-cf2f-4323-8394-f0d2af9cd6e1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1177 - Baseline Configuration | Reviews And Updates\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1177\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/63dbc7a8-e20b-4d38-b857-a7f6c0cd94bc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002263dbc7a8-e20b-4d38-b857-a7f6c0cd94bc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1185 - Configuration Change Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1185\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6420cd73-b939-43b7-9d99-e8688fea053c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226420cd73-b939-43b7-9d99-e8688fea053c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Devices\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Devices\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022DevicesAllowedToFormatAndEjectRemovableMedia\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Devices: Allowed to format and eject removable media\u0022,\u0022description\u0022:\u0022Specifies who is allowed to format and eject removable NTFS media. You can use this policy setting to prevent unauthorized users from removing data on one computer to access it on another computer on which they have local administrator privileges.\u0022},\u0022defaultValue\u0022:\u00220\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsDevices\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Devices: Allowed to format and eject removable media;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027DevicesAllowedToFormatAndEjectRemovableMedia\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsDevices\u0022},\u0022DevicesAllowedToFormatAndEjectRemovableMedia\u0022:{\u0022value\u0022:\u0022[parameters(\u0027DevicesAllowedToFormatAndEjectRemovableMedia\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022DevicesAllowedToFormatAndEjectRemovableMedia\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Devices: Allowed to format and eject removable media;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027DevicesAllowedToFormatAndEjectRemovableMedia\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Devices: Allowed to format and eject removable media;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027DevicesAllowedToFormatAndEjectRemovableMedia\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6481cc21-ed6e-4480-99dd-ea7c5222e897\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226481cc21-ed6e-4480-99dd-ea7c5222e897\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1441 - Media Sanitization | Equipment Testing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1441\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6519d7f3-e8a2-4ff3-a935-9a9497152ad7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226519d7f3-e8a2-4ff3-a935-9a9497152ad7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1558 - Vulnerability Scanning | Correlate Scanning Information\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1558\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/65592b16-4367-42c5-a26e-d371be450e17\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002265592b16-4367-42c5-a26e-d371be450e17\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit missing blob encryption for storage accounts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy is no longer necessary because storage blob encryption is enabled by default and cannot be turned off.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Storage/storageAccounts\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/enableBlobEncryption\u0022,\u0022equals\u0022:\u0022True\u0022}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022655cb504-bcee-4362-bd4c-402e6aa38759\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1261 - Contingency Plan Testing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1261\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/65aeceb5-a59c-4cb1-8d82-9c474be5d431\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002265aeceb5-a59c-4cb1-8d82-9c474be5d431\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit IP restrictions configuration for a Function App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects a Function app from common attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022ConfigureIPRestrictions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/664346d9-be92-43fb-a219-d595eeb76a90\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022664346d9-be92-43fb-a219-d595eeb76a90\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1444 - Media Use | Prohibit Use Without Owner\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1444\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/666143df-f5e0-45bd-b554-135f0f93e44e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022666143df-f5e0-45bd-b554-135f0f93e44e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1319 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1319\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/66f7ae57-5560-4fc5-85c9-659f204e7a42\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002266f7ae57-5560-4fc5-85c9-659f204e7a42\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1628 - Boundary Protection | External Telecommunications Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1628\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/67de62b4-a737-4781-8861-3baed3c35069\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002267de62b4-a737-4781-8861-3baed3c35069\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1377 - Incident Response Assistance | Coordination With External Providers\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1377\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/68434bd1-e14b-4031-9edb-a4adf5f84a67\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002268434bd1-e14b-4031-9edb-a4adf5f84a67\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs on which the Log Analytics agent is not connected as expected\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines on which the Log Analytics agent is not connected to the specified workspaces. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022WorkspaceId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Connected workspace IDs\u0022,\u0022description\u0022:\u0022A semicolon-separated list of the workspace IDs that the Log Analytics agent should be connected to\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsLogAnalyticsAgentConnection\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[LogAnalyticsAgent]LogAnalyticsAgent1;WorkspaceId\u0027, \u0027=\u0027, parameters(\u0027WorkspaceId\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsLogAnalyticsAgentConnection\u0022},\u0022WorkspaceId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WorkspaceId\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WorkspaceId\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[LogAnalyticsAgent]LogAnalyticsAgent1;WorkspaceId\u0022,\u0022value\u0022:\u0022[parameters(\u0027WorkspaceId\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[LogAnalyticsAgent]LogAnalyticsAgent1;WorkspaceId\u0022,\u0022value\u0022:\u0022[parameters(\u0027WorkspaceId\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/68511db2-bd02-41c4-ae6b-1900a012968a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002268511db2-bd02-41c4-ae6b-1900a012968a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1597 - Developer Configuration Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1597\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/68b250ec-2e4f-4eee-898a-117a9fda7016\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002268b250ec-2e4f-4eee-898a-117a9fda7016\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1588 - External Information System Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1588\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/68ebae26-e0e0-4ecb-8379-aabf633b51e9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002268ebae26-e0e0-4ecb-8379-aabf633b51e9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1070 - Wireless Access | Disable Wireless Networking\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1070\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/68f837d0-8942-4b1e-9b31-be78b247bda8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002268f837d0-8942-4b1e-9b31-be78b247bda8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1727 - Memory Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1727\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/697175a7-9715-4e89-b98b-c6f605888fa3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022697175a7-9715-4e89-b98b-c6f605888fa3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1652 - Mobile Code\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1652\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6998e84a-2d29-4e10-8962-76754d4f772d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226998e84a-2d29-4e10-8962-76754d4f772d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy Log Analytics agent to Windows Azure Arc machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy deploys the Log Analytics agent to Windows Azure Arc machines if the agent isn\u0027t installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-preview\u0022,\u0022category\u0022:\u0022Monitoring\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/type\u0022,\u0022equals\u0022:\u0022MicrosoftMonitoringAgent\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022MMAExtension\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022,\u0022vmExtensionType\u0022:\u0022MicrosoftMonitoringAgent\u0022},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022apiVersion\u0022:\u00222019-12-12\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022settings\u0022:{\u0022workspaceId\u0022:\u0022[reference(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).customerId]\u0022,\u0022stopOnMultipleConnections\u0022:\u0022true\u0022},\u0022protectedSettings\u0022:{\u0022workspaceKey\u0022:\u0022[listKeys(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).primarySharedKey]\u0022}}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for VM\u0027, \u0027: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/69af7d4a-7b18-4044-93a9-2651498ef203\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002269af7d4a-7b18-4044-93a9-2651498ef203\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1699 - Information System Monitoring | Privileged Users\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1699\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/69c7bee8-bc19-4129-a51e-65a7b39d3e7c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002269c7bee8-bc19-4129-a51e-65a7b39d3e7c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1696 - Information System Monitoring | Correlate Monitoring Information\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1696\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/69d2a238-20ab-4206-a6dc-f302bf88b1b8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002269d2a238-20ab-4206-a6dc-f302bf88b1b8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1244 - Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1244\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6a13a8f8-c163-4b1b-8554-d63569dab937\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226a13a8f8-c163-4b1b-8554-d63569dab937\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1019 - Account Management | Role-Based Schemes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1019\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6a3ee9b2-3977-459c-b8ce-2db583abd9f7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226a3ee9b2-3977-459c-b8ce-2db583abd9f7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Deploy prerequisites to audit Windows VMs on which Windows Defender Exploit Guard is not enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines on which Windows Defender Exploit Guard is not enabled. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-deprecated\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022NotAvailableMachineState\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: State in which to show VMs on which Windows Defender Exploit Guard is not available\u0022,\u0022description\u0022:\u0022Windows Defender Exploit Guard is only available starting with Windows 10/Windows Server with update 1709. Setting this value to \u0027Non-Compliant\u0027 will make machines with older versions on which Windows Defender Exploit Guard is not available (such as Windows Server 2012 R2) non-compliant. Setting this value to \u0027Compliant\u0027 will make these machines compliant.\u0022},\u0022allowedValues\u0022:[\u0022Compliant\u0022,\u0022Non-Compliant\u0022],\u0022defaultValue\u0022:\u0022Non-Compliant\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsDefenderExploitGuard\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState\u0027, \u0027=\u0027, parameters(\u0027NotAvailableMachineState\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsDefenderExploitGuard\u0022},\u0022NotAvailableMachineState\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NotAvailableMachineState\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NotAvailableMachineState\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState\u0022,\u0022value\u0022:\u0022[parameters(\u0027NotAvailableMachineState\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState\u0022,\u0022value\u0022:\u0022[parameters(\u0027NotAvailableMachineState\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6a7a2bcf-f9be-4e35-9734-4f9657a70f1d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226a7a2bcf-f9be-4e35-9734-4f9657a70f1d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit IP restrictions configuration for a Web Application\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022IP Restrictions allow you to define a list of IP addresses that are allowed to access your app. Use of IP Restrictions protects a web application from common attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022WebApp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022ConfigureIPRestrictions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6a8450e2-6c61-43b4-be65-62e3a197bffe\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226a8450e2-6c61-43b4-be65-62e3a197bffe\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1211 - Configuration Settings\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1211\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6a8b9dc8-6b00-4701-aa96-bba3277ebf50\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226a8b9dc8-6b00-4701-aa96-bba3277ebf50\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Ensure WEB app is using the latest version of TLS encryption \u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Please use /providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b instead. The TLS(Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards, such as PCI DSS.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022App Service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.minTlsVersion\u0022,\u0022equals\u0022:\u00221.2\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6ad61431-88ce-4357-a0e1-6da43f292bd7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226ad61431-88ce-4357-a0e1-6da43f292bd7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1653 - Mobile Code\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1653\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6b1c00a7-7fd0-42b0-8c5b-c45f6fa1f71b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226b1c00a7-7fd0-42b0-8c5b-c45f6fa1f71b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deprecated accounts should be removed from your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Deprecated accounts should be removed from your subscriptions.  Deprecated accounts are accounts that have been blocked from signing in.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022RemoveDeprecatedAccounts\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226b1cbf55-e8b6-442f-ba4c-7246b6381474\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Service Bus to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Service Bus to stream to a regional Event Hub when any Service Bus which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_eventHub\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022eventHubLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Location\u0022,\u0022description\u0022:\u0022The location the Event Hub resides in. Only Service Bus in this location will be linked to this Event Hub.\u0022,\u0022strongType\u0022:\u0022location\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ServiceBus/namespaces\u0022},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.ServiceBus/namespaces/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022OperationalLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6b51af03-9277-49a9-a3f8-1c69c9ff7403\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226b51af03-9277-49a9-a3f8-1c69c9ff7403\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1031 - Separation Of Duties\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1031\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6b93a801-fe25-4574-a60d-cb22acffae00\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226b93a801-fe25-4574-a60d-cb22acffae00\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Not allowed resource types\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy enables you to specify the resource types that your organization cannot deploy.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022General\u0022},\u0022parameters\u0022:{\u0022listOfResourceTypesNotAllowed\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022The list of resource types that cannot be deployed.\u0022,\u0022displayName\u0022:\u0022Not allowed resource types\u0022,\u0022strongType\u0022:\u0022resourceTypes\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfResourceTypesNotAllowed\u0027)]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226c112d4e-5bc7-47ae-a041-ea2d9dccd749\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1338 - Authenticator Management | Automated Support  For Password Strength Determination\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1338\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6c59a207-6aed-41dc-83a2-e1ff66e4a4db\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226c59a207-6aed-41dc-83a2-e1ff66e4a4db\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1304 - Identification And Authentication (Org. Users) | Local Access To Non-Privileged Accounts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1304\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6ca71be3-16cb-4d39-8b50-7f8fd5e2f11b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226ca71be3-16cb-4d39-8b50-7f8fd5e2f11b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1437 - Media Transport | Cryptographic Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1437\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6d1eb6ed-bf13-4046-b993-b9e2aef0f76c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226d1eb6ed-bf13-4046-b993-b9e2aef0f76c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1171 - Penetration Testing | Independent Penetration Agent Or Team\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1171\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6d4820bc-8b61-4982-9501-2123cb776c00\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226d4820bc-8b61-4982-9501-2123cb776c00\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Function App should only be accessible over HTTPS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/httpsOnly\u0022,\u0022equals\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226d555dd1-86f2-4f1c-8ed7-5abae7c6cbab\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1643 - Cryptographic Key Establishment And Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1643\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6d8d492c-dd7a-46f7-a723-fa66a425b87c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226d8d492c-dd7a-46f7-a723-fa66a425b87c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1291 - Information System Backup | Testing For Reliability / Integrity\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1291\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6d8fd073-9c85-4ee2-a9d0-2e4ec9eb8912\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226d8fd073-9c85-4ee2-a9d0-2e4ec9eb8912\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1175 - Configuration Management Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1175\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6dab4254-c30d-4bb7-ae99-1d21586c063c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226dab4254-c30d-4bb7-ae99-1d21586c063c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1651 - Mobile Code\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1651\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6db63528-c9ba-491c-8a80-83e1e6977a50\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226db63528-c9ba-491c-8a80-83e1e6977a50\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Enable Security Center\u0027s auto provisioning of the Log Analytics agent on your subscriptions with default workspace.\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Allow Security Center to auto provision the Log Analytics agent on your subscriptions to monitor and collect security data using ASC default workspace.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/autoProvisioningSettings\u0022,\u0022deploymentScope\u0022:\u0022Subscription\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/autoProvisioningSettings/autoProvision\u0022,\u0022equals\u0022:\u0022On\u0022},\u0022deployment\u0022:{\u0022location\u0022:\u0022westus\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Security/autoProvisioningSettings\u0022,\u0022name\u0022:\u0022default\u0022,\u0022apiVersion\u0022:\u00222017-08-01-preview\u0022,\u0022properties\u0022:{\u0022autoProvision\u0022:\u0022On\u0022}}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6df2fee6-a9ed-4fef-bced-e13be1b25f1c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226df2fee6-a9ed-4fef-bced-e13be1b25f1c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Email notification for high severity alerts should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enable emailing security alerts to the security contact, in order to have them receive security alert emails from Microsoft. This ensures that the right people are aware of any potential security issues and are able to mitigate the risks\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/securityContacts\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/securityContacts/alertNotifications\u0022,\u0022notEquals\u0022:\u0022Off\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6e2593d9-add6-4083-9c9b-4b7d2188c899\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226e2593d9-add6-4083-9c9b-4b7d2188c899\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1586 - External Information System Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1586\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6e3b2fbd-8f37-4766-a64d-3f37703dcb51\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226e3b2fbd-8f37-4766-a64d-3f37703dcb51\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1536 - Risk Assessment Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1536\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6e40d9de-2ad4-4cb5-8945-23143326a502\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226e40d9de-2ad4-4cb5-8945-23143326a502\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1530 - Third-Party Personnel Security\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1530\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6e8f9566-29f1-49cd-b61f-f8628a3cf993\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226e8f9566-29f1-49cd-b61f-f8628a3cf993\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1460 - Access Control For Output Devices\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1460\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6f3ce1bb-4f77-4695-8355-70b08d54fdda\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226f3ce1bb-4f77-4695-8355-70b08d54fdda\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1320 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1320\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6f54c732-71d4-4f93-a696-4e373eca3a77\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226f54c732-71d4-4f93-a696-4e373eca3a77\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allow resource creation only in Japan data centers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Allows resource creation in the following locations only: Japan East, Japan West\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022General\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022in\u0022:[\u0022japaneast\u0022,\u0022japanwest\u0022]}},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226fdb9205-3462-4cfc-87d8-16c7860b53f4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1141 - Audit Generation | Changes By Authorized Individuals\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1141\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6fdefbf4-93e7-4513-bc95-c1858b7093e0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226fdefbf4-93e7-4513-bc95-c1858b7093e0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Microsoft Network Server\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Microsoft Network Server\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsMicrosoftNetworkServer\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/6fe4ef56-7576-4dc4-8e9c-26bad4b087ce\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00226fe4ef56-7576-4dc4-8e9c-26bad4b087ce\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027Python version\u0027 is the latest, if used as a part of the Web app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest Python version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022WindowsPythonLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Windows Latest Python version\u0022,\u0022description\u0022:\u0022Latest supported Python version for App Services\u0022},\u0022defaultValue\u0022:\u00223.6\u0022},\u0022LinuxPythonLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Linux Latest Python version\u0022,\u0022description\u0022:\u0022Latest supported Python version for App Services\u0022},\u0022defaultValue\u0022:\u00223.8\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022notContains\u0022:\u0022PYTHON\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.pythonVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022[concat(\u0027PYTHON|\u0027, parameters(\u0027LinuxPythonLatestVersion\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.pythonVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.pythonVersion\u0022,\u0022equals\u0022:\u0022[parameters(\u0027WindowsPythonLatestVersion\u0027)]\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7008174a-fd10-4ef0-817e-fc820a951d73\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227008174a-fd10-4ef0-817e-fc820a951d73\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Windows Components\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Windows Components\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022SendFileSamplesWhenFurtherAnalysisIsRequired\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Send file samples when further analysis is required\u0022,\u0022description\u0022:\u0022Specifies whether and how Windows Defender will submit samples of suspected malware  to Microsoft for further analysis when opt-in for MAPS telemetry is set.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022AllowIndexingOfEncryptedFiles\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allow indexing of encrypted files\u0022,\u0022description\u0022:\u0022Specifies whether encrypted items are allowed to be indexed.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022AllowTelemetry\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allow Telemetry\u0022,\u0022description\u0022:\u0022Specifies configuration of the amount of diagnostic and usage data reported to Microsoft. The data is transmitted securely and sensitive data is not sent.\u0022},\u0022defaultValue\u0022:\u00222\u0022},\u0022AllowUnencryptedTraffic\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allow unencrypted traffic\u0022,\u0022description\u0022:\u0022Specifies whether the Windows Remote Management (WinRM) service sends and receives unencrypted messages over the network.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022AlwaysInstallWithElevatedPrivileges\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Always install with elevated privileges\u0022,\u0022description\u0022:\u0022Specifies whether Windows Installer should use system permissions when it installs any program on the system.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022AlwaysPromptForPasswordUponConnection\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Always prompt for password upon connection\u0022,\u0022description\u0022:\u0022Specifies whether Terminal Services/Remote Desktop Connection always prompts the client computer for a password upon connection.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022ApplicationSpecifyTheMaximumLogFileSizeKB\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Application: Specify the maximum log file size (KB)\u0022,\u0022description\u0022:\u0022Specifies the maximum size for the Application event log in kilobytes.\u0022},\u0022defaultValue\u0022:\u002232768\u0022},\u0022AutomaticallySendMemoryDumpsForOSgeneratedErrorReports\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Automatically send memory dumps for OS-generated error reports\u0022,\u0022description\u0022:\u0022Specifies if memory dumps in support of OS-generated error reports can be sent to Microsoft automatically.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022ConfigureDefaultConsent\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Configure Default consent\u0022,\u0022description\u0022:\u0022Specifies setting of the default consent handling for error reports sent to Microsoft.\u0022},\u0022defaultValue\u0022:\u00224\u0022},\u0022ConfigureWindowsSmartScreen\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Configure Windows SmartScreen\u0022,\u0022description\u0022:\u0022Specifies how to manage the behavior of Windows SmartScreen. Windows SmartScreen helps keep PCs safer by warning users before running unrecognized programs downloaded from the Internet. Some information is sent to Microsoft about files and programs run on PCs with this feature enabled.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022DisallowDigestAuthentication\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Disallow Digest authentication\u0022,\u0022description\u0022:\u0022Specifies whether the Windows Remote Management (WinRM) client will not use Digest authentication.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022DisallowWinRMFromStoringRunAsCredentials\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Disallow WinRM from storing RunAs credentials\u0022,\u0022description\u0022:\u0022Specifies whether the Windows Remote Management (WinRM) service will not allow RunAs credentials to be stored for any plug-ins.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022DoNotAllowPasswordsToBeSaved\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Do not allow passwords to be saved\u0022,\u0022description\u0022:\u0022Specifies whether to prevent Remote Desktop Services - Terminal Services clients from saving passwords on a computer.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022SecuritySpecifyTheMaximumLogFileSizeKB\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Security: Specify the maximum log file size (KB)\u0022,\u0022description\u0022:\u0022Specifies the maximum size for the Security event log in kilobytes.\u0022},\u0022defaultValue\u0022:\u0022196608\u0022},\u0022SetClientConnectionEncryptionLevel\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Set client connection encryption level\u0022,\u0022description\u0022:\u0022Specifies whether to require the use of a specific encryption level to secure communications between client computers and RD Session Host servers during Remote Desktop Protocol (RDP) connections. This policy only applies when you are using native RDP encryption.\u0022},\u0022defaultValue\u0022:\u00223\u0022},\u0022SetTheDefaultBehaviorForAutoRun\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Set the default behavior for AutoRun\u0022,\u0022description\u0022:\u0022Specifies the default behavior for Autorun commands. Autorun commands are generally stored in autorun.inf files. They often launch the installation program or other routines.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022SetupSpecifyTheMaximumLogFileSizeKB\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Setup: Specify the maximum log file size (KB)\u0022,\u0022description\u0022:\u0022Specifies the maximum size for the Setup event log in kilobytes.\u0022},\u0022defaultValue\u0022:\u002232768\u0022},\u0022SystemSpecifyTheMaximumLogFileSizeKB\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: System: Specify the maximum log file size (KB)\u0022,\u0022description\u0022:\u0022Specifies the maximum size for the System event log in kilobytes.\u0022},\u0022defaultValue\u0022:\u002232768\u0022},\u0022TurnOffDataExecutionPreventionForExplorer\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Turn off Data Execution Prevention for Explorer\u0022,\u0022description\u0022:\u0022Specifies whether to turn off Data Execution Prevention for Windows File Explorer. Disabling data execution prevention can allow certain legacy plug-in applications to function without terminating Explorer.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022SpecifyTheIntervalToCheckForDefinitionUpdates\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Specify the interval to check for definition updates\u0022,\u0022description\u0022:\u0022Specifies an interval at which to check for Windows Defender definition updates. The time value is represented as the number of hours between update checks.\u0022},\u0022defaultValue\u0022:\u00228\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_WindowsComponents\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Send file samples when further analysis is required;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027SendFileSamplesWhenFurtherAnalysisIsRequired\u0027), \u0027,\u0027, \u0027Allow indexing of encrypted files;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AllowIndexingOfEncryptedFiles\u0027), \u0027,\u0027, \u0027Allow Telemetry;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AllowTelemetry\u0027), \u0027,\u0027, \u0027Allow unencrypted traffic;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AllowUnencryptedTraffic\u0027), \u0027,\u0027, \u0027Always install with elevated privileges;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AlwaysInstallWithElevatedPrivileges\u0027), \u0027,\u0027, \u0027Always prompt for password upon connection;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AlwaysPromptForPasswordUponConnection\u0027), \u0027,\u0027, \u0027Application: Specify the maximum log file size (KB);ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027ApplicationSpecifyTheMaximumLogFileSizeKB\u0027), \u0027,\u0027, \u0027Automatically send memory dumps for OS-generated error reports;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AutomaticallySendMemoryDumpsForOSgeneratedErrorReports\u0027), \u0027,\u0027, \u0027Configure Default consent;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027ConfigureDefaultConsent\u0027), \u0027,\u0027, \u0027Configure Windows SmartScreen;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027ConfigureWindowsSmartScreen\u0027), \u0027,\u0027, \u0027Disallow Digest authentication;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027DisallowDigestAuthentication\u0027), \u0027,\u0027, \u0027Disallow WinRM from storing RunAs credentials;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027DisallowWinRMFromStoringRunAsCredentials\u0027), \u0027,\u0027, \u0027Do not allow passwords to be saved;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027DoNotAllowPasswordsToBeSaved\u0027), \u0027,\u0027, \u0027Security: Specify the maximum log file size (KB);ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027SecuritySpecifyTheMaximumLogFileSizeKB\u0027), \u0027,\u0027, \u0027Set client connection encryption level;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027SetClientConnectionEncryptionLevel\u0027), \u0027,\u0027, \u0027Set the default behavior for AutoRun;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027SetTheDefaultBehaviorForAutoRun\u0027), \u0027,\u0027, \u0027Setup: Specify the maximum log file size (KB);ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027SetupSpecifyTheMaximumLogFileSizeKB\u0027), \u0027,\u0027, \u0027System: Specify the maximum log file size (KB);ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027SystemSpecifyTheMaximumLogFileSizeKB\u0027), \u0027,\u0027, \u0027Turn off Data Execution Prevention for Explorer;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027TurnOffDataExecutionPreventionForExplorer\u0027), \u0027,\u0027, \u0027Specify the interval to check for definition updates;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027SpecifyTheIntervalToCheckForDefinitionUpdates\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_WindowsComponents\u0022},\u0022SendFileSamplesWhenFurtherAnalysisIsRequired\u0022:{\u0022value\u0022:\u0022[parameters(\u0027SendFileSamplesWhenFurtherAnalysisIsRequired\u0027)]\u0022},\u0022AllowIndexingOfEncryptedFiles\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AllowIndexingOfEncryptedFiles\u0027)]\u0022},\u0022AllowTelemetry\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AllowTelemetry\u0027)]\u0022},\u0022AllowUnencryptedTraffic\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AllowUnencryptedTraffic\u0027)]\u0022},\u0022AlwaysInstallWithElevatedPrivileges\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AlwaysInstallWithElevatedPrivileges\u0027)]\u0022},\u0022AlwaysPromptForPasswordUponConnection\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AlwaysPromptForPasswordUponConnection\u0027)]\u0022},\u0022ApplicationSpecifyTheMaximumLogFileSizeKB\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ApplicationSpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},\u0022AutomaticallySendMemoryDumpsForOSgeneratedErrorReports\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AutomaticallySendMemoryDumpsForOSgeneratedErrorReports\u0027)]\u0022},\u0022ConfigureDefaultConsent\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ConfigureDefaultConsent\u0027)]\u0022},\u0022ConfigureWindowsSmartScreen\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ConfigureWindowsSmartScreen\u0027)]\u0022},\u0022DisallowDigestAuthentication\u0022:{\u0022value\u0022:\u0022[parameters(\u0027DisallowDigestAuthentication\u0027)]\u0022},\u0022DisallowWinRMFromStoringRunAsCredentials\u0022:{\u0022value\u0022:\u0022[parameters(\u0027DisallowWinRMFromStoringRunAsCredentials\u0027)]\u0022},\u0022DoNotAllowPasswordsToBeSaved\u0022:{\u0022value\u0022:\u0022[parameters(\u0027DoNotAllowPasswordsToBeSaved\u0027)]\u0022},\u0022SecuritySpecifyTheMaximumLogFileSizeKB\u0022:{\u0022value\u0022:\u0022[parameters(\u0027SecuritySpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},\u0022SetClientConnectionEncryptionLevel\u0022:{\u0022value\u0022:\u0022[parameters(\u0027SetClientConnectionEncryptionLevel\u0027)]\u0022},\u0022SetTheDefaultBehaviorForAutoRun\u0022:{\u0022value\u0022:\u0022[parameters(\u0027SetTheDefaultBehaviorForAutoRun\u0027)]\u0022},\u0022SetupSpecifyTheMaximumLogFileSizeKB\u0022:{\u0022value\u0022:\u0022[parameters(\u0027SetupSpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},\u0022SystemSpecifyTheMaximumLogFileSizeKB\u0022:{\u0022value\u0022:\u0022[parameters(\u0027SystemSpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},\u0022TurnOffDataExecutionPreventionForExplorer\u0022:{\u0022value\u0022:\u0022[parameters(\u0027TurnOffDataExecutionPreventionForExplorer\u0027)]\u0022},\u0022SpecifyTheIntervalToCheckForDefinitionUpdates\u0022:{\u0022value\u0022:\u0022[parameters(\u0027SpecifyTheIntervalToCheckForDefinitionUpdates\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022SendFileSamplesWhenFurtherAnalysisIsRequired\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AllowIndexingOfEncryptedFiles\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AllowTelemetry\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AllowUnencryptedTraffic\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AlwaysInstallWithElevatedPrivileges\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AlwaysPromptForPasswordUponConnection\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ApplicationSpecifyTheMaximumLogFileSizeKB\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AutomaticallySendMemoryDumpsForOSgeneratedErrorReports\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ConfigureDefaultConsent\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ConfigureWindowsSmartScreen\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022DisallowDigestAuthentication\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022DisallowWinRMFromStoringRunAsCredentials\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022DoNotAllowPasswordsToBeSaved\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022SecuritySpecifyTheMaximumLogFileSizeKB\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022SetClientConnectionEncryptionLevel\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022SetTheDefaultBehaviorForAutoRun\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022SetupSpecifyTheMaximumLogFileSizeKB\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022SystemSpecifyTheMaximumLogFileSizeKB\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022TurnOffDataExecutionPreventionForExplorer\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022SpecifyTheIntervalToCheckForDefinitionUpdates\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Send file samples when further analysis is required;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SendFileSamplesWhenFurtherAnalysisIsRequired\u0027)]\u0022},{\u0022name\u0022:\u0022Allow indexing of encrypted files;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AllowIndexingOfEncryptedFiles\u0027)]\u0022},{\u0022name\u0022:\u0022Allow Telemetry;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AllowTelemetry\u0027)]\u0022},{\u0022name\u0022:\u0022Allow unencrypted traffic;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AllowUnencryptedTraffic\u0027)]\u0022},{\u0022name\u0022:\u0022Always install with elevated privileges;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AlwaysInstallWithElevatedPrivileges\u0027)]\u0022},{\u0022name\u0022:\u0022Always prompt for password upon connection;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AlwaysPromptForPasswordUponConnection\u0027)]\u0022},{\u0022name\u0022:\u0022Application: Specify the maximum log file size (KB);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ApplicationSpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},{\u0022name\u0022:\u0022Automatically send memory dumps for OS-generated error reports;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AutomaticallySendMemoryDumpsForOSgeneratedErrorReports\u0027)]\u0022},{\u0022name\u0022:\u0022Configure Default consent;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ConfigureDefaultConsent\u0027)]\u0022},{\u0022name\u0022:\u0022Configure Windows SmartScreen;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ConfigureWindowsSmartScreen\u0027)]\u0022},{\u0022name\u0022:\u0022Disallow Digest authentication;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027DisallowDigestAuthentication\u0027)]\u0022},{\u0022name\u0022:\u0022Disallow WinRM from storing RunAs credentials;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027DisallowWinRMFromStoringRunAsCredentials\u0027)]\u0022},{\u0022name\u0022:\u0022Do not allow passwords to be saved;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027DoNotAllowPasswordsToBeSaved\u0027)]\u0022},{\u0022name\u0022:\u0022Security: Specify the maximum log file size (KB);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SecuritySpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},{\u0022name\u0022:\u0022Set client connection encryption level;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SetClientConnectionEncryptionLevel\u0027)]\u0022},{\u0022name\u0022:\u0022Set the default behavior for AutoRun;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SetTheDefaultBehaviorForAutoRun\u0027)]\u0022},{\u0022name\u0022:\u0022Setup: Specify the maximum log file size (KB);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SetupSpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},{\u0022name\u0022:\u0022System: Specify the maximum log file size (KB);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SystemSpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},{\u0022name\u0022:\u0022Turn off Data Execution Prevention for Explorer;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027TurnOffDataExecutionPreventionForExplorer\u0027)]\u0022},{\u0022name\u0022:\u0022Specify the interval to check for definition updates;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SpecifyTheIntervalToCheckForDefinitionUpdates\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Send file samples when further analysis is required;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SendFileSamplesWhenFurtherAnalysisIsRequired\u0027)]\u0022},{\u0022name\u0022:\u0022Allow indexing of encrypted files;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AllowIndexingOfEncryptedFiles\u0027)]\u0022},{\u0022name\u0022:\u0022Allow Telemetry;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AllowTelemetry\u0027)]\u0022},{\u0022name\u0022:\u0022Allow unencrypted traffic;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AllowUnencryptedTraffic\u0027)]\u0022},{\u0022name\u0022:\u0022Always install with elevated privileges;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AlwaysInstallWithElevatedPrivileges\u0027)]\u0022},{\u0022name\u0022:\u0022Always prompt for password upon connection;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AlwaysPromptForPasswordUponConnection\u0027)]\u0022},{\u0022name\u0022:\u0022Application: Specify the maximum log file size (KB);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ApplicationSpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},{\u0022name\u0022:\u0022Automatically send memory dumps for OS-generated error reports;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AutomaticallySendMemoryDumpsForOSgeneratedErrorReports\u0027)]\u0022},{\u0022name\u0022:\u0022Configure Default consent;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ConfigureDefaultConsent\u0027)]\u0022},{\u0022name\u0022:\u0022Configure Windows SmartScreen;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027ConfigureWindowsSmartScreen\u0027)]\u0022},{\u0022name\u0022:\u0022Disallow Digest authentication;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027DisallowDigestAuthentication\u0027)]\u0022},{\u0022name\u0022:\u0022Disallow WinRM from storing RunAs credentials;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027DisallowWinRMFromStoringRunAsCredentials\u0027)]\u0022},{\u0022name\u0022:\u0022Do not allow passwords to be saved;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027DoNotAllowPasswordsToBeSaved\u0027)]\u0022},{\u0022name\u0022:\u0022Security: Specify the maximum log file size (KB);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SecuritySpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},{\u0022name\u0022:\u0022Set client connection encryption level;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SetClientConnectionEncryptionLevel\u0027)]\u0022},{\u0022name\u0022:\u0022Set the default behavior for AutoRun;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SetTheDefaultBehaviorForAutoRun\u0027)]\u0022},{\u0022name\u0022:\u0022Setup: Specify the maximum log file size (KB);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SetupSpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},{\u0022name\u0022:\u0022System: Specify the maximum log file size (KB);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SystemSpecifyTheMaximumLogFileSizeKB\u0027)]\u0022},{\u0022name\u0022:\u0022Turn off Data Execution Prevention for Explorer;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027TurnOffDataExecutionPreventionForExplorer\u0027)]\u0022},{\u0022name\u0022:\u0022Specify the interval to check for definition updates;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027SpecifyTheIntervalToCheckForDefinitionUpdates\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7040a231-fb65-4412-8c0a-b365f4866c24\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227040a231-fb65-4412-8c0a-b365f4866c24\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1254 - Contingency Plan | Resume All Missions / Business Functions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1254\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/704e136a-4fe0-427c-b829-cd69957f5d2b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022704e136a-4fe0-427c-b829-cd69957f5d2b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027System Audit Policies - System\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - System\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesSystem\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7066131b-61a6-4917-a7e4-72e8983f0aa6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227066131b-61a6-4917-a7e4-72e8983f0aa6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1509 - Position Risk Designation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1509\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/70792197-9bfc-4813-905a-bd33993e327f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002270792197-9bfc-4813-905a-bd33993e327f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1541 - Risk Assessment\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1541\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/70f6af82-7be6-44aa-9b15-8b9231b2e434\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002270f6af82-7be6-44aa-9b15-8b9231b2e434\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1691 - Information System Monitoring | Automated Tools For Real-Time Analysis\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1691\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/71475fb4-49bd-450b-a1a5-f63894c24725\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002271475fb4-49bd-450b-a1a5-f63894c24725\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1481 - Temperature And Humidity Controls\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1481\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/717a1c78-a267-4f56-ac58-ee6c54dc4339\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022717a1c78-a267-4f56-ac58-ee6c54dc4339\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1129 - Time Stamps | Synchronization With Authoritative Time Source\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1129\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/71bb965d-4047-4623-afd4-b8189a58df5d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002271bb965d-4047-4623-afd4-b8189a58df5d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1395 - System Maintenance Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1395\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7207a023-a517-41c5-9df2-09d4c6845a05\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227207a023-a517-41c5-9df2-09d4c6845a05\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs on which the DSC configuration is not compliant\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows VMs on which the Desired State Configuration (DSC) configuration is not compliant. This policy is only applicable to machines with WMF 4 and above. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsDscConfiguration\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7227ebe5-9ff7-47ab-b823-171cd02fb90f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227227ebe5-9ff7-47ab-b823-171cd02fb90f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Administrative Templates - Network\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Administrative Templates - Network\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_AdministrativeTemplatesNetwork\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7229bd6a-693d-478a-87f0-1dc1af06f3b8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227229bd6a-693d-478a-87f0-1dc1af06f3b8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027Python version\u0027 is the latest, if used as a part of the Function app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest Python version for Function apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022WindowsPythonLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Windows Latest Python version\u0022,\u0022description\u0022:\u0022Latest supported Python version for App Services\u0022},\u0022defaultValue\u0022:\u00223.6\u0022},\u0022LinuxPythonLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Linux Latest Python version\u0022,\u0022description\u0022:\u0022Latest supported Python version for App Services\u0022},\u0022defaultValue\u0022:\u00223.8\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022notContains\u0022:\u0022PYTHON\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.pythonVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022[concat(\u0027PYTHON|\u0027, parameters(\u0027LinuxPythonLatestVersion\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.pythonVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.pythonVersion\u0022,\u0022equals\u0022:\u0022[parameters(\u0027WindowsPythonLatestVersion\u0027)]\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7238174a-fd10-4ef0-817e-fc820a951d73\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227238174a-fd10-4ef0-817e-fc820a951d73\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027PHP version\u0027 is the latest, if used as a part of the WEB app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022PHPLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Latest PHP version\u0022,\u0022description\u0022:\u0022Latest supported PHP version for App Services\u0022},\u0022defaultValue\u0022:\u00227.3\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022notContains\u0022:\u0022PHP\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.phpVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022[concat(\u0027PHP|\u0027, parameters(\u0027PHPLatestVersion\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.phpVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.phpVersion\u0022,\u0022equals\u0022:\u0022[parameters(\u0027PHPLatestVersion\u0027)]\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7261b898-8a84-4db8-9e04-18527132abb3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227261b898-8a84-4db8-9e04-18527132abb3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs that allow re-use of the previous 24 passwords\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that allow re-use of the previous 24 passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022EnforcePasswordHistory\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022EnforcePasswordHistory\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/726671ac-c4de-4908-8c7d-6043ae62e3b6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022726671ac-c4de-4908-8c7d-6043ae62e3b6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Add a tag to resource groups\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Adds the specified tag and value when any resource group missing this tag is created or updated. Existing resource groups can be remediated by triggering a remediation task. If the tag exists with a different value it will not be changed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}},\u0022tagValue\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Value\u0022,\u0022description\u0022:\u0022Value of the tag, such as \u0027production\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022},{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022exists\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022modify\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022operations\u0022:[{\u0022operation\u0022:\u0022add\u0022,\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}]}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/726aca4c-86e9-4b04-b0c5-073027359532\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022726aca4c-86e9-4b04-b0c5-073027359532\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1524 - Personnel Transfer\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1524\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/72f1cb4e-2439-4fe8-88ea-b8671ce3c268\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002272f1cb4e-2439-4fe8-88ea-b8671ce3c268\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1393 - Information Spillage Response | Exposure To Unauthorized Personnel\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1393\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/731856d8-1598-4b75-92de-7d46235747c0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022731856d8-1598-4b75-92de-7d46235747c0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1101 - Audit And Accountability Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1101\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7327b708-f0e0-457d-9d2a-527fcc9c9a65\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227327b708-f0e0-457d-9d2a-527fcc9c9a65\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1456 - Physical Access Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1456\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/733ba9e3-9e7c-440a-a7aa-6196a90a2870\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022733ba9e3-9e7c-440a-a7aa-6196a90a2870\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Workflow Automation for Azure Security Center recommendations\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enable automation of Azure Security Center recommendations. This policy deploys a workflow automation with your conditions and triggers on the assigned scope. To deploy this policy on newly created subscriptions, open the Compliance tab, select the relevant non-compliant assignment and create a remediation task.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022automationName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Automation name\u0022,\u0022description\u0022:\u0022This is the automation name.\u0022}},\u0022resourceGroupName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource group name\u0022,\u0022description\u0022:\u0022The resource group name where the workflow automation is created. If you enter a name for a resource group that doesn\u0027t exist, it\u0027ll be created in the subscription.\u0022}},\u0022resourceGroupLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource group location\u0022,\u0022description\u0022:\u0022The location where the resource group and the workflow automation are created.\u0022,\u0022strongType\u0022:\u0022location\u0022}},\u0022recommendationNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Recommendation IDs\u0022,\u0022description\u0022:\u0022For all recommendations, leave empty. For specific recommendations, enter a list of recommendation IDs separated by semicolons (\u0027;\u0027). Recommendation IDs are available through the Assessments API (https://docs.microsoft.com/en-us/rest/api/securitycenter/assessments), or Azure Resource Graph Explorer (https://portal.azure.com/#blade/HubsExtension/ArgQueryBlade), choose securityresources and microsoft.security/assessments.\u0022},\u0022defaultValue\u0022:[]},\u0022recommendationSeverities\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Recommendation severities\u0022,\u0022description\u0022:\u0022Determines recommendation severities. Example: High;Medium;Low;\u0022},\u0022allowedValues\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022],\u0022defaultValue\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022]},\u0022recommendationStates\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Recommendation states\u0022,\u0022description\u0022:\u0022Determines recommendation states. Recommendations with unhealthy state require your attention to resolve. When a recommendation state is healthy, it no longer applies to the resource as Security Center detects it as healthy. A recommendation is not-applicable if, for example, it was disabled in the Security Policy. Example: Healthy;Unhealthy;Not Applicable;\u0022},\u0022allowedValues\u0022:[\u0022Healthy\u0022,\u0022Unhealthy\u0022,\u0022Not Applicable\u0022],\u0022defaultValue\u0022:[\u0022Healthy\u0022,\u0022Unhealthy\u0022,\u0022Not Applicable\u0022]},\u0022logicAppResourceId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Logic App\u0022,\u0022description\u0022:\u0022The Logic App that is triggered. If you do not already have a logic app, visit Logic Apps to create one (https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Logic%2Fworkflows).\u0022,\u0022strongType\u0022:\u0022Microsoft.Logic/workflows\u0022,\u0022assignPermissions\u0022:true}},\u0022logicAppTrigger\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Logic app trigger\u0022,\u0022description\u0022:\u0022The trigger connector of the logic app that is triggered. Possible values: \u0027Manual (Incoming HTTP request)\u0027, \u0027When an Azure Security Center Recommendation is created or triggered\u0027.\u0022},\u0022allowedValues\u0022:[\u0022Manual (Incoming HTTP request)\u0022,\u0022When an Azure Security Center Recommendation is created or triggered\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/automations\u0022,\u0022name\u0022:\u0022[parameters(\u0027automationName\u0027)]\u0022,\u0022existenceScope\u0022:\u0022resourcegroup\u0022,\u0022ResourceGroupName\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022deploymentScope\u0022:\u0022subscription\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022location\u0022:\u0022westeurope\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022automationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022resourceGroupName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022resourceGroupLocation\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022recommendationNames\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022recommendationSeverities\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022recommendationStates\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022logicAppResourceId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logicAppTrigger\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022guidValue\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022[newGuid()]\u0022}},\u0022variables\u0022:{\u0022scopeDescription\u0022:\u0022scope for subscription {0}\u0022,\u0022recommendationNamesLength\u0022:\u0022[length(parameters(\u0027recommendationNames\u0027))]\u0022,\u0022recommendationSeveritiesLength\u0022:\u0022[length(parameters(\u0027recommendationSeverities\u0027))]\u0022,\u0022recommendationStatesLength\u0022:\u0022[length(parameters(\u0027recommendationStates\u0027))]\u0022,\u0022recommendationNamesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027recommendationNamesLength\u0027), 0), 1, variables(\u0027recommendationNamesLength\u0027))]\u0022,\u0022recommendationSeveritiesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027recommendationSeveritiesLength\u0027), 0), 1, variables(\u0027recommendationSeveritiesLength\u0027))]\u0022,\u0022recommendationStatesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027recommendationStatesLength\u0027), 0), 1, variables(\u0027recommendationStatesLength\u0027))]\u0022,\u0022totalRuleCombinationsForOneRecommendationName\u0022:\u0022[mul(variables(\u0027recommendationSeveritiesLengthIfEmpty\u0027),variables(\u0027recommendationStatesLengthIfEmpty\u0027))]\u0022,\u0022totalRuleCombinationsForOneRecommendationSeverity\u0022:\u0022[variables(\u0027recommendationStatesLengthIfEmpty\u0027)]\u0022,\u0022totalRuleCombinationsForOneRecommendationState\u0022:1,\u0022stateMap\u0022:{\u0022Healthy\u0022:\u0022healthy\u0022,\u0022Unhealthy\u0022:\u0022unhealthy\u0022,\u0022Not Applicable\u0022:\u0022notapplicable\u0022},\u0022triggerMap\u0022:{\u0022Manual (Incoming HTTP request)\u0022:\u0022manual\u0022,\u0022When an Azure Security Center Recommendation is created or triggered\u0022:\u0022When_an_Azure_Security_Center_Recommendation_is_created_or_triggered\u0022}},\u0022resources\u0022:[{\u0022name\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Resources/resourceGroups\u0022,\u0022apiVersion\u0022:\u00222019-10-01\u0022,\u0022location\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022,\u0022tags\u0022:{},\u0022properties\u0022:{}},{\u0022type\u0022:\u0022Microsoft.Resources/deployments\u0022,\u0022apiVersion\u0022:\u00222019-10-01\u0022,\u0022name\u0022:\u0022[concat(\u0027nestedAutomationDeployment\u0027, \u0027_\u0027, parameters(\u0027guidValue\u0027))]\u0022,\u0022resourceGroup\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022dependsOn\u0022:[\u0022[resourceId(\u0027Microsoft.Resources/resourceGroups/\u0027, parameters(\u0027resourceGroupName\u0027))]\u0022],\u0022properties\u0022:{\u0022mode\u0022:\u0022Incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022tags\u0022:{},\u0022apiVersion\u0022:\u00222019-01-01-preview\u0022,\u0022location\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022,\u0022name\u0022:\u0022[parameters(\u0027automationName\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Security/automations\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022description\u0022:\u0022Workflow Automation for Azure Security Center recommendations via policy\u0022,\u0022isEnabled\u0022:true,\u0022scopes\u0022:[{\u0022description\u0022:\u0022[replace(variables(\u0027scopeDescription\u0027),\u0027{0}\u0027, subscription().subscriptionId)]\u0022,\u0022scopePath\u0022:\u0022[subscription().id]\u0022}],\u0022sources\u0022:[{\u0022eventSource\u0022:\u0022Assessments\u0022,\u0022copy\u0022:[{\u0022name\u0022:\u0022ruleSets\u0022,\u0022count\u0022:\u0022[mul(variables(\u0027recommendationNamesLengthIfEmpty\u0027), mul(variables(\u0027recommendationSeveritiesLengthIfEmpty\u0027),variables(\u0027recommendationStatesLengthIfEmpty\u0027)))]\u0022,\u0022input\u0022:{\u0022rules\u0022:[{\u0022propertyJPath\u0022:\u0022[if(equals(variables(\u0027recommendationNamesLength\u0027), 0), \u0027type\u0027, \u0027name\u0027)]\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[if(equals(variables(\u0027recommendationNamesLength\u0027), 0), \u0027Microsoft.Security/assessments\u0027, parameters(\u0027recommendationNames\u0027)[mod(div(copyIndex(\u0027ruleSets\u0027), variables(\u0027totalRuleCombinationsForOneRecommendationName\u0027)), variables(\u0027recommendationNamesLength\u0027))])]\u0022,\u0022operator\u0022:\u0022Contains\u0022},{\u0022propertyJPath\u0022:\u0022properties.metadata.severity\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[parameters(\u0027recommendationSeverities\u0027)[mod(div(copyIndex(\u0027ruleSets\u0027), variables(\u0027totalRuleCombinationsForOneRecommendationSeverity\u0027)), variables(\u0027recommendationSeveritiesLength\u0027))]]\u0022,\u0022operator\u0022:\u0022Equals\u0022},{\u0022propertyJPath\u0022:\u0022properties.status.code\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[variables(\u0027stateMap\u0027)[parameters(\u0027recommendationStates\u0027)[mod(div(copyIndex(\u0027ruleSets\u0027), variables(\u0027totalRuleCombinationsForOneRecommendationState\u0027)), variables(\u0027recommendationStatesLength\u0027))]]]\u0022,\u0022operator\u0022:\u0022Contains\u0022}]}}]}],\u0022actions\u0022:[{\u0022actionType\u0022:\u0022LogicApp\u0022,\u0022logicAppResourceId\u0022:\u0022[parameters(\u0027logicAppResourceId\u0027)]\u0022,\u0022uri\u0022:\u0022[listCallbackUrl(concat(parameters(\u0027logicAppResourceId\u0027), \u0027/triggers/\u0027, variables(\u0027triggerMap\u0027)[parameters(\u0027logicAppTrigger\u0027)]),\u00272016-06-01\u0027).value]\u0022}]}}]}}}]},\u0022parameters\u0022:{\u0022automationName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027automationName\u0027)]\u0022},\u0022resourceGroupName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022},\u0022resourceGroupLocation\u0022:{\u0022value\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022},\u0022recommendationNames\u0022:{\u0022value\u0022:\u0022[parameters(\u0027recommendationNames\u0027)]\u0022},\u0022recommendationSeverities\u0022:{\u0022value\u0022:\u0022[parameters(\u0027recommendationSeverities\u0027)]\u0022},\u0022recommendationStates\u0022:{\u0022value\u0022:\u0022[parameters(\u0027recommendationStates\u0027)]\u0022},\u0022logicAppResourceId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logicAppResourceId\u0027)]\u0022},\u0022logicAppTrigger\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logicAppTrigger\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/73d6ab6c-2475-4850-afd6-43795f3492ef\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002273d6ab6c-2475-4850-afd6-43795f3492ef\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1581 - Information System Documentation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1581\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/742b549b-7a25-465f-b83c-ea1ffb4f4e0e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022742b549b-7a25-465f-b83c-ea1ffb4f4e0e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Allowed storage account SKUs\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy enables you to specify a set of storage account SKUs that your organization can deploy.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Storage\u0022},\u0022parameters\u0022:{\u0022listOfAllowedSKUs\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022The list of SKUs that can be specified for storage accounts.\u0022,\u0022displayName\u0022:\u0022Allowed SKUs\u0022,\u0022strongType\u0022:\u0022StorageSKUs\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Storage/storageAccounts\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/sku.name\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfAllowedSKUs\u0027)]\u0022}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227433c107-6db4-4ad1-b57a-a76dce0154a1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1631 - Boundary Protection | Deny By Default / Allow By Exception\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1631\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/74ae9b8e-e7bb-4c9c-992f-c535282f7a2c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002274ae9b8e-e7bb-4c9c-992f-c535282f7a2c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027Python version\u0027 is the latest, if used as a part of the Api app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest Python version for Api apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022WindowsPythonLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Windows Latest Python version\u0022,\u0022description\u0022:\u0022Latest supported Python version for App Services\u0022},\u0022defaultValue\u0022:\u00223.6\u0022},\u0022LinuxPythonLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Linux Latest Python version\u0022,\u0022description\u0022:\u0022Latest supported Python version for App Services\u0022},\u0022defaultValue\u0022:\u00223.8\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022notContains\u0022:\u0022PYTHON\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.pythonVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022[concat(\u0027PYTHON|\u0027, parameters(\u0027LinuxPythonLatestVersion\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.pythonVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.pythonVersion\u0022,\u0022equals\u0022:\u0022[parameters(\u0027WindowsPythonLatestVersion\u0027)]\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/74c3584d-afae-46f7-a20a-6f8adba71a16\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002274c3584d-afae-46f7-a20a-6f8adba71a16\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1417 - Nonlocal Maintenance | Comparable Security / Sanitization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1417\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7522ed84-70d5-4181-afc0-21e50b1b6d0e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227522ed84-70d5-4181-afc0-21e50b1b6d0e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit enabling of diagnostic logs in App Services\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs on the app. This enables you to recreate activity trails for investigation purposes if a security incident occurs or your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022App Service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites/config\u0022},{\u0022field\u0022:\u0022name\u0022,\u0022equals\u0022:\u0022web\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/detailedErrorLoggingEnabled\u0022,\u0022notEquals\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/httpLoggingEnabled\u0022,\u0022notEquals\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/requestTracingEnabled\u0022,\u0022notEquals\u0022:\u0022true\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/752c6934-9bcc-4749-b004-655e676ae2ac\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022752c6934-9bcc-4749-b004-655e676ae2ac\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1468 - Visitor Access Records | Automated Records Maintenance / Review\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1468\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/75603f96-80a1-4757-991d-5a1221765ddd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002275603f96-80a1-4757-991d-5a1221765ddd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1053 - Session Lock | Pattern-Hiding Displays\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1053\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7582b19c-9dba-438e-aed8-ede59ac35ba3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227582b19c-9dba-438e-aed8-ede59ac35ba3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Private endpoint should be enabled for MySQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits MySQL servers not configured to use a private endpoint. For more details, visit https://aka.ms/mysqlprivatelink.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMySQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforMySQL/servers/privateEndpointConnections\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforMySQL/servers/privateEndpointConnections/privateLinkServiceConnectionState.status\u0022,\u0022equals\u0022:\u0022Approved\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7595c971-233d-4bcf-bd18-596129188c49\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227595c971-233d-4bcf-bd18-596129188c49\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1459 - Access Control For Transmission Medium\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1459\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/75cc73c7-5cdb-479d-a06f-7b4d0dbb1da0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002275cc73c7-5cdb-479d-a06f-7b4d0dbb1da0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Vulnerabilities should be remediated by a Vulnerability Assessment solution\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Monitors vulnerabilities detected by Vulnerability Assessment solution and VMs without a Vulnerability Assessment solution in Azure Security Center as recommendations.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022vulnerabilityAssessment\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022760a85ff-6162-42b3-8d70-698e268f648c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Dependency agent for Linux virtual machine scale sets\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploy Dependency agent for Linux virtual machine scale sets if the VM Image (OS) is in the list defined and the agent is not installed. Note: if your scale set upgradePolicy is set to Manual, you need to apply the extension to the all VMs in the set by calling upgrade on them. In CLI this would be az vmss update-instances.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022listOfImageIdToInclude\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Linux OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude\u0027)]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002214.04.0-LTS\u0022,\u002214.04.1-LTS\u0022,\u002214.04.5-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002216.04-LTS\u0022,\u002216.04.0-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002218.04-LTS\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002212-SP2\u0022,\u002212-SP3\u0022,\u002212-SP4\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022CentOS\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/type\u0022,\u0022equals\u0022:\u0022DependencyAgentLinux\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022DependencyAgent\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022,\u0022vmExtensionType\u0022:\u0022DependencyAgentLinux\u0022,\u0022vmExtensionTypeHandlerVersion\u0022:\u00229.7\u0022},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-06-01\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022typeHandlerVersion\u0022:\u0022[variables(\u0027vmExtensionTypeHandlerVersion\u0027)]\u0022,\u0022autoUpgradeMinorVersion\u0022:true}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/765266ab-e40e-4c61-bcb2-5a5275d0b7c0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022765266ab-e40e-4c61-bcb2-5a5275d0b7c0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1055 - Session Termination| User-Initiated Logouts / Message Displays\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1055\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/769efd9b-3587-4e22-90ce-65ddcd5bd969\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022769efd9b-3587-4e22-90ce-65ddcd5bd969\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit delegation of scopes to a managing tenant\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Audit delegation of scopes to a managing tenant via Azure Lighthouse.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Lighthouse\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ManagedServices/registrationAssignments\u0022},{\u0022value\u0022:\u0022true\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/76bed37b-484f-430f-a009-fd7592dff818\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002276bed37b-484f-430f-a009-fd7592dff818\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1058 - Permitted Actions Without Identification Or Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1058\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/76e85d08-8fbb-4112-a1c1-93521e6a9254\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002276e85d08-8fbb-4112-a1c1-93521e6a9254\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1508 - Position Risk Designation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1508\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/76f500cc-4bca-4583-bda1-6d084dc21086\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002276f500cc-4bca-4583-bda1-6d084dc21086\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1423 - Maintenance Personnel | Individuals Without Appropriate Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1423\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7741669e-d4f6-485a-83cb-e70ce7cbbc20\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227741669e-d4f6-485a-83cb-e70ce7cbbc20\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure subscriptions should have a log profile for Activity Log\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy ensures if a log profile is enabled for exporting activity logs. It audits if there is no log profile created to export the logs either to a storage account or to an event hub.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/logProfiles\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/categories\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7796937f-307b-4598-941c-67d3a05ebfe7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227796937f-307b-4598-941c-67d3a05ebfe7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1336 - Authenticator Management | Pki-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1336\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/77f56280-e367-432a-a3b9-8ca2aa636a26\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002277f56280-e367-432a-a3b9-8ca2aa636a26\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1258 - Contingency Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1258\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7814506c-382c-4d33-a142-249dd4a0dbff\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227814506c-382c-4d33-a142-249dd4a0dbff\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1178 - Baseline Configuration | Reviews And Updates\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1178\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7818b8f4-47c6-441a-90ae-12ce04e99893\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227818b8f4-47c6-441a-90ae-12ce04e99893\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1057 - Permitted Actions Without Identification Or Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1057\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/78255758-6d45-4bf0-a005-7016bc03b13c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002278255758-6d45-4bf0-a005-7016bc03b13c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1700 - Information System Monitoring | Unauthorized Network Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1700\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7831b4ba-c3f4-4cb1-8c11-ef8d59438cd5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227831b4ba-c3f4-4cb1-8c11-ef8d59438cd5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1010 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1010\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/784663a8-1eb0-418a-a98c-24d19bc1bb62\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022784663a8-1eb0-418a-a98c-24d19bc1bb62\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1216 - Least Functionality | Periodic Review\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1216\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7894fe6a-f5cb-44c8-ba90-c3f254ff9484\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227894fe6a-f5cb-44c8-ba90-c3f254ff9484\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1639 - Boundary Protection | Isolation Of Information System Components\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1639\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/78e8e649-50f6-4fe3-99ac-fedc2e63b03f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002278e8e649-50f6-4fe3-99ac-fedc2e63b03f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1647 - Cryptographic Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1647\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/791cfc15-6974-42a0-9f4c-2d4b82f4a78c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022791cfc15-6974-42a0-9f4c-2d4b82f4a78c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1510 - Position Risk Designation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1510\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/79da5b09-0e7e-499e-adda-141b069c7998\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002279da5b09-0e7e-499e-adda-141b069c7998\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1384 - Information Spillage Response\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1384\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/79fbc228-461c-4a45-9004-a865ca0728a7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002279fbc228-461c-4a45-9004-a865ca0728a7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows Server VMs on which Windows Serial Console is not enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows Server virtual machines on which Windows Serial Console is not enabled. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022EMSPortNumber\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022EMS Port Number\u0022,\u0022description\u0022:\u0022An integer indicating the COM port to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\u0022},\u0022allowedValues\u0022:[\u00221\u0022,\u00222\u0022,\u00223\u0022,\u00224\u0022],\u0022defaultValue\u0022:\u00221\u0022},\u0022EMSBaudRate\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022EMS Baud Rate\u0022,\u0022description\u0022:\u0022An integer indicating the baud rate to be used for the Emergency Management Services (EMS) console redirection. For more information on EMS settings, please visit https://aka.ms/gcpolwsc\u0022},\u0022allowedValues\u0022:[\u00229600\u0022,\u002219200\u0022,\u002238400\u0022,\u002257600\u0022,\u0022115200\u0022],\u0022defaultValue\u0022:\u0022115200\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsSerialConsole\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber\u0027, \u0027=\u0027, parameters(\u0027EMSPortNumber\u0027), \u0027,\u0027, \u0027[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate\u0027, \u0027=\u0027, parameters(\u0027EMSBaudRate\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsSerialConsole\u0022},\u0022EMSPortNumber\u0022:{\u0022value\u0022:\u0022[parameters(\u0027EMSPortNumber\u0027)]\u0022},\u0022EMSBaudRate\u0022:{\u0022value\u0022:\u0022[parameters(\u0027EMSBaudRate\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022EMSPortNumber\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022EMSBaudRate\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber\u0022,\u0022value\u0022:\u0022[parameters(\u0027EMSPortNumber\u0027)]\u0022},{\u0022name\u0022:\u0022[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate\u0022,\u0022value\u0022:\u0022[parameters(\u0027EMSBaudRate\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsSerialConsole]WindowsSerialConsole;EMSPortNumber\u0022,\u0022value\u0022:\u0022[parameters(\u0027EMSPortNumber\u0027)]\u0022},{\u0022name\u0022:\u0022[WindowsSerialConsole]WindowsSerialConsole;EMSBaudRate\u0022,\u0022value\u0022:\u0022[parameters(\u0027EMSBaudRate\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7a031c68-d6ab-406e-a506-697a19c634b0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227a031c68-d6ab-406e-a506-697a19c634b0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1093 - Role-Based Security Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1093\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7a0bdeeb-15f4-47e8-a1da-9f769f845fdf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227a0bdeeb-15f4-47e8-a1da-9f769f845fdf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1708 - Security Function Verification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1708\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7a1e2c88-13de-4959-8ee7-47e3d74f1f48\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227a1e2c88-13de-4959-8ee7-47e3d74f1f48\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1289 - Information System Backup\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1289\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7a724864-956a-496c-b778-637cb1d762cf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227a724864-956a-496c-b778-637cb1d762cf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1687 - Information System Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1687\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7a87fc7f-301e-49f3-ba2a-4d74f424fa97\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227a87fc7f-301e-49f3-ba2a-4d74f424fa97\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1061 - Remote Access | Automated Monitoring / Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1061\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7ac22808-a2e8-41c4-9d46-429b50738914\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227ac22808-a2e8-41c4-9d46-429b50738914\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1492 - System Security Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1492\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7ad5f307-e045-46f7-8214-5bdb7e973737\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227ad5f307-e045-46f7-8214-5bdb7e973737\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1636 - Boundary Protection | Isolation Of Security Tools / Mechanisms / Support Components\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1636\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7b694eed-7081-43c6-867c-41c76c961043\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227b694eed-7081-43c6-867c-41c76c961043\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Virtual Machine Scale Sets should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022It is recommended to enable Logs so that activity trail can be recreated when investigations are required in the event of an incident or a compromise.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/type\u0022,\u0022equals\u0022:\u0022IaaSDiagnostics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Diagnostics\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/type\u0022,\u0022equals\u0022:\u0022LinuxDiagnostic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\u0022,\u0022in\u0022:[\u0022Microsoft.OSTCExtensions\u0022,\u0022Microsoft.Azure.Diagnostics\u0022]}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7c1b1214-f927-48bf-8882-84f0af6588b1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227c1b1214-f927-48bf-8882-84f0af6588b1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Require blob encryption for storage accounts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy ensures blob encryption for storage accounts is turned on. It only applies to Microsoft.Storage resource types, not other storage providers. This policy is deprecated because storage blob encryption is now enabled by default, and can no longer be disabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Storage\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Storage/storageAccounts\u0022},{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/enableBlobEncryption\u0022,\u0022equals\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1143 - Security Assessment And Authorization Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1143\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7c6de11b-5f51-4f7c-8d83-d2467c8a816e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227c6de11b-5f51-4f7c-8d83-d2467c8a816e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1051 - Session Lock\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1051\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7cac6ee9-b58b-40c8-a5ce-f0efc3d9b339\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227cac6ee9-b58b-40c8-a5ce-f0efc3d9b339\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1279 - Telecommunications Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1279\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7d00bcd6-963d-4c02-ad8e-b45fa50bf3b0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227d00bcd6-963d-4c02-ad8e-b45fa50bf3b0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Cache for Redis should reside within a virtual network\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits whether the Azure Cache for Redis resource has a non-public endpoint by being deployed into a virtual network.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Cache\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match.\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Cache/redis\u0022},{\u0022field\u0022:\u0022Microsoft.Cache/Redis/subnetId\u0022,\u0022exists\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7d092e0a-7acd-40d2-a975-dca21cae48c4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227d092e0a-7acd-40d2-a975-dca21cae48c4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1109 - Content Of Audit Records | Centralized Management Of Planned Audit Record Content\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1109\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7d9ffa23-ad92-4d0d-b1f4-7db274cc2aec\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227d9ffa23-ad92-4d0d-b1f4-7db274cc2aec\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1201 - Security Impact Analysis | Separate Test Environments\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1201\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7daef997-fdd3-461b-8807-a608a6dd70f1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227daef997-fdd3-461b-8807-a608a6dd70f1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1471 - Emergency Shutoff\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1471\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7dd0e9ce-1772-41fb-a50a-99977071f916\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227dd0e9ce-1772-41fb-a50a-99977071f916\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs that have the specified applications installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022NotInstalledApplication\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7e56b49b-5990-4159-a734-511ea19b731c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227e56b49b-5990-4159-a734-511ea19b731c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1011 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1011\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7e6a54f3-883f-43d5-87c4-172dfd64a1f5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227e6a54f3-883f-43d5-87c4-172dfd64a1f5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs that have not restarted within the specified number of days\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that have not restarted within the specified number of days. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022MachineLastBootUpTime\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7e84ba44-6d03-46fd-950e-5efa5a1112fa\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227e84ba44-6d03-46fd-950e-5efa5a1112fa\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1692 - Information System Monitoring | Inbound And Outbound Communications Traffic\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1692\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7ecda928-9df4-4dd7-8f44-641a91e470e8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227ecda928-9df4-4dd7-8f44-641a91e470e8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs that do not have the password complexity setting enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the password complexity setting enabled. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022PasswordMustMeetComplexityRequirements\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022PasswordMustMeetComplexityRequirements\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227ed40801-8a0f-4ceb-85c0-9fd25c1d61a8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1191 - Configuration Change Control | Automated Document / Notification / Prohibition Of Changes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1191\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7f26a61b-a74d-467c-99cf-63644db144f7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227f26a61b-a74d-467c-99cf-63644db144f7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1520 - Personnel Termination\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1520\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7f2c513b-eb16-463b-b469-c10e5fa94f0a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227f2c513b-eb16-463b-b469-c10e5fa94f0a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1126 - Audit Reduction And Report Generation | Automatic Processing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1126\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7f37f71b-420f-49bf-9477-9c0196974ecf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227f37f71b-420f-49bf-9477-9c0196974ecf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027System Audit Policies - Privilege Use\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Privilege Use\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesPrivilegeUse\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7f4e96d1-e4f3-4dbb-b767-33ca4df8df7c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227f4e96d1-e4f3-4dbb-b767-33ca4df8df7c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit diagnostic setting\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Audit diagnostic setting for selected resource types\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022listOfResourceTypes\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource Types\u0022,\u0022strongType\u0022:\u0022resourceTypes\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfResourceTypes\u0027)]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022AuditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227f89b1eb-583c-429a-8828-af049802c1d9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1117 - Audit Review, Analysis, And Reporting | Process Integration\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1117\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7fbfe680-6dbb-4037-963c-a621c5635902\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227fbfe680-6dbb-4037-963c-a621c5635902\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022SQL Auditing settings should have Action-Groups configured to capture critical activities\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022The AuditActionsAndGroups property should contain at least SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP, FAILED_DATABASE_AUTHENTICATION_GROUP, BATCH_COMPLETED_GROUP to ensure a thorough audit logging\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/auditingSettings\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]\u0022,\u0022notEquals\u0022:\u0022SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]\u0022,\u0022notEquals\u0022:\u0022FAILED_DATABASE_AUTHENTICATION_GROUP\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/auditingSettings/auditActionsAndGroups[*]\u0022,\u0022notEquals\u0022:\u0022BATCH_COMPLETED_GROUP\u0022}}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7ff426e2-515f-405a-91c8-4f2333442eb5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227ff426e2-515f-405a-91c8-4f2333442eb5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1703 - Security Alerts, Advisories, And Directives\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1703\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/804faf7d-b687-40f7-9f74-79e28adf4205\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022804faf7d-b687-40f7-9f74-79e28adf4205\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1303 - Identification And Authentication (Org. Users) | Local Access To Privileged Accounts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1303\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/80ca0a27-918a-4604-af9e-723a27ee51e8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002280ca0a27-918a-4604-af9e-723a27ee51e8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1505 - Information Security Architecture\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1505\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/813a10a7-3943-4fe3-8678-00dc52db5490\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022813a10a7-3943-4fe3-8678-00dc52db5490\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1614 - Developer Security Architecture And Design\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1614\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8154e3b3-cc52-40be-9407-7756581d71f6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228154e3b3-cc52-40be-9407-7756581d71f6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027User Rights Assignment\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027User Rights Assignment\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022UsersOrGroupsThatMayAccessThisComputerFromTheNetwork\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users or groups that may access this computer from the network\u0022,\u0022description\u0022:\u0022Specifies which remote users on the network are permitted to connect to the computer. This does not include Remote Desktop Connection.\u0022},\u0022defaultValue\u0022:\u0022Administrators, Authenticated Users\u0022},\u0022UsersOrGroupsThatMayLogOnLocally\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users or groups that may log on locally\u0022,\u0022description\u0022:\u0022Specifies which users or groups can interactively log on to the computer. Users who attempt to log on via Remote Desktop Connection or IIS also require this user right.\u0022},\u0022defaultValue\u0022:\u0022Administrators\u0022},\u0022UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users or groups that may log on through Remote Desktop Services\u0022,\u0022description\u0022:\u0022Specifies which users or groups are permitted to log on as a Terminal Services client, Remote Desktop, or for Remote Assistance.\u0022},\u0022defaultValue\u0022:\u0022Administrators, Remote Desktop Users\u0022},\u0022UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users and groups that are denied access to this computer from the network\u0022,\u0022description\u0022:\u0022Specifies which users or groups are explicitly prohibited from connecting to the computer across the network.\u0022},\u0022defaultValue\u0022:\u0022Guests\u0022},\u0022UsersOrGroupsThatMayManageAuditingAndSecurityLog\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users or groups that may manage auditing and security log\u0022,\u0022description\u0022:\u0022Specifies users and groups permitted to change the auditing options for files and directories and clear the Security log.\u0022},\u0022defaultValue\u0022:\u0022Administrators\u0022},\u0022UsersOrGroupsThatMayBackUpFilesAndDirectories\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users or groups that may back up files and directories\u0022,\u0022description\u0022:\u0022Specifies users and groups allowed to circumvent file and directory permissions to back up the system.\u0022},\u0022defaultValue\u0022:\u0022Administrators, Backup Operators\u0022},\u0022UsersOrGroupsThatMayChangeTheSystemTime\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users or groups that may change the system time\u0022,\u0022description\u0022:\u0022Specifies which users and groups are permitted to change the time and date on the internal clock of the computer.\u0022},\u0022defaultValue\u0022:\u0022Administrators, LOCAL SERVICE\u0022},\u0022UsersOrGroupsThatMayChangeTheTimeZone\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users or groups that may change the time zone\u0022,\u0022description\u0022:\u0022Specifies which users and groups are permitted to change the time zone of the computer.\u0022},\u0022defaultValue\u0022:\u0022Administrators, LOCAL SERVICE\u0022},\u0022UsersOrGroupsThatMayCreateATokenObject\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users or groups that may create a token object\u0022,\u0022description\u0022:\u0022Specifies which users and groups are permitted to create an access token, which may provide elevated rights to access sensitive data.\u0022},\u0022defaultValue\u0022:\u0022No One\u0022},\u0022UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users and groups that are denied logging on as a batch job\u0022,\u0022description\u0022:\u0022Specifies which users and groups are explicitly not permitted to log on to the computer as a batch job (i.e. scheduled task).\u0022},\u0022defaultValue\u0022:\u0022Guests\u0022},\u0022UsersAndGroupsThatAreDeniedLoggingOnAsAService\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users and groups that are denied logging on as a service\u0022,\u0022description\u0022:\u0022Specifies which service accounts are explicitly not permitted to register a process as a service.\u0022},\u0022defaultValue\u0022:\u0022Guests\u0022},\u0022UsersAndGroupsThatAreDeniedLocalLogon\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users and groups that are denied local logon\u0022,\u0022description\u0022:\u0022Specifies which users and groups are explicitly not permitted to log on to the computer.\u0022},\u0022defaultValue\u0022:\u0022Guests\u0022},\u0022UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users and groups that are denied log on through Remote Desktop Services\u0022,\u0022description\u0022:\u0022Specifies which users and groups are explicitly not permitted to log on to the computer via Terminal Services/Remote Desktop Client.\u0022},\u0022defaultValue\u0022:\u0022Guests\u0022},\u0022UserAndGroupsThatMayForceShutdownFromARemoteSystem\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: User and groups that may force shutdown from a remote system\u0022,\u0022description\u0022:\u0022Specifies which users and groups are permitted to shut down the computer from a remote location on the network.\u0022},\u0022defaultValue\u0022:\u0022Administrators\u0022},\u0022UsersAndGroupsThatMayRestoreFilesAndDirectories\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users and groups that may restore files and directories\u0022,\u0022description\u0022:\u0022Specifies which users and groups are permitted to bypass file, directory, registry, and other persistent object permissions when restoring backed up files and directories.\u0022},\u0022defaultValue\u0022:\u0022Administrators, Backup Operators\u0022},\u0022UsersAndGroupsThatMayShutDownTheSystem\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users and groups that may shut down the system\u0022,\u0022description\u0022:\u0022Specifies which users and groups who are logged on locally to the computers in your environment are permitted to shut down the operating system with the Shut Down command.\u0022},\u0022defaultValue\u0022:\u0022Administrators\u0022},\u0022UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Users or groups that may take ownership of files or other objects\u0022,\u0022description\u0022:\u0022Specifies which users and groups are permitted to take ownership of files, folders, registry keys, processes, or threads. This user right bypasses any permissions that are in place to protect objects to give ownership to the specified user.\u0022},\u0022defaultValue\u0022:\u0022Administrators\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_UserRightsAssignment\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Access this computer from the network;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersOrGroupsThatMayAccessThisComputerFromTheNetwork\u0027), \u0027,\u0027, \u0027Allow log on locally;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersOrGroupsThatMayLogOnLocally\u0027), \u0027,\u0027, \u0027Allow log on through Remote Desktop Services;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices\u0027), \u0027,\u0027, \u0027Deny access to this computer from the network;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork\u0027), \u0027,\u0027, \u0027Manage auditing and security log;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersOrGroupsThatMayManageAuditingAndSecurityLog\u0027), \u0027,\u0027, \u0027Back up files and directories;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersOrGroupsThatMayBackUpFilesAndDirectories\u0027), \u0027,\u0027, \u0027Change the system time;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersOrGroupsThatMayChangeTheSystemTime\u0027), \u0027,\u0027, \u0027Change the time zone;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersOrGroupsThatMayChangeTheTimeZone\u0027), \u0027,\u0027, \u0027Create a token object;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersOrGroupsThatMayCreateATokenObject\u0027), \u0027,\u0027, \u0027Deny log on as a batch job;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob\u0027), \u0027,\u0027, \u0027Deny log on as a service;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersAndGroupsThatAreDeniedLoggingOnAsAService\u0027), \u0027,\u0027, \u0027Deny log on locally;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersAndGroupsThatAreDeniedLocalLogon\u0027), \u0027,\u0027, \u0027Deny log on through Remote Desktop Services;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices\u0027), \u0027,\u0027, \u0027Force shutdown from a remote system;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UserAndGroupsThatMayForceShutdownFromARemoteSystem\u0027), \u0027,\u0027, \u0027Restore files and directories;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersAndGroupsThatMayRestoreFilesAndDirectories\u0027), \u0027,\u0027, \u0027Shut down the system;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersAndGroupsThatMayShutDownTheSystem\u0027), \u0027,\u0027, \u0027Take ownership of files or other objects;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_UserRightsAssignment\u0022},\u0022UsersOrGroupsThatMayAccessThisComputerFromTheNetwork\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayAccessThisComputerFromTheNetwork\u0027)]\u0022},\u0022UsersOrGroupsThatMayLogOnLocally\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayLogOnLocally\u0027)]\u0022},\u0022UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices\u0027)]\u0022},\u0022UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork\u0027)]\u0022},\u0022UsersOrGroupsThatMayManageAuditingAndSecurityLog\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayManageAuditingAndSecurityLog\u0027)]\u0022},\u0022UsersOrGroupsThatMayBackUpFilesAndDirectories\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayBackUpFilesAndDirectories\u0027)]\u0022},\u0022UsersOrGroupsThatMayChangeTheSystemTime\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayChangeTheSystemTime\u0027)]\u0022},\u0022UsersOrGroupsThatMayChangeTheTimeZone\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayChangeTheTimeZone\u0027)]\u0022},\u0022UsersOrGroupsThatMayCreateATokenObject\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayCreateATokenObject\u0027)]\u0022},\u0022UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob\u0027)]\u0022},\u0022UsersAndGroupsThatAreDeniedLoggingOnAsAService\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLoggingOnAsAService\u0027)]\u0022},\u0022UsersAndGroupsThatAreDeniedLocalLogon\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLocalLogon\u0027)]\u0022},\u0022UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices\u0027)]\u0022},\u0022UserAndGroupsThatMayForceShutdownFromARemoteSystem\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UserAndGroupsThatMayForceShutdownFromARemoteSystem\u0027)]\u0022},\u0022UsersAndGroupsThatMayRestoreFilesAndDirectories\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatMayRestoreFilesAndDirectories\u0027)]\u0022},\u0022UsersAndGroupsThatMayShutDownTheSystem\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatMayShutDownTheSystem\u0027)]\u0022},\u0022UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersOrGroupsThatMayAccessThisComputerFromTheNetwork\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersOrGroupsThatMayLogOnLocally\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersOrGroupsThatMayManageAuditingAndSecurityLog\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersOrGroupsThatMayBackUpFilesAndDirectories\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersOrGroupsThatMayChangeTheSystemTime\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersOrGroupsThatMayChangeTheTimeZone\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersOrGroupsThatMayCreateATokenObject\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersAndGroupsThatAreDeniedLoggingOnAsAService\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersAndGroupsThatAreDeniedLocalLogon\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UserAndGroupsThatMayForceShutdownFromARemoteSystem\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersAndGroupsThatMayRestoreFilesAndDirectories\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersAndGroupsThatMayShutDownTheSystem\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Access this computer from the network;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayAccessThisComputerFromTheNetwork\u0027)]\u0022},{\u0022name\u0022:\u0022Allow log on locally;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayLogOnLocally\u0027)]\u0022},{\u0022name\u0022:\u0022Allow log on through Remote Desktop Services;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices\u0027)]\u0022},{\u0022name\u0022:\u0022Deny access to this computer from the network;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork\u0027)]\u0022},{\u0022name\u0022:\u0022Manage auditing and security log;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayManageAuditingAndSecurityLog\u0027)]\u0022},{\u0022name\u0022:\u0022Back up files and directories;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayBackUpFilesAndDirectories\u0027)]\u0022},{\u0022name\u0022:\u0022Change the system time;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayChangeTheSystemTime\u0027)]\u0022},{\u0022name\u0022:\u0022Change the time zone;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayChangeTheTimeZone\u0027)]\u0022},{\u0022name\u0022:\u0022Create a token object;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayCreateATokenObject\u0027)]\u0022},{\u0022name\u0022:\u0022Deny log on as a batch job;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob\u0027)]\u0022},{\u0022name\u0022:\u0022Deny log on as a service;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLoggingOnAsAService\u0027)]\u0022},{\u0022name\u0022:\u0022Deny log on locally;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLocalLogon\u0027)]\u0022},{\u0022name\u0022:\u0022Deny log on through Remote Desktop Services;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices\u0027)]\u0022},{\u0022name\u0022:\u0022Force shutdown from a remote system;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UserAndGroupsThatMayForceShutdownFromARemoteSystem\u0027)]\u0022},{\u0022name\u0022:\u0022Restore files and directories;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatMayRestoreFilesAndDirectories\u0027)]\u0022},{\u0022name\u0022:\u0022Shut down the system;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatMayShutDownTheSystem\u0027)]\u0022},{\u0022name\u0022:\u0022Take ownership of files or other objects;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Access this computer from the network;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayAccessThisComputerFromTheNetwork\u0027)]\u0022},{\u0022name\u0022:\u0022Allow log on locally;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayLogOnLocally\u0027)]\u0022},{\u0022name\u0022:\u0022Allow log on through Remote Desktop Services;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayLogOnThroughRemoteDesktopServices\u0027)]\u0022},{\u0022name\u0022:\u0022Deny access to this computer from the network;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedAccessToThisComputerFromTheNetwork\u0027)]\u0022},{\u0022name\u0022:\u0022Manage auditing and security log;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayManageAuditingAndSecurityLog\u0027)]\u0022},{\u0022name\u0022:\u0022Back up files and directories;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayBackUpFilesAndDirectories\u0027)]\u0022},{\u0022name\u0022:\u0022Change the system time;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayChangeTheSystemTime\u0027)]\u0022},{\u0022name\u0022:\u0022Change the time zone;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayChangeTheTimeZone\u0027)]\u0022},{\u0022name\u0022:\u0022Create a token object;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayCreateATokenObject\u0027)]\u0022},{\u0022name\u0022:\u0022Deny log on as a batch job;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLoggingOnAsABatchJob\u0027)]\u0022},{\u0022name\u0022:\u0022Deny log on as a service;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLoggingOnAsAService\u0027)]\u0022},{\u0022name\u0022:\u0022Deny log on locally;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLocalLogon\u0027)]\u0022},{\u0022name\u0022:\u0022Deny log on through Remote Desktop Services;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatAreDeniedLogOnThroughRemoteDesktopServices\u0027)]\u0022},{\u0022name\u0022:\u0022Force shutdown from a remote system;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UserAndGroupsThatMayForceShutdownFromARemoteSystem\u0027)]\u0022},{\u0022name\u0022:\u0022Restore files and directories;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatMayRestoreFilesAndDirectories\u0027)]\u0022},{\u0022name\u0022:\u0022Shut down the system;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersAndGroupsThatMayShutDownTheSystem\u0027)]\u0022},{\u0022name\u0022:\u0022Take ownership of files or other objects;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UsersOrGroupsThatMayTakeOwnershipOfFilesOrOtherObjects\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/815dcc9f-6662-43f2-9a03-1b83e9876f24\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022815dcc9f-6662-43f2-9a03-1b83e9876f24\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1308 - Identification And Authentication (Org. Users) | Remote Access  - Separate Device\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1308\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/81817e1c-5347-48dd-965a-40159d008229\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002281817e1c-5347-48dd-965a-40159d008229\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1287 - Information System Backup\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1287\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/819dc6da-289d-476e-8500-7e341ef8677d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022819dc6da-289d-476e-8500-7e341ef8677d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1213 - Configuration Settings | Respond To Unauthorized Changes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1213\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/81f11e32-a293-4a58-82cd-134af52e2318\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002281f11e32-a293-4a58-82cd-134af52e2318\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Geo-redundant backup should be enabled for Azure Database for MySQL\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Azure Database for MySQL with geo-redundant backup not enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMySQL/servers\u0022},{\u0022field\u0022:\u0022Microsoft.DBforMySQL/servers/storageProfile.geoRedundantBackup\u0022,\u0022notEquals\u0022:\u0022Enabled\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/82339799-d096-41ae-8538-b108becf0970\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002282339799-d096-41ae-8538-b108becf0970\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1168 - Continuous Monitoring | Independent Assessment\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1168\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/82409f9e-1f32-4775-bf07-b99d53a91b06\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002282409f9e-1f32-4775-bf07-b99d53a91b06\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1448 - Physical Access Authorizations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1448\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/825d6494-e583-42f2-a3f2-6458e6f0004f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022825d6494-e583-42f2-a3f2-6458e6f0004f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1452 - Physical Access Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1452\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/82c76455-4d3f-4e09-a654-22e592107e74\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002282c76455-4d3f-4e09-a654-22e592107e74\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1262 - Contingency Plan Testing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1262\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/831e510e-db41-4c72-888e-a0621ab62265\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022831e510e-db41-4c72-888e-a0621ab62265\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1008 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1008\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8356cfc6-507a-4d20-b818-08038011cd07\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228356cfc6-507a-4d20-b818-08038011cd07\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Event Hub should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Event Hub\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.EventHub/namespaces\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002283a214f7-d01a-484b-91a9-ed54470c9a6a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Network interfaces should not have public IPs\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy denies the network interfaces which are configured with any public IP. Public IP addresses allow internet resources to communicate inbound to Azure resources, and Azure resources to communicate outbound to the internet. This should be reviewed by the network security team.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/networkInterfaces\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkInterfaces/ipconfigurations[*].publicIpAddress.id\u0022,\u0022notLike\u0022:\u0022*\u0022}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002283a86a26-fd1f-447c-b59d-e51f44264114\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Bring your own key data protection should be enabled for MySQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits MySQL servers in your environment without bring your own key data protection enabled. For more details, visit https://aka.ms/mysqlbyok.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMySQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforMySQL/servers/keys\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.DBforMySQL/servers/keys/serverKeyType\u0022,\u0022equals\u0022:\u0022AzureKeyVault\u0022},{\u0022field\u0022:\u0022Microsoft.DBforMySQL/servers/keys/uri\u0022,\u0022notEquals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.DBforMySQL/servers/keys/uri\u0022,\u0022exists\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002283cef61d-dbd1-4b20-a4fc-5fbc7da10833\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1382 - Incident Response Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1382\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/841392b3-40da-4473-b328-4cde49db67b3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022841392b3-40da-4473-b328-4cde49db67b3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Log Analytics agent should be installed on your Linux Azure Arc machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits Linux Azure Arc machines if the Log Analytics agent is not installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Monitoring\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/type\u0022,\u0022equals\u0022:\u0022OmsAgentForLinux\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/842c54e8-c2f9-4d79-ae8d-38d8b8019373\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022842c54e8-c2f9-4d79-ae8d-38d8b8019373\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1098 - Security Training Records\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1098\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/84363adb-dde3-411a-9fc1-36b56737f822\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002284363adb-dde3-411a-9fc1-36b56737f822\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027.NET Framework\u0027 version is the latest, if used as a part of the Web app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for .NET Framework software either due to security flaws or to include additional functionality. Using the latest .NET framework version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.netFrameworkVersion\u0022,\u0022in\u0022:[\u0022v3.0\u0022,\u0022v4.0\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/843664e0-7563-41ee-a9cb-7522c382d2c4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022843664e0-7563-41ee-a9cb-7522c382d2c4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1119 - Audit Review, Analysis, And Reporting | Central Review And Analysis\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1119\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/845f6359-b764-4b40-b579-657aefe23c44\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022845f6359-b764-4b40-b579-657aefe23c44\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1024 - Account Management | Account Monitoring / Atypical Usage\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1024\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/84914fb4-12da-4c53-a341-a9fd463bed10\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002284914fb4-12da-4c53-a341-a9fd463bed10\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1307 - Identification And Authentication (Org. Users) | Net. Access To Non-Priv. Accts. - Replay\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1307\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/84e622c8-4bed-417c-84c6-b2fb0dd73682\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002284e622c8-4bed-417c-84c6-b2fb0dd73682\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1080 - Use Of External Information Systems | Portable Storage Devices\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1080\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/852981b4-a380-4704-aa1e-2e52d63445e5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022852981b4-a380-4704-aa1e-2e52d63445e5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1580 - Information System Documentation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1580\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/854db8ac-6adf-42a0-bef3-b73f764f40b9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022854db8ac-6adf-42a0-bef3-b73f764f40b9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1348 - Identification And Authentication (Non-Org. Users) | Acceptance Of Third-Party Credentials\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1348\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/855ced56-417b-4d74-9d5f-dd1bc81e22d6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022855ced56-417b-4d74-9d5f-dd1bc81e22d6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1079 - Use Of External Information Systems | Limits On Authorized Use\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1079\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/85c32733-7d23-4948-88da-058e2c56b60f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002285c32733-7d23-4948-88da-058e2c56b60f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1326 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1326\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8605fc00-1bf5-4fb3-984e-c95cec4f231d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228605fc00-1bf5-4fb3-984e-c95cec4f231d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Microsoft Network Server\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Microsoft Network Server\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsMicrosoftNetworkServer\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsMicrosoftNetworkServer\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/86880e5c-df35-43c5-95ad-7e120635775e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002286880e5c-df35-43c5-95ad-7e120635775e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy SQL DB transparent data encryption\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Enables transparent data encryption on SQL databases\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers/databases\u0022},{\u0022field\u0022:\u0022name\u0022,\u0022notEquals\u0022:\u0022master\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022DeployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/databases/transparentDataEncryption\u0022,\u0022name\u0022:\u0022current\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/transparentDataEncryption.status\u0022,\u0022equals\u0022:\u0022Enabled\u0022},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/9b7fa17d-e63e-47b0-bb0a-15c516ac86ec\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022fullDbName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027fullDbName\u0027), \u0027/current\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Sql/servers/databases/transparentDataEncryption\u0022,\u0022apiVersion\u0022:\u00222014-04-01\u0022,\u0022properties\u0022:{\u0022status\u0022:\u0022Enabled\u0022}}]},\u0022parameters\u0022:{\u0022fullDbName\u0022:{\u0022value\u0022:\u0022[field(\u0027fullName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002286a912f6-9a06-4e26-b447-11b16ba8659f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022System updates should be installed on your machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Missing security system updates on your servers will be monitored by Azure Security Center as recommendations\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022systemUpdates\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002286b3d65f-7626-441e-b690-81a8b71cff60\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1507 - Personnel Security Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1507\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/86ccd1bf-e7ad-4851-93ce-6ec817469c1e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002286ccd1bf-e7ad-4851-93ce-6ec817469c1e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that Register with Azure Active Directory is enabled on API app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.managedServiceIdentityId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/86d97760-d216-4d81-a3ad-163087b2b6c3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002286d97760-d216-4d81-a3ad-163087b2b6c3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1392 - Information Spillage Response | Post-Spill Operations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1392\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/86dc819f-15e1-43f9-a271-41ae58d4cecc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002286dc819f-15e1-43f9-a271-41ae58d4cecc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1589 - External Information System Services | Risk Assessments / Organizational Approvals\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1589\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/86ec7f9b-9478-40ff-8cfd-6a0d510081a8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002286ec7f9b-9478-40ff-8cfd-6a0d510081a8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1207 - Access Restrictions For Change | Limit Production / Operational Privileges\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1207\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8713a0ed-0d1e-4d10-be82-83dffb39830e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228713a0ed-0d1e-4d10-be82-83dffb39830e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Require a tag on resources\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Enforces existence of a tag. Does not apply to resource groups.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022exists\u0022:\u0022false\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/871b6d14-10aa-478d-b590-94f262ecfa99\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022871b6d14-10aa-478d-b590-94f262ecfa99\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1180 - Baseline Configuration | Automation Support For Accuracy / Currency\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1180\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/874e7880-a067-42a7-bcbe-1a340f54c8cc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022874e7880-a067-42a7-bcbe-1a340f54c8cc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1635 - Boundary Protection | Host-Based Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1635\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/87551b5d-1deb-4d0f-86cc-9dc14cb4bf7e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002287551b5d-1deb-4d0f-86cc-9dc14cb4bf7e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Administrative Templates - Control Panel\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Administrative Templates - Control Panel\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_AdministrativeTemplatesControlPanel\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/87b590fe-4a1d-4697-ae74-d4fe72ab786c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002287b590fe-4a1d-4697-ae74-d4fe72ab786c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1293 - Information System Backup | Separate Storage For Critical Information\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1293\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/87f7cd82-2e45-4d0f-9e2f-586b0962d142\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002287f7cd82-2e45-4d0f-9e2f-586b0962d142\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1440 - Media Sanitization | Review / Approve / Track / Document / Verify\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1440\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/881299bf-2a5b-4686-a1b2-321d33679953\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022881299bf-2a5b-4686-a1b2-321d33679953\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1356 - Incident Response Training | Simulated Events\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1356\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8829f8f5-e8be-441e-85c9-85b72a5d0ef3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228829f8f5-e8be-441e-85c9-85b72a5d0ef3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Linux VMs that have the specified applications installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Linux virtual machines that have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.2.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022ApplicationName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Application names\u0022,\u0022description\u0022:\u0022A semicolon-separated list of the names of the applications that should not be installed. e.g. \u0027python; powershell\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022not_installed_application_linux\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent\u0027, \u0027=\u0027, concat(\u0027packages: [\u0027, replace(parameters(\u0027ApplicationName\u0027), \u0027;\u0027, \u0027,\u0027), \u0027]\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022not_installed_application_linux\u0022},\u0022ApplicationName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ApplicationName\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ApplicationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent\u0022,\u0022value\u0022:\u0022[concat(\u0027packages: [\u0027, replace(parameters(\u0027ApplicationName\u0027), \u0027;\u0027, \u0027,\u0027), \u0027]\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[ChefInSpec]NotInstalledApplicationLinuxResource1;AttributesYmlContent\u0022,\u0022value\u0022:\u0022[concat(\u0027packages: [\u0027, replace(parameters(\u0027ApplicationName\u0027), \u0027;\u0027, \u0027,\u0027), \u0027]\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforLinux\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforLinux\u0022,\u0022typeHandlerVersion\u0022:\u00221.0\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/884b209a-963b-4520-8006-d20cb3c213e0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022884b209a-963b-4520-8006-d20cb3c213e0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1317 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1317\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8877f519-c166-47b7-81b7-8a8eb4ff3775\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228877f519-c166-47b7-81b7-8a8eb4ff3775\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1501 - Rules Of Behavior\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1501\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/88817b58-8472-4f6c-81fa-58ce42b67f51\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002288817b58-8472-4f6c-81fa-58ce42b67f51\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027Java version\u0027 is the latest, if used as a part of the Api app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for Java either due to security flaws or to include additional functionality. Using the latest Python version for Api apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022JavaLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Latest Java version\u0022,\u0022description\u0022:\u0022Latest supported Java version for App Services\u0022},\u0022defaultValue\u0022:\u002211\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022notContains\u0022:\u0022JAVA\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.javaVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022like\u0022:\u0022[concat(\u0027*\u0027, parameters(\u0027JavaLatestVersion\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.javaVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.javaVersion\u0022,\u0022like\u0022:\u0022[concat(parameters(\u0027JavaLatestVersion\u0027), \u0027*\u0027)]\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/88999f4c-376a-45c8-bcb3-4058f713cf39\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002288999f4c-376a-45c8-bcb3-4058f713cf39\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Network interfaces should disable IP forwarding\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy denies the network interfaces which enabled IP forwarding. The setting of IP forwarding disables Azure\u0027s check of the source and destination for a network interface. This should be reviewed by the network security team.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/networkInterfaces\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkInterfaces/enableIpForwarding\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002288c0b9da-ce96-4b03-9635-f29a937e2900\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1215 - Least Functionality\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1215\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/88fc93e8-4745-4785-b5a5-b44bb92c44ff\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002288fc93e8-4745-4785-b5a5-b44bb92c44ff\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022SQL servers should be configured with auditing retention days greater than 90 days.\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit SQL servers configured with an auditing retention period of less than 90 days.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/auditingSettings\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/auditingSettings/retentionDays\u0022,\u0022greater\u0022:90}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002289099bee-89e0-4b26-a5f4-165451757743\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1411 - Nonlocal Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1411\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/898d4fe8-f743-4333-86b7-0c9245d93e7d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022898d4fe8-f743-4333-86b7-0c9245d93e7d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1092 - Security Awareness Training | Insider Threat\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1092\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8a29d47b-8604-4667-84ef-90d203fcb305\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228a29d47b-8604-4667-84ef-90d203fcb305\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - System settings\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - System settings\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsSystemsettings\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8a39d1f1-5513-4628-b261-f469a5a3341b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228a39d1f1-5513-4628-b261-f469a5a3341b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs with a pending reboot\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with a pending reboot. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsPendingReboot\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8b0de57a-f511-4d45-a277-17cb79cb163b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228b0de57a-f511-4d45-a277-17cb79cb163b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1534 - Personnel Sanctions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1534\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8b2b263e-cd05-4488-bcbf-4debec7a17d9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228b2b263e-cd05-4488-bcbf-4debec7a17d9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1170 - Penetration Testing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1170\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8b78b9b3-ee3c-48e0-a243-ed6dba5b7a12\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228b78b9b3-ee3c-48e0-a243-ed6dba5b7a12\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Windows Firewall Properties\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Windows Firewall Properties\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_WindowsFirewallProperties\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8bbd627e-4d25-4906-9a6e-3789780af3ec\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228bbd627e-4d25-4906-9a6e-3789780af3ec\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027HTTP Version\u0027 is the latest, if used to run the Web app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.http20Enabled\u0022,\u0022Equals\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8c122334-9d20-4eb8-89ea-ac9a705b74ae\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228c122334-9d20-4eb8-89ea-ac9a705b74ae\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1458 - Physical Access Control | Information System Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1458\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8c19ceb7-56e9-4488-8ddb-b1eb3aa6d203\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228c19ceb7-56e9-4488-8ddb-b1eb3aa6d203\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1683 - Information System Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1683\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8c79fee4-88dd-44ce-bbd4-4de88948c4f8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228c79fee4-88dd-44ce-bbd4-4de88948c4f8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Latest TLS version should be used in your API App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Upgrade to the latest TLS version\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/minTlsVersion\u0022,\u0022equals\u0022:\u00221.2\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228cb6aa8b-9e41-4f4e-aa25-089a7ac2581e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1316 - Identifier Management | Identify User Status\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1316\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8ce14753-66e5-465d-9841-26ef55c09c0d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228ce14753-66e5-465d-9841-26ef55c09c0d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Require a tag and its value on resource groups\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enforces a required tag and its value on resource groups.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}},\u0022tagValue\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Value\u0022,\u0022description\u0022:\u0022Value of the tag, such as \u0027production\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022},{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022notEquals\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228ce3da23-7156-49e4-b145-24f95f9dcb46\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1324 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1324\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8cfea2b3-7f77-497e-ac20-0752f2ff6eee\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228cfea2b3-7f77-497e-ac20-0752f2ff6eee\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1225 - Information System Component Inventory | Automated Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1225\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8d096fe0-f510-4486-8b4d-d17dc230980b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228d096fe0-f510-4486-8b4d-d17dc230980b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1288 - Information System Backup\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1288\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8d854c3b-a3e6-4ec9-9f0c-c7274dbaeb2f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228d854c3b-a3e6-4ec9-9f0c-c7274dbaeb2f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1281 - Telecommunications Services | Priority Of Service Provisions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1281\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8dc459b3-0e77-45af-8d71-cfd8c9654fe2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228dc459b3-0e77-45af-8d71-cfd8c9654fe2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1250 - Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1250\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8de614d8-a8b7-4f70-a62a-6d37089a002c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228de614d8-a8b7-4f70-a62a-6d37089a002c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027System Audit Policies - Object Access\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Object Access\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022AuditDetailedFileShare\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Detailed File Share\u0022,\u0022description\u0022:\u0022If this policy setting is enabled, access to all shared files and folders on the system is audited. Auditing for Success can lead to very high volumes of events.\u0022},\u0022allowedValues\u0022:[\u0022No Auditing\u0022,\u0022Success\u0022,\u0022Failure\u0022,\u0022Success and Failure\u0022],\u0022defaultValue\u0022:\u0022No Auditing\u0022},\u0022AuditFileShare\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit File Share\u0022,\u0022description\u0022:\u0022Specifies whether to audit events related to file shares: creation, deletion, modification, and access attempts. Also, it shows failed SMB SPN checks. Event volumes can be high on DCs and File Servers.\u0022},\u0022allowedValues\u0022:[\u0022No Auditing\u0022,\u0022Success\u0022,\u0022Failure\u0022,\u0022Success and Failure\u0022],\u0022defaultValue\u0022:\u0022No Auditing\u0022},\u0022AuditFileSystem\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit File System\u0022,\u0022description\u0022:\u0022Specifies whether audit events are generated when users attempt to access file system objects. Audit events are generated only for objects that have configured system access control lists (SACLs).\u0022},\u0022allowedValues\u0022:[\u0022No Auditing\u0022,\u0022Success\u0022,\u0022Failure\u0022,\u0022Success and Failure\u0022],\u0022defaultValue\u0022:\u0022No Auditing\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesObjectAccess\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Audit Detailed File Share;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditDetailedFileShare\u0027), \u0027,\u0027, \u0027Audit File Share;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditFileShare\u0027), \u0027,\u0027, \u0027Audit File System;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditFileSystem\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SystemAuditPoliciesObjectAccess\u0022},\u0022AuditDetailedFileShare\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditDetailedFileShare\u0027)]\u0022},\u0022AuditFileShare\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditFileShare\u0027)]\u0022},\u0022AuditFileSystem\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditFileSystem\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditDetailedFileShare\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditFileShare\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditFileSystem\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Detailed File Share;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditDetailedFileShare\u0027)]\u0022},{\u0022name\u0022:\u0022Audit File Share;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditFileShare\u0027)]\u0022},{\u0022name\u0022:\u0022Audit File System;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditFileSystem\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Detailed File Share;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditDetailedFileShare\u0027)]\u0022},{\u0022name\u0022:\u0022Audit File Share;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditFileShare\u0027)]\u0022},{\u0022name\u0022:\u0022Audit File System;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditFileSystem\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8e170edb-e0f5-497a-bb36-48b3280cec6a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228e170edb-e0f5-497a-bb36-48b3280cec6a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1278 - Alternate Processing Site | Preparation For Use\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1278\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8e5ef485-9e16-4c53-a475-fbb8107eac59\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228e5ef485-9e16-4c53-a475-fbb8107eac59\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Enable Security Center\u0027s auto provisioning of the Log Analytics agent on your subscriptions with custom workspace.\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Allow Security Center to auto provision the Log Analytics agent on your subscriptions to monitor and collect security data using a custom workspace.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Auto provision the Log Analytics agent on your subscriptions to monitor and collect security data using a custom workspace.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/autoProvisioningSettings\u0022,\u0022deploymentScope\u0022:\u0022Subscription\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/autoProvisioningSettings/autoProvision\u0022,\u0022equals\u0022:\u0022On\u0022},\u0022deployment\u0022:{\u0022location\u0022:\u0022westus\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Security/autoProvisioningSettings\u0022,\u0022name\u0022:\u0022default\u0022,\u0022apiVersion\u0022:\u00222017-08-01-preview\u0022,\u0022properties\u0022:{\u0022autoProvision\u0022:\u0022On\u0022}},{\u0022type\u0022:\u0022Microsoft.Security/workspaceSettings\u0022,\u0022apiVersion\u0022:\u00222017-08-01-preview\u0022,\u0022name\u0022:\u0022default\u0022,\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022scope\u0022:\u0022[subscription().id]\u0022}}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8e7da0a5-0a0e-4bbc-bfc0-7773c018b616\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228e7da0a5-0a0e-4bbc-bfc0-7773c018b616\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1517 - Personnel Termination\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1517\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8f5ad423-50d6-4617-b058-69908f5586c9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228f5ad423-50d6-4617-b058-69908f5586c9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1668 - Flaw Remediation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1668\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8fb0966e-be1d-42c3-baca-60df5c0bcc61\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228fb0966e-be1d-42c3-baca-60df5c0bcc61\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1013 - Account Management | Automated System Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1013\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8fd7b917-d83b-4379-af60-51e14e316c61\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228fd7b917-d83b-4379-af60-51e14e316c61\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1147 - Security Assessments\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1147\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8fef824a-29a8-4a4c-88fc-420a39c0d541\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228fef824a-29a8-4a4c-88fc-420a39c0d541\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs that do not store passwords using reversible encryption\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not store passwords using reversible encryption. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022StorePasswordsUsingReversibleEncryption\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022StorePasswordsUsingReversibleEncryption\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8ff0b18b-262e-4512-857a-48ad0aeb9a78\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228ff0b18b-262e-4512-857a-48ad0aeb9a78\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1550 - Vulnerability Scanning\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1550\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/902908fb-25a8-4225-a3a5-5603c80066c9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022902908fb-25a8-4225-a3a5-5603c80066c9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Windows Firewall Properties\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Windows Firewall Properties\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022WindowsFirewallDomainUseProfileSettings\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Domain): Use profile settings\u0022,\u0022description\u0022:\u0022Specifies whether Windows Firewall with Advanced Security uses the settings for the Domain profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallDomainBehaviorForOutboundConnections\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Domain): Behavior for outbound connections\u0022,\u0022description\u0022:\u0022Specifies the behavior for outbound connections for the Domain profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022WindowsFirewallDomainApplyLocalConnectionSecurityRules\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Domain): Apply local connection security rules\u0022,\u0022description\u0022:\u0022Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Domain profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallDomainApplyLocalFirewallRules\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Domain): Apply local firewall rules\u0022,\u0022description\u0022:\u0022Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Domain profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallDomainDisplayNotifications\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Domain): Display notifications\u0022,\u0022description\u0022:\u0022Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Domain profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallPrivateUseProfileSettings\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Private): Use profile settings\u0022,\u0022description\u0022:\u0022Specifies whether Windows Firewall with Advanced Security uses the settings for the Private profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallPrivateBehaviorForOutboundConnections\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Private): Behavior for outbound connections\u0022,\u0022description\u0022:\u0022Specifies the behavior for outbound connections for the Private profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022WindowsFirewallPrivateApplyLocalConnectionSecurityRules\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Private): Apply local connection security rules\u0022,\u0022description\u0022:\u0022Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Private profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallPrivateApplyLocalFirewallRules\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Private): Apply local firewall rules\u0022,\u0022description\u0022:\u0022Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Private profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallPrivateDisplayNotifications\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Private): Display notifications\u0022,\u0022description\u0022:\u0022Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Private profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallPublicUseProfileSettings\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Public): Use profile settings\u0022,\u0022description\u0022:\u0022Specifies whether Windows Firewall with Advanced Security uses the settings for the Public profile to filter network traffic. If you select Off, Windows Firewall with Advanced Security will not use any of the firewall rules or connection security rules for this profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallPublicBehaviorForOutboundConnections\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Public): Behavior for outbound connections\u0022,\u0022description\u0022:\u0022Specifies the behavior for outbound connections for the Public profile that do not match an outbound firewall rule. The default value of 0 means to allow connections, and a value of 1 means to block connections.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022WindowsFirewallPublicApplyLocalConnectionSecurityRules\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Public): Apply local connection security rules\u0022,\u0022description\u0022:\u0022Specifies whether local administrators are allowed to create connection security rules that apply together with connection security rules configured by Group Policy for the Public profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallPublicApplyLocalFirewallRules\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Public): Apply local firewall rules\u0022,\u0022description\u0022:\u0022Specifies whether local administrators are allowed to create local firewall rules that apply together with firewall rules configured by Group Policy for the Public profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallPublicDisplayNotifications\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall (Public): Display notifications\u0022,\u0022description\u0022:\u0022Specifies whether Windows Firewall with Advanced Security displays notifications to the user when a program is blocked from receiving inbound connections, for the Public profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022WindowsFirewallDomainAllowUnicastResponse\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall: Domain: Allow unicast response\u0022,\u0022description\u0022:\u0022Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Domain profile.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022WindowsFirewallPrivateAllowUnicastResponse\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall: Private: Allow unicast response\u0022,\u0022description\u0022:\u0022Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Private profile.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022WindowsFirewallPublicAllowUnicastResponse\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Windows Firewall: Public: Allow unicast response\u0022,\u0022description\u0022:\u0022Specifies whether Windows Firewall with Advanced Security permits the local computer to receive unicast responses to its outgoing multicast or broadcast messages; for the Public profile.\u0022},\u0022defaultValue\u0022:\u00221\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_WindowsFirewallProperties\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Windows Firewall: Domain: Firewall state;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallDomainUseProfileSettings\u0027), \u0027,\u0027, \u0027Windows Firewall: Domain: Outbound connections;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallDomainBehaviorForOutboundConnections\u0027), \u0027,\u0027, \u0027Windows Firewall: Domain: Settings: Apply local connection security rules;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallDomainApplyLocalConnectionSecurityRules\u0027), \u0027,\u0027, \u0027Windows Firewall: Domain: Settings: Apply local firewall rules;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallDomainApplyLocalFirewallRules\u0027), \u0027,\u0027, \u0027Windows Firewall: Domain: Settings: Display a notification;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallDomainDisplayNotifications\u0027), \u0027,\u0027, \u0027Windows Firewall: Private: Firewall state;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPrivateUseProfileSettings\u0027), \u0027,\u0027, \u0027Windows Firewall: Private: Outbound connections;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPrivateBehaviorForOutboundConnections\u0027), \u0027,\u0027, \u0027Windows Firewall: Private: Settings: Apply local connection security rules;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPrivateApplyLocalConnectionSecurityRules\u0027), \u0027,\u0027, \u0027Windows Firewall: Private: Settings: Apply local firewall rules;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPrivateApplyLocalFirewallRules\u0027), \u0027,\u0027, \u0027Windows Firewall: Private: Settings: Display a notification;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPrivateDisplayNotifications\u0027), \u0027,\u0027, \u0027Windows Firewall: Public: Firewall state;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPublicUseProfileSettings\u0027), \u0027,\u0027, \u0027Windows Firewall: Public: Outbound connections;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPublicBehaviorForOutboundConnections\u0027), \u0027,\u0027, \u0027Windows Firewall: Public: Settings: Apply local connection security rules;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPublicApplyLocalConnectionSecurityRules\u0027), \u0027,\u0027, \u0027Windows Firewall: Public: Settings: Apply local firewall rules;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPublicApplyLocalFirewallRules\u0027), \u0027,\u0027, \u0027Windows Firewall: Public: Settings: Display a notification;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPublicDisplayNotifications\u0027), \u0027,\u0027, \u0027Windows Firewall: Domain: Allow unicast response;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallDomainAllowUnicastResponse\u0027), \u0027,\u0027, \u0027Windows Firewall: Private: Allow unicast response;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPrivateAllowUnicastResponse\u0027), \u0027,\u0027, \u0027Windows Firewall: Public: Allow unicast response;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027WindowsFirewallPublicAllowUnicastResponse\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_WindowsFirewallProperties\u0022},\u0022WindowsFirewallDomainUseProfileSettings\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainUseProfileSettings\u0027)]\u0022},\u0022WindowsFirewallDomainBehaviorForOutboundConnections\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainBehaviorForOutboundConnections\u0027)]\u0022},\u0022WindowsFirewallDomainApplyLocalConnectionSecurityRules\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainApplyLocalConnectionSecurityRules\u0027)]\u0022},\u0022WindowsFirewallDomainApplyLocalFirewallRules\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainApplyLocalFirewallRules\u0027)]\u0022},\u0022WindowsFirewallDomainDisplayNotifications\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainDisplayNotifications\u0027)]\u0022},\u0022WindowsFirewallPrivateUseProfileSettings\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateUseProfileSettings\u0027)]\u0022},\u0022WindowsFirewallPrivateBehaviorForOutboundConnections\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateBehaviorForOutboundConnections\u0027)]\u0022},\u0022WindowsFirewallPrivateApplyLocalConnectionSecurityRules\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateApplyLocalConnectionSecurityRules\u0027)]\u0022},\u0022WindowsFirewallPrivateApplyLocalFirewallRules\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateApplyLocalFirewallRules\u0027)]\u0022},\u0022WindowsFirewallPrivateDisplayNotifications\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateDisplayNotifications\u0027)]\u0022},\u0022WindowsFirewallPublicUseProfileSettings\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicUseProfileSettings\u0027)]\u0022},\u0022WindowsFirewallPublicBehaviorForOutboundConnections\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicBehaviorForOutboundConnections\u0027)]\u0022},\u0022WindowsFirewallPublicApplyLocalConnectionSecurityRules\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicApplyLocalConnectionSecurityRules\u0027)]\u0022},\u0022WindowsFirewallPublicApplyLocalFirewallRules\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicApplyLocalFirewallRules\u0027)]\u0022},\u0022WindowsFirewallPublicDisplayNotifications\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicDisplayNotifications\u0027)]\u0022},\u0022WindowsFirewallDomainAllowUnicastResponse\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainAllowUnicastResponse\u0027)]\u0022},\u0022WindowsFirewallPrivateAllowUnicastResponse\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateAllowUnicastResponse\u0027)]\u0022},\u0022WindowsFirewallPublicAllowUnicastResponse\u0022:{\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicAllowUnicastResponse\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallDomainUseProfileSettings\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallDomainBehaviorForOutboundConnections\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallDomainApplyLocalConnectionSecurityRules\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallDomainApplyLocalFirewallRules\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallDomainDisplayNotifications\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPrivateUseProfileSettings\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPrivateBehaviorForOutboundConnections\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPrivateApplyLocalConnectionSecurityRules\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPrivateApplyLocalFirewallRules\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPrivateDisplayNotifications\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPublicUseProfileSettings\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPublicBehaviorForOutboundConnections\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPublicApplyLocalConnectionSecurityRules\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPublicApplyLocalFirewallRules\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPublicDisplayNotifications\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallDomainAllowUnicastResponse\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPrivateAllowUnicastResponse\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022WindowsFirewallPublicAllowUnicastResponse\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Windows Firewall: Domain: Firewall state;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainUseProfileSettings\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Outbound connections;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainBehaviorForOutboundConnections\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Settings: Apply local connection security rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainApplyLocalConnectionSecurityRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Settings: Apply local firewall rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainApplyLocalFirewallRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Settings: Display a notification;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainDisplayNotifications\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Firewall state;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateUseProfileSettings\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Outbound connections;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateBehaviorForOutboundConnections\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Settings: Apply local connection security rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateApplyLocalConnectionSecurityRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Settings: Apply local firewall rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateApplyLocalFirewallRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Settings: Display a notification;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateDisplayNotifications\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Firewall state;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicUseProfileSettings\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Outbound connections;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicBehaviorForOutboundConnections\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Settings: Apply local connection security rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicApplyLocalConnectionSecurityRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Settings: Apply local firewall rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicApplyLocalFirewallRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Settings: Display a notification;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicDisplayNotifications\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Allow unicast response;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainAllowUnicastResponse\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Allow unicast response;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateAllowUnicastResponse\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Allow unicast response;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicAllowUnicastResponse\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Windows Firewall: Domain: Firewall state;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainUseProfileSettings\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Outbound connections;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainBehaviorForOutboundConnections\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Settings: Apply local connection security rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainApplyLocalConnectionSecurityRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Settings: Apply local firewall rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainApplyLocalFirewallRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Settings: Display a notification;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainDisplayNotifications\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Firewall state;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateUseProfileSettings\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Outbound connections;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateBehaviorForOutboundConnections\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Settings: Apply local connection security rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateApplyLocalConnectionSecurityRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Settings: Apply local firewall rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateApplyLocalFirewallRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Settings: Display a notification;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateDisplayNotifications\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Firewall state;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicUseProfileSettings\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Outbound connections;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicBehaviorForOutboundConnections\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Settings: Apply local connection security rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicApplyLocalConnectionSecurityRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Settings: Apply local firewall rules;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicApplyLocalFirewallRules\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Settings: Display a notification;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicDisplayNotifications\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Domain: Allow unicast response;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallDomainAllowUnicastResponse\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Private: Allow unicast response;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPrivateAllowUnicastResponse\u0027)]\u0022},{\u0022name\u0022:\u0022Windows Firewall: Public: Allow unicast response;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027WindowsFirewallPublicAllowUnicastResponse\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/909c958d-1b99-4c74-b88f-46a5c5bc34f9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022909c958d-1b99-4c74-b88f-46a5c5bc34f9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1133 - Protection Of Audit Information | Cryptographic Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1133\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/90b60a09-133d-45bc-86ef-b206a6134bbe\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002290b60a09-133d-45bc-86ef-b206a6134bbe\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs that do not have the specified Windows PowerShell modules installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that do not have the specified Windows PowerShell modules installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022Modules\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022PowerShell Modules\u0022,\u0022description\u0022:\u0022A semicolon-separated list of the names of the PowerShell modules that should be installed. You may also specify a specific version of a module that should be installed by including a comma after the module name, followed by the desired version. e.g. PSDscResources; SqlServerDsc, 12.0.0.0; ComputerManagementDsc, 6.1.0.0\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsPowerShellModules\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[PowerShellModules]PowerShellModules1;Modules\u0027, \u0027=\u0027, parameters(\u0027Modules\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsPowerShellModules\u0022},\u0022Modules\u0022:{\u0022value\u0022:\u0022[parameters(\u0027Modules\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022Modules\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[PowerShellModules]PowerShellModules1;Modules\u0022,\u0022value\u0022:\u0022[parameters(\u0027Modules\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[PowerShellModules]PowerShellModules1;Modules\u0022,\u0022value\u0022:\u0022[parameters(\u0027Modules\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/90ba2ee7-4ca8-4673-84d1-c851c50d3baf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002290ba2ee7-4ca8-4673-84d1-c851c50d3baf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1140 - Audit Generation | System-Wide / Time-Correlated Audit Trail\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1140\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/90d8b8ad-8ee3-4db7-913f-2a53fcff5316\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002290d8b8ad-8ee3-4db7-913f-2a53fcff5316\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1355 - Incident Response Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1355\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/90e01f69-3074-4de8-ade7-0fef3e7d83e0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002290e01f69-3074-4de8-ade7-0fef3e7d83e0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1657 - Secure Name / Address Resolution Service (Authoritative Source)\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1657\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/90f01329-a100-43c2-af31-098996135d2b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002290f01329-a100-43c2-af31-098996135d2b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Windows Components\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Windows Components\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_WindowsComponents\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9178b430-2295-406e-bb28-f6a7a2a2f897\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229178b430-2295-406e-bb28-f6a7a2a2f897\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1069 - Wireless Access | Authentication And Encryption\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1069\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/91c97b44-791e-46e9-bad7-ab7c4949edbb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002291c97b44-791e-46e9-bad7-ab7c4949edbb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy Dependency agent to Windows Azure Arc machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy deploys the Dependency agent to Windows Azure Arc machines if the agent isn\u0027t installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-preview\u0022,\u0022category\u0022:\u0022Monitoring\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/type\u0022,\u0022equals\u0022:\u0022DependencyAgentWindows\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022DaExtensionName\u0022:\u0022DependencyAgent\u0022,\u0022DaExtensionType\u0022:\u0022DependencyAgentWindows\u0022},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.HybridCompute/machines\u0022,\u0022apiVersion\u0022:\u00222020-03-11-preview\u0022,\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022resources\u0022:[{\u0022type\u0022:\u0022extensions\u0022,\u0022apiVersion\u0022:\u00222020-03-11-preview\u0022,\u0022name\u0022:\u0022[variables(\u0027DaExtensionName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.HybridCompute/machines/\u0027, parameters(\u0027vmName\u0027))]\u0022],\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022,\u0022type\u0022:\u0022[variables(\u0027DaExtensionType\u0027)]\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{}}}]}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled DA extension for VM\u0027, \u0027: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/91cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002291cb9edd-cd92-4d2f-b2f2-bdd8d065a3d4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1370 - Incident Monitoring | Automated Tracking / Data Collection / Analysis\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1370\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/924e1b2d-c502-478f-bfdb-a7e09a0d5c01\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022924e1b2d-c502-478f-bfdb-a7e09a0d5c01\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022MFA should be enabled accounts with write permissions on your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with write privileges to prevent a breach of accounts or resources.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022EnableMFAForWritePermissions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229297c21d-2ed6-4474-b48f-163f75654ce3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1290 - Information System Backup\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1290\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/92f85ce9-17b7-49ea-85ee-ea7271ea6b82\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002292f85ce9-17b7-49ea-85ee-ea7271ea6b82\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs that contain certificates expiring within the specified number of days\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that contain certificates expiring within the specified number of days. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022CertificateExpiration\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9328f27e-611e-44a7-a244-39109d7d35ab\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229328f27e-611e-44a7-a244-39109d7d35ab\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs in which the Administrators group does not contain all of the specified members\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group does not contain all of the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022MembersToInclude\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Members to include\u0022,\u0022description\u0022:\u0022A semicolon-separated list of members that should be included in the Administrators local group. Ex: Administrator; myUser1; myUser2\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AdministratorsGroupMembersToInclude\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[LocalGroup]AdministratorsGroup;MembersToInclude\u0027, \u0027=\u0027, parameters(\u0027MembersToInclude\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AdministratorsGroupMembersToInclude\u0022},\u0022MembersToInclude\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MembersToInclude\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MembersToInclude\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[LocalGroup]AdministratorsGroup;MembersToInclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027MembersToInclude\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[LocalGroup]AdministratorsGroup;MembersToInclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027MembersToInclude\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/93507a81-10a4-4af0-9ee2-34cf25a96e98\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002293507a81-10a4-4af0-9ee2-34cf25a96e98\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1575 - Acquisition Process | Functional Properties Of Security Controls\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1575\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/93e1bb73-1b08-4dbe-9c62-8e2e92e7ec41\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002293e1bb73-1b08-4dbe-9c62-8e2e92e7ec41\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1674 - Flaw Remediation | Time To Remediate Flaws / Benchmarks For Corrective Actions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1674\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/93e9e233-dd0a-4bde-aea5-1371bce0e002\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002293e9e233-dd0a-4bde-aea5-1371bce0e002\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1297 - Information System Recovery And Reconstitution | Restore Within Time Period\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1297\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/93fd8af1-c161-4bae-9ba9-f62731f76439\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002293fd8af1-c161-4bae-9ba9-f62731f76439\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1284 - Telecommunications Services | Provider Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1284\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/942b3e97-6ae3-410e-a794-c9c999b97c0b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022942b3e97-6ae3-410e-a794-c9c999b97c0b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1379 - Incident Response Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1379\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9442dd2c-a07f-46cd-b55a-553b66ba47ca\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229442dd2c-a07f-46cd-b55a-553b66ba47ca\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1371 - Incident Reporting\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1371\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9447f354-2c85-4700-93b3-ecdc6cb6a417\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229447f354-2c85-4700-93b3-ecdc6cb6a417\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allow resource creation only in European data centers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Allows resource creation in the following locations only: North Europe, West Europe\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022General\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022in\u0022:[\u0022northeurope\u0022,\u0022westeurope\u0022]}},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002294c19f19-8192-48cd-a11b-e37099d3e36b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1526 - Access Agreements\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1526\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/953e6261-a05a-44fd-8246-000e1a3edbb9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022953e6261-a05a-44fd-8246-000e1a3edbb9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Authentication should be enabled on your web app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching the web app, or authenticate those that have tokens before they reach the web app\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/siteAuthEnabled\u0022,\u0022equals\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/95bccee9-a7f8-4bec-9ee9-62c3473701fc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002295bccee9-a7f8-4bec-9ee9-62c3473701fc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1163 - Continuous Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1163\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/961663a1-8a91-4e59-b6f5-1eee57c0f49c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022961663a1-8a91-4e59-b6f5-1eee57c0f49c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Require a tag on resource groups\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enforces existence of a tag on resource groups.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022},{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022exists\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/96670d01-0a4d-4649-9c89-2d3abc0a5025\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002296670d01-0a4d-4649-9c89-2d3abc0a5025\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1717 - Software, Firmware, And Information Integrity | Binary Or Machine Executable Code\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1717\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/967773fc-d9ab-4a4e-8ff6-f5e9e3f5dbef\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022967773fc-d9ab-4a4e-8ff6-f5e9e3f5dbef\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Advanced data security settings for SQL server should contain an email address to receive security alerts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Ensure that an email address is provided for the \u0027Send alerts to\u0027 field in the Advanced Data Security server settings. This email address receives alert notifications when anomalous activities are detected on SQL servers.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies/emailAddresses[*]\u0022,\u0022notEquals\u0022:\u0022\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9677b740-f641-4f3c-b9c5-466005c85278\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229677b740-f641-4f3c-b9c5-466005c85278\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022App Configuration should use a customer managed key\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any App Configuration instance that does not use a customer managed key.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Configuration\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.AppConfiguration/configurationStores\u0022},{\u0022field\u0022:\u0022Microsoft.AppConfiguration/configurationStores/encryption.keyVaultProperties.keyIdentifier\u0022,\u0022exists\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/967a4b4b-2da9-43c1-b7d0-f98d0d74d0b1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022967a4b4b-2da9-43c1-b7d0-f98d0d74d0b1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1453 - Physical Access Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1453\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9693b564-3008-42bc-9d5d-9c7fe198c011\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229693b564-3008-42bc-9d5d-9c7fe198c011\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Administrative Templates - MSS (Legacy)\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Administrative Templates - MSS (Legacy)\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_AdminstrativeTemplatesMSSLegacy\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/97646672-5efa-4622-9b54-740270ad60bf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002297646672-5efa-4622-9b54-740270ad60bf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1607 - Developer Security Testing And Evaluation | Dynamic Code Analysis\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1607\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/976a74cf-b192-4d35-8cab-2068f272addb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022976a74cf-b192-4d35-8cab-2068f272addb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027System Audit Policies - Policy Change\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Policy Change\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022AuditAuthenticationPolicyChange\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Authentication Policy Change\u0022,\u0022description\u0022:\u0022Specifies whether audit events are generated when changes are made to authentication policy. This setting is useful for tracking changes in domain-level and forest-level trust and privileges that are granted to user accounts or groups.\u0022},\u0022allowedValues\u0022:[\u0022No Auditing\u0022,\u0022Success\u0022,\u0022Failure\u0022,\u0022Success and Failure\u0022],\u0022defaultValue\u0022:\u0022Success\u0022},\u0022AuditAuthorizationPolicyChange\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Authorization Policy Change\u0022,\u0022description\u0022:\u0022Specifies whether audit events are generated for assignment and removal of user rights in user right policies, changes in security token object permission, resource attributes changes and Central Access Policy changes for file system objects.\u0022},\u0022allowedValues\u0022:[\u0022No Auditing\u0022,\u0022Success\u0022,\u0022Failure\u0022,\u0022Success and Failure\u0022],\u0022defaultValue\u0022:\u0022No Auditing\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesPolicyChange\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Audit Authentication Policy Change;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditAuthenticationPolicyChange\u0027), \u0027,\u0027, \u0027Audit Authorization Policy Change;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditAuthorizationPolicyChange\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SystemAuditPoliciesPolicyChange\u0022},\u0022AuditAuthenticationPolicyChange\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditAuthenticationPolicyChange\u0027)]\u0022},\u0022AuditAuthorizationPolicyChange\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditAuthorizationPolicyChange\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditAuthenticationPolicyChange\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditAuthorizationPolicyChange\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Authentication Policy Change;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditAuthenticationPolicyChange\u0027)]\u0022},{\u0022name\u0022:\u0022Audit Authorization Policy Change;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditAuthorizationPolicyChange\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Authentication Policy Change;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditAuthenticationPolicyChange\u0027)]\u0022},{\u0022name\u0022:\u0022Audit Authorization Policy Change;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditAuthorizationPolicyChange\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/97b595c8-fd10-400e-8543-28e2b9138b13\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002297b595c8-fd10-400e-8543-28e2b9138b13\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1136 - Audit Record Retention\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1136\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/97ed5bac-a92f-4f6d-a8ed-dc094723597c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002297ed5bac-a92f-4f6d-a8ed-dc094723597c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1378 - Incident Response Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1378\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/97fceb70-6983-42d0-9331-18ad8253184d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002297fceb70-6983-42d0-9331-18ad8253184d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure Event Grid domains should use private links\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit Azure Event Grid domains that do not have at least one approved private endpoint connection. Clients in a virtual network can securely access resources that have private endpoint connections via private links. For more information, visit https://aka.ms/privateendpoints.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Event Grid\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.EventGrid/domains\u0022},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.EventGrid/domains/privateEndpointConnections[*]\u0022,\u0022where\u0022:{\u0022field\u0022:\u0022Microsoft.EventGrid/domains/privateEndpointConnections[*].privateLinkServiceConnectionState.status\u0022,\u0022equals\u0022:\u0022Approved\u0022}},\u0022less\u0022:1}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9830b652-8523-49cc-b1b3-e17dce1127ca\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229830b652-8523-49cc-b1b3-e17dce1127ca\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allow resource creation only in United States data centers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Allows resource creation in the following locations only: Central US, East US, East US2, North Central US, South Central US, West US\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022General\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022in\u0022:[\u0022centralus\u0022,\u0022eastus\u0022,\u0022eastus2\u0022,\u0022northcentralus\u0022,\u0022southcentralus\u0022,\u0022westus\u0022]}},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022983211ba-f348-4758-983b-21fa29294869\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Administrative Templates - Network\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Administrative Templates - Network\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022EnableInsecureGuestLogons\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Enable insecure guest logons\u0022,\u0022description\u0022:\u0022Specifies whether the SMB client will allow insecure guest logons to an SMB server.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allow simultaneous connections to the Internet or a Windows Domain\u0022,\u0022description\u0022:\u0022Specify whether to prevent computers from connecting to both a domain based network and a non-domain based network at the same time. A value of 0 allows simultaneous connections, and a value of 1 blocks them.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022TurnOffMulticastNameResolution\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Turn off multicast name resolution\u0022,\u0022description\u0022:\u0022Specifies whether LLMNR, a secondary name resolution protocol that transmits using multicast over a local subnet link on a single subnet, is enabled.\u0022},\u0022defaultValue\u0022:\u00221\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_AdministrativeTemplatesNetwork\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Enable insecure guest logons;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027EnableInsecureGuestLogons\u0027), \u0027,\u0027, \u0027Minimize the number of simultaneous connections to the Internet or a Windows Domain;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain\u0027), \u0027,\u0027, \u0027Turn off multicast name resolution;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027TurnOffMulticastNameResolution\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_AdministrativeTemplatesNetwork\u0022},\u0022EnableInsecureGuestLogons\u0022:{\u0022value\u0022:\u0022[parameters(\u0027EnableInsecureGuestLogons\u0027)]\u0022},\u0022AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain\u0027)]\u0022},\u0022TurnOffMulticastNameResolution\u0022:{\u0022value\u0022:\u0022[parameters(\u0027TurnOffMulticastNameResolution\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022EnableInsecureGuestLogons\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022TurnOffMulticastNameResolution\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Enable insecure guest logons;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027EnableInsecureGuestLogons\u0027)]\u0022},{\u0022name\u0022:\u0022Minimize the number of simultaneous connections to the Internet or a Windows Domain;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain\u0027)]\u0022},{\u0022name\u0022:\u0022Turn off multicast name resolution;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027TurnOffMulticastNameResolution\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Enable insecure guest logons;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027EnableInsecureGuestLogons\u0027)]\u0022},{\u0022name\u0022:\u0022Minimize the number of simultaneous connections to the Internet or a Windows Domain;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AllowSimultaneousConnectionsToTheInternetOrAWindowsDomain\u0027)]\u0022},{\u0022name\u0022:\u0022Turn off multicast name resolution;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027TurnOffMulticastNameResolution\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/985285b7-b97a-419c-8d48-c88cc934c8d8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022985285b7-b97a-419c-8d48-c88cc934c8d8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1076 - Use Of External Information Systems\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1076\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/98a4bd5f-6436-46d4-ad00-930b5b1dfed4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002298a4bd5f-6436-46d4-ad00-930b5b1dfed4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027HTTP Version\u0027 is the latest, if used to run the Api app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.http20Enabled\u0022,\u0022equals\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/991310cd-e9f3-47bc-b7b6-f57b557d07db\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022991310cd-e9f3-47bc-b7b6-f57b557d07db\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1102 - Audit Events\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1102\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9943c16a-c54c-4b4a-ad28-bfd938cdbf57\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229943c16a-c54c-4b4a-ad28-bfd938cdbf57\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1300 - Identification And Authentication (Organizational Users)\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1300\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/99deec7d-5526-472e-b07c-3645a792026a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002299deec7d-5526-472e-b07c-3645a792026a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1036 - Least Privilege | Non-Privileged Access For Nonsecurity Functions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1036\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9a16d673-8cf0-4dcf-b1d5-9b3e114fef71\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229a16d673-8cf0-4dcf-b1d5-9b3e114fef71\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022FTPS only should be required in your API App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Enable FTPS enforcement for enhanced security\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/ftpsState\u0022,\u0022equals\u0022:\u0022FtpsOnly\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9a1b8c48-453a-4044-86c3-d8bfd823e4f5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229a1b8c48-453a-4044-86c3-d8bfd823e4f5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1021 - Account Management | Restrictions On Use Of Shared / Group Accounts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1021\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9a3eb0a3-428d-4669-baff-20a14eb4b551\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229a3eb0a3-428d-4669-baff-20a14eb4b551\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Azure SQL Database to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Azure SQL Database to stream to a regional Event Hub on any Azure SQL Database which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers/databases\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022DeployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022fullName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Sql/servers/databases/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027fullName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022QueryStoreRuntimeStatistics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022QueryStoreWaitStatistics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Errors\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022DatabaseWaitStatistics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Blocks\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022SQLInsights\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Audit\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022SQLSecurityAuditEvents\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Timeouts\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022AutomaticTuning\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Deadlocks\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled diagnostic settings for \u0027, parameters(\u0027fullName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022fullName\u0022:{\u0022value\u0022:\u0022[field(\u0027fullName\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9a7c7a7d-49e5-4213-bea8-6a502b6272e0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229a7c7a7d-49e5-4213-bea8-6a502b6272e0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1049 - System Use Notification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1049\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9adf7ba7-900a-4f35-8d57-9f34aafc405c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229adf7ba7-900a-4f35-8d57-9f34aafc405c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1563 - Allocation Of Resources\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1563\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9afe2edf-232c-4fdf-8e6a-e867a5c525fd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229afe2edf-232c-4fdf-8e6a-e867a5c525fd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1462 - Monitoring Physical Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1462\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9b1f3a9a-13a1-4b40-8420-36bca6fd8c02\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229b1f3a9a-13a1-4b40-8420-36bca6fd8c02\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft IaaSAntimalware extension should be deployed on Windows servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Windows server VM without Microsoft IaaSAntimalware extension deployed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022IaaSAntimalware\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Security\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9b597639-28e4-48eb-b506-56b05d366257\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229b597639-28e4-48eb-b506-56b05d366257\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1236 - Software Usage Restrictions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1236\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9ba3ed84-c768-4e18-b87c-34ef1aff1b57\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229ba3ed84-c768-4e18-b87c-34ef1aff1b57\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1525 - Personnel Transfer\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1525\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9be2f688-7a61-45e3-8230-e1ec93893f66\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229be2f688-7a61-45e3-8230-e1ec93893f66\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit API Applications that are not using latest supported Java Framework\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use the latest supported Java version for the latest security classes. Using older classes and types can make your application vulnerable.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022api\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022apiApp\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UseLatestJava\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9bfe3727-0a17-471f-a2fe-eddd6b668745\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229bfe3727-0a17-471f-a2fe-eddd6b668745\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1138 - Audit Generation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1138\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9c284fc0-268a-4f29-af44-3c126674edb4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229c284fc0-268a-4f29-af44-3c126674edb4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1135 - Non-Repudiation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1135\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9c308b6b-2429-4b97-86cf-081b8e737b04\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229c308b6b-2429-4b97-86cf-081b8e737b04\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1489 - Location Of Information System Components\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1489\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9d0a794f-1444-4c96-9534-e35fc8c39c91\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229d0a794f-1444-4c96-9534-e35fc8c39c91\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027Java version\u0027 is the latest, if used as a part of the Function app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for Java software either due to security flaws or to include additional functionality. Using the latest Java version for Function apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022JavaLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Latest Java version\u0022,\u0022description\u0022:\u0022Latest supported Java version for App Services\u0022},\u0022defaultValue\u0022:\u002211\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022notContains\u0022:\u0022JAVA\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.javaVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022like\u0022:\u0022[concat(\u0027*\u0027, parameters(\u0027JavaLatestVersion\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.javaVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.javaVersion\u0022,\u0022like\u0022:\u0022[concat(parameters(\u0027JavaLatestVersion\u0027), \u0027*\u0027)]\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229d0b6ea4-93e2-4578-bf2f-6bb17d22b4bc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1322 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1322\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9d1d971e-467e-4278-9633-c74c3d4fecc4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229d1d971e-467e-4278-9633-c74c3d4fecc4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy Log Analytics agent to Linux Azure Arc machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy deploys the Log Analytics agent to Linux Azure Arc machines if the agent isn\u0027t installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Monitoring\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Specify the Log Analytics workspace the agent should be connected to. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/type\u0022,\u0022equals\u0022:\u0022OmsAgentForLinux\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022MMAExtension\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022,\u0022vmExtensionType\u0022:\u0022OmsAgentForLinux\u0022},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022apiVersion\u0022:\u00222019-12-12\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022settings\u0022:{\u0022workspaceId\u0022:\u0022[reference(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).customerId]\u0022,\u0022stopOnMultipleConnections\u0022:\u0022true\u0022},\u0022protectedSettings\u0022:{\u0022workspaceKey\u0022:\u0022[listKeys(parameters(\u0027logAnalytics\u0027), \u00272015-03-20\u0027).primarySharedKey]\u0022}}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled extension for VM\u0027, \u0027: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9d2b61b4-1d14-4a63-be30-d4498e7ad2cf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229d2b61b4-1d14-4a63-be30-d4498e7ad2cf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1233 - Configuration Management Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1233\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9d79001f-95fe-45d0-8736-f217e78c1f57\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229d79001f-95fe-45d0-8736-f217e78c1f57\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1305 - Identification And Authentication (Org. Users) | Group Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1305\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9d9166a8-1722-4b8f-847c-2cf3f2618b3d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229d9166a8-1722-4b8f-847c-2cf3f2618b3d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1259 - Contingency Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1259\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9d9e18f7-bad9-4d30-8806-a0c9d5e26208\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229d9e18f7-bad9-4d30-8806-a0c9d5e26208\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Access through Internet facing endpoint should be restricted\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Azure Security center has identified some of your Network Security Groups\u0027 inbound rules to be too permissive. Inbound rules should not allow access from \u0027Any\u0027 or \u0027Internet\u0027 ranges. This can potentially enable attackers to easily target your resources.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022unprotectedNetworkEndpoint\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229daedab3-fb2d-461e-b861-71790eead4f6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1500 - Rules Of Behavior\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1500\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9dd5b241-03cb-47d3-a5cd-4b89f9c53c92\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229dd5b241-03cb-47d3-a5cd-4b89f9c53c92\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1482 - Temperature And Humidity Controls | Monitoring With Alarms / Notifications\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1482\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9df4277e-8c88-4d5c-9b1a-541d53d15d7b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229df4277e-8c88-4d5c-9b1a-541d53d15d7b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1553 - Vulnerability Scanning | Breadth / Depth Of Coverage\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1553\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9e5225fe-cdfb-4fce-9aec-0fe20dd53b62\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229e5225fe-cdfb-4fce-9aec-0fe20dd53b62\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1490 - Security Planning Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1490\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9e61da80-0957-4892-b70c-609d5eaafb6b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229e61da80-0957-4892-b70c-609d5eaafb6b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1504 - Information Security Architecture\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1504\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9e7c35d0-12d4-4e0c-80a2-8a352537aefd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229e7c35d0-12d4-4e0c-80a2-8a352537aefd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1609 - Development Process, Standards, And Tools\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1609\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9e93fa71-42ac-41a7-b177-efbfdc53c69f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229e93fa71-42ac-41a7-b177-efbfdc53c69f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Append a tag and its value from the resource group\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Appends the specified tag with its value from the resource group when any resource which is missing this tag is created or updated. Does not modify the tags of resources created before this policy was applied until those resources are changed. New \u0027modify\u0027 effect policies are available that support remediation of tags on existing resources (see https://aka.ms/modifydoc).\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022value\u0022:\u0022[resourceGroup().tags[parameters(\u0027tagName\u0027)]]\u0022,\u0022notEquals\u0022:\u0022\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022append\u0022,\u0022details\u0022:[{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[resourceGroup().tags[parameters(\u0027tagName\u0027)]]\u0022}]}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9ea02ca2-71db-412d-8b00-7c7ca9fcd32d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229ea02ca2-71db-412d-8b00-7c7ca9fcd32d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1494 - System Security Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1494\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9ed09d84-3311-4853-8b67-2b55dfa33d09\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229ed09d84-3311-4853-8b67-2b55dfa33d09\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1514 - Personnel Screening | Information With Special Protection Measures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1514\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9ed5ca00-0e43-434e-a018-7aab91461ba7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229ed5ca00-0e43-434e-a018-7aab91461ba7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1187 - Configuration Change Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1187\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9f2b2f9e-4ba6-46c3-907f-66db138b6f85\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229f2b2f9e-4ba6-46c3-907f-66db138b6f85\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs that are not set to the specified time zone\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that are not set to the specified time zone. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsTimeZone\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9f658460-46b7-43af-8565-94fc0662be38\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229f658460-46b7-43af-8565-94fc0662be38\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1354 - Incident Response Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1354\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/9fd92c17-163a-4511-bb96-bbb476449796\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00229fd92c17-163a-4511-bb96-bbb476449796\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs on which the Log Analytics agent is not connected as expected\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines on which the Log Analytics agent is not connected to the specified workspaces. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsLogAnalyticsAgentConnection\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a030a57e-4639-4e8f-ade9-a92f33afe7ee\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a030a57e-4639-4e8f-ade9-a92f33afe7ee\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1145 - Security Assessments\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1145\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a0724970-9c75-4a64-a225-a28002953f28\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a0724970-9c75-4a64-a225-a28002953f28\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Allowed resource types\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy enables you to specify the resource types that your organization can deploy. Only resource types that support \u0027tags\u0027 and \u0027location\u0027 will be affected by this policy. To restrict all resources please duplicate this policy and change the \u0027mode\u0027 to \u0027All\u0027.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022General\u0022},\u0022parameters\u0022:{\u0022listOfResourceTypesAllowed\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022The list of resource types that can be deployed.\u0022,\u0022displayName\u0022:\u0022Allowed resource types\u0022,\u0022strongType\u0022:\u0022resourceTypes\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfResourceTypesAllowed\u0027)]\u0022}},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a08ec900-254a-4555-9bf5-e42af04b5c5c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1245 - Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1245\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a0e45314-57b8-4623-80cd-bbb561f59516\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a0e45314-57b8-4623-80cd-bbb561f59516\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1406 - Maintenance Tools | Inspect Media\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1406\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a0f5339c-9292-43aa-a0bc-d27c6b8e30aa\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a0f5339c-9292-43aa-a0bc-d27c6b8e30aa\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Security Center standard pricing tier should be selected\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022The standard pricing tier enables threat detection for networks and virtual machines, providing threat intelligence, anomaly detection, and behavior analytics in Azure Security Center\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Security/pricings\u0022},{\u0022field\u0022:\u0022Microsoft.Security/pricings/pricingTier\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Security/pricings/pricingTier\u0022,\u0022notEquals\u0022:\u0022Standard\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a1181c5f-672a-477a-979a-7d58aa086233\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a1181c5f-672a-477a-979a-7d58aa086233\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022All authorization rules except RootManageSharedAccessKey should be removed from Service Bus namespace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Service Bus clients should not use a namespace level access policy that provides access to all queues and topics in a namespace. To align with the least privilege security model, you should create access policies at the entity level for queues and topics to provide access to only the specific entity\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Service Bus\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ServiceBus/namespaces/authorizationRules\u0022},{\u0022field\u0022:\u0022name\u0022,\u0022notEquals\u0022:\u0022RootManageSharedAccessKey\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a1817ec0-a368-432a-8057-8371e17ac6ee\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a1817ec0-a368-432a-8057-8371e17ac6ee\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1265 - Contingency Plan Testing | Alternate Processing Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1265\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a18adb5b-1db6-4a5b-901a-7d3797d12972\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a18adb5b-1db6-4a5b-901a-7d3797d12972\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Logic Apps to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Logic Apps to stream to a regional Event Hub when any Logic Apps which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_eventHub\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022eventHubLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Location\u0022,\u0022description\u0022:\u0022The location the Event Hub resides in. Only Logic Apps in this location will be linked to this Event Hub.\u0022,\u0022strongType\u0022:\u0022location\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Logic/workflows\u0022},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Logic/workflows/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022WorkflowRuntime\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a1dae6c7-13f3-48ea-a149-ff8442661f60\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a1dae6c7-13f3-48ea-a149-ff8442661f60\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Administrative Templates - System\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Administrative Templates - System\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_AdministrativeTemplatesSystem\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a1e8dda3-9fd2-4835-aec3-0e55531fde33\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a1e8dda3-9fd2-4835-aec3-0e55531fde33\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1612 - Developer Security Architecture And Design\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1612\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a2037b3d-8b04-4171-8610-e6d4f1d08db5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a2037b3d-8b04-4171-8610-e6d4f1d08db5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1197 - Configuration Change Control | Test / Validate / Document Changes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1197\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a20d2eaa-88e2-4907-96a2-8f3a05797e5c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a20d2eaa-88e2-4907-96a2-8f3a05797e5c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1275 - Alternate Processing Site | Separation From Primary Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1275\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a23d9d53-ad2e-45ef-afd5-e6d10900a737\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a23d9d53-ad2e-45ef-afd5-e6d10900a737\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1690 - Information System Monitoring | System-Wide Intrusion Detection System\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1690\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a2567a23-d1c3-4783-99f3-d471302a4d6b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a2567a23-d1c3-4783-99f3-d471302a4d6b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1410 - Maintenance Tools | Prevent Unauthorized Removal\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1410\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a2596a9f-e59f-420d-9625-6e0b536348be\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a2596a9f-e59f-420d-9625-6e0b536348be\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1059 - Remote Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1059\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a29b5d9f-4953-4afe-b560-203a6410b6b4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a29b5d9f-4953-4afe-b560-203a6410b6b4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs that are not joined to the specified domain\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that are not joined to the specified domain. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsDomainMembership\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a29ee95c-0395-4515-9851-cc04ffe82a91\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a29ee95c-0395-4515-9851-cc04ffe82a91\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1532 - Third-Party Personnel Security\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1532\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a2c66299-9017-4d95-8040-8bdbf7901d52\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a2c66299-9017-4d95-8040-8bdbf7901d52\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1664 - Protection Of Information At Rest | Cryptographic Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1664\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a2cdf6b8-9505-4619-b579-309ba72037ac\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a2cdf6b8-9505-4619-b579-309ba72037ac\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1252 - Contingency Plan | Capacity Planning\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1252\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a328fd72-8ff5-4f96-8c9c-b30ed95db4ab\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a328fd72-8ff5-4f96-8c9c-b30ed95db4ab\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1238 - User-Installed Software\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1238\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a36cedd4-3ffd-4b1f-8b18-aa71d8d87ce1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a36cedd4-3ffd-4b1f-8b18-aa71d8d87ce1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1693 - Information System Monitoring | System-Generated Alerts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1693\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a450eba6-2efc-4a00-846a-5804a93c6b77\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a450eba6-2efc-4a00-846a-5804a93c6b77\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit usage of custom RBAC rules\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Audit built-in roles such as \u0027Owner, Contributer, Reader\u0027 instead of custom RBAC roles, which are error prone. Using custom roles is treated as an exception and requires a rigorous review and threat modeling\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022General\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Authorization/roleDefinitions\u0022},{\u0022field\u0022:\u0022Microsoft.Authorization/roleDefinitions/type\u0022,\u0022equals\u0022:\u0022CustomRole\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a451c1ef-c6ca-483d-87ed-f49761e3ffb5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a451c1ef-c6ca-483d-87ed-f49761e3ffb5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Web Application should only be accessible over HTTPS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/httpsOnly\u0022,\u0022equals\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a4af4a39-4135-47fb-b175-47fbdf85311d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1617 - Application Partitioning\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1617\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a631d8f5-eb81-4f9d-9ee1-74431371e4a3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a631d8f5-eb81-4f9d-9ee1-74431371e4a3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Auditing on SQL server should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Auditing on your SQL Server should be enabled to track database activities across all databases on the server and save them in an audit log.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022setting\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Desired Auditing setting\u0022},\u0022allowedValues\u0022:[\u0022enabled\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enabled\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/auditingSettings\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/auditingSettings.state\u0022,\u0022equals\u0022:\u0022[parameters(\u0027setting\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022The Log Analytics agent should be installed on virtual machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Windows/Linux virtual machines if the Log Analytics agent is not installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022in\u0022:[\u0022MicrosoftMonitoringAgent\u0022,\u0022OmsAgentForLinux\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/settings.workspaceId\u0022,\u0022exists\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a70ca396-0a34-413a-88e1-b956c1e683be\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a70ca396-0a34-413a-88e1-b956c1e683be\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1431 - Media Storage\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1431\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a7173c52-2b99-4696-a576-63dd5f970ef4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a7173c52-2b99-4696-a576-63dd5f970ef4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1644 - Cryptographic Key Establishment And Management | Availability\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1644\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a7211477-c970-446b-b4af-062f37461147\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a7211477-c970-446b-b4af-062f37461147\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1027 - Access Enforcement\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1027\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a76ca9b0-3f4a-4192-9a38-b25e4f8ae48c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a76ca9b0-3f4a-4192-9a38-b25e4f8ae48c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022DDoS Protection Standard should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022DDoS protection standard should be enabled for all virtual networks with a subnet that is part of an application gateway with a public IP.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.network/virtualNetworks\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022EnableDDoSProtection\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a7aca53f-2ed4-4466-a25e-0b45ade68efd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1570 - Acquisition Process\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1570\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a7fcf38d-bb09-4600-be7d-825046eb162a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a7fcf38d-bb09-4600-be7d-825046eb162a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Require encryption on Data Lake Store accounts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy ensures encryption is enabled on all Data Lake Store accounts\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Data Lake\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DataLakeStore/accounts\u0022},{\u0022field\u0022:\u0022Microsoft.DataLakeStore/accounts/encryptionState\u0022,\u0022equals\u0022:\u0022Disabled\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a7ff3161-0087-490a-9ad9-ad6217f4f43a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1295 - Information System Recovery And Reconstitution\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1295\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a895fbdb-204d-4302-9689-0a59dc42b3d9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a895fbdb-204d-4302-9689-0a59dc42b3d9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Monitor unencrypted SQL databases in Azure Security Center\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Unencrypted SQL databases will be monitored by Azure Security Center as recommendations. This policy is deprecated and replaced by the following policy: Transparent Data Encryption on SQL databases should be enabled\u0027\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.SQL/servers/databases\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022encryption\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a8bef009-a5c9-4d0f-90d7-6018734e8a16\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1283 - Telecommunications Services | Separation Of Primary / Alternate Providers\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1283\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a9172e76-7f56-46e9-93bf-75d69bdb5491\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a9172e76-7f56-46e9-93bf-75d69bdb5491\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1400 - Controlled Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1400\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a96d5098-a604-4cdf-90b1-ef6449a27424\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a96d5098-a604-4cdf-90b1-ef6449a27424\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1118 - Audit Review, Analysis, And Reporting | Correlate Audit Repositories\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1118\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a96f743d-a195-420d-983a-08aa06bc441e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a96f743d-a195-420d-983a-08aa06bc441e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1199 - Configuration Change Control | Cryptography Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1199\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a9a08d1c-09b1-48f1-90ea-029bbdf7111e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a9a08d1c-09b1-48f1-90ea-029bbdf7111e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027System Audit Policies - Detailed Tracking\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Detailed Tracking\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesDetailedTracking\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a9a33475-481d-4b81-9116-0bf02ffe67e8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a9a33475-481d-4b81-9116-0bf02ffe67e8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy network watcher when virtual networks are created\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a network watcher resource in regions with virtual networks. You need to ensure existence of a resource group named networkWatcherRG, which will be used to deploy network watcher instances.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/virtualNetworks\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022DeployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Network/networkWatchers\u0022,\u0022resourceGroupName\u0022:\u0022networkWatcherRG\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022apiVersion\u0022:\u00222016-09-01\u0022,\u0022type\u0022:\u0022Microsoft.Network/networkWatchers\u0022,\u0022name\u0022:\u0022[concat(\u0027networkWatcher_\u0027, parameters(\u0027location\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022}]},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1511 - Personnel Screening\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1511\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a9eae324-d327-4539-9293-b48e122465f8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a9eae324-d327-4539-9293-b48e122465f8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022MFA should be enabled on accounts with owner permissions on your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with owner permissions to prevent a breach of accounts or resources.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022EnableMFAForOwnerPermissions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022aa633080-8b72-40c4-a2d7-d00c03e80bed\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that Register with Azure Active Directory is enabled on WEB App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.managedServiceIdentityId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/aa81768c-cb87-4ce2-bfaa-00baa10d760c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022aa81768c-cb87-4ce2-bfaa-00baa10d760c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1539 - Security Categorization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1539\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/aabb155f-e7a5-4896-a767-e918bfae2ee0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022aabb155f-e7a5-4896-a767-e918bfae2ee0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1006 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1006\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/aae8d54c-4bce-4c04-b3aa-5b65b67caac8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022aae8d54c-4bce-4c04-b3aa-5b65b67caac8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1461 - Monitoring Physical Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1461\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/aafef03e-fea8-470b-88fa-54bd1fcd7064\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022aafef03e-fea8-470b-88fa-54bd1fcd7064\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1073 - Access Control For Mobile Devices\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1073\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ab55cdb0-c7dd-4bd8-ae22-a7cea7594e9c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ab55cdb0-c7dd-4bd8-ae22-a7cea7594e9c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027PHP version\u0027 is the latest, if used as a part of the Function app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for Function apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022PHPLatestVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Latest PHP version\u0022,\u0022description\u0022:\u0022Latest supported PHP version for App Services\u0022},\u0022defaultValue\u0022:\u00227.3\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022notContains\u0022:\u0022PHP\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.phpVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022[concat(\u0027PHP|\u0027, parameters(\u0027PHPLatestVersion\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.phpVersion\u0022,\u0022equals\u0022:\u0022\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.linuxFxVersion\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.phpVersion\u0022,\u0022equals\u0022:\u0022[parameters(\u0027PHPLatestVersion\u0027)]\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ab965db2-d2bf-4b64-8b39-c38ec8179461\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ab965db2-d2bf-4b64-8b39-c38ec8179461\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Automatic provisioning of security monitoring agent\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Installs security agent on VMs for advanced security alerts and preventions in Azure Security Center. Applies only for subscriptions that use Azure Security Center.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022AuditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022securityAgent\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022abcc6037-1fc4-47f6-aac5-89706589be24\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1323 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1323\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/abe8f70b-680f-470c-9b86-a7edfb664ecc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022abe8f70b-680f-470c-9b86-a7edfb664ecc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Advanced data security should be enabled on your SQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit SQL servers without Advanced Data Security\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies\u0022,\u0022name\u0022:\u0022Default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies/state\u0022,\u0022equals\u0022:\u0022Enabled\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Advanced data security should be enabled on your SQL managed instances\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit SQL managed instances without Advanced Data Security\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/managedInstances\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/managedInstances/securityAlertPolicies\u0022,\u0022name\u0022:\u0022Default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/managedInstances/securityAlertPolicies/state\u0022,\u0022equals\u0022:\u0022Enabled\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Enable Azure Security Center on your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Identifies existing subscriptions that are not monitored by Azure Security Center (ASC).\\nSubscriptions not monitored by ASC will be registered to the free pricing tier.\\nSubscriptions already monitored by ASC (free or standard), will be considered compliant.\\nTo register newly created subscriptions, open the compliance tab, select the relevant non-compliant assignment and create a remediation task.\\nRepeat this step when you have one or more new subscriptions you want to monitor with Security Center.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/pricings\u0022,\u0022name\u0022:\u0022VirtualMachines\u0022,\u0022deploymentScope\u0022:\u0022subscription\u0022,\u0022existenceScope\u0022:\u0022subscription\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\u0022],\u0022existenceCondition\u0022:{\u0022anyof\u0022:[{\u0022field\u0022:\u0022microsoft.security/pricings/pricingTier\u0022,\u0022equals\u0022:\u0022standard\u0022},{\u0022field\u0022:\u0022microsoft.security/pricings/pricingTier\u0022,\u0022equals\u0022:\u0022free\u0022}]},\u0022deployment\u0022:{\u0022location\u0022:\u0022westeurope\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Security/pricings\u0022,\u0022apiVersion\u0022:\u00222018-06-01\u0022,\u0022name\u0022:\u0022VirtualMachines\u0022,\u0022properties\u0022:{\u0022pricingTier\u0022:\u0022free\u0022}}],\u0022outputs\u0022:{}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ac076320-ddcf-4066-b451-6154267e8ad2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ac076320-ddcf-4066-b451-6154267e8ad2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1056 - Session Termination | User-Initiated Logouts / Message Displays\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1056\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ac43352f-df83-4694-8738-cfce549fd08d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ac43352f-df83-4694-8738-cfce549fd08d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Role-Based Access Control (RBAC) should be used on Kubernetes Services\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022To provide granular filtering on the actions that users can perform, use Role-Based Access Control (RBAC) to manage permissions in Kubernetes Service Clusters and configure relevant authorization policies.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-preview\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/enableRBAC\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/enableRBAC\u0022,\u0022equals\u0022:\u0022false\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ac4a19c2-fa67-49b4-8ae5-0b2e78c49457\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allow resource creation if \u0027environment\u0027 tag value in allowed values\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Allows resource creation if the \u0027environment\u0027 tag is set to one of the following values: production, dev, test, staging\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Tags\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022tags[\u0027environment\u0027]\u0022,\u0022in\u0022:[\u0022production\u0022,\u0022dev\u0022,\u0022test\u0022,\u0022staging\u0022]}},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ac7e5fc0-c029-4b12-91d4-a8500ce697f9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1569 - Acquisition Process\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1569\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ad2f8e61-a564-4dfd-8eaa-816f5be8cb34\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ad2f8e61-a564-4dfd-8eaa-816f5be8cb34\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1454 - Physical Access Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1454\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ad58985d-ab32-4f99-8bd3-b7e134c90229\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ad58985d-ab32-4f99-8bd3-b7e134c90229\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1025 - Account Management | Account Monitoring / Atypical Usage\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1025\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/adfe020d-0a97-45f4-a39c-696ef99f3a95\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022adfe020d-0a97-45f4-a39c-696ef99f3a95\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1272 - Alternate Processing Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1272\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ae46cf7a-e3fd-427b-9b91-44bc78e2d9d8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ae46cf7a-e3fd-427b-9b91-44bc78e2d9d8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022SQL Server should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any SQL Server not configured to use a virtual network service endpoint.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/virtualNetworkRules\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/virtualNetworkRules/virtualNetworkSubnetId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ae5d2f14-d830-42b6-9899-df6cfe9c71a3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ae5d2f14-d830-42b6-9899-df6cfe9c71a3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1598 - Developer Configuration Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1598\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ae7e1f5e-2d63-4b38-91ef-bce14151cce3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ae7e1f5e-2d63-4b38-91ef-bce14151cce3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Email notifications to admins and subscription owners should be enabled in SQL managed instance advanced data security settings\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit that \u0027email notification to admins and subscription owners\u0027 is enabled in the SQL managed instance advanced threat protection settings. This ensures that any detections of anomalous activities on SQL managed instance are reported as soon as possible to the admins.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/managedInstances\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/managedInstances/securityAlertPolicies\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/managedInstances/securityAlertPolicies/emailAccountAdmins\u0022,\u0022equals\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/aeb23562-188d-47cb-80b8-551f16ef9fff\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022aeb23562-188d-47cb-80b8-551f16ef9fff\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1413 - Nonlocal Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1413\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/aeedddb6-6bc0-42d5-809b-80048033419d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022aeedddb6-6bc0-42d5-809b-80048033419d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1710 - Security Function Verification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1710\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/af2a93c8-e6dd-4c94-acdd-4a2eedfc478e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022af2a93c8-e6dd-4c94-acdd-4a2eedfc478e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Monitor missing Endpoint Protection in Azure Security Center\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Servers without an installed Endpoint Protection agent will be monitored by Azure Security Center as recommendations\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022endpointProtection\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022af6cd1bd-1635-48cb-bde7-5b15693900b9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Monitor unaudited SQL servers in Azure Security Center\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022SQL servers which don\u0027t have SQL auditing turned on will be monitored by Azure Security Center as recommendations. This policy is deprecated and replaced by the following policy: \u0027Auditing should be enabled on advanced data security settings on SQL Server\u0027\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.SQL/servers\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022auditing\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022af8051bf-258b-44e2-a2bf-165330459f9d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1645 - Cryptographic Key Establishment And Management | Symmetric Keys\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1645\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/afbd0baf-ff1a-4447-a86f-088a97347c0c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022afbd0baf-ff1a-4447-a86f-088a97347c0c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1725 - Error Handling\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1725\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/afc234b5-456b-4aa5-b3e2-ce89108124cc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022afc234b5-456b-4aa5-b3e2-ce89108124cc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Activity log should be retained for at least one year\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy audits the activity log if the retention is not set for 365 days or forever (retention days set to 0).\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/logProfiles\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/retentionPolicy.days\u0022,\u0022equals\u0022:\u0022365\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022}]}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b02aacc0-b073-424e-8298-42b22829ee0a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b02aacc0-b073-424e-8298-42b22829ee0a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1429 - Media Marking\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1429\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b07c9b24-729e-4e85-95fc-f224d2d08a80\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b07c9b24-729e-4e85-95fc-f224d2d08a80\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1711 - Security Function Verification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1711\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b083a535-a66a-41ec-ba7f-f9498bf67cde\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b083a535-a66a-41ec-ba7f-f9498bf67cde\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Just-In-Time network access control should be applied on virtual machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Possible network Just In Time (JIT) access will be monitored by Azure Security Center as recommendations\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022jitNetworkAccess\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b0f33259-77d7-4c9e-aac6-3aabcfae693c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1571 - Acquisition Process\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1571\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b11c985b-f2cd-4bd7-85f4-b52426edf905\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b11c985b-f2cd-4bd7-85f4-b52426edf905\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Linux VMs that do not have the passwd file permissions set to 0644\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that do not have the passwd file permissions set to 0644. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022PasswordPolicy_msid121\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b18175dd-c599-4c64-83ba-bb018a06d35b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b18175dd-c599-4c64-83ba-bb018a06d35b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1537 - Risk Assessment Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1537\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b19454ca-0d70-42c0-acf5-ea1c1e5726d1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b19454ca-0d70-42c0-acf5-ea1c1e5726d1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1091 - Security Awareness Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1091\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b23bd715-5d1c-4e5c-9759-9cbdf79ded9d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b23bd715-5d1c-4e5c-9759-9cbdf79ded9d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1078 - Use Of External Information Systems | Limits On Authorized Use\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1078\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b25faf85-8a16-4f28-8e15-d05c0072d64d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b25faf85-8a16-4f28-8e15-d05c0072d64d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1009 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1009\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b26f8610-e615-47c2-abd6-c00b2b0b503a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b26f8610-e615-47c2-abd6-c00b2b0b503a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022All authorization rules except RootManageSharedAccessKey should be removed from Event Hub namespace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Event Hub clients should not use a namespace level access policy that provides access to all queues and topics in a namespace. To align with the least privilege security model, you should create access policies at the entity level for queues and topics to provide access to only the specific entity\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Event Hub\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.EventHub/namespaces/authorizationRules\u0022},{\u0022field\u0022:\u0022name\u0022,\u0022notEquals\u0022:\u0022RootManageSharedAccessKey\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b278e460-7cfc-4451-8294-cccc40a940d7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b278e460-7cfc-4451-8294-cccc40a940d7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Inherit a tag from the subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Adds or replaces the specified tag and value from the containing subscription when any resource is created or updated. Existing resources can be remediated by triggering a remediation task.\u0022,\u0022metadata\u0022:{\u0022category\u0022:\u0022Tags\u0022,\u0022version\u0022:\u00221.0.0\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022notEquals\u0022:\u0022[subscription().tags[parameters(\u0027tagName\u0027)]]\u0022},{\u0022value\u0022:\u0022[subscription().tags[parameters(\u0027tagName\u0027)]]\u0022,\u0022notEquals\u0022:\u0022\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022modify\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022operations\u0022:[{\u0022operation\u0022:\u0022addOrReplace\u0022,\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[subscription().tags[parameters(\u0027tagName\u0027)]]\u0022}]}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b27a0cbd-a167-4dfa-ae64-4337be671140\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b27a0cbd-a167-4dfa-ae64-4337be671140\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1234 - Software Usage Restrictions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1234\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b293f881-361c-47ed-b997-bc4e2296bc0b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b293f881-361c-47ed-b997-bc4e2296bc0b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1107 - Content Of Audit Records\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1107\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b29ed931-8e21-4779-8458-27916122a904\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b29ed931-8e21-4779-8458-27916122a904\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows web servers that are not using secure communication protocols\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows web servers that are not using secure communication protocols (TLS 1.1 or TLS 1.2). It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022MinimumTLSVersion\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Minimum TLS version\u0022,\u0022description\u0022:\u0022The minimum TLS protocol version that should be enabled. Windows web servers with lower TLS versions will be marked as non-compliant.\u0022},\u0022allowedValues\u0022:[\u00221.1\u0022,\u00221.2\u0022],\u0022defaultValue\u0022:\u00221.1\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AuditSecureProtocol\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[SecureWebServer]s1;MinimumTLSVersion\u0027, \u0027=\u0027, parameters(\u0027MinimumTLSVersion\u0027)))]\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022value\u0022:\u0022[parameters(\u0027MinimumTLSVersion\u0027)]\u0022,\u0022equals\u0022:\u00221.1\u0022}]}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AuditSecureProtocol\u0022},\u0022MinimumTLSVersion\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MinimumTLSVersion\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MinimumTLSVersion\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[SecureWebServer]s1;MinimumTLSVersion\u0022,\u0022value\u0022:\u0022[parameters(\u0027MinimumTLSVersion\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[SecureWebServer]s1;MinimumTLSVersion\u0022,\u0022value\u0022:\u0022[parameters(\u0027MinimumTLSVersion\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b2fc8f91-866d-4434-9089-5ebfe38d6fd8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b2fc8f91-866d-4434-9089-5ebfe38d6fd8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027System Audit Policies - Logon-Logoff\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Logon-Logoff\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesLogonLogoff\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b3802d79-dd88-4bce-b81d-780218e48280\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b3802d79-dd88-4bce-b81d-780218e48280\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1041 - Least Privilege | Privilege Levels For Code Execution\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1041\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b3d8d15b-627a-4219-8c96-4d16f788888b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b3d8d15b-627a-4219-8c96-4d16f788888b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1380 - Incident Response Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1380\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b4319b7e-ea8d-42ff-8a67-ccd462972827\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b4319b7e-ea8d-42ff-8a67-ccd462972827\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Search services should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Search\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Search/searchServices\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b4330a05-a843-4bc8-bf9a-cacce50c67f4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b4330a05-a843-4bc8-bf9a-cacce50c67f4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1172 - Internal System Connections\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1172\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b43e946e-a4c8-4b92-8201-4a39331db43c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b43e946e-a4c8-4b92-8201-4a39331db43c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1672 - Flaw Remediation | Central Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1672\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b45fe972-904e-45a4-ac20-673ba027a301\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b45fe972-904e-45a4-ac20-673ba027a301\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1131 - Protection Of Audit Information\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1131\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b472a17e-c2bc-493f-b50b-42d55a346962\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b472a17e-c2bc-493f-b50b-42d55a346962\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Web Sockets state for an API App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within an API app must be carefully reviewed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022api\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022apiApp\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022DisableWebSockets\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b48334a4-911b-4084-b1ab-3e6a4e50b951\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b48334a4-911b-4084-b1ab-3e6a4e50b951\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022A security contact phone number should be provided for your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enter a phone number to receive notifications when Azure Security Center detects compromised resources\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/securityContacts\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/securityContacts/phone\u0022,\u0022notEquals\u0022:\u0022\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b4d66858-c922-44e3-9566-5cdb7a7be744\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b4d66858-c922-44e3-9566-5cdb7a7be744\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1286 - Telecommunications Services | Provider Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1286\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b4f9b47a-2116-4e6f-88db-4edbf22753f1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b4f9b47a-2116-4e6f-88db-4edbf22753f1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Public network access should be disabled for PostgreSQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits PostgreSQL servers in your environment with public network access enabled. For more details, visit https://go.microsoft.com/fwlink/?linkid=2120015.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/publicNetworkAccess\u0022,\u0022notEquals\u0022:\u0022Disabled\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b52376f7-9612-48a1-81cd-1ffe4b61032c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Service Fabric clusters should only use Azure Active Directory for client authentication\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit usage of client authentication only via Azure Active Directory in Service Fabric\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Service Fabric\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ServiceFabric/clusters\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.ServiceFabric/clusters/azureActiveDirectory.tenantId\u0022,\u0022equals\u0022:\u0022\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b54ed75b-3e1a-44ac-a333-05ba39b99ff0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Advanced Threat Protection for Cosmos DB Accounts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy enables Advanced Threat Protection across Cosmos DB accounts.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Cosmos DB\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DocumentDB/databaseAccounts\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/advancedThreatProtectionSettings\u0022,\u0022name\u0022:\u0022current\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/advancedThreatProtectionSettings/isEnabled\u0022,\u0022equals\u0022:\u0022true\u0022},\u0022roleDefinitionIds\u0022:[\u0022/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022cosmosDbAccountName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022apiVersion\u0022:\u00222019-01-01\u0022,\u0022type\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/providers/advancedThreatProtectionSettings\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027cosmosDbAccountName\u0027), \u0027/Microsoft.Security/current\u0027)]\u0022,\u0022properties\u0022:{\u0022isEnabled\u0022:true}}]},\u0022parameters\u0022:{\u0022cosmosDbAccountName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b5f04e03-92a3-4b09-9410-2cc5e5047656\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b5f04e03-92a3-4b09-9410-2cc5e5047656\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in App Services should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs on the app. This enables you to recreate activity trails for investigation purposes if a security incident occurs or your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022notContains\u0022:\u0022functionapp\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Web/sites/config/detailedErrorLoggingEnabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/httpLoggingEnabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/config/requestTracingEnabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b607c5de-e7d9-4eee-9e5c-83f1bcee4fa0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1419 - Nonlocal Maintenance | Cryptographic Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1419\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b6747bf9-2b97-45b8-b162-3c8becb9937d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b6747bf9-2b97-45b8-b162-3c8becb9937d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1301 - Identification And Authentication (Org. Users) | Network Access To Privileged Accounts\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1301\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b6a8e0cc-ac23-468b-abe4-a8a1cc6d7a08\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b6a8e0cc-ac23-468b-abe4-a8a1cc6d7a08\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1568 - Acquisition Process\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1568\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b6a8eae8-9854-495a-ac82-d2cd3eac02a6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b6a8eae8-9854-495a-ac82-d2cd3eac02a6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Network Watcher should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Network Watcher is a regional service that enables you to monitor and diagnose conditions at a network scenario level in, to, and from Azure. Scenario level monitoring enables you to diagnose problems at an end to end network level view. Network diagnostic and visualization tools available with Network Watcher help you understand, diagnose, and gain insights to your network in Azure.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022listOfLocations\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Locations\u0022,\u0022description\u0022:\u0022Audit if Network Watcher is not enabled for region(s).\u0022,\u0022strongType\u0022:\u0022location\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Network/networkWatchers\u0022,\u0022resourceGroupName\u0022:\u0022NetworkWatcherRG\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfLocations\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b6e2945c-0b7b-40f5-9233-7a5323b5cdc6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1608 - Supply Chain Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1608\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b73b7b3b-677c-4a2a-b949-ad4dc4acd89f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b73b7b3b-677c-4a2a-b949-ad4dc4acd89f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1401 - Controlled Maintenance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1401\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b78ee928-e3c1-4569-ad97-9f8c4b629847\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b78ee928-e3c1-4569-ad97-9f8c4b629847\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022API App should only be accessible over HTTPS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/httpsOnly\u0022,\u0022equals\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b7ddfbdc-1260-477d-91fd-98bd9be789a6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b7ddfbdc-1260-477d-91fd-98bd9be789a6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs in which the Administrators group does not contain only the specified members\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines in which the Administrators group does not contain only the specified members. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022Members\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Members\u0022,\u0022description\u0022:\u0022A semicolon-separated list of all the expected members of the Administrators local group. Ex: Administrator; myUser1; myUser2\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AdministratorsGroupMembers\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[LocalGroup]AdministratorsGroup;Members\u0027, \u0027=\u0027, parameters(\u0027Members\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AdministratorsGroupMembers\u0022},\u0022Members\u0022:{\u0022value\u0022:\u0022[parameters(\u0027Members\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022Members\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[LocalGroup]AdministratorsGroup;Members\u0022,\u0022value\u0022:\u0022[parameters(\u0027Members\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[LocalGroup]AdministratorsGroup;Members\u0022,\u0022value\u0022:\u0022[parameters(\u0027Members\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b821191b-3a12-44bc-9c38-212138a29ff3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b821191b-3a12-44bc-9c38-212138a29ff3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Accounts\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Accounts\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsAccounts\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b872a447-cc6f-43b9-bccf-45703cd81607\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b872a447-cc6f-43b9-bccf-45703cd81607\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Logic Apps to Log Analytics workspace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Logic Apps to stream to a regional Log Analytics workspace when any Logic Apps which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Logic/workflows\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Logic/workflows/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022WorkflowRuntime\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b889a06c-ec72-4b03-910a-cb169ee18721\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b889a06c-ec72-4b03-910a-cb169ee18721\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022An activity log alert should exist for specific Administrative operations\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy audits specific Administrative operations with no activity log alerts configured.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022operationName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Operation Name\u0022,\u0022description\u0022:\u0022Administrative Operation name for which activity log alert should be configured\u0022},\u0022allowedValues\u0022:[\u0022Microsoft.Sql/servers/firewallRules/write\u0022,\u0022Microsoft.Sql/servers/firewallRules/delete\u0022,\u0022Microsoft.Network/networkSecurityGroups/write\u0022,\u0022Microsoft.Network/networkSecurityGroups/delete\u0022,\u0022Microsoft.ClassicNetwork/networkSecurityGroups/write\u0022,\u0022Microsoft.ClassicNetwork/networkSecurityGroups/delete\u0022,\u0022Microsoft.Network/networkSecurityGroups/securityRules/write\u0022,\u0022Microsoft.Network/networkSecurityGroups/securityRules/delete\u0022,\u0022Microsoft.ClassicNetwork/networkSecurityGroups/securityRules/write\u0022,\u0022Microsoft.ClassicNetwork/networkSecurityGroups/securityRules/delete\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/ActivityLogAlerts\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022category\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\u0022,\u0022equals\u0022:\u0022Administrative\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022operationName\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\u0022,\u0022equals\u0022:\u0022[parameters(\u0027operationName\u0027)]\u0022}]}]}},\u0022equals\u0022:2},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022category\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022operationName\u0022}}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b954148f-4c11-4c38-8221-be76711e194a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b954148f-4c11-4c38-8221-be76711e194a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1257 - Contingency Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1257\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b958b241-4245-4bd6-bd2d-b8f0779fb543\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b958b241-4245-4bd6-bd2d-b8f0779fb543\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1186 - Configuration Change Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1186\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b95ba3bd-4ded-49ea-9d10-c6f4b680813d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b95ba3bd-4ded-49ea-9d10-c6f4b680813d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1447 - Physical Access Authorizations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1447\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b9783a99-98fe-4a95-873f-29613309fe9a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b9783a99-98fe-4a95-873f-29613309fe9a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1625 - Boundary Protection | Access Points\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1625\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b9b66a4d-70a1-4b47-8fa1-289cec68c605\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b9b66a4d-70a1-4b47-8fa1-289cec68c605\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1610 - Development Process, Standards, And Tools\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1610\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b9f3fb54-4222-46a1-a308-4874061f8491\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b9f3fb54-4222-46a1-a308-4874061f8491\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Recovery console\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Recovery console\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsRecoveryconsole\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ba12366f-f9a6-42b8-9d98-157d0b1a837b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ba12366f-f9a6-42b8-9d98-157d0b1a837b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1606 - Developer Security Testing And Evaluation | Threat And Vulnerability Analyses\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1606\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/baa8a9a4-5bbe-4c72-98f6-a3a47ae2b1ca\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022baa8a9a4-5bbe-4c72-98f6-a3a47ae2b1ca\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1726 - Information Handling And Retention\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1726\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/baff1279-05e0-4463-9a70-8ba5de4c7aa4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022baff1279-05e0-4463-9a70-8ba5de4c7aa4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1166 - Continuous Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1166\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bb02733d-3cc5-4bb0-a6cd-695ba2c2272e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bb02733d-3cc5-4bb0-a6cd-695ba2c2272e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1188 - Configuration Change Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1188\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bb20548a-c926-4e4d-855c-bcddc6faf95e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bb20548a-c926-4e4d-855c-bcddc6faf95e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1533 - Third-Party Personnel Security\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1533\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bba2a036-fb3b-4261-b1be-a13dfb5fbcaa\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bba2a036-fb3b-4261-b1be-a13dfb5fbcaa\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Microsoft Network Client\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Microsoft Network Client\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022MicrosoftNetworkClientDigitallySignCommunicationsAlways\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Microsoft network client: Digitally sign communications (always)\u0022,\u0022description\u0022:\u0022Specifies whether packet signing is required by the SMB client component.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Microsoft network client: Send unencrypted password to third-party SMB servers\u0022,\u0022description\u0022:\u0022Specifies whether the SMB redirector will send plaintext passwords during authentication to third-party SMB servers that do not support password encryption. It is recommended that you disable this policy setting unless there is a strong business case to enable it.\u0022},\u0022defaultValue\u0022:\u00220\u0022},\u0022MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Microsoft network server: Amount of idle time required before suspending session\u0022,\u0022description\u0022:\u0022Specifies the amount of continuous idle time that must pass in an SMB session before the session is suspended because of inactivity. The format of the value is two integers separated by a comma, denoting an inclusive range.\u0022},\u0022defaultValue\u0022:\u00221,15\u0022},\u0022MicrosoftNetworkServerDigitallySignCommunicationsAlways\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Microsoft network server: Digitally sign communications (always)\u0022,\u0022description\u0022:\u0022Specifies whether packet signing is required by the SMB server component.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Microsoft network server: Disconnect clients when logon hours expire\u0022,\u0022description\u0022:\u0022Specifies whether to disconnect users who are connected to the local computer outside their user account\u0027s valid logon hours. This setting affects the Server Message Block (SMB) component. If you enable this policy setting you should also enable \u0027Network security: Force logoff when logon hours expire\u0027\u0022},\u0022defaultValue\u0022:\u00221\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsMicrosoftNetworkClient\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Microsoft network client: Digitally sign communications (always);ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027MicrosoftNetworkClientDigitallySignCommunicationsAlways\u0027), \u0027,\u0027, \u0027Microsoft network client: Send unencrypted password to third-party SMB servers;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers\u0027), \u0027,\u0027, \u0027Microsoft network server: Amount of idle time required before suspending session;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession\u0027), \u0027,\u0027, \u0027Microsoft network server: Digitally sign communications (always);ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027MicrosoftNetworkServerDigitallySignCommunicationsAlways\u0027), \u0027,\u0027, \u0027Microsoft network server: Disconnect clients when logon hours expire;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsMicrosoftNetworkClient\u0022},\u0022MicrosoftNetworkClientDigitallySignCommunicationsAlways\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkClientDigitallySignCommunicationsAlways\u0027)]\u0022},\u0022MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers\u0027)]\u0022},\u0022MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession\u0027)]\u0022},\u0022MicrosoftNetworkServerDigitallySignCommunicationsAlways\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkServerDigitallySignCommunicationsAlways\u0027)]\u0022},\u0022MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MicrosoftNetworkClientDigitallySignCommunicationsAlways\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MicrosoftNetworkServerDigitallySignCommunicationsAlways\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Microsoft network client: Digitally sign communications (always);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkClientDigitallySignCommunicationsAlways\u0027)]\u0022},{\u0022name\u0022:\u0022Microsoft network client: Send unencrypted password to third-party SMB servers;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers\u0027)]\u0022},{\u0022name\u0022:\u0022Microsoft network server: Amount of idle time required before suspending session;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession\u0027)]\u0022},{\u0022name\u0022:\u0022Microsoft network server: Digitally sign communications (always);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkServerDigitallySignCommunicationsAlways\u0027)]\u0022},{\u0022name\u0022:\u0022Microsoft network server: Disconnect clients when logon hours expire;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Microsoft network client: Digitally sign communications (always);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkClientDigitallySignCommunicationsAlways\u0027)]\u0022},{\u0022name\u0022:\u0022Microsoft network client: Send unencrypted password to third-party SMB servers;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkClientSendUnencryptedPasswordToThirdpartySMBServers\u0027)]\u0022},{\u0022name\u0022:\u0022Microsoft network server: Amount of idle time required before suspending session;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkServerAmountOfIdleTimeRequiredBeforeSuspendingSession\u0027)]\u0022},{\u0022name\u0022:\u0022Microsoft network server: Digitally sign communications (always);ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkServerDigitallySignCommunicationsAlways\u0027)]\u0022},{\u0022name\u0022:\u0022Microsoft network server: Disconnect clients when logon hours expire;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MicrosoftNetworkServerDisconnectClientsWhenLogonHoursExpire\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bbcdd8fa-b600-4ee3-85b8-d184e3339652\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bbcdd8fa-b600-4ee3-85b8-d184e3339652\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit API Applications that are not using latest supported Python Framework\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use the latest supported Python version for the latest security classes. Using older classes and types can make your application vulnerable.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022api\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022apiApp\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UseLatestPython\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bc0378bb-d7ab-4614-a0f6-5a6e3f02d644\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bc0378bb-d7ab-4614-a0f6-5a6e3f02d644\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1194 - Configuration Change Control | Automated Document / Notification / Prohibition Of Changes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1194\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bc34667f-397e-4a65-9b72-d0358f0b6b09\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bc34667f-397e-4a65-9b72-d0358f0b6b09\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1095 - Role-Based Security Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1095\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bc3f6f7a-057b-433e-9834-e8c97b0194f6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bc3f6f7a-057b-433e-9834-e8c97b0194f6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027System Audit Policies - Account Logon\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Account Logon\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesAccountLogon\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bc87d811-4a9b-47cc-ae54-0a41abda7768\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bc87d811-4a9b-47cc-ae54-0a41abda7768\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1427 - Media Protection Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1427\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bc90e44f-d83f-4bdf-900f-3d5eb4111b31\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bc90e44f-d83f-4bdf-900f-3d5eb4111b31\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1351 - Incident Response Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1351\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bcfb6683-05e5-4ce6-9723-c3fbe9896bdd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bcfb6683-05e5-4ce6-9723-c3fbe9896bdd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1050 - Concurrent Session Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1050\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bd20184c-b4ec-4ce5-8db6-6e86352d183f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bd20184c-b4ec-4ce5-8db6-6e86352d183f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: IP Forwarding on your virtual machine should be disabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enabling IP forwarding on a virtual machine\u0027s NIC allows the machine to receive traffic addressed to other destinations. IP forwarding is rarely required (e.g., when using the VM as a network virtual appliance), and therefore, this should be reviewed by the network security team.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022disableIPForwarding\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022Monitored\u0022,\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bd352bd5-2853-4985-bf0d-73806b4a5744\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Advanced Threat Protection types should be set to \u0027All\u0027 in SQL managed instance Advanced Data Security settings\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/managedInstances\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/managedInstances/securityAlertPolicies\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/managedInstances/securityAlertPolicies/disabledAlerts[*]\u0022,\u0022equals\u0022:\u0022\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bda18df3-5e41-4709-add9-2554ce68c966\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bda18df3-5e41-4709-add9-2554ce68c966\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs in which the Administrators group contains any of the specified members\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines in which the Administrators group contains any of the specified members. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AdministratorsGroupMembersToExclude\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bde62c94-ccca-4821-a815-92c1d31a76de\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bde62c94-ccca-4821-a815-92c1d31a76de\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Web Applications that are not using latest supported Java Framework\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use the latest supported Java version for the latest security classes. Using older classes and types can make your application vulnerable.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022WebApp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UseLatestJava\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/be0a7681-bed4-48dc-9ff3-f0171ee170b6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022be0a7681-bed4-48dc-9ff3-f0171ee170b6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1360 - Incident Handling\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1360\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/be5b05e7-0b82-4ebc-9eda-25e447b1a41e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022be5b05e7-0b82-4ebc-9eda-25e447b1a41e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Windows VMs on which Windows Defender Exploit Guard is not enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Windows Defender Exploit Guard helps protect against malware that uses exploits to infect devices and spread. Exploit Guard protection consists of a number of mitigations that can be applied to either the operating system or individual apps. This policy requires the Azure Policy for Windows extension. For details, visit https://aks.ms/gcpol.\u0022,\u0022metadata\u0022:{\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022preview\u0022:true,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022WindowsDefenderExploitGuard\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:{\u0022NotAvailableMachineState\u0022:\u0022[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState\u0022}}},\u0022parameters\u0022:{\u0022NotAvailableMachineState\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Status if Windows Defender is not available on machine\u0022,\u0022description\u0022:\u0022Windows Defender Exploit Guard is only available starting with Windows 10/Windows Server with update 1709. Setting this value to \u0027Non-Compliant\u0027 shows machines with older versions on which Windows Defender Exploit Guard is not available (such as Windows Server 2012 R2) as non-compliant. Setting this value to \u0027Compliant\u0027 shows these machines as compliant.\u0022},\u0022allowedValues\u0022:[\u0022Compliant\u0022,\u0022Non-Compliant\u0022],\u0022defaultValue\u0022:\u0022Non-Compliant\u0022},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of this policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsDefenderExploitGuard\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022},{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[WindowsDefenderExploitGuard]WindowsDefenderExploitGuard1;NotAvailableMachineState\u0027, \u0027=\u0027, parameters(\u0027NotAvailableMachineState\u0027)))]\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bed48b13-6647-468e-aa2f-1af1d3f4dd40\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bed48b13-6647-468e-aa2f-1af1d3f4dd40\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Key Vault to Log Analytics workspace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Key Vault to stream to a regional Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.KeyVault/vaults\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.KeyVault/vaults/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022AuditEvent\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bef3f64c-5290-43b7-85b0-9b254eef4c47\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bef3f64c-5290-43b7-85b0-9b254eef4c47\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1152 - System Interconnections\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1152\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/beff0acf-7e67-40b2-b1ca-1a0e8205cf1b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022beff0acf-7e67-40b2-b1ca-1a0e8205cf1b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Geo-redundant storage should be enabled for Storage Accounts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Storage Account with geo-redundant storage not enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Storage\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Storage/storageAccounts\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/sku.name\u0022,\u0022in\u0022:[\u0022Standard_GRS\u0022,\u0022Standard_RAGRS\u0022,\u0022Standard_GZRS\u0022,\u0022Standard_RAGZRS\u0022]}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bf045164-79ba-4215-8f95-f8048dc1780b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bf045164-79ba-4215-8f95-f8048dc1780b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1590 - External Information System Services | Risk Assessments / Organizational Approvals\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1590\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bf296b8c-f391-4ea4-9198-be3c9d39dd1f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bf296b8c-f391-4ea4-9198-be3c9d39dd1f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1446 - Physical And Environmental Protection Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1446\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bf6850fe-abba-468e-9ef4-d09ec7d983cd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bf6850fe-abba-468e-9ef4-d09ec7d983cd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027System Audit Policies - Logon-Logoff\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Logon-Logoff\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022AuditGroupMembership\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Group Membership\u0022,\u0022description\u0022:\u0022Specifies whether audit events are generated when group memberships are enumerated on the client computer.\u0022},\u0022allowedValues\u0022:[\u0022No Auditing\u0022,\u0022Success\u0022,\u0022Failure\u0022,\u0022Success and Failure\u0022],\u0022defaultValue\u0022:\u0022Success\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesLogonLogoff\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Audit Group Membership;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditGroupMembership\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SystemAuditPoliciesLogonLogoff\u0022},\u0022AuditGroupMembership\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditGroupMembership\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditGroupMembership\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Group Membership;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditGroupMembership\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Group Membership;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditGroupMembership\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c04255ee-1b9f-42c1-abaa-bf1553f79930\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c04255ee-1b9f-42c1-abaa-bf1553f79930\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Only approved VM extensions should be installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy governs the virtual machine extensions that are not approved.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022},\u0022approvedExtensions\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022The list of approved extension types that can be installed. Example: AzureDiskEncryption\u0022,\u0022displayName\u0022:\u0022Approved extensions\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027approvedExtensions\u0027)]\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c0e996f8-39cf-4af9-9f45-83fbde810432\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c0e996f8-39cf-4af9-9f45-83fbde810432\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1124 - Audit Reduction And Report Generation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1124\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c10152dd-78f8-4335-ae2d-ad92cc028da4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c10152dd-78f8-4335-ae2d-ad92cc028da4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1676 - Malicious Code Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1676\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c10fb58b-56a8-489e-9ce3-7ffe24e78e4b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c10fb58b-56a8-489e-9ce3-7ffe24e78e4b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1719 - Spam Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1719\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c13da9b4-fe14-4fe2-853a-5997c9d4215a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c13da9b4-fe14-4fe2-853a-5997c9d4215a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1226 - Information System Component Inventory | Automated Unauthorized Component Detection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1226\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c158eb1c-ae7e-4081-8057-d527140c4e0c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c158eb1c-ae7e-4081-8057-d527140c4e0c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy associations for a custom provider\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys an association resource that associates selected resource types to the specified custom provider. This policy deployment does not support nested resource types.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Custom Provider\u0022},\u0022parameters\u0022:{\u0022targetCustomProviderId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Custom provider ID\u0022,\u0022description\u0022:\u0022Resource ID of the Custom provider to which resources need to be associated.\u0022}},\u0022resourceTypesToAssociate\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource types to associate\u0022,\u0022description\u0022:\u0022The list of resource types to be associated to the custom provider.\u0022,\u0022strongType\u0022:\u0022resourceTypes\u0022}},\u0022associationNamePrefix\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Association name prefix\u0022,\u0022description\u0022:\u0022Prefix to be added to the name of the association resource being created.\u0022},\u0022defaultValue\u0022:\u0022DeployedByPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:\u0022[parameters(\u0027resourceTypesToAssociate\u0027)]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.CustomProviders/Associations\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027associationNamePrefix\u0027), \u0027-\u0027, uniqueString(parameters(\u0027targetCustomProviderId\u0027)))]\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022associatedResourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022resourceTypesToAssociate\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022targetCustomProviderId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022associationNamePrefix\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022resourceType\u0022:\u0022[concat(parameters(\u0027resourceTypesToAssociate\u0027), \u0027/providers/associations\u0027)]\u0022,\u0022resourceName\u0022:\u0022[concat(parameters(\u0027associatedResourceName\u0027), \u0027/microsoft.customproviders/\u0027, parameters(\u0027associationNamePrefix\u0027), \u0027-\u0027, uniqueString(parameters(\u0027targetCustomProviderId\u0027)))]\u0022},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Resources/deployments\u0022,\u0022apiVersion\u0022:\u00222017-05-10\u0022,\u0022name\u0022:\u0022[concat(deployment().Name, \u0027-2\u0027)]\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022Incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022resources\u0022:[{\u0022type\u0022:\u0022[variables(\u0027resourceType\u0027)]\u0022,\u0022name\u0022:\u0022[variables(\u0027resourceName\u0027)]\u0022,\u0022apiVersion\u0022:\u00222018-09-01-preview\u0022,\u0022properties\u0022:{\u0022targetResourceId\u0022:\u0022[parameters(\u0027targetCustomProviderId\u0027)]\u0022}}]}}}]},\u0022parameters\u0022:{\u0022resourceTypesToAssociate\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022associatedResourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022targetCustomProviderId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027targetCustomProviderId\u0027)]\u0022},\u0022associationNamePrefix\u0022:{\u0022value\u0022:\u0022[parameters(\u0027associationNamePrefix\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c15c281f-ea5c-44cd-90b8-fc3c14d13f0c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c15c281f-ea5c-44cd-90b8-fc3c14d13f0c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1629 - Boundary Protection | External Telecommunications Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1629\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c171b095-7756-41de-8644-a062a96043f2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c171b095-7756-41de-8644-a062a96043f2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1004 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1004\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c17822dc-736f-4eb4-a97d-e6be662ff835\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c17822dc-736f-4eb4-a97d-e6be662ff835\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allow resource creation only in Asia data centers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Allows resource creation in the following locations only: East Asia, Southeast Asia, West India, South India, Central India, Japan East, Japan West\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022General\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022in\u0022:[\u0022eastasia\u0022,\u0022southeastasia\u0022,\u0022westindia\u0022,\u0022southindia\u0022,\u0022centralindia\u0022,\u0022japaneast\u0022,\u0022japanwest\u0022]}},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027System Audit Policies - Account Logon\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Account Logon\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022AuditCredentialValidation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Credential Validation\u0022,\u0022description\u0022:\u0022Specifies whether audit events are generated when credentials are submitted for a user account logon request.  This setting is especially useful for monitoring unsuccessful attempts, to find brute-force attacks, account enumeration, and potential account compromise events on domain controllers.\u0022},\u0022allowedValues\u0022:[\u0022No Auditing\u0022,\u0022Success\u0022,\u0022Failure\u0022,\u0022Success and Failure\u0022],\u0022defaultValue\u0022:\u0022Success and Failure\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesAccountLogon\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Audit Credential Validation;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditCredentialValidation\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SystemAuditPoliciesAccountLogon\u0022},\u0022AuditCredentialValidation\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditCredentialValidation\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditCredentialValidation\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Credential Validation;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditCredentialValidation\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Credential Validation;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditCredentialValidation\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c1e289c0-ffad-475d-a924-adc058765d65\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c1e289c0-ffad-475d-a924-adc058765d65\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1503 - Information Security Architecture\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1503\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c1fa9c2f-d439-4ab9-8b83-81fb1934f81d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c1fa9c2f-d439-4ab9-8b83-81fb1934f81d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs that are not set to the specified time zone\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that are not set to the specified time zone. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022TimeZone\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Time zone\u0022,\u0022description\u0022:\u0022The expected time zone\u0022},\u0022allowedValues\u0022:[\u0022(UTC-12:00) International Date Line West\u0022,\u0022(UTC-11:00) Coordinated Universal Time-11\u0022,\u0022(UTC-10:00) Aleutian Islands\u0022,\u0022(UTC-10:00) Hawaii\u0022,\u0022(UTC-09:30) Marquesas Islands\u0022,\u0022(UTC-09:00) Alaska\u0022,\u0022(UTC-09:00) Coordinated Universal Time-09\u0022,\u0022(UTC-08:00) Baja California\u0022,\u0022(UTC-08:00) Coordinated Universal Time-08\u0022,\u0022(UTC-08:00) Pacific Time (US \u0026 Canada)\u0022,\u0022(UTC-07:00) Arizona\u0022,\u0022(UTC-07:00) Chihuahua, La Paz, Mazatlan\u0022,\u0022(UTC-07:00) Mountain Time (US \u0026 Canada)\u0022,\u0022(UTC-06:00) Central America\u0022,\u0022(UTC-06:00) Central Time (US \u0026 Canada)\u0022,\u0022(UTC-06:00) Easter Island\u0022,\u0022(UTC-06:00) Guadalajara, Mexico City, Monterrey\u0022,\u0022(UTC-06:00) Saskatchewan\u0022,\u0022(UTC-05:00) Bogota, Lima, Quito, Rio Branco\u0022,\u0022(UTC-05:00) Chetumal\u0022,\u0022(UTC-05:00) Eastern Time (US \u0026 Canada)\u0022,\u0022(UTC-05:00) Haiti\u0022,\u0022(UTC-05:00) Havana\u0022,\u0022(UTC-05:00) Indiana (East)\u0022,\u0022(UTC-05:00) Turks and Caicos\u0022,\u0022(UTC-04:00) Asuncion\u0022,\u0022(UTC-04:00) Atlantic Time (Canada)\u0022,\u0022(UTC-04:00) Caracas\u0022,\u0022(UTC-04:00) Cuiaba\u0022,\u0022(UTC-04:00) Georgetown, La Paz, Manaus, San Juan\u0022,\u0022(UTC-04:00) Santiago\u0022,\u0022(UTC-03:30) Newfoundland\u0022,\u0022(UTC-03:00) Araguaina\u0022,\u0022(UTC-03:00) Brasilia\u0022,\u0022(UTC-03:00) Cayenne, Fortaleza\u0022,\u0022(UTC-03:00) City of Buenos Aires\u0022,\u0022(UTC-03:00) Greenland\u0022,\u0022(UTC-03:00) Montevideo\u0022,\u0022(UTC-03:00) Punta Arenas\u0022,\u0022(UTC-03:00) Saint Pierre and Miquelon\u0022,\u0022(UTC-03:00) Salvador\u0022,\u0022(UTC-02:00) Coordinated Universal Time-02\u0022,\u0022(UTC-02:00) Mid-Atlantic - Old\u0022,\u0022(UTC-01:00) Azores\u0022,\u0022(UTC-01:00) Cabo Verde Is.\u0022,\u0022(UTC) Coordinated Universal Time\u0022,\u0022(UTC\u002B00:00) Dublin, Edinburgh, Lisbon, London\u0022,\u0022(UTC\u002B00:00) Monrovia, Reykjavik\u0022,\u0022(UTC\u002B00:00) Sao Tome\u0022,\u0022(UTC\u002B01:00) Casablanca\u0022,\u0022(UTC\u002B01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna\u0022,\u0022(UTC\u002B01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague\u0022,\u0022(UTC\u002B01:00) Brussels, Copenhagen, Madrid, Paris\u0022,\u0022(UTC\u002B01:00) Sarajevo, Skopje, Warsaw, Zagreb\u0022,\u0022(UTC\u002B01:00) West Central Africa\u0022,\u0022(UTC\u002B02:00) Amman\u0022,\u0022(UTC\u002B02:00) Athens, Bucharest\u0022,\u0022(UTC\u002B02:00) Beirut\u0022,\u0022(UTC\u002B02:00) Cairo\u0022,\u0022(UTC\u002B02:00) Chisinau\u0022,\u0022(UTC\u002B02:00) Damascus\u0022,\u0022(UTC\u002B02:00) Gaza, Hebron\u0022,\u0022(UTC\u002B02:00) Harare, Pretoria\u0022,\u0022(UTC\u002B02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius\u0022,\u0022(UTC\u002B02:00) Jerusalem\u0022,\u0022(UTC\u002B02:00) Kaliningrad\u0022,\u0022(UTC\u002B02:00) Khartoum\u0022,\u0022(UTC\u002B02:00) Tripoli\u0022,\u0022(UTC\u002B02:00) Windhoek\u0022,\u0022(UTC\u002B03:00) Baghdad\u0022,\u0022(UTC\u002B03:00) Istanbul\u0022,\u0022(UTC\u002B03:00) Kuwait, Riyadh\u0022,\u0022(UTC\u002B03:00) Minsk\u0022,\u0022(UTC\u002B03:00) Moscow, St. Petersburg\u0022,\u0022(UTC\u002B03:00) Nairobi\u0022,\u0022(UTC\u002B03:30) Tehran\u0022,\u0022(UTC\u002B04:00) Abu Dhabi, Muscat\u0022,\u0022(UTC\u002B04:00) Astrakhan, Ulyanovsk\u0022,\u0022(UTC\u002B04:00) Baku\u0022,\u0022(UTC\u002B04:00) Izhevsk, Samara\u0022,\u0022(UTC\u002B04:00) Port Louis\u0022,\u0022(UTC\u002B04:00) Saratov\u0022,\u0022(UTC\u002B04:00) Tbilisi\u0022,\u0022(UTC\u002B04:00) Volgograd\u0022,\u0022(UTC\u002B04:00) Yerevan\u0022,\u0022(UTC\u002B04:30) Kabul\u0022,\u0022(UTC\u002B05:00) Ashgabat, Tashkent\u0022,\u0022(UTC\u002B05:00) Ekaterinburg\u0022,\u0022(UTC\u002B05:00) Islamabad, Karachi\u0022,\u0022(UTC\u002B05:00) Qyzylorda\u0022,\u0022(UTC\u002B05:30) Chennai, Kolkata, Mumbai, New Delhi\u0022,\u0022(UTC\u002B05:30) Sri Jayawardenepura\u0022,\u0022(UTC\u002B05:45) Kathmandu\u0022,\u0022(UTC\u002B06:00) Astana\u0022,\u0022(UTC\u002B06:00) Dhaka\u0022,\u0022(UTC\u002B06:00) Omsk\u0022,\u0022(UTC\u002B06:30) Yangon (Rangoon)\u0022,\u0022(UTC\u002B07:00) Bangkok, Hanoi, Jakarta\u0022,\u0022(UTC\u002B07:00) Barnaul, Gorno-Altaysk\u0022,\u0022(UTC\u002B07:00) Hovd\u0022,\u0022(UTC\u002B07:00) Krasnoyarsk\u0022,\u0022(UTC\u002B07:00) Novosibirsk\u0022,\u0022(UTC\u002B07:00) Tomsk\u0022,\u0022(UTC\u002B08:00) Beijing, Chongqing, Hong Kong, Urumqi\u0022,\u0022(UTC\u002B08:00) Irkutsk\u0022,\u0022(UTC\u002B08:00) Kuala Lumpur, Singapore\u0022,\u0022(UTC\u002B08:00) Perth\u0022,\u0022(UTC\u002B08:00) Taipei\u0022,\u0022(UTC\u002B08:00) Ulaanbaatar\u0022,\u0022(UTC\u002B08:45) Eucla\u0022,\u0022(UTC\u002B09:00) Chita\u0022,\u0022(UTC\u002B09:00) Osaka, Sapporo, Tokyo\u0022,\u0022(UTC\u002B09:00) Pyongyang\u0022,\u0022(UTC\u002B09:00) Seoul\u0022,\u0022(UTC\u002B09:00) Yakutsk\u0022,\u0022(UTC\u002B09:30) Adelaide\u0022,\u0022(UTC\u002B09:30) Darwin\u0022,\u0022(UTC\u002B10:00) Brisbane\u0022,\u0022(UTC\u002B10:00) Canberra, Melbourne, Sydney\u0022,\u0022(UTC\u002B10:00) Guam, Port Moresby\u0022,\u0022(UTC\u002B10:00) Hobart\u0022,\u0022(UTC\u002B10:00) Vladivostok\u0022,\u0022(UTC\u002B10:30) Lord Howe Island\u0022,\u0022(UTC\u002B11:00) Bougainville Island\u0022,\u0022(UTC\u002B11:00) Chokurdakh\u0022,\u0022(UTC\u002B11:00) Magadan\u0022,\u0022(UTC\u002B11:00) Norfolk Island\u0022,\u0022(UTC\u002B11:00) Sakhalin\u0022,\u0022(UTC\u002B11:00) Solomon Is., New Caledonia\u0022,\u0022(UTC\u002B12:00) Anadyr, Petropavlovsk-Kamchatsky\u0022,\u0022(UTC\u002B12:00) Auckland, Wellington\u0022,\u0022(UTC\u002B12:00) Coordinated Universal Time\u002B12\u0022,\u0022(UTC\u002B12:00) Fiji\u0022,\u0022(UTC\u002B12:00) Petropavlovsk-Kamchatsky - Old\u0022,\u0022(UTC\u002B12:45) Chatham Islands\u0022,\u0022(UTC\u002B13:00) Coordinated Universal Time\u002B13\u0022,\u0022(UTC\u002B13:00) Nuku\u0027alofa\u0022,\u0022(UTC\u002B13:00) Samoa\u0022,\u0022(UTC\u002B14:00) Kiritimati Island\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsTimeZone\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[WindowsTimeZone]WindowsTimeZone1;TimeZone\u0027, \u0027=\u0027, parameters(\u0027TimeZone\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsTimeZone\u0022},\u0022TimeZone\u0022:{\u0022value\u0022:\u0022[parameters(\u0027TimeZone\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022TimeZone\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsTimeZone]WindowsTimeZone1;TimeZone\u0022,\u0022value\u0022:\u0022[parameters(\u0027TimeZone\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[WindowsTimeZone]WindowsTimeZone1;TimeZone\u0022,\u0022value\u0022:\u0022[parameters(\u0027TimeZone\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c21f7060-c148-41cf-a68b-0ab3e14c764c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c21f7060-c148-41cf-a68b-0ab3e14c764c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs on which the specified services are not installed and \u0027Running\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines on which the specified services are not installed and \u0027Running\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsServiceStatus\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c2dd2a9a-8a20-4a9c-b8d6-f17ccc26939a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027.NET Framework\u0027 version is the latest, if used as a part of the API app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for .NET Framework software either due to security flaws or to include additional functionality. Using the latest .NET framework version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the latest version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.netFrameworkVersion\u0022,\u0022in\u0022:[\u0022v3.0\u0022,\u0022v4.0\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c2e7ca55-f62c-49b2-89a4-d41eb661d2f0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c2e7ca55-f62c-49b2-89a4-d41eb661d2f0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1176 - Baseline Configuration\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1176\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c30690a5-7bf3-467f-b0cd-ef5c7c7449cd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c30690a5-7bf3-467f-b0cd-ef5c7c7449cd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1389 - Information Spillage Response\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1389\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c39e6fda-ae70-4891-a739-be7bba6d1062\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c39e6fda-ae70-4891-a739-be7bba6d1062\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1390 - Information Spillage Response | Responsible Personnel\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1390\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c3b65b63-09ec-4cb5-8028-7dd324d10eb0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c3b65b63-09ec-4cb5-8028-7dd324d10eb0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022System updates on virtual machine scale sets should be installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit whether there are any missing system security updates and critical updates that should be installed to ensure that your Windows and Linux virtual machine scale sets are secure.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022SystemUpdates\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c3f317a7-a95c-4547-b7e7-11017ebdf2fe\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c3f317a7-a95c-4547-b7e7-11017ebdf2fe\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Linux VMs that have accounts without passwords\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that have accounts without passwords. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022PasswordPolicy_msid232\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c40c9087-1981-4e73-9f53-39743eda9d05\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c40c9087-1981-4e73-9f53-39743eda9d05\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1220 - Least Functionality | Authorized Software / Whitelisting\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1220\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c40f31a7-81e1-4130-99e5-a02ceea2a1d6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c40f31a7-81e1-4130-99e5-a02ceea2a1d6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1513 - Personnel Screening | Information With Special Protection Measures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1513\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c416970d-b12b-49eb-8af4-fb144cd7c290\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c416970d-b12b-49eb-8af4-fb144cd7c290\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Antimalware for Azure should be configured to automatically update protection signatures\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Windows virtual machine not configured with automatic update of Microsoft Antimalware protection signatures.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022equals\u0022:\u0022Windows\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022IaaSAntimalware\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Security\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\u0022,\u0022equals\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c43e4a30-77cb-48ab-a4dd-93f175c63b57\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c43e4a30-77cb-48ab-a4dd-93f175c63b57\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Container Registry should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Container Registry not configured to use a virtual network service endpoint.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Network\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerRegistry/registries\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.ContainerRegistry/registries/networkRuleSet.defaultAction\u0022,\u0022notEquals\u0022:\u0022Deny\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerRegistry/registries/networkRuleSet.virtualNetworkRules[*].action\u0022,\u0022exists\u0022:\u0022false\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c4857be7-912a-4c75-87e6-e30292bcdf78\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c4857be7-912a-4c75-87e6-e30292bcdf78\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1235 - Software Usage Restrictions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1235\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c49c610b-ece4-44b3-988c-2172b70d6e46\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c49c610b-ece4-44b3-988c-2172b70d6e46\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1173 - Internal System Connections\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1173\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c4aff9e7-2e60-46fa-86be-506b79033fc5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c4aff9e7-2e60-46fa-86be-506b79033fc5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Managed identity should be used in your API App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Use a managed identity for enhanced authentication security\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/managedServiceIdentityId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c4d441f8-f9d9-4a9e-9cef-e82117cb3eef\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c4d441f8-f9d9-4a9e-9cef-e82117cb3eef\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Authentication should be enabled on your API app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching the API app, or authenticate those that have tokens before they reach the API app\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/siteAuthEnabled\u0022,\u0022equals\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c4ebc54a-46e1-481a-bee2-d4411e95d828\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c4ebc54a-46e1-481a-bee2-d4411e95d828\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1600 - Developer Security Testing And Evaluation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1600\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c53f3123-d233-44a7-930b-f40d3bfeb7d6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c53f3123-d233-44a7-930b-f40d3bfeb7d6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022An activity log alert should exist for specific Policy operations\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy audits specific Policy operations with no activity log alerts configured.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022operationName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Operation Name\u0022,\u0022description\u0022:\u0022Policy Operation name for which activity log alert should exist\u0022},\u0022allowedValues\u0022:[\u0022Microsoft.Authorization/policyAssignments/write\u0022,\u0022Microsoft.Authorization/policyAssignments/delete\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/ActivityLogAlerts\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022category\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\u0022,\u0022equals\u0022:\u0022Policy\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022operationName\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].equals\u0022,\u0022equals\u0022:\u0022[parameters(\u0027operationName\u0027)]\u0022}]}]}},\u0022equals\u0022:2},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022category\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/ActivityLogAlerts/condition.allOf[*].field\u0022,\u0022equals\u0022:\u0022operationName\u0022}}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c5447c04-a4d7-4ba8-a263-c9ee321a6858\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c5447c04-a4d7-4ba8-a263-c9ee321a6858\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1408 - Maintenance Tools | Prevent Unauthorized Removal\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1408\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c5f56ac6-4bb2-4086-bc41-ad76344ba2c2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c5f56ac6-4bb2-4086-bc41-ad76344ba2c2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs that contain certificates expiring within the specified number of days\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that contain certificates expiring within the specified number of days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022CertificateStorePath\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Certificate store path\u0022,\u0022description\u0022:\u0022The path to the certificate store containing the certificates to check the expiration dates of. Default value is \u0027Cert:\u0027 which is the root certificate store path, so all certificates on the machine will be checked. Other example paths: \u0027Cert:\\\\LocalMachine\u0027, \u0027Cert:\\\\LocalMachine\\\\TrustedPublisher\u0027, \u0027Cert:\\\\CurrentUser\u0027\u0022},\u0022defaultValue\u0022:\u0022Cert:\u0022},\u0022ExpirationLimitInDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Expiration limit in days\u0022,\u0022description\u0022:\u0022An integer indicating the number of days within which to check for certificates that are expiring. For example, if this value is 30, any certificate expiring within the next 30 days will cause this policy to be non-compliant.\u0022},\u0022defaultValue\u0022:\u002230\u0022},\u0022CertificateThumbprintsToInclude\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Certificate thumbprints to include\u0022,\u0022description\u0022:\u0022A semicolon-separated list of certificate thumbprints to check under the specified path. If a value is not specified, all certificates under the certificate store path will be checked. If a value is specified, no certificates other than those with the thumbprints specified will be checked. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022CertificateThumbprintsToExclude\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Certificate thumbprints to exclude\u0022,\u0022description\u0022:\u0022A semicolon-separated list of certificate thumbprints to ignore. e.g. THUMBPRINT1;THUMBPRINT2;THUMBPRINT3\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022IncludeExpiredCertificates\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Include expired certificates\u0022,\u0022description\u0022:\u0022Must be \u0027true\u0027 or \u0027false\u0027. True indicates that any found certificates that have already expired will also make this policy non-compliant. False indicates that certificates that have expired will be be ignored.\u0022},\u0022allowedValues\u0022:[\u0022true\u0022,\u0022false\u0022],\u0022defaultValue\u0022:\u0022false\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022CertificateExpiration\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[CertificateStore]CertificateStore1;CertificateStorePath\u0027, \u0027=\u0027, parameters(\u0027CertificateStorePath\u0027), \u0027,\u0027, \u0027[CertificateStore]CertificateStore1;ExpirationLimitInDays\u0027, \u0027=\u0027, parameters(\u0027ExpirationLimitInDays\u0027), \u0027,\u0027, \u0027[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\u0027, \u0027=\u0027, parameters(\u0027CertificateThumbprintsToInclude\u0027), \u0027,\u0027, \u0027[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude\u0027, \u0027=\u0027, parameters(\u0027CertificateThumbprintsToExclude\u0027), \u0027,\u0027, \u0027[CertificateStore]CertificateStore1;IncludeExpiredCertificates\u0027, \u0027=\u0027, parameters(\u0027IncludeExpiredCertificates\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022CertificateExpiration\u0022},\u0022CertificateStorePath\u0022:{\u0022value\u0022:\u0022[parameters(\u0027CertificateStorePath\u0027)]\u0022},\u0022ExpirationLimitInDays\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ExpirationLimitInDays\u0027)]\u0022},\u0022CertificateThumbprintsToInclude\u0022:{\u0022value\u0022:\u0022[parameters(\u0027CertificateThumbprintsToInclude\u0027)]\u0022},\u0022CertificateThumbprintsToExclude\u0022:{\u0022value\u0022:\u0022[parameters(\u0027CertificateThumbprintsToExclude\u0027)]\u0022},\u0022IncludeExpiredCertificates\u0022:{\u0022value\u0022:\u0022[parameters(\u0027IncludeExpiredCertificates\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022CertificateStorePath\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ExpirationLimitInDays\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022CertificateThumbprintsToInclude\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022CertificateThumbprintsToExclude\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022IncludeExpiredCertificates\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;CertificateStorePath\u0022,\u0022value\u0022:\u0022[parameters(\u0027CertificateStorePath\u0027)]\u0022},{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;ExpirationLimitInDays\u0022,\u0022value\u0022:\u0022[parameters(\u0027ExpirationLimitInDays\u0027)]\u0022},{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027CertificateThumbprintsToInclude\u0027)]\u0022},{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027CertificateThumbprintsToExclude\u0027)]\u0022},{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;IncludeExpiredCertificates\u0022,\u0022value\u0022:\u0022[parameters(\u0027IncludeExpiredCertificates\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;CertificateStorePath\u0022,\u0022value\u0022:\u0022[parameters(\u0027CertificateStorePath\u0027)]\u0022},{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;ExpirationLimitInDays\u0022,\u0022value\u0022:\u0022[parameters(\u0027ExpirationLimitInDays\u0027)]\u0022},{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;CertificateThumbprintsToInclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027CertificateThumbprintsToInclude\u0027)]\u0022},{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;CertificateThumbprintsToExclude\u0022,\u0022value\u0022:\u0022[parameters(\u0027CertificateThumbprintsToExclude\u0027)]\u0022},{\u0022name\u0022:\u0022[CertificateStore]CertificateStore1;IncludeExpiredCertificates\u0022,\u0022value\u0022:\u0022[parameters(\u0027IncludeExpiredCertificates\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c5fbc59e-fb6f-494f-81e2-d99a671bdaa8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c5fbc59e-fb6f-494f-81e2-d99a671bdaa8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1670 - Flaw Remediation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1670\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c6108469-57ee-4666-af7e-79ba61c7ae0c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c6108469-57ee-4666-af7e-79ba61c7ae0c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1190 - Configuration Change Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1190\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c66a3d1e-465b-4f28-9da5-aef701b59892\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c66a3d1e-465b-4f28-9da5-aef701b59892\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1120 - Audit Review, Analysis, And Reporting | Integration / Scanning And Monitoring Capabilities\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1120\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c69b870e-857b-458b-af02-bb234f7a00d3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c69b870e-857b-458b-af02-bb234f7a00d3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1125 - Audit Reduction And Report Generation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1125\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c6ce745a-670e-47d3-a6c4-3cfe5ef00c10\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c6ce745a-670e-47d3-a6c4-3cfe5ef00c10\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy Diagnostic Settings for Recovery Services Vault to Log Analytics workspace for resource specific categories.\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploy Diagnostic Settings for Recovery Services Vault to stream to Log Analytics workspace for Resource specific categories. If any of the Resource specific categories are not enabled, a new diagnostic setting is created.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022preview\u0022:true,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Exclusion Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Value parameter.\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022tagValue\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Exclusion Tag Value\u0022,\u0022description\u0022:\u0022Value of the tag to use for excluding vaults from this policy. This should be used along with the Exclusion Tag Name parameter.\u0022},\u0022defaultValue\u0022:\u0022\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.RecoveryServices/vaults\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027,parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022equals\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022allof\u0022:[{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].Category\u0022,\u0022in\u0022:[\u0022CoreAzureBackup\u0022,\u0022AddonAzureBackupJobs\u0022,\u0022AddonAzureBackupAlerts\u0022,\u0022AddonAzureBackupPolicy\u0022,\u0022AddonAzureBackupStorage\u0022,\u0022AddonAzureBackupProtectedInstance\u0022]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].Enabled\u0022,\u0022equals\u0022:\u0022True\u0022}]}},\u0022Equals\u0022:6},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/workspaceId\u0022,\u0022notEquals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logAnalyticsDestinationType\u0022,\u0022equals\u0022:\u0022Dedicated\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vaultName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.RecoveryServices/vaults/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vaultName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022logAnalyticsDestinationType\u0022:\u0022Dedicated\u0022,\u0022metrics\u0022:[],\u0022logs\u0022:[{\u0022category\u0022:\u0022CoreAzureBackup\u0022,\u0022enabled\u0022:\u0022true\u0022},{\u0022category\u0022:\u0022AddonAzureBackupAlerts\u0022,\u0022enabled\u0022:\u0022true\u0022},{\u0022category\u0022:\u0022AddonAzureBackupJobs\u0022,\u0022enabled\u0022:\u0022true\u0022},{\u0022category\u0022:\u0022AddonAzureBackupPolicy\u0022,\u0022enabled\u0022:\u0022true\u0022},{\u0022category\u0022:\u0022AddonAzureBackupProtectedInstance\u0022,\u0022enabled\u0022:\u0022true\u0022},{\u0022category\u0022:\u0022AddonAzureBackupStorage\u0022,\u0022enabled\u0022:\u0022true\u0022}]}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(parameters(\u0027logAnalytics\u0027), \u0027configured for diagnostic logs for \u0027, \u0027: \u0027, parameters(\u0027vaultName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022vaultName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c717fb0c-d118-4c43-ab3d-ece30ac81fb3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c717fb0c-d118-4c43-ab3d-ece30ac81fb3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1619 - Information In Shared Resources\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1619\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c722e569-cb52-45f3-a643-836547d016e1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c722e569-cb52-45f3-a643-836547d016e1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1121 - Audit Review, Analysis, And Reporting | Correlation With Physical Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1121\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c72b0eb9-1fc2-44e5-a866-e7cb0532f7c1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c72b0eb9-1fc2-44e5-a866-e7cb0532f7c1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Authentication should be enabled on your Function app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching the Function app, or authenticate those that have tokens before they reach the Function app\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/siteAuthEnabled\u0022,\u0022equals\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c75248c1-ea1d-4a9c-8fc9-29a6aabd5da8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c75248c1-ea1d-4a9c-8fc9-29a6aabd5da8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1353 - Incident Response Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1353\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c785ad59-f78f-44ad-9a7f-d1202318c748\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c785ad59-f78f-44ad-9a7f-d1202318c748\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Email notifications to admins and subscription owners should be enabled in SQL server advanced data security settings\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit that \u0027email notification to admins and subscription owners\u0027 is enabled in the SQL server advanced threat protection settings. This ensures that any detections of anomalous activities on SQL server are reported as soon as possible to the admins.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies/emailAccountAdmins\u0022,\u0022equals\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c8343d2f-fdc9-4a97-b76f-fc71d1163bfc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c8343d2f-fdc9-4a97-b76f-fc71d1163bfc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Batch Account to Log Analytics workspace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Batch Account to stream to a regional Log Analytics workspace when any Batch Account which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Batch/batchAccounts\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Batch/batchAccounts/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022ServiceLog\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c84e5349-db6d-4769-805e-e14037dab9b5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c84e5349-db6d-4769-805e-e14037dab9b5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: API App should only be accessible over HTTPS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022api\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022apiApp\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022OnlyHttpsForApiApp\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c85538c1-b527-4ce4-bdb4-1dabcb3fd90d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1470 - Emergency Shutoff\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1470\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c89ba09f-2e0f-44d0-8095-65b05bd151ef\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c89ba09f-2e0f-44d0-8095-65b05bd151ef\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Interactive Logon\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Interactive Logon\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsInteractiveLogon\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c8abcef9-fc26-482f-b8db-5fa60ee4586d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c8abcef9-fc26-482f-b8db-5fa60ee4586d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1018 - Account Management | Role-Based Schemes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1018\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c9121abf-e698-4ee9-b1cf-71ee528ff07f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c9121abf-e698-4ee9-b1cf-71ee528ff07f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Data Lake Analytics should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Data Lake\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DataLakeAnalytics/accounts\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c95c74d9-38fe-4f0d-af86-0c7d626a315c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027User Rights Assignment\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027User Rights Assignment\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_UserRightsAssignment\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c961dac9-5916-42e8-8fb1-703148323994\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c961dac9-5916-42e8-8fb1-703148323994\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs with a pending reboot\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with a pending reboot. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsPendingReboot\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsPendingReboot\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c96f3246-4382-4264-bf6b-af0b35e23c3c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c96f3246-4382-4264-bf6b-af0b35e23c3c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Network Security Groups\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy automatically deploys diagnostic settings to network security groups. A storage account with name \u0027{storagePrefixParameter}{NSGLocation}\u0027 will be automatically created.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022storagePrefix\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Storage Account Prefix for Regional Storage Account\u0022,\u0022description\u0022:\u0022This prefix will be combined with the network security group location to form the created storage account name.\u0022}},\u0022rgName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource Group Name for Storage Account (must exist)\u0022,\u0022description\u0022:\u0022The resource group that the storage account will be created in. This resource group must already exist.\u0022,\u0022strongType\u0022:\u0022ExistingResourceGroups\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/networkSecurityGroups\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022setbypolicy\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022storagePrefix\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022nsgName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022rgName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022storageDeployName\u0022:\u0022[concat(\u0027policyStorage_\u0027, uniqueString(parameters(\u0027location\u0027), parameters(\u0027nsgName\u0027)))]\u0022},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027nsgName\u0027),\u0027/Microsoft.Insights/setbypolicy\u0027)]\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[\u0022[variables(\u0027storageDeployName\u0027)]\u0022],\u0022properties\u0022:{\u0022storageAccountId\u0022:\u0022[reference(variables(\u0027storageDeployName\u0027)).outputs.storageAccountId.value]\u0022,\u0022logs\u0022:[{\u0022category\u0022:\u0022NetworkSecurityGroupEvent\u0022,\u0022enabled\u0022:true,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}},{\u0022category\u0022:\u0022NetworkSecurityGroupRuleCounter\u0022,\u0022enabled\u0022:true,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}]}},{\u0022apiVersion\u0022:\u00222017-05-10\u0022,\u0022name\u0022:\u0022[variables(\u0027storageDeployName\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Resources/deployments\u0022,\u0022resourceGroup\u0022:\u0022[parameters(\u0027rgName\u0027)]\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},\u0022storagePrefix\u0022:{\u0022value\u0022:\u0022[parameters(\u0027storagePrefix\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022storagePrefix\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022apiVersion\u0022:\u00222017-06-01\u0022,\u0022type\u0022:\u0022Microsoft.Storage/storageAccounts\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027storageprefix\u0027), parameters(\u0027location\u0027))]\u0022,\u0022sku\u0022:{\u0022name\u0022:\u0022Standard_LRS\u0022,\u0022tier\u0022:\u0022Standard\u0022},\u0022kind\u0022:\u0022Storage\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022tags\u0022:{\u0022created-by\u0022:\u0022policy\u0022},\u0022scale\u0022:null,\u0022properties\u0022:{\u0022networkAcls\u0022:{\u0022bypass\u0022:\u0022AzureServices\u0022,\u0022defaultAction\u0022:\u0022Allow\u0022,\u0022ipRules\u0022:[],\u0022virtualNetworkRules\u0022:[]},\u0022supportsHttpsTrafficOnly\u0022:true}}],\u0022outputs\u0022:{\u0022storageAccountId\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[resourceId(parameters(\u0027rgName\u0027), \u0027Microsoft.Storage/storageAccounts\u0027,concat(parameters(\u0027storagePrefix\u0027), parameters(\u0027location\u0027)))]\u0022}}}}}]},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022storagePrefix\u0022:{\u0022value\u0022:\u0022[parameters(\u0027storagePrefix\u0027)]\u0022},\u0022rgName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027rgName\u0027)]\u0022},\u0022nsgName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Storage accounts should allow access from trusted Microsoft services\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Some Microsoft services that interact with storage accounts operate from networks that can\u0027t be granted access through network rules. To help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules. These services will then use strong authentication to access the storage account.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Storage\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Storage/storageAccounts\u0022},{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/networkAcls.bypass\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/networkAcls.bypass\u0022,\u0022notContains\u0022:\u0022AzureServices\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/c9d007d0-c057-4772-b18c-01e546713bcd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022c9d007d0-c057-4772-b18c-01e546713bcd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022App Configuration should use a private link\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any App Configuration instance that does not use a private link.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Configuration\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.AppConfiguration/configurationStores\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.AppConfiguration/configurationStores/privateEndpointConnections\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.AppConfiguration/configurationStores/privateEndpointConnections/privateLinkServiceConnectionState.status\u0022,\u0022equals\u0022:\u0022Approved\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ca610c1d-041c-4332-9d88-7ed3094967c7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ca610c1d-041c-4332-9d88-7ed3094967c7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1035 - Least Privilege | Authorize Access To Security Functions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1035\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ca94b046-45e2-444f-a862-dc8ce262a516\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ca94b046-45e2-444f-a862-dc8ce262a516\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1243 - Contingency Planning Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1243\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ca9a4469-d6df-4ab2-a42f-1213c396f0ec\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ca9a4469-d6df-4ab2-a42f-1213c396f0ec\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1306 - Identification And Authentication (Org. Users) | Net. Access To Priv. Accts. - Replay\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1306\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cafc6c3c-5fc5-4c5e-a99b-a0ccb1d34eff\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cafc6c3c-5fc5-4c5e-a99b-a0ccb1d34eff\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Remote debugging should be turned off for Web Applications\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Remote debugging requires inbound ports to be opened on a web application. Remote debugging should be turned off.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.remoteDebuggingEnabled\u0022,\u0022equals\u0022:\u0022false\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cb510bfd-1cba-4d9f-a230-cb0976f4bb71\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1486 - Alternate Work Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1486\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cb790345-a51f-43de-934e-98dbfaf9dca5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cb790345-a51f-43de-934e-98dbfaf9dca5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1167 - Continuous Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1167\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cbb2be76-4891-430b-95a7-ca0b0a3d1300\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cbb2be76-4891-430b-95a7-ca0b0a3d1300\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1374 - Incident Response Assistance\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1374\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cc5c8616-52ef-4e5e-8000-491634ed9249\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cc5c8616-52ef-4e5e-8000-491634ed9249\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs in which the Administrators group does not contain only the specified members\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines in which the Administrators group does not contain only the specified members. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AdministratorsGroupMembers\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cc7cda28-f867-4311-8497-a526129a8d19\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cc7cda28-f867-4311-8497-a526129a8d19\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Sensitive data in your SQL databases should be classified\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Azure Security Center monitors the data discovery and classification scan results for your SQL databases and provides recommendations to classify the sensitive data in your databases for better monitoring and security\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Sql/servers/databases\u0022,\u0022Microsoft.Sql/managedInstances/databases\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022sqlDataClassification\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cc9835f2-9f6b-4cc8-ab4a-f8ef615eb349\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Allowed virtual machine size SKUs\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy enables you to specify a set of virtual machine size SKUs that your organization can deploy.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Compute\u0022},\u0022parameters\u0022:{\u0022listOfAllowedSKUs\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022The list of size SKUs that can be specified for virtual machines.\u0022,\u0022displayName\u0022:\u0022Allowed Size SKUs\u0022,\u0022strongType\u0022:\u0022VMSKUs\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/sku.name\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfAllowedSKUs\u0027)]\u0022}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cccc23c7-8427-4f53-ad12-b6a63eb452b3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1443 - Media Use\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1443\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cd0ec6fa-a2e7-4361-aee4-a8688659a9ed\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cd0ec6fa-a2e7-4361-aee4-a8688659a9ed\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Inherit a tag from the resource group\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Adds or replaces the specified tag and value from the parent resource group when any resource is created or updated. Existing resources can be remediated by triggering a remediation task.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022notEquals\u0022:\u0022[resourceGroup().tags[parameters(\u0027tagName\u0027)]]\u0022},{\u0022value\u0022:\u0022[resourceGroup().tags[parameters(\u0027tagName\u0027)]]\u0022,\u0022notEquals\u0022:\u0022\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022modify\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022operations\u0022:[{\u0022operation\u0022:\u0022addOrReplace\u0022,\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[resourceGroup().tags[parameters(\u0027tagName\u0027)]]\u0022}]}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cd3aa116-8754-49c9-a813-ad46512ece54\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cd3aa116-8754-49c9-a813-ad46512ece54\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allow resource creation if \u0027department\u0027 tag set\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Allows resource creation only if the \u0027department\u0027 tag is set\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Tags\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022tags\u0022,\u0022containsKey\u0022:\u0022department\u0022}},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cd8dc879-a2ae-43c3-8211-1877c5755064\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1582 - Information System Documentation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1582\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cd9e2f38-259b-462c-bfad-0ad7ab4e65c5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cd9e2f38-259b-462c-bfad-0ad7ab4e65c5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs that allow re-use of the previous 24 passwords\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that allow re-use of the previous 24 passwords. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022EnforcePasswordHistory\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cdbf72d9-ac9c-4026-8a3a-491a5ac59293\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cdbf72d9-ac9c-4026-8a3a-491a5ac59293\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1104 - Audit Events\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1104\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cdd8d244-18b2-4306-a1d1-df175ae0935f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cdd8d244-18b2-4306-a1d1-df175ae0935f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy export to Event Hub for Azure Security Center alerts and recommendations\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enable export to Event Hub of Azure Security Center alerts and/or recommendations. This policy deploys an export to Event Hub configuration with your conditions and target Event Hub on the assigned scope. To deploy this policy on newly created subscriptions, open the Compliance tab, select the relevant non-compliant assignment and create a remediation task.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022resourceGroupName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource group name\u0022,\u0022description\u0022:\u0022The resource group name where the export to Event Hub configuration is created. If you enter a name for a resource group that doesn\u0027t exist, it\u0027ll be created in the subscription. Note that each resource group can only have one export to Event Hub configured.\u0022}},\u0022resourceGroupLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource group location\u0022,\u0022description\u0022:\u0022The location where the resource group and the export to Event Hub configuration are created.\u0022,\u0022strongType\u0022:\u0022location\u0022}},\u0022exportedDataTypes\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Exported data types\u0022,\u0022description\u0022:\u0022The data types to be exported. Example: Security recommendations;Security alerts;\u0022},\u0022allowedValues\u0022:[\u0022Security recommendations\u0022,\u0022Security alerts\u0022],\u0022defaultValue\u0022:[\u0022Security recommendations\u0022,\u0022Security alerts\u0022]},\u0022recommendationNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Recommendation IDs\u0022,\u0022description\u0022:\u0022Applicable only for export of security recommendations. To export all recommendations, leave this empty. To export specific recommendations, enter a list of recommendation IDs separated by semicolons (\u0027;\u0027). Recommendation IDs are available through the Assessments API (https://docs.microsoft.com/rest/api/securitycenter/assessments), or Azure Resource Graph Explorer (https://portal.azure.com/#blade/HubsExtension/ArgQueryBlade), choose securityresources and microsoft.security/assessments.\u0022},\u0022defaultValue\u0022:[]},\u0022recommendationSeverities\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Recommendation severities\u0022,\u0022description\u0022:\u0022Applicable only for export of security recommendations. Determines recommendation severities. Example: High;Medium;Low;\u0022},\u0022allowedValues\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022],\u0022defaultValue\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022]},\u0022alertSeverities\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Alert severities\u0022,\u0022description\u0022:\u0022Applicable only for export of security alerts. Determines alert severities. Example: High;Medium;Low;\u0022},\u0022allowedValues\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022],\u0022defaultValue\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022]},\u0022eventHubDetails\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub details\u0022,\u0022description\u0022:\u0022The Event Hub details of where the data should be exported to: Subscription, Event Hub Namespace, Event Hub, and Authorizations rules with \u0027Send\u0027 claim. If you do not already have an event hub, visit Event Hubs to create one (https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.EventHub%2Fnamespaces).\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/namespaces/eventhubs/authorizationrules\u0022,\u0022assignPermissions\u0022:true}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/automations\u0022,\u0022name\u0022:\u0022exportToEventHub\u0022,\u0022existenceScope\u0022:\u0022resourcegroup\u0022,\u0022ResourceGroupName\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022deploymentScope\u0022:\u0022subscription\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022location\u0022:\u0022westeurope\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceGroupName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022resourceGroupLocation\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022exportedDataTypes\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022recommendationNames\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022recommendationSeverities\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022alertSeverities\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022eventHubDetails\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022guidValue\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022[newGuid()]\u0022}},\u0022variables\u0022:{\u0022scopeDescription\u0022:\u0022scope for subscription {0}\u0022,\u0022recommendationNamesLength\u0022:\u0022[length(parameters(\u0027recommendationNames\u0027))]\u0022,\u0022recommendationSeveritiesLength\u0022:\u0022[length(parameters(\u0027recommendationSeverities\u0027))]\u0022,\u0022alertSeveritiesLength\u0022:\u0022[length(parameters(\u0027alertSeverities\u0027))]\u0022,\u0022recommendationNamesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027recommendationNamesLength\u0027), 0), 1, variables(\u0027recommendationNamesLength\u0027))]\u0022,\u0022recommendationSeveritiesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027recommendationSeveritiesLength\u0027), 0), 1, variables(\u0027recommendationSeveritiesLength\u0027))]\u0022,\u0022alertSeveritiesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027alertSeveritiesLength\u0027), 0), 1, variables(\u0027alertSeveritiesLength\u0027))]\u0022,\u0022totalRuleCombinationsForOneRecommendationName\u0022:\u0022[variables(\u0027recommendationSeveritiesLengthIfEmpty\u0027)]\u0022,\u0022totalRuleCombinationsForOneRecommendationSeverity\u0022:1,\u0022exportedDataTypesLength\u0022:\u0022[length(parameters(\u0027exportedDataTypes\u0027))]\u0022,\u0022exportedDataTypesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027exportedDataTypesLength\u0027), 0), 1, variables(\u0027exportedDataTypesLength\u0027))]\u0022,\u0022SeperatedEventHubDetails\u0022:\u0022[split(parameters(\u0027eventHubDetails\u0027),\u0027/\u0027)]\u0022,\u0022dataTypeMap\u0022:{\u0022Security recommendations\u0022:\u0022Assessments\u0022,\u0022Security alerts\u0022:\u0022Alerts\u0022},\u0022alertSeverityMap\u0022:{\u0022High\u0022:\u0022high\u0022,\u0022Medium\u0022:\u0022medium\u0022,\u0022Low\u0022:\u0022low\u0022},\u0022ruleSetsForAssessmentsObj\u0022:{\u0022copy\u0022:[{\u0022name\u0022:\u0022ruleSetsForAssessmentsArr\u0022,\u0022count\u0022:\u0022[mul(variables(\u0027recommendationNamesLengthIfEmpty\u0027),variables(\u0027recommendationSeveritiesLengthIfEmpty\u0027))]\u0022,\u0022input\u0022:{\u0022rules\u0022:[{\u0022propertyJPath\u0022:\u0022[if(equals(variables(\u0027recommendationNamesLength\u0027),0),\u0027type\u0027,\u0027name\u0027)]\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[if(equals(variables(\u0027recommendationNamesLength\u0027),0),\u0027Microsoft.Security/assessments\u0027,parameters(\u0027recommendationNames\u0027)[mod(div(copyIndex(\u0027ruleSetsForAssessmentsArr\u0027),variables(\u0027totalRuleCombinationsForOneRecommendationName\u0027)),variables(\u0027recommendationNamesLength\u0027))])]\u0022,\u0022operator\u0022:\u0022Contains\u0022},{\u0022propertyJPath\u0022:\u0022properties.metadata.severity\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[parameters(\u0027recommendationSeverities\u0027)[mod(div(copyIndex(\u0027ruleSetsForAssessmentsArr\u0027),variables(\u0027totalRuleCombinationsForOneRecommendationSeverity\u0027)),variables(\u0027recommendationSeveritiesLength\u0027))]]\u0022,\u0022operator\u0022:\u0022Equals\u0022}]}}]},\u0022ruleSetsForAlertsObj\u0022:{\u0022copy\u0022:[{\u0022name\u0022:\u0022ruleSetsForAlertsArr\u0022,\u0022count\u0022:\u0022[variables(\u0027alertSeveritiesLengthIfEmpty\u0027)]\u0022,\u0022input\u0022:{\u0022rules\u0022:[{\u0022propertyJPath\u0022:\u0022Severity\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[variables(\u0027alertSeverityMap\u0027)[parameters(\u0027alertSeverities\u0027)[mod(copyIndex(\u0027ruleSetsForAlertsArr\u0027),variables(\u0027alertSeveritiesLengthIfEmpty\u0027))]]]\u0022,\u0022operator\u0022:\u0022Equals\u0022}]}}]}},\u0022resources\u0022:[{\u0022name\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Resources/resourceGroups\u0022,\u0022apiVersion\u0022:\u00222019-10-01\u0022,\u0022location\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022,\u0022tags\u0022:{},\u0022properties\u0022:{}},{\u0022type\u0022:\u0022Microsoft.Resources/deployments\u0022,\u0022apiVersion\u0022:\u00222019-10-01\u0022,\u0022name\u0022:\u0022[concat(\u0027nestedAutomationDeployment\u0027, \u0027_\u0027, parameters(\u0027guidValue\u0027))]\u0022,\u0022resourceGroup\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022dependsOn\u0022:[\u0022[resourceId(\u0027Microsoft.Resources/resourceGroups/\u0027, parameters(\u0027resourceGroupName\u0027))]\u0022],\u0022properties\u0022:{\u0022mode\u0022:\u0022Incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022tags\u0022:{},\u0022apiVersion\u0022:\u00222019-01-01-preview\u0022,\u0022location\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022,\u0022name\u0022:\u0022exportToEventHub\u0022,\u0022type\u0022:\u0022Microsoft.Security/automations\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022description\u0022:\u0022Export Azure Security Center alerts and/or recommendations to Event Hub via policy\u0022,\u0022isEnabled\u0022:true,\u0022scopes\u0022:[{\u0022description\u0022:\u0022[replace(variables(\u0027scopeDescription\u0027),\u0027{0}\u0027, subscription().subscriptionId)]\u0022,\u0022scopePath\u0022:\u0022[subscription().id]\u0022}],\u0022copy\u0022:[{\u0022name\u0022:\u0022sources\u0022,\u0022count\u0022:\u0022[variables(\u0027exportedDataTypesLengthIfEmpty\u0027)]\u0022,\u0022input\u0022:{\u0022eventSource\u0022:\u0022[variables(\u0027dataTypeMap\u0027)[parameters(\u0027exportedDataTypes\u0027)[copyIndex(\u0027sources\u0027)]]]\u0022,\u0022ruleSets\u0022:\u0022[if(equals(parameters(\u0027exportedDataTypes\u0027)[copyIndex(\u0027sources\u0027)], \u0027Security recommendations\u0027), variables(\u0027ruleSetsForAssessmentsObj\u0027).ruleSetsForAssessmentsArr, variables(\u0027ruleSetsForAlertsObj\u0027).ruleSetsForAlertsArr)]\u0022}}],\u0022actions\u0022:[{\u0022actionType\u0022:\u0022EventHub\u0022,\u0022eventHubResourceId\u0022:\u0022[concat(\u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[1], \u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[2], \u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[3], \u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[4], \u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[5], \u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[6], \u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[7], \u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[8], \u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[9], \u0027/\u0027, variables(\u0027SeperatedEventHubDetails\u0027)[10])]\u0022,\u0022connectionString\u0022:\u0022[listkeys(parameters(\u0027eventHubDetails\u0027),\u00272017-04-01\u0027).primaryConnectionString]\u0022}]}}]}}}]},\u0022parameters\u0022:{\u0022resourceGroupName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022},\u0022resourceGroupLocation\u0022:{\u0022value\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022},\u0022exportedDataTypes\u0022:{\u0022value\u0022:\u0022[parameters(\u0027exportedDataTypes\u0027)]\u0022},\u0022recommendationNames\u0022:{\u0022value\u0022:\u0022[parameters(\u0027recommendationNames\u0027)]\u0022},\u0022recommendationSeverities\u0022:{\u0022value\u0022:\u0022[parameters(\u0027recommendationSeverities\u0027)]\u0022},\u0022alertSeverities\u0022:{\u0022value\u0022:\u0022[parameters(\u0027alertSeverities\u0027)]\u0022},\u0022eventHubDetails\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubDetails\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cdfcce10-4578-4ecd-9703-530938e4abcb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cdfcce10-4578-4ecd-9703-530938e4abcb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027System Audit Policies - Privilege Use\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Privilege Use\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesPrivilegeUse\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SystemAuditPoliciesPrivilegeUse\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ce2370f6-0ac5-4d85-8ab4-10721cc640b0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ce2370f6-0ac5-4d85-8ab4-10721cc640b0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1209 - Configuration Settings\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1209\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ce669c31-9103-4552-ae9c-cdef4e03580d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ce669c31-9103-4552-ae9c-cdef4e03580d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1242 - Contingency Planning Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1242\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cf3b3293-667a-445e-a722-fa0b0afc0958\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cf3b3293-667a-445e-a722-fa0b0afc0958\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1097 - Role-Based Security Training | Suspicious Communications And Anomalous System Behavior\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1097\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cf3e4836-f19e-47eb-a8cd-c3ca150452c0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cf3e4836-f19e-47eb-a8cd-c3ca150452c0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1424 - Maintenance Personnel | Individuals Without Appropriate Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1424\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cf55fc87-48e1-4676-a2f8-d9a8cf993283\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cf55fc87-48e1-4676-a2f8-d9a8cf993283\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Key Vault should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Key Vault\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.KeyVault/vaults\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cf820ca0-f99e-4f3e-84fb-66e913812d21\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1292 - Information System Backup | Test Restoration Using Sampling\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1292\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d03516cf-0293-489f-9b32-a18f2a79f836\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d03516cf-0293-489f-9b32-a18f2a79f836\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1724 - Error Handling\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1724\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d07594d1-0307-4c08-94db-5d71ff31f0f6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d07594d1-0307-4c08-94db-5d71ff31f0f6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Container Registries should not allow unrestricted network access\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit Container Registries that do not have any Network (IP or VNET) Rules configured and allow all network access by default. Container Registries with at least one IP / Firewall rule or configured virtual network will be deemed compliant. For more information on Container Registry Network rules, please visit: https://aka.ms/acr/vnet.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Container Registry\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerRegistry/registries\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022Microsoft.ContainerRegistry/registries/networkRuleSet.defaultAction\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerRegistry/registries/networkRuleSet.defaultAction\u0022,\u0022equals\u0022:\u0022Allow\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d0793b48-0edc-4296-a390-4c75d1bdfd71\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1084 - Publicly Accessible Content\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1084\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d0eb15db-dd1c-4d1d-b200-b12dd6cd060c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d0eb15db-dd1c-4d1d-b200-b12dd6cd060c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Add or replace a tag on resource groups\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Adds or replaces the specified tag and value when any resource group is created or updated. Existing resource groups can be remediated by triggering a remediation task.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}},\u0022tagValue\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Value\u0022,\u0022description\u0022:\u0022Value of the tag, such as \u0027production\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022},{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022notEquals\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022modify\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022operations\u0022:[{\u0022operation\u0022:\u0022addOrReplace\u0022,\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[parameters(\u0027tagValue\u0027)]\u0022}]}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d157c373-a6c4-483d-aaad-570756956268\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d157c373-a6c4-483d-aaad-570756956268\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Enforce SSL connection should be enabled for PostgreSQL database servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any PostgreSQL server that is not enforcing SSL connection. Azure Database for PostgreSQL prefers connecting your client applications to the PostgreSQL service using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against \u0027man-in-the-middle\u0027 attacks by encrypting the data stream between the server and your application\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/sslEnforcement\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/sslEnforcement\u0022,\u0022notEquals\u0022:\u0022Enabled\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d158790f-bfb0-486c-8631-2dc6b4e8e6af\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d158790f-bfb0-486c-8631-2dc6b4e8e6af\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1620 - Denial Of Service Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1620\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d17c826b-1dec-43e1-a984-7b71c446649c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d17c826b-1dec-43e1-a984-7b71c446649c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1409 - Maintenance Tools | Prevent Unauthorized Removal\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1409\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d1880188-e51a-4772-b2ab-68f5e8bd27f6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d1880188-e51a-4772-b2ab-68f5e8bd27f6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Function Apps that are not using custom domains\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use of custom domains protects a Function app from common attacks such as phishing and other DNS-related attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022functionapp,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UsedCustomDomains\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d1cb47db-b7a1-4c46-814e-aad1c0e84f3c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d1cb47db-b7a1-4c46-814e-aad1c0e84f3c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1195 - Configuration Change Control | Automated Document / Notification / Prohibition Of Changes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1195\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d1e1d65c-1013-4484-bd54-991332e6a0d2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d1e1d65c-1013-4484-bd54-991332e6a0d2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1721 - Spam Protection | Central Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1721\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d207aaef-7c4d-4f8c-9dce-4d62dfa3d29a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d207aaef-7c4d-4f8c-9dce-4d62dfa3d29a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1106 - Audit Events | Reviews And Updates\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1106\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d2b4feae-61ab-423f-a4c5-0e38ac4464d8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d2b4feae-61ab-423f-a4c5-0e38ac4464d8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1030 - Information Flow Enforcement | Physical / Logical Separation Of Information Flows\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1030\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d3531453-b869-4606-9122-29c1cd6e7ed1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d3531453-b869-4606-9122-29c1cd6e7ed1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs on which the DSC configuration is not compliant\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows VMs on which the Desired State Configuration (DSC) configuration is not compliant. This policy is only applicable to machines with WMF 4 and above. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsDscConfiguration\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsDscConfiguration\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d38b4c26-9d2e-47d7-aefe-18d859a8706a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d38b4c26-9d2e-47d7-aefe-18d859a8706a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Long-term geo-redundant backup should be enabled for Azure SQL Databases\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Azure SQL Database with long-term geo-redundant backup not enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers/databases\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/databases/backupLongTermRetentionPolicies\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Sql/servers/databases/backupLongTermRetentionPolicies/weeklyRetention\u0022,\u0022notEquals\u0022:\u0022PT0S\u0022},{\u0022field\u0022:\u0022Microsoft.Sql/servers/databases/backupLongTermRetentionPolicies/monthlyRetention\u0022,\u0022notEquals\u0022:\u0022PT0S\u0022},{\u0022field\u0022:\u0022Microsoft.Sql/servers/databases/backupLongTermRetentionPolicies/yearlyRetention\u0022,\u0022notEquals\u0022:\u0022PT0S\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d38fc420-0735-4ef3-ac11-c806f651a570\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d38fc420-0735-4ef3-ac11-c806f651a570\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1641 - Transmission Confidentiality And Integrity | Cryptographic Or Alternate Physical Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1641\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d39d4f68-7346-4133-8841-15318a714a24\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d39d4f68-7346-4133-8841-15318a714a24\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1249 - Contingency Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1249\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d3bf4251-0818-42db-950b-afd5b25a51c2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d3bf4251-0818-42db-950b-afd5b25a51c2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1562 - Allocation Of Resources\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1562\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d4142013-7964-4163-a313-a900301c2cef\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d4142013-7964-4163-a313-a900301c2cef\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Virtual machines should be connected to an approved virtual network\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any virtual machine connected to a virtual network that is not approved.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022The effect determines what happens when the policy rule is evaluated to match\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Deny\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022},\u0022virtualNetworkId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Virtual network Id\u0022,\u0022description\u0022:\u0022Resource Id of the virtual network. Example: /subscriptions/YourSubscriptionId/resourceGroups/YourResourceGroupName/providers/Microsoft.Network/virtualNetworks/Name\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/networkInterfaces\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkInterfaces/ipconfigurations[*].subnet.id\u0022,\u0022like\u0022:\u0022[concat(parameters(\u0027virtualNetworkId\u0027),\u0027/*\u0027)]\u0022}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d416745a-506c-48b6-8ab1-83cb814bcaa3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d416745a-506c-48b6-8ab1-83cb814bcaa3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1383 - Incident Response Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1383\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d4558451-e16a-4d2d-a066-fe12a6282bb9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d4558451-e16a-4d2d-a066-fe12a6282bb9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1112 - Response To Audit Processing Failures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1112\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d530aad8-4ee2-45f4-b234-c061dae683c0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d530aad8-4ee2-45f4-b234-c061dae683c0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Data Lake Analytics to stream to a regional Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_logAnalytics\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant \u0027Log Analytics Contributor\u0027 permissions (or similar) to the policy assignment\u0027s principal ID.\u0022,\u0022strongType\u0022:\u0022omsWorkspace\u0022,\u0022assignPermissions\u0022:true}},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Log Analytics workspace - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DataLakeAnalytics/accounts\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logAnalytics\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022workspaceId\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022Audit\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Requests\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022logAnalytics\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logAnalytics\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d56a5a7c-72d7-42bc-8ceb-3baf4c0eae03\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1585 - Security Engineering Principles\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1585\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d57f8732-5cdc-4cda-8d27-ab148e1f3a55\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d57f8732-5cdc-4cda-8d27-ab148e1f3a55\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1667 - System And Information Integrity Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1667\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d61880dc-6e38-4f2a-a30c-3406a98f8220\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d61880dc-6e38-4f2a-a30c-3406a98f8220\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1150 - Security Assessments | External Organizations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1150\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d630429d-e763-40b1-8fba-d20ba7314afb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d630429d-e763-40b1-8fba-d20ba7314afb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Event Hub should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Event Hub not configured to use a virtual network service endpoint.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.EventHub/namespaces\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.EventHub/namespaces/virtualNetworkRules\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.EventHub/namespaces/virtualNetworkRules/virtualNetworkSubnetId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d63edb4a-c612-454d-b47d-191a724fcbf0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d63edb4a-c612-454d-b47d-191a724fcbf0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1549 - Vulnerability Scanning\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1549\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d6976a08-d969-4df2-bb38-29556c2eb48a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d6976a08-d969-4df2-bb38-29556c2eb48a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Log Analytics agent should be installed on your Windows Azure Arc machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits Windows Azure Arc machines if the Log Analytics agent is not installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Monitoring\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/type\u0022,\u0022equals\u0022:\u0022MicrosoftMonitoringAgent\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d69b1763-b96d-40b8-a2d9-ca31e9fd0d3e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d69b1763-b96d-40b8-a2d9-ca31e9fd0d3e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1473 - Emergency Power\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1473\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d7047705-d719-46a7-8bb0-76ad233eba71\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d7047705-d719-46a7-8bb0-76ad233eba71\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1529 - Third-Party Personnel Security\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1529\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d74fdc92-1cb8-4a34-9978-8556425cd14c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d74fdc92-1cb8-4a34-9978-8556425cd14c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1350 - Identification And Authentication (Non-Org. Users) | Use Of FICAM-Issued Profiles\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1350\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d77fd943-6ba6-4a21-ba07-22b03e347cc4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d77fd943-6ba6-4a21-ba07-22b03e347cc4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows Server VMs on which Windows Serial Console is not enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows Server virtual machines on which Windows Serial Console is not enabled. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsSerialConsole\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d7ccd0ca-8d78-42af-a43d-6b7f928accbc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d7ccd0ca-8d78-42af-a43d-6b7f928accbc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1016 - Account Management | Automated Audit Actions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1016\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d8b43277-512e-40c3-ab00-14b3b6e72238\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d8b43277-512e-40c3-ab00-14b3b6e72238\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1488 - Alternate Work Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1488\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d8ef30eb-a44f-47af-8524-ac19a36d41d2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d8ef30eb-a44f-47af-8524-ac19a36d41d2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1577 - Acquisition Process | Continuous Monitoring Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1577\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d922484a-8cfc-4a6b-95a4-77d6a685407f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d922484a-8cfc-4a6b-95a4-77d6a685407f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Public network access should be disabled for MySQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits MySQL servers in your environment with public network access enabled. For more details, visit https://go.microsoft.com/fwlink/?linkid=2120014.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMySQL/servers\u0022},{\u0022field\u0022:\u0022Microsoft.DBforMySQL/servers/publicNetworkAccess\u0022,\u0022notEquals\u0022:\u0022Disabled\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d9844e8a-1437-4aeb-a32c-0c992f056095\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1271 - Alternate Storage Site | Accessibility\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1271\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/da3bfb53-9c46-4010-b3db-a7ba1296dada\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022da3bfb53-9c46-4010-b3db-a7ba1296dada\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1516 - Personnel Termination\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1516\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/da3cd269-156f-435b-b472-c3af34c032ed\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022da3cd269-156f-435b-b472-c3af34c032ed\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Batch Account to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Batch Account to stream to a regional Event Hub when any Batch Account which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_eventHub\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022eventHubLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Location\u0022,\u0022description\u0022:\u0022The location the Event Hub resides in. Only Batch Accounts in this location will be linked to this Event Hub.\u0022,\u0022strongType\u0022:\u0022location\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Batch/batchAccounts\u0022},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.Batch/batchAccounts/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022ServiceLog\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/db51110f-0865-4a6e-b274-e2e07a5b2cd7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022db51110f-0865-4a6e-b274-e2e07a5b2cd7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1277 - Alternate Processing Site | Priority Of Service\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1277\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dc43e829-3d50-4a0a-aa0f-428d551862aa\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dc43e829-3d50-4a0a-aa0f-428d551862aa\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1439 - Media Sanitization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1439\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dce72873-c5f1-47c3-9b4f-6b8207fd5a45\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dce72873-c5f1-47c3-9b4f-6b8207fd5a45\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1264 - Contingency Plan Testing | Coordinate With Related Plans\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1264\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dd280d4b-50a1-42fb-a479-ece5878acf19\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dd280d4b-50a1-42fb-a479-ece5878acf19\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Web Applications that are not using custom domains\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use of custom domains protects a web application from common attacks such as phishing and other DNS-related attacks.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022WebApp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UsedCustomDomains\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dd2ea520-6b06-45c3-806e-ea297c23e06a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dd2ea520-6b06-45c3-806e-ea297c23e06a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027System Audit Policies - Policy Change\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - Policy Change\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesPolicyChange\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dd4680ed-0559-4a6a-ad10-081d14cbb484\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dd4680ed-0559-4a6a-ad10-081d14cbb484\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1715 - Software, Firmware, And Information Integrity | Automated Response To Integrity Violations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1715\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dd469ae0-71a8-4adc-aafc-de6949ca3339\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dd469ae0-71a8-4adc-aafc-de6949ca3339\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1678 - Malicious Code Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1678\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dd533cb0-b416-4be7-8e86-4d154824dfd7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dd533cb0-b416-4be7-8e86-4d154824dfd7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1391 - Information Spillage Response | Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1391\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dd6ac1a1-660e-4810-baa8-74e868e2ed47\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dd6ac1a1-660e-4810-baa8-74e868e2ed47\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1146 - Security Assessments\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1146\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dd83410c-ecb6-4547-8f14-748c3cbdc7ac\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dd83410c-ecb6-4547-8f14-748c3cbdc7ac\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1602 - Developer Security Testing And Evaluation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1602\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ddae2e97-a449-499f-a1c8-aea4a7e52ec9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ddae2e97-a449-499f-a1c8-aea4a7e52ec9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Settings - Account Policies\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Settings - Account Policies\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecuritySettingsAccountPolicies\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ddb53c61-9db4-41d4-a953-2abff5b66c12\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ddb53c61-9db4-41d4-a953-2abff5b66c12\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Recovery console\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Recovery console\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Recovery console: Allow floppy copy and access to all drives and all folders\u0022,\u0022description\u0022:\u0022Specifies whether to make the Recovery Console SET command available, which allows setting of recovery console environment variables.\u0022},\u0022defaultValue\u0022:\u00220\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsRecoveryconsole\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Recovery console: Allow floppy copy and access to all drives and all folders;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsRecoveryconsole\u0022},\u0022RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders\u0022:{\u0022value\u0022:\u0022[parameters(\u0027RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Recovery console: Allow floppy copy and access to all drives and all folders;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Recovery console: Allow floppy copy and access to all drives and all folders;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027RecoveryConsoleAllowFloppyCopyAndAccessToAllDrivesAndAllFolders\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ddc0a4d5-5e08-43d5-9fd9-b586d8d7116b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ddc0a4d5-5e08-43d5-9fd9-b586d8d7116b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1689 - Information System Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1689\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/de901f2f-a01a-4456-97f0-33cda7966172\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022de901f2f-a01a-4456-97f0-33cda7966172\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy Dependency agent to hybrid Linux Azure Arc machines\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy deploys the Dependency agent to Linux Azure Arc machines if the agent isn\u0027t installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Monitoring\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/extensions\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/Microsoft.Authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293\u0022],\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/type\u0022,\u0022equals\u0022:\u0022DependencyAgentLinux\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/machines/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022vmExtensionName\u0022:\u0022DependencyAgent\u0022,\u0022vmExtensionPublisher\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022,\u0022vmExtensionType\u0022:\u0022DependencyAgentLinux\u0022},\u0022resources\u0022:[{\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/\u0027, variables(\u0027vmExtensionName\u0027))]\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022apiVersion\u0022:\u00222019-12-12\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022[variables(\u0027vmExtensionPublisher\u0027)]\u0022,\u0022type\u0022:\u0022[variables(\u0027vmExtensionType\u0027)]\u0022,\u0022settings\u0022:{}}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled DA extension for VM\u0027, \u0027: \u0027, parameters(\u0027vmName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/deacecc0-9f84-44d2-bb82-46f32d766d43\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022deacecc0-9f84-44d2-bb82-46f32d766d43\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1528 - Access Agreements\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1528\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/deb9797c-22f8-40e8-b342-a84003c924e6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022deb9797c-22f8-40e8-b342-a84003c924e6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022MariaDB server should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits MariaDB servers not configured to use a virtual network service endpoint. For more details, visit https://aka.ms/mariadbvirtualnetwork.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMariaDB/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforMariaDB/servers/virtualNetworkRules\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforMariaDB/servers/virtualNetworkRules/virtualNetworkSubnetId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dfbd9a64-6114-48de-a47d-90574dc2e489\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dfbd9a64-6114-48de-a47d-90574dc2e489\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1673 - Flaw Remediation | Automated Flaw Remediation Status\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1673\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/dff0b90d-5a6f-491c-b2f8-b90aa402d844\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022dff0b90d-5a6f-491c-b2f8-b90aa402d844\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allow resource creation only in Japan data centers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Allows resource creation in the following locations only: Japan East, Japan West\u0022,\u0022metadata\u0022:{\u0022category\u0022:\u0022General\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022in\u0022:[\u0022japaneast\u0022,\u0022japanwest\u0022]}},\u0022then\u0022:{\u0022effect\u0022:\u0022Deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e01598e8-6538-41ed-95e8-8b29746cd697\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Cosmos DB should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Cosmos DB not configured to use a virtual network service endpoint.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DocumentDB/databaseAccounts\u0022},{\u0022field\u0022:\u0022Microsoft.DocumentDB/databaseAccounts/virtualNetworkRules[*].id\u0022,\u0022exists\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e0a2b1a3-f7f9-4569-807f-2a9edebdf4d9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e0a2b1a3-f7f9-4569-807f-2a9edebdf4d9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1206 - Access Restrictions For Change | Limit Production / Operational Privileges\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1206\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e0de232d-02a0-4652-872d-88afb4ae5e91\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e0de232d-02a0-4652-872d-88afb4ae5e91\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs that do not have the specified Windows PowerShell execution policy\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines where Windows PowerShell is not configured to use the specified PowerShell execution policy. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022ExecutionPolicy\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022PowerShell Execution Policy\u0022,\u0022description\u0022:\u0022The expected PowerShell execution policy.\u0022},\u0022allowedValues\u0022:[\u0022AllSigned\u0022,\u0022Bypass\u0022,\u0022Default\u0022,\u0022RemoteSigned\u0022,\u0022Restricted\u0022,\u0022Undefined\u0022,\u0022Unrestricted\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsPowerShellExecutionPolicy\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[PowerShellExecutionPolicy]PowerShellExecutionPolicy1;ExecutionPolicy\u0027, \u0027=\u0027, parameters(\u0027ExecutionPolicy\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022WindowsPowerShellExecutionPolicy\u0022},\u0022ExecutionPolicy\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ExecutionPolicy\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ExecutionPolicy\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[PowerShellExecutionPolicy]PowerShellExecutionPolicy1;ExecutionPolicy\u0022,\u0022value\u0022:\u0022[parameters(\u0027ExecutionPolicy\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[PowerShellExecutionPolicy]PowerShellExecutionPolicy1;ExecutionPolicy\u0022,\u0022value\u0022:\u0022[parameters(\u0027ExecutionPolicy\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e0efc13a-122a-47c5-b817-2ccfe5d12615\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e0efc13a-122a-47c5-b817-2ccfe5d12615\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1714 - Software, Firmware, And Information Integrity | Automated Notifications Of Integrity Violations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1714\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e12494fa-b81e-4080-af71-7dbacc2da0ec\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e12494fa-b81e-4080-af71-7dbacc2da0ec\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1686 - Information System Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1686\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e17085c5-0be8-4423-b39b-a52d3d1402e5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e17085c5-0be8-4423-b39b-a52d3d1402e5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1722 - Spam Protection | Automatic Updates\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1722\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e1da06bd-25b6-4127-a301-c313d6873fff\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e1da06bd-25b6-4127-a301-c313d6873fff\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Vulnerabilities in security configuration on your machines should be remediated\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Servers which do not satisfy the configured baseline will be monitored by Azure Security Center as recommendations\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022osVulnerabilities\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1047 - System Use Notification\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1047\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e1ff6d62-a55c-41ab-90ba-90bb5b7b6f62\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e1ff6d62-a55c-41ab-90ba-90bb5b7b6f62\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1276 - Alternate Processing Site | Accessibility\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1276\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e214e563-1206-4a43-a56b-ac5880c9c571\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e214e563-1206-4a43-a56b-ac5880c9c571\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1560 - System And Services Acquisition Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1560\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e29e0915-5c2f-4d09-8806-048b749ad763\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e29e0915-5c2f-4d09-8806-048b749ad763\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that \u0027HTTP Version\u0027 is the latest, if used to run the Function app\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Periodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.http20Enabled\u0022,\u0022equals\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e2c1c086-2d84-4019-bff3-c44ccd95113c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e2c1c086-2d84-4019-bff3-c44ccd95113c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit Dependency agent deployment in virtual machine scale sets - VM Image (OS) unlisted\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Reports virtual machine scale sets as non-compliant if the VM Image (OS) is not in the list defined and the agent is not installed. The list of OS images will be updated over time as support is updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022listOfImageIdToInclude_windows\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Windows OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]},\u0022listOfImageIdToInclude_linux\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Optional: List of VM images that have supported Linux OS to add to scope\u0022,\u0022description\u0022:\u0022Example value: \u0027/subscriptions/\u003CsubscriptionId\u003E/resourceGroups/YourResourceGroup/providers/Microsoft.Compute/images/ContosoStdImage\u0027\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},{\u0022not\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude_windows\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageId\u0022,\u0022in\u0022:\u0022[parameters(\u0027listOfImageIdToInclude_linux\u0027)]\u0022},{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u00222008-R2-SP1\u0022,\u00222008-R2-SP1-smalldisk\u0022,\u00222012-Datacenter\u0022,\u00222012-Datacenter-smalldisk\u0022,\u00222012-R2-Datacenter\u0022,\u00222012-R2-Datacenter-smalldisk\u0022,\u00222016-Datacenter\u0022,\u00222016-Datacenter-Server-Core\u0022,\u00222016-Datacenter-Server-Core-smalldisk\u0022,\u00222016-Datacenter-smalldisk\u0022,\u00222016-Datacenter-with-Containers\u0022,\u00222016-Datacenter-with-RDSH\u0022,\u00222019-Datacenter\u0022,\u00222019-Datacenter-Core\u0022,\u00222019-Datacenter-Core-smalldisk\u0022,\u00222019-Datacenter-Core-with-Containers\u0022,\u00222019-Datacenter-Core-with-Containers-smalldisk\u0022,\u00222019-Datacenter-smalldisk\u0022,\u00222019-Datacenter-with-Containers\u0022,\u00222019-Datacenter-with-Containers-smalldisk\u0022,\u00222019-Datacenter-zhcn\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerSemiAnnual\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u0022Datacenter-Core-1709-smalldisk\u0022,\u0022Datacenter-Core-1709-with-Containers-smalldisk\u0022,\u0022Datacenter-Core-1803-with-Containers-smalldisk\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServerHPCPack\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022WindowsServerHPCPack\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2016-BYOL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022*-WS2012R2-BYOL\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftRServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022MLServer-WS2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftVisualStudio\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022VisualStudio\u0022,\u0022Windows\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftDynamicsAX\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Dynamics\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022equals\u0022:\u0022Pre-Req-AX7-Onebox-U8\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022windows-data-science-vm\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsDesktop\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Windows-10\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022RHEL\u0022,\u0022RHEL-SAP-HANA\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022SUSE\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022SLES\u0022,\u0022SLES-HPC\u0022,\u0022SLES-HPC-Priority\u0022,\u0022SLES-SAP\u0022,\u0022SLES-SAP-BYOS\u0022,\u0022SLES-Priority\u0022,\u0022SLES-BYOS\u0022,\u0022SLES-SAPCAL\u0022,\u0022SLES-Standard\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002212-SP2\u0022,\u002212-SP3\u0022,\u002212-SP4\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002214.04.0-LTS\u0022,\u002214.04.1-LTS\u0022,\u002214.04.5-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002216.04-LTS\u0022,\u002216.04.0-LTS\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022in\u0022:[\u002218.04-LTS\u0022]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022Centos\u0022,\u0022Centos-LVM\u0022,\u0022CentOS-SRIOV\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00226.*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022like\u0022:\u00227*\u0022}]}]}}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.Azure.Monitoring.DependencyAgent\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e2dd799a-a932-4e9d-ac17-d473bc3c6c10\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e2dd799a-a932-4e9d-ac17-d473bc3c6c10\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1161 - Continuous Monitoring\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1161\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e2f8f6c6-dde4-436b-a79d-bc50e129eb3a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e2f8f6c6-dde4-436b-a79d-bc50e129eb3a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1387 - Information Spillage Response\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1387\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e3007185-3857-43a9-8237-06ca94f1084c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e3007185-3857-43a9-8237-06ca94f1084c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1479 - Fire Protection | Automatic Fire Suppression\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1479\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e327b072-281d-4f75-9c28-4216e5d72f26\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e327b072-281d-4f75-9c28-4216e5d72f26\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Azure VPN gateways should not use \u0027basic\u0027 SKU\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy ensures that VPN gateways do not use \u0027basic\u0027 SKU.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/virtualNetworkGateways\u0022},{\u0022field\u0022:\u0022Microsoft.Network/virtualNetworkGateways/gatewayType\u0022,\u0022equals\u0022:\u0022Vpn\u0022},{\u0022field\u0022:\u0022Microsoft.Network/virtualNetworkGateways/sku.tier\u0022,\u0022equals\u0022:\u0022Basic\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e345b6c3-24bd-4c93-9bbb-7e5e49a17b78\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e345b6c3-24bd-4c93-9bbb-7e5e49a17b78\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022MFA should be enabled on accounts with read permissions on your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Multi-Factor Authentication (MFA) should be enabled for all subscription accounts with read privileges to prevent a breach of accounts or resources.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022EnableMFAForReadPermissions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e3576e28-8b17-4677-84c3-db2990658d64\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022RDP access from the Internet should be blocked\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy audits any network security rule that allows RDP access from Internet\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/access\u0022,\u0022equals\u0022:\u0022Allow\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/direction\u0022,\u0022equals\u0022:\u0022Inbound\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0022,\u0022equals\u0022:\u0022*\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0022,\u0022equals\u0022:\u00223389\u0022},{\u0022value\u0022:\u0022[if(and(not(empty(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0027))), contains(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0027),\u0027-\u0027)), and(lessOrEquals(int(first(split(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0027), \u0027-\u0027))),3389),greaterOrEquals(int(last(split(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\u0027), \u0027-\u0027))),3389)), \u0027false\u0027)]\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0022,\u0022where\u0022:{\u0022value\u0022:\u0022[if(and(not(empty(first(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0027)))), contains(first(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0027)),\u0027-\u0027)), and(lessOrEquals(int(first(split(first(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0027)), \u0027-\u0027))),3389),greaterOrEquals(int(last(split(first(field(\u0027Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0027)), \u0027-\u0027))),3389)) , \u0027false\u0027)]\u0022,\u0022equals\u0022:\u0022true\u0022}},\u0022greater\u0022:0},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0022,\u0022notEquals\u0022:\u0022*\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\u0022,\u0022notEquals\u0022:\u00223389\u0022}}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\u0022,\u0022equals\u0022:\u0022*\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\u0022,\u0022equals\u0022:\u0022Internet\u0022},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\u0022,\u0022notEquals\u0022:\u0022*\u0022}},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\u0022,\u0022notEquals\u0022:\u0022Internet\u0022}}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e372f825-a257-4fb8-9175-797a8a8627d6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e372f825-a257-4fb8-9175-797a8a8627d6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Shutdown\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Shutdown\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsShutdown\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e3a77a94-cf41-4ee8-b45c-98be28841c03\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e3a77a94-cf41-4ee8-b45c-98be28841c03\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Settings - Account Policies\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Settings - Account Policies\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022EnforcePasswordHistory\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Enforce password history\u0022,\u0022description\u0022:\u0022Specifies limits on password reuse - how many times a new password must be created for a user account before the password can be repeated.\u0022},\u0022defaultValue\u0022:\u002224\u0022},\u0022MaximumPasswordAge\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Maximum password age\u0022,\u0022description\u0022:\u0022Specifies the maximum number of days that may elapse before a user account password must be changed. The format of the value is two integers separated by a comma, denoting an inclusive range.\u0022},\u0022defaultValue\u0022:\u00221,70\u0022},\u0022MinimumPasswordAge\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Minimum password age\u0022,\u0022description\u0022:\u0022Specifies the minimum number of days that must elapse before a user account password can be changed.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022MinimumPasswordLength\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Minimum password length\u0022,\u0022description\u0022:\u0022Specifies the minimum number of characters that a user account password may contain.\u0022},\u0022defaultValue\u0022:\u002214\u0022},\u0022PasswordMustMeetComplexityRequirements\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Password must meet complexity requirements\u0022,\u0022description\u0022:\u0022Specifies whether a user account password must be complex. If required, a complex password must not contain part of  user\u0027s account name or full name; be at least 6 characters long; contain a mix of uppercase, lowercase, number, and non-alphabetic characters.\u0022},\u0022defaultValue\u0022:\u00221\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecuritySettingsAccountPolicies\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Enforce password history;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027EnforcePasswordHistory\u0027), \u0027,\u0027, \u0027Maximum password age;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027MaximumPasswordAge\u0027), \u0027,\u0027, \u0027Minimum password age;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027MinimumPasswordAge\u0027), \u0027,\u0027, \u0027Minimum password length;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027MinimumPasswordLength\u0027), \u0027,\u0027, \u0027Password must meet complexity requirements;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027PasswordMustMeetComplexityRequirements\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecuritySettingsAccountPolicies\u0022},\u0022EnforcePasswordHistory\u0022:{\u0022value\u0022:\u0022[parameters(\u0027EnforcePasswordHistory\u0027)]\u0022},\u0022MaximumPasswordAge\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MaximumPasswordAge\u0027)]\u0022},\u0022MinimumPasswordAge\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MinimumPasswordAge\u0027)]\u0022},\u0022MinimumPasswordLength\u0022:{\u0022value\u0022:\u0022[parameters(\u0027MinimumPasswordLength\u0027)]\u0022},\u0022PasswordMustMeetComplexityRequirements\u0022:{\u0022value\u0022:\u0022[parameters(\u0027PasswordMustMeetComplexityRequirements\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022EnforcePasswordHistory\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MaximumPasswordAge\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MinimumPasswordAge\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022MinimumPasswordLength\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022PasswordMustMeetComplexityRequirements\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Enforce password history;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027EnforcePasswordHistory\u0027)]\u0022},{\u0022name\u0022:\u0022Maximum password age;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MaximumPasswordAge\u0027)]\u0022},{\u0022name\u0022:\u0022Minimum password age;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MinimumPasswordAge\u0027)]\u0022},{\u0022name\u0022:\u0022Minimum password length;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MinimumPasswordLength\u0027)]\u0022},{\u0022name\u0022:\u0022Password must meet complexity requirements;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027PasswordMustMeetComplexityRequirements\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Enforce password history;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027EnforcePasswordHistory\u0027)]\u0022},{\u0022name\u0022:\u0022Maximum password age;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MaximumPasswordAge\u0027)]\u0022},{\u0022name\u0022:\u0022Minimum password age;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MinimumPasswordAge\u0027)]\u0022},{\u0022name\u0022:\u0022Minimum password length;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027MinimumPasswordLength\u0027)]\u0022},{\u0022name\u0022:\u0022Password must meet complexity requirements;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027PasswordMustMeetComplexityRequirements\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e3d95ab7-f47a-49d8-a347-784177b6c94c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e3d95ab7-f47a-49d8-a347-784177b6c94c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1451 - Physical Access Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1451\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e3f1e5a3-25c1-4476-8cb6-3955031f8e65\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e3f1e5a3-25c1-4476-8cb6-3955031f8e65\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1357 - Incident Response Training | Automated Training Environments\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1357\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e4213689-05e8-4241-9d4e-8dd1cdafd105\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e4213689-05e8-4241-9d4e-8dd1cdafd105\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - User Account Control\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - User Account Control\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022UACAdminApprovalModeForTheBuiltinAdministratorAccount\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: UAC: Admin Approval Mode for the Built-in Administrator account\u0022,\u0022description\u0022:\u0022Specifies the behavior of Admin Approval Mode for the built-in Administrator account.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: UAC: Behavior of the elevation prompt for administrators in Admin Approval Mode\u0022,\u0022description\u0022:\u0022Specifies the behavior of the elevation prompt for administrators.\u0022},\u0022defaultValue\u0022:\u00222\u0022},\u0022UACDetectApplicationInstallationsAndPromptForElevation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: UAC: Detect application installations and prompt for elevation\u0022,\u0022description\u0022:\u0022Specifies the behavior of application installation detection for the computer.\u0022},\u0022defaultValue\u0022:\u00221\u0022},\u0022UACRunAllAdministratorsInAdminApprovalMode\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: UAC: Run all administrators in Admin Approval Mode\u0022,\u0022description\u0022:\u0022Specifies the behavior of all User Account Control (UAC) policy settings for the computer.\u0022},\u0022defaultValue\u0022:\u00221\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsUserAccountControl\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027User Account Control: Admin Approval Mode for the Built-in Administrator account;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UACAdminApprovalModeForTheBuiltinAdministratorAccount\u0027), \u0027,\u0027, \u0027User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\u0027), \u0027,\u0027, \u0027User Account Control: Detect application installations and prompt for elevation;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UACDetectApplicationInstallationsAndPromptForElevation\u0027), \u0027,\u0027, \u0027User Account Control: Run all administrators in Admin Approval Mode;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027UACRunAllAdministratorsInAdminApprovalMode\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsUserAccountControl\u0022},\u0022UACAdminApprovalModeForTheBuiltinAdministratorAccount\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UACAdminApprovalModeForTheBuiltinAdministratorAccount\u0027)]\u0022},\u0022UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\u0027)]\u0022},\u0022UACDetectApplicationInstallationsAndPromptForElevation\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UACDetectApplicationInstallationsAndPromptForElevation\u0027)]\u0022},\u0022UACRunAllAdministratorsInAdminApprovalMode\u0022:{\u0022value\u0022:\u0022[parameters(\u0027UACRunAllAdministratorsInAdminApprovalMode\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UACAdminApprovalModeForTheBuiltinAdministratorAccount\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UACDetectApplicationInstallationsAndPromptForElevation\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022UACRunAllAdministratorsInAdminApprovalMode\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022User Account Control: Admin Approval Mode for the Built-in Administrator account;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UACAdminApprovalModeForTheBuiltinAdministratorAccount\u0027)]\u0022},{\u0022name\u0022:\u0022User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\u0027)]\u0022},{\u0022name\u0022:\u0022User Account Control: Detect application installations and prompt for elevation;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UACDetectApplicationInstallationsAndPromptForElevation\u0027)]\u0022},{\u0022name\u0022:\u0022User Account Control: Run all administrators in Admin Approval Mode;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UACRunAllAdministratorsInAdminApprovalMode\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022User Account Control: Admin Approval Mode for the Built-in Administrator account;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UACAdminApprovalModeForTheBuiltinAdministratorAccount\u0027)]\u0022},{\u0022name\u0022:\u0022User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UACBehaviorOfTheElevationPromptForAdministratorsInAdminApprovalMode\u0027)]\u0022},{\u0022name\u0022:\u0022User Account Control: Detect application installations and prompt for elevation;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UACDetectApplicationInstallationsAndPromptForElevation\u0027)]\u0022},{\u0022name\u0022:\u0022User Account Control: Run all administrators in Admin Approval Mode;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027UACRunAllAdministratorsInAdminApprovalMode\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e425e402-a050-45e5-b010-bd3f934589fc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e425e402-a050-45e5-b010-bd3f934589fc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1340 - Authenticator Management | No Embedded Unencrypted Static Authenticators\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1340\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e51ff84b-e5ea-408f-b651-2ecc2933e4c6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e51ff84b-e5ea-408f-b651-2ecc2933e4c6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1381 - Incident Response Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1381\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e5368258-9684-4567-8126-269f34e65eab\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e5368258-9684-4567-8126-269f34e65eab\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1421 - Maintenance Personnel\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1421\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e539caaa-da8c-41b8-9e1e-449851e2f7a6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e539caaa-da8c-41b8-9e1e-449851e2f7a6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1716 - Software, Firmware, And Information Integrity | Integration Of Detection And Response\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1716\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e54c325e-42a0-4dcf-b105-046e0f6f590f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e54c325e-42a0-4dcf-b105-046e0f6f590f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1023 - Account Management | Usage Conditions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1023\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e55698b6-3dea-4aa9-99b9-d8218c6ab6e5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e55698b6-3dea-4aa9-99b9-d8218c6ab6e5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Allowed locations\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the \u0027global\u0027 region.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022General\u0022},\u0022parameters\u0022:{\u0022listOfAllowedLocations\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022The list of locations that can be specified when deploying resources.\u0022,\u0022strongType\u0022:\u0022location\u0022,\u0022displayName\u0022:\u0022Allowed locations\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022location\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027listOfAllowedLocations\u0027)]\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022notEquals\u0022:\u0022global\u0022},{\u0022field\u0022:\u0022type\u0022,\u0022notEquals\u0022:\u0022Microsoft.AzureActiveDirectory/b2cDirectories\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e56962a6-4747-49cd-b67b-bf8b01975c4c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1296 - Information System Recovery And Reconstitution | Transaction Recovery\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1296\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e57b98a0-a011-4956-a79d-5d17ed8b8e48\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e57b98a0-a011-4956-a79d-5d17ed8b8e48\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1499 - Rules Of Behavior\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1499\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e59671ab-9720-4ee2-9c60-170e8c82251e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e59671ab-9720-4ee2-9c60-170e8c82251e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Accounts\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Accounts\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022AccountsGuestAccountStatus\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Accounts: Guest account status\u0022,\u0022description\u0022:\u0022Specifies whether the local Guest account is disabled.\u0022},\u0022defaultValue\u0022:\u00220\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsAccounts\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Accounts: Guest account status;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AccountsGuestAccountStatus\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsAccounts\u0022},\u0022AccountsGuestAccountStatus\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AccountsGuestAccountStatus\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AccountsGuestAccountStatus\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Accounts: Guest account status;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AccountsGuestAccountStatus\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Accounts: Guest account status;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AccountsGuestAccountStatus\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e5b81f87-9185-4224-bf00-9f505e9f89f3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e5b81f87-9185-4224-bf00-9f505e9f89f3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Web Applications that are not using latest supported Node.js Framework\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Use the latest supported Node.js version for the latest security classes. Using older classes and types can make your application vulnerable.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022UseLatestNodeJS\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e67687e8-08d5-4e7f-8226-5b4753bba008\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e67687e8-08d5-4e7f-8226-5b4753bba008\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1465 - Monitoring Physical Access | Monitoring Physical Access To Information Systems\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1465\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e6e41554-86b5-4537-9f7f-4fc41a1d1640\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e6e41554-86b5-4537-9f7f-4fc41a1d1640\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Subnets should be associated with a Network Security Group\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Protect your subnet from potential threats by restricting access to it with a Network Security Group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your subnet.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/virtualNetworks/subnets\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022networkSecurityGroupsOnSubnets\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022NotApplicable\u0022,\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e71308d3-144b-4262-b144-efdc3cc90517\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1567 - System Development Life Cycle\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1567\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e72edbf6-aa61-436d-a227-0f32b77194b3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e72edbf6-aa61-436d-a227-0f32b77194b3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1311 - Identifier Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1311\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e7568697-0c9e-4ea3-9cec-9e567d14f3c6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e7568697-0c9e-4ea3-9cec-9e567d14f3c6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Advanced Threat Protection types should be set to \u0027All\u0027 in SQL server Advanced Data Security settings\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022It is recommended to enable all Advanced Threat Protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/securityAlertPolicies/disabledAlerts[*]\u0022,\u0022equals\u0022:\u0022\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e756b945-1b1b-480b-8de8-9a0859d5f7ad\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e756b945-1b1b-480b-8de8-9a0859d5f7ad\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1154 - System Interconnections | Unclassified Non-National Security System Connections\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1154\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e757ceb9-93b3-45fe-a4f4-f43f64f1ac5a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e757ceb9-93b3-45fe-a4f4-f43f64f1ac5a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Allowed locations for resource groups\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022General\u0022},\u0022parameters\u0022:{\u0022listOfAllowedLocations\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022The list of locations that resource groups can be created in.\u0022,\u0022strongType\u0022:\u0022location\u0022,\u0022displayName\u0022:\u0022Allowed locations\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027listOfAllowedLocations\u0027)]\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e765b5de-1225-4ba3-bd56-1ac6695af988\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1273 - Alternate Processing Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1273\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e77fcbf2-a1e8-44f1-860e-ed6583761e65\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e77fcbf2-a1e8-44f1-860e-ed6583761e65\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Audit Web Sockets state for a Web Application\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022The Web Sockets protocol is vulnerable to different types of security threats. Use of Web Sockets within a web application must be carefully reviewed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-deprecated\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allof\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022microsoft.Web/sites\u0022},{\u0022anyof\u0022:[{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022WebApp\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022equals\u0022:\u0022app,linux,container\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022DisableWebSockets\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e797f851-8be7-4c40-bb56-2e3395215b0e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e797f851-8be7-4c40-bb56-2e3395215b0e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1169 - Continuous Monitoring | Trend Analyses\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1169\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e7ba2cb3-5675-4468-8b50-8486bdd998a5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e7ba2cb3-5675-4468-8b50-8486bdd998a5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Enforce SSL connection should be enabled for MySQL database servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any MySQL server that is not enforcing SSL connection. Azure Database for MySQL supports connecting your Azure Database for MySQL server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between your database server and your client applications helps protect against \u0027man in the middle\u0027 attacks by encrypting the data stream between the server and your application.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMySQL/servers\u0022},{\u0022field\u0022:\u0022Microsoft.DBforMySQL/servers/sslEnforcement\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.DBforMySQL/servers/sslEnforcement\u0022,\u0022notEquals\u0022:\u0022Enabled\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e802a67a-daf5-4436-9ea6-f6d821dd0c5d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e802a67a-daf5-4436-9ea6-f6d821dd0c5d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1237 - Software Usage Restrictions | Open Source Software\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1237\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e80b6812-0bfa-4383-8223-cdd86a46a890\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e80b6812-0bfa-4383-8223-cdd86a46a890\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Vulnerabilities in container security configurations should be remediated\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Audit vulnerabilities in security configuration on machines with Docker installed and display as recommendations in Azure Security Center.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022,\u0022Microsoft.Compute/virtualMachineScaleSets\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022ContainerBenchmark\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e8cbc669-f12d-49eb-93e7-9273119e9933\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e8cbc669-f12d-49eb-93e7-9273119e9933\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Data Lake Storage Gen1 to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Data Lake Storage Gen1 to stream to a regional Event Hub when any Data Lake Storage Gen1 which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_eventHub\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022eventHubLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Location\u0022,\u0022description\u0022:\u0022The location the Event Hub resides in. Only Data Lake Storage in this location will be linked to this Event Hub.\u0022,\u0022strongType\u0022:\u0022location\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DataLakeStore/accounts\u0022},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.DataLakeStore/accounts/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022Audit\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Requests\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e8d096bc-85de-4c5f-8cfb-857bd1b9d62d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e8d096bc-85de-4c5f-8cfb-857bd1b9d62d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Container Registries should use private links\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit Container Registries that do not have at least one approved private endpoint connection. Clients in a virtual network can securely access resources that have private endpoint connections through private links. For more information, visit: https://aka.ms/acr/private-link.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Container Registry\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerRegistry/registries\u0022},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.ContainerRegistry/registries/privateEndpointConnections[*]\u0022,\u0022where\u0022:{\u0022field\u0022:\u0022Microsoft.ContainerRegistry/registries/privateEndpointConnections[*].privateLinkServiceConnectionState.status\u0022,\u0022equals\u0022:\u0022Approved\u0022}},\u0022less\u0022:1}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e8eef0a8-67cf-4eb4-9386-14b0e78733d4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e8eef0a8-67cf-4eb4-9386-14b0e78733d4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1626 - Boundary Protection | External Telecommunications Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1626\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e8f6bddd-6d67-439a-88d4-c5fe39a79341\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e8f6bddd-6d67-439a-88d4-c5fe39a79341\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1502 - Rules Of Behavior | Social Media And Networking Restrictions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1502\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e901375c-8f01-4ac8-9183-d5312f47fe63\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e901375c-8f01-4ac8-9183-d5312f47fe63\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1723 - Information Input Validation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1723\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e91927a0-ac1d-44a0-95f8-5185f9dfce9f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e91927a0-ac1d-44a0-95f8-5185f9dfce9f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1200 - Security Impact Analysis\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1200\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e98fe9d7-2ed3-44f8-93b7-24dca69783ff\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e98fe9d7-2ed3-44f8-93b7-24dca69783ff\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1487 - Alternate Work Site\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1487\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e9c3371d-c30c-4f58-abd9-30b8a8199571\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e9c3371d-c30c-4f58-abd9-30b8a8199571\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Remote debugging should be turned off for API Apps\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Remote debugging requires inbound ports to be opened on API apps. Remote debugging should be turned off.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022*api\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/remoteDebuggingEnabled\u0022,\u0022equals\u0022:\u0022false\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e9c8d085-d9cc-4b17-9cdc-059f1f01f19e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1363 - Incident Handling | Automated Incident Handling Processes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1363\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ea3e8156-89a1-45b1-8bd6-938abc79fdfd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ea3e8156-89a1-45b1-8bd6-938abc79fdfd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Inherit a tag from the resource group if missing\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Adds the specified tag with its value from the parent resource group when any resource missing this tag is created or updated. Existing resources can be remediated by triggering a remediation task. If the tag exists with a different value it will not be changed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Tags\u0022},\u0022parameters\u0022:{\u0022tagName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Tag Name\u0022,\u0022description\u0022:\u0022Name of the tag, such as \u0027environment\u0027\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022value\u0022:\u0022[resourceGroup().tags[parameters(\u0027tagName\u0027)]]\u0022,\u0022notEquals\u0022:\u0022\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022modify\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022operations\u0022:[{\u0022operation\u0022:\u0022add\u0022,\u0022field\u0022:\u0022[concat(\u0027tags[\u0027, parameters(\u0027tagName\u0027), \u0027]\u0027)]\u0022,\u0022value\u0022:\u0022[resourceGroup().tags[parameters(\u0027tagName\u0027)]]\u0022}]}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ea3f2387-9b95-492a-a190-fcdc54f7b070\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ea3f2387-9b95-492a-a190-fcdc54f7b070\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Key Vault should use a virtual network service endpoint\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Key Vault not configured to use a virtual network service endpoint.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.KeyVault/vaults\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.KeyVault/vaults/networkAcls.defaultAction\u0022,\u0022notEquals\u0022:\u0022Deny\u0022},{\u0022field\u0022:\u0022Microsoft.KeyVault/vaults/networkAcls.virtualNetworkRules[*].id\u0022,\u0022exists\u0022:\u0022false\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ea4d6841-2173-4317-9747-ff522a45120f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ea4d6841-2173-4317-9747-ff522a45120f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1422 - Maintenance Personnel\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1422\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ea556850-838d-4a37-8ce5-9d7642f95e11\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ea556850-838d-4a37-8ce5-9d7642f95e11\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1542 - Risk Assessment\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1542\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/eab340d0-3d55-4826-a0e5-feebfeb0131d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022eab340d0-3d55-4826-a0e5-feebfeb0131d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure Function app has \u0027Client Certificates (Incoming client certificates)\u0027 set to \u0027On\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022},{\u0022field\u0022:\u0022Microsoft.Web/sites/clientCertEnabled\u0022,\u0022equals\u0022:\u0022false\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/eaebaea7-8013-4ceb-9d14-7eb32271373c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022eaebaea7-8013-4ceb-9d14-7eb32271373c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1064 - Remote Access | Privileged Commands / Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1064\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/eb4d9508-cbf0-4a3c-bb5c-6c95b159f3fb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022eb4d9508-cbf0-4a3c-bb5c-6c95b159f3fb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1321 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1321\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/eb627cc6-3a9d-46b5-96b7-5fca49178a37\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022eb627cc6-3a9d-46b5-96b7-5fca49178a37\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Log checkpoints should be enabled for PostgreSQL database servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy helps audit any PostgreSQL databases in your environment without log_checkpoints setting enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations\u0022,\u0022name\u0022:\u0022log_checkpoints\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations/value\u0022,\u0022equals\u0022:\u0022ON\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e43d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022eb6f77b9-bd53-4e35-a23d-7f65d5f0e43d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Log connections should be enabled for PostgreSQL database servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy helps audit any PostgreSQL databases in your environment without log_connections setting enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations\u0022,\u0022name\u0022:\u0022log_connections\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations/value\u0022,\u0022equals\u0022:\u0022ON\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e442\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022eb6f77b9-bd53-4e35-a23d-7f65d5f0e442\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Disconnections should be logged for PostgreSQL database servers.\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy helps audit any PostgreSQL databases in your environment without log_disconnections enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations\u0022,\u0022name\u0022:\u0022log_disconnections\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations/value\u0022,\u0022equals\u0022:\u0022ON\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e446\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022eb6f77b9-bd53-4e35-a23d-7f65d5f0e446\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Log duration should be enabled for PostgreSQL database servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy helps audit any PostgreSQL databases in your environment without log_duration setting enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforPostgreSQL/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations\u0022,\u0022name\u0022:\u0022log_duration\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.DBforPostgreSQL/servers/configurations/value\u0022,\u0022equals\u0022:\u0022ON\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/eb6f77b9-bd53-4e35-a23d-7f65d5f0e8f3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022eb6f77b9-bd53-4e35-a23d-7f65d5f0e8f3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deprecated accounts with owner permissions should be removed from your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Deprecated accounts with owner permissions should be removed from your subscription.  Deprecated accounts are accounts that have been blocked from signing in.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022RemoveDeprecatedAccountsWithOwnerPermissions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ebb62a0c-3560-49e1-89ed-27e074e9f8ad\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Linux VMs that allow remote connections from accounts without passwords\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Linux virtual machines that allow remote connections from accounts without passwords. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.2.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022PasswordPolicy_msid110\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022PasswordPolicy_msid110\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforLinux\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforLinux\u0022,\u0022typeHandlerVersion\u0022:\u00221.0\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ec49586f-4939-402d-a29e-6ff502b20592\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ec49586f-4939-402d-a29e-6ff502b20592\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Administrative Templates - Control Panel\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Administrative Templates - Control Panel\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_AdministrativeTemplatesControlPanel\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_AdministrativeTemplatesControlPanel\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ec7ac234-2af5-4729-94d2-c557c071799d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ec7ac234-2af5-4729-94d2-c557c071799d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1241 - User-Installed Software | Alerts For Unauthorized Installations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1241\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/eca4d7b2-65e2-4e04-95d4-c68606b063c3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022eca4d7b2-65e2-4e04-95d4-c68606b063c3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1622 - Boundary Protection\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1622\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ecf56554-164d-499a-8d00-206b07c27bed\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ecf56554-164d-499a-8d00-206b07c27bed\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Key Vault to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Key Vault to stream to a regional Event Hub when any Key Vault which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Key Vault\u0022},\u0022parameters\u0022:{\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022eventHubLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Location\u0022,\u0022description\u0022:\u0022The location the Event Hub resides in. Only Key Vaults in this location will be linked to this Event Hub.\u0022,\u0022strongType\u0022:\u0022location\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.KeyVault/vaults\u0022},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vaultName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.KeyVault/vaults/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vaultName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022AuditEvent\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{\u0022policy\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022value\u0022:\u0022[concat(\u0027Enabled diagnostic settings for \u0027, parameters(\u0027vaultName\u0027))]\u0022}}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022vaultName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ed7c8c13-51e7-49d1-8a43-8490431a0da2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ed7c8c13-51e7-49d1-8a43-8490431a0da2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1217 - Least Functionality | Periodic Review\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1217\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/edea4f20-b02c-4115-be75-86c080e5c0ed\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022edea4f20-b02c-4115-be75-86c080e5c0ed\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Stream Analytics to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Stream Analytics to stream to a regional Event Hub when any Stream Analytics which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_eventHub\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022eventHubLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Location\u0022,\u0022description\u0022:\u0022The location the Event Hub resides in. Only Stream Analytics in this location will be linked to this Event Hub.\u0022,\u0022strongType\u0022:\u0022location\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.StreamAnalytics/streamingjobs\u0022},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022Execution\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022Authoring\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/edf3780c-3d70-40fe-b17e-ab72013dafca\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022edf3780c-3d70-40fe-b17e-ab72013dafca\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1189 - Configuration Change Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1189\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ee45e02a-4140-416c-82c4-fecfea660b9d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ee45e02a-4140-416c-82c4-fecfea660b9d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1089 - Security Awareness Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Awareness and Training control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1089\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ef080e67-0d1a-4f76-a0c5-fb9b0358485e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ef080e67-0d1a-4f76-a0c5-fb9b0358485e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1314 - Identifier Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1314\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ef0c8530-efd9-45b8-b753-f03083d06295\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ef0c8530-efd9-45b8-b753-f03083d06295\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1128 - Time Stamps\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1128\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ef212163-3bc4-4e86-bcf8-705127086393\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ef212163-3bc4-4e86-bcf8-705127086393\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Vulnerability assessment should be enabled on your SQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit Azure SQL servers which do not have recurring vulnerability assessment scans enabled. Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/vulnerabilityAssessments\u0022,\u0022name\u0022:\u0022default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/servers/vulnerabilityAssessments/recurringScans.isEnabled\u0022,\u0022equals\u0022:\u0022True\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022API Management services should use a virtual network\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Virtual network on API Management services of the specified SKU should be enabled.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022API Management\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022},\u0022evaluatedSkuNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022API Management SKU Names\u0022,\u0022description\u0022:\u0022List of API Management SKUs against which this policy will be evaluated.\u0022},\u0022allowedValues\u0022:[\u0022Developer\u0022,\u0022Basic\u0022,\u0022Standard\u0022,\u0022Premium\u0022,\u0022Consumption\u0022],\u0022defaultValue\u0022:[\u0022Developer\u0022,\u0022Premium\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ApiManagement/service\u0022},{\u0022field\u0022:\u0022Microsoft.ApiManagement/service/sku.name\u0022,\u0022in\u0022:\u0022[parameters(\u0027evaluatedSkuNames\u0027)]\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.ApiManagement/service/virtualNetworkType\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.ApiManagement/service/virtualNetworkType\u0022,\u0022equals\u0022:\u0022None\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ef619a2c-cc4d-4d03-b2ba-8c94a834d85b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Diagnostic Settings for Event Hub to Event Hub\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Deploys the diagnostic settings for Event Hub to stream to a regional Event Hub when any Event Hub which is missing this diagnostic settings is created or updated.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022DeployIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022DeployIfNotExists\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Profile name\u0022,\u0022description\u0022:\u0022The diagnostic settings profile name\u0022},\u0022defaultValue\u0022:\u0022setbypolicy_eventHub\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Authorization Rule Id\u0022,\u0022description\u0022:\u0022The Event Hub authorization rule Id for Azure Diagnostics. The authorization rule needs to be at Event Hub namespace level. e.g. /subscriptions/{subscription Id}/resourceGroups/{resource group}/providers/Microsoft.EventHub/namespaces/{Event Hub namespace}/authorizationrules/{authorization rule}\u0022,\u0022strongType\u0022:\u0022Microsoft.EventHub/Namespaces/AuthorizationRules\u0022,\u0022assignPermissions\u0022:true}},\u0022eventHubLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Event Hub Destination Location\u0022,\u0022description\u0022:\u0022The location the Event Hub that will get diagnostic data resides in. Only source Event Hubs in this location will be linked to this destination Event Hub.\u0022,\u0022strongType\u0022:\u0022location\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable metrics\u0022,\u0022description\u0022:\u0022Whether to enable metrics stream to the Event Hub - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022False\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Enable logs\u0022,\u0022description\u0022:\u0022Whether to enable logs stream to the Event Hub  - True or False\u0022},\u0022allowedValues\u0022:[\u0022True\u0022,\u0022False\u0022],\u0022defaultValue\u0022:\u0022True\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.EventHub/namespaces\u0022},{\u0022anyOf\u0022:[{\u0022value\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022,\u0022equals\u0022:\u0022\u0022},{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022[parameters(\u0027eventHubLocation\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022name\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/metrics.enabled\u0022,\u0022equals\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022}]},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022eventHubRuleId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022metricsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logsEnabled\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022profileName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022type\u0022:\u0022Microsoft.EventHub/namespaces/providers/diagnosticSettings\u0022,\u0022apiVersion\u0022:\u00222017-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027resourceName\u0027), \u0027/\u0027, \u0027Microsoft.Insights/\u0027, parameters(\u0027profileName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022eventHubAuthorizationRuleId\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022,\u0022metrics\u0022:[{\u0022category\u0022:\u0022AllMetrics\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022,\u0022retentionPolicy\u0022:{\u0022enabled\u0022:false,\u0022days\u0022:0}}],\u0022logs\u0022:[{\u0022category\u0022:\u0022ArchiveLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022OperationalLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022AutoScaleLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022KafkaCoordinatorLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022EventHubVNetConnectionEvent\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},{\u0022category\u0022:\u0022CustomerManagedKeyUserLogs\u0022,\u0022enabled\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022}]}}],\u0022outputs\u0022:{}},\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022resourceName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022eventHubRuleId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027eventHubRuleId\u0027)]\u0022},\u0022metricsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027metricsEnabled\u0027)]\u0022},\u0022logsEnabled\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logsEnabled\u0027)]\u0022},\u0022profileName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027profileName\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ef7b61ef-b8e4-4c91-8e78-6946c6b0023f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ef7b61ef-b8e4-4c91-8e78-6946c6b0023f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1472 - Emergency Shutoff\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1472\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ef869332-921d-4c28-9402-3be73e6e50c8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ef869332-921d-4c28-9402-3be73e6e50c8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022The Log Analytics agent should be installed on Virtual Machine Scale Sets\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any Windows/Linux Virtual Machine Scale Sets if the Log Analytics agent is not installed.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/type\u0022,\u0022in\u0022:[\u0022MicrosoftMonitoringAgent\u0022,\u0022OmsAgentForLinux\u0022]},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/provisioningState\u0022,\u0022equals\u0022:\u0022Succeeded\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachineScaleSets/extensions/settings.workspaceId\u0022,\u0022exists\u0022:\u0022true\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/efbde977-ba53-4479-b8e9-10b957924fbf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022efbde977-ba53-4479-b8e9-10b957924fbf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1012 - Account Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1012\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/efd7b9ae-1db6-4eb6-b0fe-87e6565f9738\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022efd7b9ae-1db6-4eb6-b0fe-87e6565f9738\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1358 - Incident Response Testing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Incident Response control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1358\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/effbaeef-5bf4-400d-895e-ef8cbc0e64c7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022effbaeef-5bf4-400d-895e-ef8cbc0e64c7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Ensure that Register with Azure Active Directory is enabled on Function App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/web.managedServiceIdentityId\u0022,\u0022exists\u0022:\u0022true\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f0473e7a-a1ba-4e86-afb2-e829e11b01d8\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f0473e7a-a1ba-4e86-afb2-e829e11b01d8\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to audit Windows VMs that have the specified applications installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that have the specified applications installed. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022parameters\u0022:{\u0022ApplicationName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Application names (supports wildcards)\u0022,\u0022description\u0022:\u0022A semicolon-separated list of the names of the applications that should not be installed. e.g. \u0027Microsoft SQL Server 2014 (64-bit); Microsoft Visual Studio Code\u0027 or \u0027Microsoft SQL Server 2014*\u0027 (to match any application starting with \u0027Microsoft SQL Server 2014\u0027)\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022NotInstalledApplication\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[InstalledApplication]NotInstalledApplicationResource1;Name\u0027, \u0027=\u0027, parameters(\u0027ApplicationName\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022NotInstalledApplication\u0022},\u0022ApplicationName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027ApplicationName\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022ApplicationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[InstalledApplication]NotInstalledApplicationResource1;Name\u0022,\u0022value\u0022:\u0022[parameters(\u0027ApplicationName\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[InstalledApplication]NotInstalledApplicationResource1;Name\u0022,\u0022value\u0022:\u0022[parameters(\u0027ApplicationName\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f0633351-c7b2-41ff-9981-508fc08553c2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f0633351-c7b2-41ff-9981-508fc08553c2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1531 - Third-Party Personnel Security\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1531\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f0643e0c-eee5-4113-8684-c608d05c5236\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f0643e0c-eee5-4113-8684-c608d05c5236\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Latest TLS version should be used in your Web App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Upgrade to the latest TLS version\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022app*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/minTlsVersion\u0022,\u0022equals\u0022:\u00221.2\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Workflow Automation for Azure Security Center alerts\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enable automation of Azure Security Center alerts. This policy deploys a workflow automation with your conditions and triggers on the assigned scope. To deploy this policy on newly created subscriptions, open the Compliance tab, select the relevant non-compliant assignment and create a remediation task.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022automationName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Automation name\u0022,\u0022description\u0022:\u0022This is the automation name.\u0022}},\u0022resourceGroupName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource group name\u0022,\u0022description\u0022:\u0022The resource group name where the workflow automation is created. If you enter a name for a resource group that doesn\u0027t exist, it\u0027ll be created in the subscription.\u0022}},\u0022resourceGroupLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource group location\u0022,\u0022description\u0022:\u0022The location where the resource group and the workflow automation are created.\u0022,\u0022strongType\u0022:\u0022location\u0022}},\u0022alertName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Alert name contains\u0022,\u0022description\u0022:\u0022String included in the required alert name. For a full reference list of Security Center\u0027s alerts, see https://docs.microsoft.com/azure/security-center/alerts-reference.\u0022},\u0022defaultValue\u0022:\u0022\u0022},\u0022alertSeverities\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Alert severities\u0022,\u0022description\u0022:\u0022Determines alert severities. Example: High;Medium;Low;\u0022},\u0022allowedValues\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022],\u0022defaultValue\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022]},\u0022logicAppResourceId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Logic App\u0022,\u0022description\u0022:\u0022The Logic App that is triggered. If you do not already have a logic app, visit Logic Apps to create one (https://portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.Logic%2Fworkflows).\u0022,\u0022strongType\u0022:\u0022Microsoft.Logic/workflows\u0022,\u0022assignPermissions\u0022:true}},\u0022logicAppTrigger\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Logic app trigger\u0022,\u0022description\u0022:\u0022The trigger connector of the logic app that is triggered. Possible values: \u0027Manual (Incoming HTTP request)\u0027, \u0027When an Azure Security Center Alert is created or triggered\u0027.\u0022},\u0022allowedValues\u0022:[\u0022Manual (Incoming HTTP request)\u0022,\u0022When an Azure Security Center Alert is created or triggered\u0022]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/automations\u0022,\u0022name\u0022:\u0022[parameters(\u0027automationName\u0027)]\u0022,\u0022existenceScope\u0022:\u0022resourcegroup\u0022,\u0022ResourceGroupName\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022deploymentScope\u0022:\u0022subscription\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022location\u0022:\u0022westeurope\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022automationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022resourceGroupName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022resourceGroupLocation\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022alertName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022alertSeverities\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022logicAppResourceId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022logicAppTrigger\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022guidValue\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022[newGuid()]\u0022}},\u0022variables\u0022:{\u0022scopeDescription\u0022:\u0022scope for subscription {0}\u0022,\u0022alertSeveritiesLength\u0022:\u0022[length(parameters(\u0027alertSeverities\u0027))]\u0022,\u0022alertSeveritiesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027alertSeveritiesLength\u0027), 0), 1, variables(\u0027alertSeveritiesLength\u0027))]\u0022,\u0022severityMap\u0022:{\u0022High\u0022:\u0022high\u0022,\u0022Medium\u0022:\u0022medium\u0022,\u0022Low\u0022:\u0022low\u0022},\u0022triggerMap\u0022:{\u0022Manual (Incoming HTTP request)\u0022:\u0022manual\u0022,\u0022When an Azure Security Center Alert is created or triggered\u0022:\u0022When_an_Azure_Security_Center_Alert_is_created_or_triggered\u0022}},\u0022resources\u0022:[{\u0022name\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Resources/resourceGroups\u0022,\u0022apiVersion\u0022:\u00222019-10-01\u0022,\u0022location\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022,\u0022tags\u0022:{},\u0022properties\u0022:{}},{\u0022type\u0022:\u0022Microsoft.Resources/deployments\u0022,\u0022apiVersion\u0022:\u00222019-10-01\u0022,\u0022name\u0022:\u0022[concat(\u0027nestedAutomationDeployment\u0027, \u0027_\u0027, parameters(\u0027guidValue\u0027))]\u0022,\u0022resourceGroup\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022dependsOn\u0022:[\u0022[resourceId(\u0027Microsoft.Resources/resourceGroups/\u0027, parameters(\u0027resourceGroupName\u0027))]\u0022],\u0022properties\u0022:{\u0022mode\u0022:\u0022Incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022tags\u0022:{},\u0022apiVersion\u0022:\u00222019-01-01-preview\u0022,\u0022location\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022,\u0022name\u0022:\u0022[parameters(\u0027automationName\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Security/automations\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022description\u0022:\u0022Workflow Automation for Azure Security Center alerts via policy\u0022,\u0022isEnabled\u0022:true,\u0022scopes\u0022:[{\u0022description\u0022:\u0022[replace(variables(\u0027scopeDescription\u0027),\u0027{0}\u0027, subscription().subscriptionId)]\u0022,\u0022scopePath\u0022:\u0022[subscription().id]\u0022}],\u0022sources\u0022:[{\u0022eventSource\u0022:\u0022Alerts\u0022,\u0022copy\u0022:[{\u0022name\u0022:\u0022ruleSets\u0022,\u0022count\u0022:\u0022[variables(\u0027alertSeveritiesLengthIfEmpty\u0027)]\u0022,\u0022input\u0022:{\u0022rules\u0022:[{\u0022propertyJPath\u0022:\u0022[if(equals(parameters(\u0027alertName\u0027), \u0027\u0027), \u0027Version\u0027, \u0027AlertDisplayName\u0027)]\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[if(equals(parameters(\u0027alertName\u0027), \u0027\u0027), \u00273.\u0027, parameters(\u0027alertName\u0027))]\u0022,\u0022operator\u0022:\u0022Contains\u0022},{\u0022propertyJPath\u0022:\u0022Severity\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[variables(\u0027severityMap\u0027)[parameters(\u0027alertSeverities\u0027)[mod(copyIndex(\u0027ruleSets\u0027), variables(\u0027alertSeveritiesLengthIfEmpty\u0027))]]]\u0022,\u0022operator\u0022:\u0022Equals\u0022}]}}]}],\u0022actions\u0022:[{\u0022actionType\u0022:\u0022LogicApp\u0022,\u0022logicAppResourceId\u0022:\u0022[parameters(\u0027logicAppResourceId\u0027)]\u0022,\u0022uri\u0022:\u0022[listCallbackUrl(concat(parameters(\u0027logicAppResourceId\u0027), \u0027/triggers/\u0027, variables(\u0027triggerMap\u0027)[parameters(\u0027logicAppTrigger\u0027)]),\u00272016-06-01\u0027).value]\u0022}]}}]}}}]},\u0022parameters\u0022:{\u0022automationName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027automationName\u0027)]\u0022},\u0022resourceGroupName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022},\u0022resourceGroupLocation\u0022:{\u0022value\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022},\u0022alertName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027alertName\u0027)]\u0022},\u0022alertSeverities\u0022:{\u0022value\u0022:\u0022[parameters(\u0027alertSeverities\u0027)]\u0022},\u0022logicAppResourceId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logicAppResourceId\u0027)]\u0022},\u0022logicAppTrigger\u0022:{\u0022value\u0022:\u0022[parameters(\u0027logicAppTrigger\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f1525828-9a90-4fcf-be48-268cdd02361e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f1525828-9a90-4fcf-be48-268cdd02361e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1028 - Information Flow Enforcement\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1028\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f171df5c-921b-41e9-b12b-50801c315475\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f171df5c-921b-41e9-b12b-50801c315475\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Virtual networks should use specified virtual network gateway\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits any virtual network if the default route does not point to the specified virtual network gateway.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Network\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022virtualNetworkGatewayId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Virtual network gateway Id\u0022,\u0022description\u0022:\u0022Resource Id of the virtual network gateway. Example: /subscriptions/YourSubscriptionId/resourceGroups/YourResourceGroup/providers/Microsoft.Network/virtualNetworkGateways/Name\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/virtualNetworks\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Network/virtualNetworks/subnets\u0022,\u0022name\u0022:\u0022GatewaySubnet\u0022,\u0022existenceCondition\u0022:{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/virtualNetworks/subnets/ipConfigurations[*].id\u0022,\u0022notContains\u0022:\u0022[concat(parameters(\u0027virtualNetworkGatewayId\u0027), \u0027/\u0027)]\u0022}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f1776c76-f58c-4245-a8d0-2b207198dc8b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f1776c76-f58c-4245-a8d0-2b207198dc8b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Linux VMs that do not have the passwd file permissions set to 0644\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Linux virtual machines that do not have the passwd file permissions set to 0644. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.2.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022PasswordPolicy_msid121\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022PasswordPolicy_msid121\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforLinux\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforLinux\u0022,\u0022typeHandlerVersion\u0022:\u00221.0\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f19aa1c1-6b91-4c27-ae6a-970279f03db9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f19aa1c1-6b91-4c27-ae6a-970279f03db9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Administrative Templates - MSS (Legacy)\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Administrative Templates - MSS (Legacy)\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_AdminstrativeTemplatesMSSLegacy\u0022,\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_AdminstrativeTemplatesMSSLegacy\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f1f4825d-58fb-4257-8016-8c00e3c9ed9d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f1f4825d-58fb-4257-8016-8c00e3c9ed9d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1701 - Information System Monitoring | Host-Based Devices\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1701\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f25bc08f-27cb-43b6-9a23-014d00700426\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f25bc08f-27cb-43b6-9a23-014d00700426\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1457 - Physical Access Control\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1457\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f2d9d3e6-8886-4305-865d-639163e5c305\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f2d9d3e6-8886-4305-865d-639163e5c305\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1309 - Identification And Authentication (Org. Users) | Acceptance Of Piv Credentials\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1309\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f355d62b-39a8-4ba3-abf7-90f71cb3b000\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f355d62b-39a8-4ba3-abf7-90f71cb3b000\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1615 - System And Communications Protection Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1615\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f35e02aa-0a55-49f8-8811-8abfa7e6f2c0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f35e02aa-0a55-49f8-8811-8abfa7e6f2c0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1255 - Contingency Plan | Continue  Essential Missions / Business Functions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1255\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f3793f5e-937f-44f7-bfba-40647ef3efa0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f3793f5e-937f-44f7-bfba-40647ef3efa0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs in which the Administrators group does not contain all of the specified members\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines in which the Administrators group does not contain all of the specified members. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AdministratorsGroupMembersToInclude\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f3b44e5d-1456-475f-9c67-c66c4618e85a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f3b44e5d-1456-475f-9c67-c66c4618e85a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs that do not contain the specified certificates in Trusted Root\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows VMs that do not contain the specified certificates in the Trusted Root Certification Authorities certificate store (Cert:\\\\LocalMachine\\\\Root). For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsCertificateInTrustedRoot\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f3b9ad83-000d-4dc1-bff0-6d54533dd03f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f3b9ad83-000d-4dc1-bff0-6d54533dd03f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1706 - Security Alerts, Advisories, And Directives\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1706\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f475ee0e-f560-4c9b-876b-04a77460a404\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f475ee0e-f560-4c9b-876b-04a77460a404\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Audit Log Analytics workspace for VM - Report Mismatch\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Reports VMs as non-compliant if they aren\u0027t logging to the Log Analytics workspace specified in the policy/initiative assignment.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022logAnalyticsWorkspaceId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics Workspace Id that VMs should be configured for\u0022,\u0022description\u0022:\u0022This is the Id (GUID) of the Log Analytics Workspace that the VMs should be configured for.\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.EnterpriseCloud.Monitoring\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/settings.workspaceId\u0022,\u0022notEquals\u0022:\u0022[parameters(\u0027logAnalyticsWorkspaceId\u0027)]\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f47b5582-33ec-4c5c-87c0-b010a6b2e917\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Authorization rules on the Event Hub instance should be defined\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Audit existence of authorization rules on Event Hub entities to grant least-privileged access\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Event Hub\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.EventHub/namespaces/eventhubs\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.EventHub/namespaces/eventHubs/authorizationRules\u0022}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f4826e5f-6a27-407c-ae3e-9582eb39891d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f4826e5f-6a27-407c-ae3e-9582eb39891d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs that do not have the password complexity setting enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines that do not have the password complexity setting enabled. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022PasswordMustMeetComplexityRequirements\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f48b2913-1dc5-4834-8c72-ccc1dfd819bb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f48b2913-1dc5-4834-8c72-ccc1dfd819bb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1495 - System Security Plan\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1495\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f4978d0e-a596-48e7-9f8c-bbf52554ce8d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f4978d0e-a596-48e7-9f8c-bbf52554ce8d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs that have not restarted within the specified number of days\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines that have not restarted within the specified number of days. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022NumberOfDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Number of days\u0022,\u0022description\u0022:\u0022The number of days without restart until the machine is considered non-compliant\u0022},\u0022defaultValue\u0022:\u002212\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022MachineLastBootUpTime\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027[MachineUpTime]MachineLastBootUpTime;NumberOfDays\u0027, \u0027=\u0027, parameters(\u0027NumberOfDays\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022MachineLastBootUpTime\u0022},\u0022NumberOfDays\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NumberOfDays\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NumberOfDays\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[MachineUpTime]MachineLastBootUpTime;NumberOfDays\u0022,\u0022value\u0022:\u0022[parameters(\u0027NumberOfDays\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022[MachineUpTime]MachineLastBootUpTime;NumberOfDays\u0022,\u0022value\u0022:\u0022[parameters(\u0027NumberOfDays\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f4b245d4-46c9-42be-9b1a-49e2b5b94194\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f4b245d4-46c9-42be-9b1a-49e2b5b94194\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy Auditing on SQL servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy ensures that Auditing is enabled on SQL Servers for enhanced security and compliance. It will automatically create a storage account in the same region as the SQL server to store audit records.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022retentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022description\u0022:\u0022The value in days of the retention period (0 indicates unlimited retention)\u0022,\u0022displayName\u0022:\u0022Retention days (optional, 180 days if unspecified)\u0022},\u0022defaultValue\u0022:\u0022180\u0022},\u0022storageAccountsResourceGroup\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource group name for storage accounts\u0022,\u0022description\u0022:\u0022Auditing writes database events to an audit log in your Azure Storage account (a storage account will be created in each region where a SQL Server is created that will be shared by all servers in that region). Important - for proper operation of Auditing do not delete or rename the resource group or the storage accounts.\u0022,\u0022strongType\u0022:\u0022existingResourceGroups\u0022}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Sql/servers\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022DeployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Sql/servers/auditingSettings\u0022,\u0022name\u0022:\u0022Default\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Sql/auditingSettings.state\u0022,\u0022equals\u0022:\u0022Enabled\u0022},\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3\u0022,\u0022/providers/microsoft.authorization/roleDefinitions/17d1049b-9a84-46fb-8f53-869881c3d3ab\u0022],\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022serverName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022auditRetentionDays\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022storageAccountsResourceGroup\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022variables\u0022:{\u0022retentionDays\u0022:\u0022[int(parameters(\u0027auditRetentionDays\u0027))]\u0022,\u0022subscriptionId\u0022:\u0022[subscription().subscriptionId]\u0022,\u0022uniqueStorage\u0022:\u0022[uniqueString(variables(\u0027subscriptionId\u0027), parameters(\u0027location\u0027), parameters(\u0027storageAccountsResourceGroup\u0027))]\u0022,\u0022locationCode\u0022:\u0022[substring(parameters(\u0027location\u0027), 0, 3)]\u0022,\u0022storageName\u0022:\u0022[tolower(concat(\u0027sqlaudit\u0027, variables(\u0027locationCode\u0027), variables(\u0027uniqueStorage\u0027)))]\u0022,\u0022createStorageAccountDeploymentName\u0022:\u0022[concat(\u0027sqlServerAuditingStorageAccount-\u0027, uniqueString(variables(\u0027locationCode\u0027), parameters(\u0027serverName\u0027)))]\u0022},\u0022resources\u0022:[{\u0022apiVersion\u0022:\u00222017-05-10\u0022,\u0022name\u0022:\u0022[variables(\u0027createStorageAccountDeploymentName\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Resources/deployments\u0022,\u0022resourceGroup\u0022:\u0022[parameters(\u0027storageAccountsResourceGroup\u0027)]\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022Incremental\u0022,\u0022parameters\u0022:{\u0022location\u0022:{\u0022value\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},\u0022storageName\u0022:{\u0022value\u0022:\u0022[variables(\u0027storageName\u0027)]\u0022}},\u0022templateLink\u0022:{\u0022uri\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022}}},{\u0022name\u0022:\u0022[concat(parameters(\u0027serverName\u0027), \u0027/Default\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Sql/servers/auditingSettings\u0022,\u0022apiVersion\u0022:\u00222017-03-01-preview\u0022,\u0022properties\u0022:{\u0022state\u0022:\u0022Enabled\u0022,\u0022storageEndpoint\u0022:\u0022[reference(variables(\u0027createStorageAccountDeploymentName\u0027)).outputs.storageAccountEndPoint.value]\u0022,\u0022storageAccountAccessKey\u0022:\u0022[reference(variables(\u0027createStorageAccountDeploymentName\u0027)).outputs.storageAccountKey.value]\u0022,\u0022retentionDays\u0022:\u0022[variables(\u0027retentionDays\u0027)]\u0022,\u0022auditActionsAndGroups\u0022:null,\u0022storageAccountSubscriptionId\u0022:\u0022[subscription().subscriptionId]\u0022,\u0022isStorageSecondaryKeyInUse\u0022:false}}]},\u0022parameters\u0022:{\u0022serverName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022auditRetentionDays\u0022:{\u0022value\u0022:\u0022[parameters(\u0027retentionDays\u0027)]\u0022},\u0022storageAccountsResourceGroup\u0022:{\u0022value\u0022:\u0022[parameters(\u0027storageAccountsResourceGroup\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f4c68484-132f-41f9-9b6d-3e4b1cb55036\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1469 - Power Equipment And Cabling\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1469\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f509c5b6-0de0-4a4e-9b2e-cd9cbf3a58fd\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f509c5b6-0de0-4a4e-9b2e-cd9cbf3a58fd\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1618 - Security Function Isolation\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1618\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f52f89aa-4489-4ec4-950e-8c96a036baa9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f52f89aa-4489-4ec4-950e-8c96a036baa9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027Security Options - Network Access\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Network Access\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022NetworkAccessRemotelyAccessibleRegistryPaths\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network access: Remotely accessible registry paths\u0022,\u0022description\u0022:\u0022Specifies which registry paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the \u0060winreg\u0060 registry key.\u0022},\u0022defaultValue\u0022:\u0022System\\\\CurrentControlSet\\\\Control\\\\ProductOptions|#|System\\\\CurrentControlSet\\\\Control\\\\Server Applications|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\u0022},\u0022NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network access: Remotely accessible registry paths and sub-paths\u0022,\u0022description\u0022:\u0022Specifies which registry paths and sub-paths will be accessible over the network, regardless of the users or groups listed in the access control list (ACL) of the \u0060winreg\u0060 registry key.\u0022},\u0022defaultValue\u0022:\u0022System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Printers|#|System\\\\CurrentControlSet\\\\Services\\\\Eventlog|#|Software\\\\Microsoft\\\\OLAP Server|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows|#|System\\\\CurrentControlSet\\\\Control\\\\ContentIndex|#|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server|#|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\UserConfig|#|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\DefaultUserConfiguration|#|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib|#|System\\\\CurrentControlSet\\\\Services\\\\SysmonLog\u0022},\u0022NetworkAccessSharesThatCanBeAccessedAnonymously\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Network access: Shares that can be accessed anonymously\u0022,\u0022description\u0022:\u0022Specifies which network shares can be accessed by anonymous users. The default configuration for this policy setting has little effect because all users have to be authenticated before they can access shared resources on the server.\u0022},\u0022defaultValue\u0022:\u00220\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsNetworkAccess\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Network access: Remotely accessible registry paths;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027NetworkAccessRemotelyAccessibleRegistryPaths\u0027), \u0027,\u0027, \u0027Network access: Remotely accessible registry paths and sub-paths;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\u0027), \u0027,\u0027, \u0027Network access: Shares that can be accessed anonymously;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027NetworkAccessSharesThatCanBeAccessedAnonymously\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SecurityOptionsNetworkAccess\u0022},\u0022NetworkAccessRemotelyAccessibleRegistryPaths\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NetworkAccessRemotelyAccessibleRegistryPaths\u0027)]\u0022},\u0022NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\u0027)]\u0022},\u0022NetworkAccessSharesThatCanBeAccessedAnonymously\u0022:{\u0022value\u0022:\u0022[parameters(\u0027NetworkAccessSharesThatCanBeAccessedAnonymously\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NetworkAccessRemotelyAccessibleRegistryPaths\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022NetworkAccessSharesThatCanBeAccessedAnonymously\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Network access: Remotely accessible registry paths;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkAccessRemotelyAccessibleRegistryPaths\u0027)]\u0022},{\u0022name\u0022:\u0022Network access: Remotely accessible registry paths and sub-paths;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\u0027)]\u0022},{\u0022name\u0022:\u0022Network access: Shares that can be accessed anonymously;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkAccessSharesThatCanBeAccessedAnonymously\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Network access: Remotely accessible registry paths;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkAccessRemotelyAccessibleRegistryPaths\u0027)]\u0022},{\u0022name\u0022:\u0022Network access: Remotely accessible registry paths and sub-paths;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkAccessRemotelyAccessibleRegistryPathsAndSubpaths\u0027)]\u0022},{\u0022name\u0022:\u0022Network access: Shares that can be accessed anonymously;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027NetworkAccessSharesThatCanBeAccessedAnonymously\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f56a3ab2-89d1-44de-ac0d-2ada5962e22a\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f56a3ab2-89d1-44de-ac0d-2ada5962e22a\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1198 - Configuration Change Control | Security Representative\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1198\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f56be5c3-660b-4c61-9078-f67cf072c356\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f56be5c3-660b-4c61-9078-f67cf072c356\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1328 - Authenticator Management | Password-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1328\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f5c66fdc-3d02-4034-9db5-ba57802609de\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f5c66fdc-3d02-4034-9db5-ba57802609de\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1193 - Configuration Change Control | Automated Document / Notification / Prohibition Of Changes\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1193\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f5fd629f-3075-4cae-ab53-bad65495a4ac\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f5fd629f-3075-4cae-ab53-bad65495a4ac\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Internet-facing virtual machines should be protected with Network Security Groups\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Protect your VM from potential threats by restricting access to it with a Network Security Group (NSG). To learn more about controlling traffic with NSGs, visit https://aka.ms/nsg-doc\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Compute/virtualMachines\u0022,\u0022Microsoft.ClassicCompute/virtualMachines\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022networkSecurityGroupsOnVirtualMachines\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f6de0be7-9a8a-4b8a-b349-43cf02d22f7c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1214 - Least Functionality\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1214\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f714a4e2-b580-47b6-ae8c-f2812d3750f3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f714a4e2-b580-47b6-ae8c-f2812d3750f3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1591 - External Information System Services | Ident. Of Functions / Ports / Protocols / Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1591\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f751cdb7-fbee-406b-969b-815d367cb9b3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f751cdb7-fbee-406b-969b-815d367cb9b3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1330 - Authenticator Management | Password-Based Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1330\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f75cedb2-5def-4b31-973e-b69e8c7bd031\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f75cedb2-5def-4b31-973e-b69e8c7bd031\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1540 - Security Categorization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1540\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f771f8cb-6642-45cc-9a15-8a41cd5c6977\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f771f8cb-6642-45cc-9a15-8a41cd5c6977\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1449 - Physical Access Authorizations\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1449\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f784d3b0-5f2b-49b7-b9f3-00ba8653ced5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f784d3b0-5f2b-49b7-b9f3-00ba8653ced5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1506 - Personnel Security Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1506\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f7d2ff17-d604-4dd9-b607-9ecf63f28ad2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f7d2ff17-d604-4dd9-b607-9ecf63f28ad2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Windows VMs that do not have the specified Windows PowerShell execution policy\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines where Windows PowerShell is not configured to use the specified PowerShell execution policy. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022WindowsPowerShellExecutionPolicy\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f8036bd0-c10b-4931-86bb-94a878add855\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f8036bd0-c10b-4931-86bb-94a878add855\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1705 - Security Alerts, Advisories, And Directives\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1705\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f82e3639-fa2b-4e06-a786-932d8379b972\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f82e3639-fa2b-4e06-a786-932d8379b972\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022External accounts with owner permissions should be removed from your subscription\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022External accounts with owner permissions should be removed from your subscription in order to prevent unmonitored access.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022RemoveExternalAccountsWithOwnerPermissions\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f8456c1c-aa66-4dfb-861a-25d127b775c9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1345 - Cryptographic Module Authentication\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1345\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f86aa129-7c07-4aa4-bbf5-792d93ffd9ea\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f86aa129-7c07-4aa4-bbf5-792d93ffd9ea\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1065 - Remote Access | Privileged Commands / Access\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1065\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f87b8085-dca9-4cf1-8f7b-9822b997797c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f87b8085-dca9-4cf1-8f7b-9822b997797c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Deploy prerequisites to audit Windows VMs configurations in \u0027System Audit Policies - System\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a Guest Configuration assignment to audit Windows virtual machines with non-compliant settings in Group Policy category: \u0027System Audit Policies - System\u0027. It also creates a system-assigned managed identity and deploys the VM extension for Guest Configuration. This policy should only be used along with its corresponding audit policy in an initiative. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022],\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022AuditOtherSystemEvents\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Audit Other System Events\u0022,\u0022description\u0022:\u0022Specifies whether audit events are generated for Windows Firewall Service and Windows Firewall driver start and stop events, failure events for these services and Windows Firewall Service policy processing failures.\u0022},\u0022allowedValues\u0022:[\u0022No Auditing\u0022,\u0022Success\u0022,\u0022Failure\u0022,\u0022Success and Failure\u0022],\u0022defaultValue\u0022:\u0022No Auditing\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SystemAuditPoliciesSystem\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/parameterHash\u0022,\u0022equals\u0022:\u0022[base64(concat(\u0027Audit Other System Events;ExpectedValue\u0027, \u0027=\u0027, parameters(\u0027AuditOtherSystemEvents\u0027)))]\u0022},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022},\u0022type\u0022:{\u0022value\u0022:\u0022[field(\u0027type\u0027)]\u0022},\u0022configurationName\u0022:{\u0022value\u0022:\u0022AzureBaseline_SystemAuditPoliciesSystem\u0022},\u0022AuditOtherSystemEvents\u0022:{\u0022value\u0022:\u0022[parameters(\u0027AuditOtherSystemEvents\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022type\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022configurationName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022AuditOtherSystemEvents\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027microsoft.hybridcompute/machines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.HybridCompute/machines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Other System Events;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditOtherSystemEvents\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222018-11-20\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/providers/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/Microsoft.GuestConfiguration/\u0027, parameters(\u0027configurationName\u0027))]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022guestConfiguration\u0022:{\u0022name\u0022:\u0022[parameters(\u0027configurationName\u0027)]\u0022,\u0022version\u0022:\u00221.*\u0022,\u0022configurationParameter\u0022:[{\u0022name\u0022:\u0022Audit Other System Events;ExpectedValue\u0022,\u0022value\u0022:\u0022[parameters(\u0027AuditOtherSystemEvents\u0027)]\u0022}]}}},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022condition\u0022:\u0022[equals(toLower(parameters(\u0027type\u0027)), toLower(\u0027Microsoft.Compute/virtualMachines\u0027))]\u0022,\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforWindows\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforWindows\u0022,\u0022typeHandlerVersion\u0022:\u00221.1\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}},\u0022dependsOn\u0022:[\u0022[concat(\u0027Microsoft.Compute/virtualMachines/\u0027,parameters(\u0027vmName\u0027),\u0027/providers/Microsoft.GuestConfiguration/guestConfigurationAssignments/\u0027,parameters(\u0027configurationName\u0027))]\u0022]}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f8b0158d-4766-490f-bea0-259e52dba473\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f8b0158d-4766-490f-bea0-259e52dba473\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Service Bus should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Service Bus\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ServiceBus/namespaces\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f8d36e2f-389b-4ee4-898d-21aeb69a0f45\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1203 - Access Restrictions For Change | Automated Access Enforcement / Auditing\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1203\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f9012d14-e3e6-4d7b-b926-9f37b5537066\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f9012d14-e3e6-4d7b-b926-9f37b5537066\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1697 - Information System Monitoring | Analyze Traffic / Covert Exfiltration\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1697\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f9873db2-18ad-46b3-a11a-1a1f8cbf0335\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f9873db2-18ad-46b3-a11a-1a1f8cbf0335\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1478 - Fire Protection | Suppression Devices / Systems\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Physical and Environmental Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1478\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f997df46-cfbb-4cc8-aac8-3fecdaf6a183\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f997df46-cfbb-4cc8-aac8-3fecdaf6a183\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1535 - Personnel Sanctions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Personnel Security control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1535\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f9a165d2-967d-4733-8399-1074270dae2e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f9a165d2-967d-4733-8399-1074270dae2e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1108 - Content Of Audit Records | Additional Audit Information\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1108\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f9ad559e-c12d-415e-9a78-e50fdd7da7ba\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f9ad559e-c12d-415e-9a78-e50fdd7da7ba\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Diagnostic logs in Azure Stream Analytics should be enabled\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Audit enabling of diagnostic logs. This enables you to recreate activity trails to use for investigation purposes; when a security incident occurs or when your network is compromised\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.0\u0022,\u0022category\u0022:\u0022Stream Analytics\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022},\u0022requiredRetentionDays\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Required retention (days)\u0022,\u0022description\u0022:\u0022The required diagnostic logs retention in days\u0022},\u0022defaultValue\u0022:\u0022365\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.StreamAnalytics/streamingJobs\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Insights/diagnosticSettings\u0022,\u0022existenceCondition\u0022:{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*]\u0022,\u0022where\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u00220\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.days\u0022,\u0022equals\u0022:\u0022[parameters(\u0027requiredRetentionDays\u0027)]\u0022}]},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]},{\u0022allOf\u0022:[{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs[*].retentionPolicy.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}},{\u0022field\u0022:\u0022Microsoft.Insights/diagnosticSettings/logs.enabled\u0022,\u0022equals\u0022:\u0022true\u0022}]}]}},\u0022greaterOrEquals\u0022:1}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f9be5368-9bf5-4b84-9e0a-7850da98bb46\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Latest TLS version should be used in your Function App\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Upgrade to the latest TLS version\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022App Service\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Web/sites\u0022},{\u0022field\u0022:\u0022kind\u0022,\u0022like\u0022:\u0022functionapp*\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Web/sites/config\u0022,\u0022name\u0022:\u0022web\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Web/sites/config/minTlsVersion\u0022,\u0022equals\u0022:\u00221.2\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f9d614c5-c173-4d56-95a7-b4437057d193\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1280 - Telecommunications Services | Priority Of Service Provisions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Contingency Planning control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1280\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fa108498-b3a8-4ffb-9e79-1107e76afad3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fa108498-b3a8-4ffb-9e79-1107e76afad3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1037 - Least Privilege | Network Access To Privileged Commands\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1037\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fa4c2a3d-1294-41a3-9ada-0e540471e9fb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fa4c2a3d-1294-41a3-9ada-0e540471e9fb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1435 - Media Transport\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Media Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1435\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fa8d221b-d130-4637-ba16-501e666628bb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fa8d221b-d130-4637-ba16-501e666628bb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1675 - Flaw Remediation | Time To Remediate Flaws / Benchmarks For Corrective Actions\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1675\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/facb66e0-1c48-478a-bed5-747a312323e1\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022facb66e0-1c48-478a-bed5-747a312323e1\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy prerequisites to enable Guest Configuration Policy on Linux VMs.\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy creates a system-assigned managed identity and deploys the VM extension for Guest Configuration on Linux VMs. This is a prerequisite for Guest Configuration Policy and must be assigned to the scope before using any Guest Configuration policy. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.2.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022requiredProviders\u0022:[\u0022Microsoft.GuestConfiguration\u0022]},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022name\u0022:\u0022AzurePolicyforLinux\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/publisher\u0022,\u0022equals\u0022:\u0022Microsoft.GuestConfiguration\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/extensions/type\u0022,\u0022equals\u0022:\u0022ConfigurationforLinux\u0022}]},\u0022deployment\u0022:{\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022value\u0022:\u0022[field(\u0027name\u0027)]\u0022},\u0022location\u0022:{\u0022value\u0022:\u0022[field(\u0027location\u0027)]\u0022}},\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022vmName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022location\u0022:{\u0022type\u0022:\u0022string\u0022}},\u0022resources\u0022:[{\u0022apiVersion\u0022:\u00222019-07-01\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines\u0022,\u0022identity\u0022:{\u0022type\u0022:\u0022SystemAssigned\u0022},\u0022name\u0022:\u0022[parameters(\u0027vmName\u0027)]\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022},{\u0022apiVersion\u0022:\u00222015-05-01-preview\u0022,\u0022name\u0022:\u0022[concat(parameters(\u0027vmName\u0027), \u0027/AzurePolicyforLinux\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Compute/virtualMachines/extensions\u0022,\u0022location\u0022:\u0022[parameters(\u0027location\u0027)]\u0022,\u0022properties\u0022:{\u0022publisher\u0022:\u0022Microsoft.GuestConfiguration\u0022,\u0022type\u0022:\u0022ConfigurationforLinux\u0022,\u0022typeHandlerVersion\u0022:\u00221.0\u0022,\u0022autoUpgradeMinorVersion\u0022:true,\u0022settings\u0022:{},\u0022protectedSettings\u0022:{}}}]}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fb27e9e0-526e-4ae1-89f2-a2a0bf0f8a50\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fb27e9e0-526e-4ae1-89f2-a2a0bf0f8a50\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1086 - Publicly Accessible Content\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1086\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fb321e6f-16a0-4be3-878f-500956e309c5\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fb321e6f-16a0-4be3-878f-500956e309c5\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1222 - Information System Component Inventory\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Configuration Management control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1222\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fb39e62f-6bda-4558-8088-ec03d5670914\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fb39e62f-6bda-4558-8088-ec03d5670914\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Kubernetes Services should be upgraded to a non-vulnerable Kubernetes version\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Upgrade your Kubernetes service cluster to a later Kubernetes version to protect against known vulnerabilities in your current Kubernetes version. Vulnerability CVE-2019-9946 has been patched in Kubernetes versions 1.11.9\u002B, 1.12.7\u002B, 1.13.5\u002B, and 1.14.0\u002B\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-preview\u0022,\u0022category\u0022:\u0022Security Center\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022in\u0022:[\u00221.13.4\u0022,\u00221.13.3\u0022,\u00221.13.2\u0022,\u00221.13.1\u0022,\u00221.13.0\u0022]},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022in\u0022:[\u00221.12.6\u0022,\u00221.12.5\u0022,\u00221.12.4\u0022,\u00221.12.3\u0022,\u00221.12.2\u0022,\u00221.12.1\u0022,\u00221.12.0\u0022]},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022in\u0022:[\u00221.11.8\u0022,\u00221.11.7\u0022,\u00221.11.6\u0022,\u00221.11.5\u0022,\u00221.11.4\u0022,\u00221.11.3\u0022,\u00221.11.2\u0022,\u00221.11.1\u0022,\u00221.11.0\u0022]},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.10.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.9.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.8.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.7.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.6.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.5.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.4.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.3.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.2.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.1.*\u0022},{\u0022field\u0022:\u0022Microsoft.ContainerService/managedClusters/kubernetesVersion\u0022,\u0022Like\u0022:\u00221.0.*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fb893a29-21bb-418c-a157-e99480ec364c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fb893a29-21bb-418c-a157-e99480ec364c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Storage account containing the container with activity logs must be encrypted with BYOK\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy audits if the Storage account containing the container with activity logs is encrypted with BYOK. The policy works only if the storage account lies on the same subscription as activity logs by design. More information on Azure Storage encryption at rest can be found here https://aka.ms/azurestoragebyok. \u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Monitoring\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Insights/logProfiles\u0022},{\u0022field\u0022:\u0022Microsoft.Insights/logProfiles/storageAccountId\u0022,\u0022exists\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Storage/storageAccounts\u0022,\u0022existenceScope\u0022:\u0022subscription\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022value\u0022:\u0022[contains(field(\u0027Microsoft.Insights/logProfiles/storageAccountId\u0027), subscription().Id)]\u0022,\u0022equals\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022name\u0022,\u0022equals\u0022:\u0022[last(split(field(\u0027Microsoft.Insights/logProfiles/storageAccountId\u0027),\u0027/\u0027))]\u0022},{\u0022field\u0022:\u0022Microsoft.Storage/storageAccounts/encryption.keySource\u0022,\u0022equals\u0022:\u0022Microsoft.Keyvault\u0022}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fbb99e8e-e444-4da0-9ff1-75c92f5a85b2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fbb99e8e-e444-4da0-9ff1-75c92f5a85b2\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: All Internet traffic should be routed via your deployed Azure Firewall\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Azure Security Center has identified that some of your subnets aren\u0027t protected with a next generation firewall. Protect your subnets from potential threats by restricting access to them with Azure Firewall or a supported next generation firewall\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Network\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable All Internet traffic should be routed via your deployed Azure Firewall\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Network/virtualNetworks/subnets\u0022},{\u0022field\u0022:\u0022Microsoft.Network/virtualNetworks/subnets/routeTable\u0022,\u0022exists\u0022:false},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Network/virtualNetworks/subnets/ipConfigurations[*]\u0022},\u0022greaterOrEquals\u0022:2},{\u0022field\u0022:\u0022name\u0022,\u0022notIn\u0022:[\u0022AzureFirewallSubnet\u0022,\u0022GatewaySubnet\u0022,\u0022AzureBastionSubnet\u0022]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Network/networkSecurityGroups\u0022,\u0022existenceScope\u0022:\u0022Subscription\u0022,\u0022existenceCondition\u0022:{\u0022allOf\u0022:[{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/subnets[*]\u0022,\u0022where\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/subnets[*].id\u0022,\u0022like\u0022:\u0022[concat(\u0027/subscriptions/\u0027, subscription().subscriptionId, \u0027/resourceGroups/*/providers/Microsoft.Network/virtualNetworks/\u0027, first(split(field(\u0027fullName\u0027), \u0027/\u0027)), \u0027/subnets/\u0027, field(\u0027name\u0027))]\u0022}},\u0022equals\u0022:1},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*]\u0022,\u0022where\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*].direction\u0022,\u0022equals\u0022:\u0022Outbound\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*].access\u0022,\u0022equals\u0022:\u0022Deny\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*].destinationAddressPrefix\u0022,\u0022in\u0022:[\u0022*\u0022,\u0022Internet\u0022]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\u0022,\u0022in\u0022:[\u0022*\u0022,\u00220-65535\u0022]},{\u0022not\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges\u0022,\u0022notEquals\u0022:\u00220-65535\u0022}}]}]}},\u0022greater\u0022:0},{\u0022count\u0022:{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*]\u0022,\u0022where\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*].direction\u0022,\u0022equals\u0022:\u0022Outbound\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*].access\u0022,\u0022equals\u0022:\u0022Allow\u0022},{\u0022field\u0022:\u0022Microsoft.Network/networkSecurityGroups/securityRules[*].destinationAddressPrefix\u0022,\u0022in\u0022:[\u0022*\u0022,\u0022Internet\u0022]}]}},\u0022equals\u0022:0}]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fc5e4038-4584-4632-8c85-c0448d374b2c\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fc5e4038-4584-4632-8c85-c0448d374b2c\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1075 - Access Control For Mobile Devices | Full Device / Container-Based  Encryption\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Access Control control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1075\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fc933d22-04df-48ed-8f87-22a3773d4309\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fc933d22-04df-48ed-8f87-22a3773d4309\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Show audit results from Windows VMs configurations in \u0027Security Options - Microsoft Network Client\u0027\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Windows virtual machines with non-compliant settings in Group Policy category: \u0027Security Options - Microsoft Network Client\u0027. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022,\u0022preview\u0022:true},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022esri\u0022,\u0022incredibuild\u0022,\u0022MicrosoftDynamicsAX\u0022,\u0022MicrosoftSharepoint\u0022,\u0022MicrosoftVisualStudio\u0022,\u0022MicrosoftWindowsDesktop\u0022,\u0022MicrosoftWindowsServerHPCPack\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftWindowsServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022MicrosoftSQLServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022dsvm-windows\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022standard-data-science-vm\u0022,\u0022windows-data-science-vm\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022batch\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022rendering-windows2016\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022center-for-internet-security-inc\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022cis-windows-server-201*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022pivotal\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022bosh-windows-server*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloud-infrastructure-services\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022ad*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.windowsConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Windows*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00222008*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022notLike\u0022:\u0022SQL2008*\u0022}]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022windows*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022AzureBaseline_SecurityOptionsMicrosoftNetworkClient\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fcbc55c9-f25a-4e55-a6cb-33acb3be778b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fcbc55c9-f25a-4e55-a6cb-33acb3be778b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1318 - Authenticator Management\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1318\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fced5fda-3bdb-4d73-bfea-0e2c80428b66\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fced5fda-3bdb-4d73-bfea-0e2c80428b66\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1543 - Risk Assessment\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Risk Assessment control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1543\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fd00b778-b5b5-49c0-a994-734ea7bd3624\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fd00b778-b5b5-49c0-a994-734ea7bd3624\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1707 - Security Alerts, Advisories, And Directives | Automated Alerts And Advisories\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Information Integrity control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1707\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fd4a2ac8-868a-4702-a345-6c896c3361ce\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fd4a2ac8-868a-4702-a345-6c896c3361ce\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1299 - Identification And Authentication Policy And Procedures\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Identification and Authentication control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1299\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fd4e54f7-9ab0-4bae-b6cc-457809948a89\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fd4e54f7-9ab0-4bae-b6cc-457809948a89\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1627 - Boundary Protection | External Telecommunications Services\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Communications Protection control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1627\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fd73310d-76fc-422d-bda4-3a077149f179\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fd73310d-76fc-422d-bda4-3a077149f179\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1130 - Time Stamps | Synchronization With Authoritative Time Source\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Audit and Accountability control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1130\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fd7c4c1d-51ee-4349-9dab-89a7f8c8d102\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fd7c4c1d-51ee-4349-9dab-89a7f8c8d102\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Public network access should be disabled for MariaDB servers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022This policy audits MariaDB servers in your environment with public network access enabled. For more details, visit https://go.microsoft.com/fwlink/?linkid=2119542.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022SQL\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022Audit\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022Audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.DBforMariaDB/servers\u0022},{\u0022field\u0022:\u0022Microsoft.DBforMariaDB/servers/publicNetworkAccess\u0022,\u0022notEquals\u0022:\u0022Disabled\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fdccbe47-f3e3-4213-ad5d-ea459b2fa077\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1611 - Developer-Provided Training\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1611\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fdda8a0c-ac32-43f6-b2f4-7dc1df03f43f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fdda8a0c-ac32-43f6-b2f4-7dc1df03f43f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1405 - Maintenance Tools | Inspect Tools\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1405\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fe1a0bf3-409a-4b00-b60d-0b1f917f7e7b\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fe1a0bf3-409a-4b00-b60d-0b1f917f7e7b\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1613 - Developer Security Architecture And Design\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this System and Services Acquisition control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1613\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fe2ad78b-8748-4bff-a924-f74dfca93f30\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fe2ad78b-8748-4bff-a924-f74dfca93f30\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Show audit results from Linux VMs that do not have the specified applications installed\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022This policy should only be used along with its corresponding deploy policy in an initiative. This definition allows Azure Policy to process the results of auditing Linux virtual machines that do not have the specified applications installed. For more information on Guest Configuration policies, please visit https://aka.ms/gcpol\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.1.0\u0022,\u0022category\u0022:\u0022Guest Configuration\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Compute/virtualMachines\u0022},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022in\u0022:[\u0022microsoft-aks\u0022,\u0022AzureDatabricks\u0022,\u0022qubole-inc\u0022,\u0022datastax\u0022,\u0022couchbase\u0022,\u0022scalegrid\u0022,\u0022checkpoint\u0022,\u0022paloaltonetworks\u0022]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022OpenLogic\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022CentOS*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022RHEL\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022RedHat\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022osa\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022credativ\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022Debian\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00227*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Suse\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022SLES*\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002211*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022Canonical\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022UbuntuServer\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u002212*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-dsvm\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022in\u0022:[\u0022linux-data-science-vm-ubuntu\u0022,\u0022azureml\u0022]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-centos-os\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageSKU\u0022,\u0022notLike\u0022:\u00226*\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022cloudera\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022equals\u0022:\u0022cloudera-altus-centos-os\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022equals\u0022:\u0022microsoft-ads\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]},{\u0022allOf\u0022:[{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/osProfile.linuxConfiguration\u0022,\u0022exists\u0022:\u0022true\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/virtualMachines/storageProfile.osDisk.osType\u0022,\u0022like\u0022:\u0022Linux*\u0022}]},{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022exists\u0022:\u0022false\u0022},{\u0022field\u0022:\u0022Microsoft.Compute/imagePublisher\u0022,\u0022notIn\u0022:[\u0022OpenLogic\u0022,\u0022RedHat\u0022,\u0022credativ\u0022,\u0022Suse\u0022,\u0022Canonical\u0022,\u0022microsoft-dsvm\u0022,\u0022cloudera\u0022,\u0022microsoft-ads\u0022]}]}]}]}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.HybridCompute/machines\u0022},{\u0022field\u0022:\u0022Microsoft.HybridCompute/imageOffer\u0022,\u0022like\u0022:\u0022linux*\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022auditIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments\u0022,\u0022name\u0022:\u0022installed_application_linux\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.GuestConfiguration/guestConfigurationAssignments/complianceStatus\u0022,\u0022equals\u0022:\u0022Compliant\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fee5cb2b-9d9b-410e-afe3-2902d90d0004\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fee5cb2b-9d9b-410e-afe3-2902d90d0004\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Vulnerabilities on your SQL databases should be remediated\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Monitor Vulnerability Assessment scan results and recommendations for how to remediate database vulnerabilities.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022AuditIfNotExists\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022AuditIfNotExists\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Sql/servers/databases\u0022,\u0022Microsoft.Sql/managedinstances/databases\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/complianceResults\u0022,\u0022name\u0022:\u0022sqlVulnerabilityAssessment\u0022,\u0022existenceCondition\u0022:{\u0022field\u0022:\u0022Microsoft.Security/complianceResults/resourceStatus\u0022,\u0022in\u0022:[\u0022OffByPolicy\u0022,\u0022Healthy\u0022]}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022feedbf84-6b99-488c-acc2-71c829aa5ffc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1407 - Maintenance Tools | Prevent Unauthorized Removal\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Maintenance control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1407\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ff9fbd83-1d8d-4b41-aac2-94cb44b33976\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ff9fbd83-1d8d-4b41-aac2-94cb44b33976\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Deploy export to Log Analytics workspace for Azure Security Center alerts and recommendations\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022All\u0022,\u0022description\u0022:\u0022Enable export to Log Analytics workspace of Azure Security Center alerts and/or recommendations. This policy deploys an export to Log Analytics workspace configuration with your conditions and target workspace on the assigned scope. To deploy this policy on newly created subscriptions, open the Compliance tab, select the relevant non-compliant assignment and create a remediation task.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Security Center\u0022},\u0022parameters\u0022:{\u0022resourceGroupName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource group name\u0022,\u0022description\u0022:\u0022The resource group name where the export to Log Analytics workspace configuration is created. If you enter a name for a resource group that doesn\u0027t exist, it\u0027ll be created in the subscription. Note that each resource group can only have one export to Log Analytics workspace configured.\u0022}},\u0022resourceGroupLocation\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Resource group location\u0022,\u0022description\u0022:\u0022The location where the resource group and the export to Log Analytics workspace configuration are created.\u0022,\u0022strongType\u0022:\u0022location\u0022}},\u0022exportedDataTypes\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Exported data types\u0022,\u0022description\u0022:\u0022The data types to be exported. Example: Security recommendations;Security alerts;\u0022},\u0022allowedValues\u0022:[\u0022Security recommendations\u0022,\u0022Security alerts\u0022],\u0022defaultValue\u0022:[\u0022Security recommendations\u0022,\u0022Security alerts\u0022]},\u0022recommendationNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Recommendation IDs\u0022,\u0022description\u0022:\u0022Applicable only for export of security recommendations. To export all recommendations, leave this empty. To export specific recommendations, enter a list of recommendation IDs separated by semicolons (\u0027;\u0027). Recommendation IDs are available through the Assessments API (https://docs.microsoft.com/rest/api/securitycenter/assessments), or Azure Resource Graph Explorer (https://portal.azure.com/#blade/HubsExtension/ArgQueryBlade), choose securityresources and microsoft.security/assessments.\u0022},\u0022defaultValue\u0022:[]},\u0022recommendationSeverities\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Recommendation severities\u0022,\u0022description\u0022:\u0022Applicable only for export of security recommendations. Determines recommendation severities. Example: High;Medium;Low;\u0022},\u0022allowedValues\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022],\u0022defaultValue\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022]},\u0022alertSeverities\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Alert severities\u0022,\u0022description\u0022:\u0022Applicable only for export of security alerts. Determines alert severities. Example: High;Medium;Low;\u0022},\u0022allowedValues\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022],\u0022defaultValue\u0022:[\u0022High\u0022,\u0022Medium\u0022,\u0022Low\u0022]},\u0022workspaceResourceId\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log Analytics workspace\u0022,\u0022description\u0022:\u0022The Log Analytics workspace of where the data should be exported to. If you do not already have a log analytics workspace, visit Log Analytics workspaces to create one (https://portal.azure.com/#blade/HubsExtension/BrowseResource/resourceType/Microsoft.OperationalInsights%2Fworkspaces).\u0022,\u0022strongType\u0022:\u0022Microsoft.OperationalInsights/workspaces\u0022,\u0022assignPermissions\u0022:true}}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.Resources/subscriptions\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deployIfNotExists\u0022,\u0022details\u0022:{\u0022type\u0022:\u0022Microsoft.Security/automations\u0022,\u0022name\u0022:\u0022ExportToWorkspace\u0022,\u0022existenceScope\u0022:\u0022resourcegroup\u0022,\u0022ResourceGroupName\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022deploymentScope\u0022:\u0022subscription\u0022,\u0022roleDefinitionIds\u0022:[\u0022/providers/microsoft.authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\u0022],\u0022deployment\u0022:{\u0022location\u0022:\u0022westeurope\u0022,\u0022properties\u0022:{\u0022mode\u0022:\u0022incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{\u0022resourceGroupName\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022resourceGroupLocation\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022exportedDataTypes\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022recommendationNames\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022recommendationSeverities\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022alertSeverities\u0022:{\u0022type\u0022:\u0022array\u0022},\u0022workspaceResourceId\u0022:{\u0022type\u0022:\u0022string\u0022},\u0022guidValue\u0022:{\u0022type\u0022:\u0022string\u0022,\u0022defaultValue\u0022:\u0022[newGuid()]\u0022}},\u0022variables\u0022:{\u0022scopeDescription\u0022:\u0022scope for subscription {0}\u0022,\u0022recommendationNamesLength\u0022:\u0022[length(parameters(\u0027recommendationNames\u0027))]\u0022,\u0022recommendationSeveritiesLength\u0022:\u0022[length(parameters(\u0027recommendationSeverities\u0027))]\u0022,\u0022alertSeveritiesLength\u0022:\u0022[length(parameters(\u0027alertSeverities\u0027))]\u0022,\u0022recommendationNamesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027recommendationNamesLength\u0027), 0), 1, variables(\u0027recommendationNamesLength\u0027))]\u0022,\u0022recommendationSeveritiesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027recommendationSeveritiesLength\u0027), 0), 1, variables(\u0027recommendationSeveritiesLength\u0027))]\u0022,\u0022alertSeveritiesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027alertSeveritiesLength\u0027), 0), 1, variables(\u0027alertSeveritiesLength\u0027))]\u0022,\u0022totalRuleCombinationsForOneRecommendationName\u0022:\u0022[variables(\u0027recommendationSeveritiesLengthIfEmpty\u0027)]\u0022,\u0022totalRuleCombinationsForOneRecommendationSeverity\u0022:1,\u0022exportedDataTypesLength\u0022:\u0022[length(parameters(\u0027exportedDataTypes\u0027))]\u0022,\u0022exportedDataTypesLengthIfEmpty\u0022:\u0022[if(equals(variables(\u0027exportedDataTypesLength\u0027), 0), 1, variables(\u0027exportedDataTypesLength\u0027))]\u0022,\u0022dataTypeMap\u0022:{\u0022Security recommendations\u0022:\u0022Assessments\u0022,\u0022Security alerts\u0022:\u0022Alerts\u0022},\u0022alertSeverityMap\u0022:{\u0022High\u0022:\u0022high\u0022,\u0022Medium\u0022:\u0022medium\u0022,\u0022Low\u0022:\u0022low\u0022},\u0022ruleSetsForAssessmentsObj\u0022:{\u0022copy\u0022:[{\u0022name\u0022:\u0022ruleSetsForAssessmentsArr\u0022,\u0022count\u0022:\u0022[mul(variables(\u0027recommendationNamesLengthIfEmpty\u0027),variables(\u0027recommendationSeveritiesLengthIfEmpty\u0027))]\u0022,\u0022input\u0022:{\u0022rules\u0022:[{\u0022propertyJPath\u0022:\u0022[if(equals(variables(\u0027recommendationNamesLength\u0027),0),\u0027type\u0027,\u0027name\u0027)]\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[if(equals(variables(\u0027recommendationNamesLength\u0027),0),\u0027Microsoft.Security/assessments\u0027,parameters(\u0027recommendationNames\u0027)[mod(div(copyIndex(\u0027ruleSetsForAssessmentsArr\u0027),variables(\u0027totalRuleCombinationsForOneRecommendationName\u0027)),variables(\u0027recommendationNamesLength\u0027))])]\u0022,\u0022operator\u0022:\u0022Contains\u0022},{\u0022propertyJPath\u0022:\u0022properties.metadata.severity\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[parameters(\u0027recommendationSeverities\u0027)[mod(div(copyIndex(\u0027ruleSetsForAssessmentsArr\u0027),variables(\u0027totalRuleCombinationsForOneRecommendationSeverity\u0027)),variables(\u0027recommendationSeveritiesLength\u0027))]]\u0022,\u0022operator\u0022:\u0022Equals\u0022}]}}]},\u0022ruleSetsForAlertsObj\u0022:{\u0022copy\u0022:[{\u0022name\u0022:\u0022ruleSetsForAlertsArr\u0022,\u0022count\u0022:\u0022[variables(\u0027alertSeveritiesLengthIfEmpty\u0027)]\u0022,\u0022input\u0022:{\u0022rules\u0022:[{\u0022propertyJPath\u0022:\u0022Severity\u0022,\u0022propertyType\u0022:\u0022string\u0022,\u0022expectedValue\u0022:\u0022[variables(\u0027alertSeverityMap\u0027)[parameters(\u0027alertSeverities\u0027)[mod(copyIndex(\u0027ruleSetsForAlertsArr\u0027),variables(\u0027alertSeveritiesLengthIfEmpty\u0027))]]]\u0022,\u0022operator\u0022:\u0022Equals\u0022}]}}]}},\u0022resources\u0022:[{\u0022name\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022type\u0022:\u0022Microsoft.Resources/resourceGroups\u0022,\u0022apiVersion\u0022:\u00222019-10-01\u0022,\u0022location\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022,\u0022tags\u0022:{},\u0022properties\u0022:{}},{\u0022type\u0022:\u0022Microsoft.Resources/deployments\u0022,\u0022apiVersion\u0022:\u00222019-10-01\u0022,\u0022name\u0022:\u0022[concat(\u0027nestedAutomationDeployment\u0027, \u0027_\u0027, parameters(\u0027guidValue\u0027))]\u0022,\u0022resourceGroup\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022,\u0022dependsOn\u0022:[\u0022[resourceId(\u0027Microsoft.Resources/resourceGroups/\u0027, parameters(\u0027resourceGroupName\u0027))]\u0022],\u0022properties\u0022:{\u0022mode\u0022:\u0022Incremental\u0022,\u0022template\u0022:{\u0022$schema\u0022:\u0022https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\u0022,\u0022contentVersion\u0022:\u00221.0.0.0\u0022,\u0022parameters\u0022:{},\u0022variables\u0022:{},\u0022resources\u0022:[{\u0022tags\u0022:{},\u0022apiVersion\u0022:\u00222019-01-01-preview\u0022,\u0022location\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022,\u0022name\u0022:\u0022ExportToWorkspace\u0022,\u0022type\u0022:\u0022Microsoft.Security/automations\u0022,\u0022dependsOn\u0022:[],\u0022properties\u0022:{\u0022description\u0022:\u0022Export Azure Security Center alerts and/or recommendations to Log Analytics workspace via policy\u0022,\u0022isEnabled\u0022:true,\u0022scopes\u0022:[{\u0022description\u0022:\u0022[replace(variables(\u0027scopeDescription\u0027),\u0027{0}\u0027, subscription().subscriptionId)]\u0022,\u0022scopePath\u0022:\u0022[subscription().id]\u0022}],\u0022copy\u0022:[{\u0022name\u0022:\u0022sources\u0022,\u0022count\u0022:\u0022[variables(\u0027exportedDataTypesLengthIfEmpty\u0027)]\u0022,\u0022input\u0022:{\u0022eventSource\u0022:\u0022[variables(\u0027dataTypeMap\u0027)[parameters(\u0027exportedDataTypes\u0027)[copyIndex(\u0027sources\u0027)]]]\u0022,\u0022ruleSets\u0022:\u0022[if(equals(parameters(\u0027exportedDataTypes\u0027)[copyIndex(\u0027sources\u0027)], \u0027Security recommendations\u0027), variables(\u0027ruleSetsForAssessmentsObj\u0027).ruleSetsForAssessmentsArr, variables(\u0027ruleSetsForAlertsObj\u0027).ruleSetsForAlertsArr)]\u0022}}],\u0022actions\u0022:[{\u0022actionType\u0022:\u0022Workspace\u0022,\u0022workspaceResourceId\u0022:\u0022[parameters(\u0027workspaceResourceId\u0027)]\u0022}]}}]}}}]},\u0022parameters\u0022:{\u0022resourceGroupName\u0022:{\u0022value\u0022:\u0022[parameters(\u0027resourceGroupName\u0027)]\u0022},\u0022resourceGroupLocation\u0022:{\u0022value\u0022:\u0022[parameters(\u0027resourceGroupLocation\u0027)]\u0022},\u0022exportedDataTypes\u0022:{\u0022value\u0022:\u0022[parameters(\u0027exportedDataTypes\u0027)]\u0022},\u0022recommendationNames\u0022:{\u0022value\u0022:\u0022[parameters(\u0027recommendationNames\u0027)]\u0022},\u0022recommendationSeverities\u0022:{\u0022value\u0022:\u0022[parameters(\u0027recommendationSeverities\u0027)]\u0022},\u0022alertSeverities\u0022:{\u0022value\u0022:\u0022[parameters(\u0027alertSeverities\u0027)]\u0022},\u0022workspaceResourceId\u0022:{\u0022value\u0022:\u0022[parameters(\u0027workspaceResourceId\u0027)]\u0022}}}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/ffb6f416-7bd2-4488-8828-56585fef2be9\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022ffb6f416-7bd2-4488-8828-56585fef2be9\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022Microsoft Managed Control 1158 - Security Authorization\u0022,\u0022policyType\u0022:\u0022Static\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022description\u0022:\u0022Microsoft implements this Security Assessment and Authorization control\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0\u0022,\u0022category\u0022:\u0022Regulatory Compliance\u0022,\u0022additionalMetadataId\u0022:\u0022/providers/Microsoft.PolicyInsights/policyMetadata/ACF1158\u0022},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022Microsoft.Resources/subscriptions\u0022,\u0022Microsoft.Resources/subscriptions/resourceGroups\u0022]},{\u0022value\u0022:\u0022false\u0022,\u0022equals\u0022:\u0022true\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022audit\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/fff50cf2-28eb-45b4-b378-c99412688907\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022fff50cf2-28eb-45b4-b378-c99412688907\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Manage certificate validity period\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.KeyVault.Data\u0022,\u0022description\u0022:\u0022This policy manages the maximum validity period for certificates in months.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Key Vault\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022maximumValidityInMonths\u0022:{\u0022type\u0022:\u0022Integer\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: The maximum validity in months\u0022,\u0022description\u0022:\u0022The limit to how long a certificate may be valid for. Certificates with lengthy validity periods aren\u0027t best practice.\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022audit\u0022,\u0022deny\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/properties.validityInMonths\u0022,\u0022greater\u0022:\u0022[parameters(\u0027maximumValidityInMonths\u0027)]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220a075868-4c26-42ef-914c-5bc007359560\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Limited Preview]: [AKS] Ensure containers listen only on allowed ports in AKS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.ContainerService.Data\u0022,\u0022description\u0022:\u0022This policy enforces containers to listen only on allowed ports in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022allowedContainerPortsRegex\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allowed container ports regex\u0022,\u0022description\u0022:\u0022Regex representing container ports allowed in Kubernetes cluster. E.g. Regex for allowing ports 443,446 is ^(443|446)$\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022EnforceRegoPolicy\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022EnforceRegoPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022policyId\u0022:\u0022ContainerAllowedPorts\u0022,\u0022policy\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-allowed-ports/limited-preview/gatekeeperpolicy.rego\u0022,\u0022policyParameters\u0022:{\u0022allowedContainerPortsRegex\u0022:\u0022[parameters(\u0027allowedContainerPortsRegex\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/0f636243-1b1c-4d50-880f-310f6199f2cb\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00220f636243-1b1c-4d50-880f-310f6199f2cb\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Manage allowed certificate key types\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.KeyVault.Data\u0022,\u0022description\u0022:\u0022This policy manages the allowed key types for certificates.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Key Vault\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022allowedKeyTypes\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allowed key types\u0022,\u0022description\u0022:\u0022The list of allowed certificate key types.\u0022},\u0022allowedValues\u0022:[\u0022RSA\u0022,\u0022RSA-HSM\u0022,\u0022EC\u0022,\u0022EC-HSM\u0022],\u0022defaultValue\u0022:[\u0022RSA\u0022,\u0022RSA-HSM\u0022]},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022audit\u0022,\u0022deny\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/keyProperties.keyType\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027allowedKeyTypes\u0027)]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1151cede-290b-4ba0-8b38-0ad145ac888f\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221151cede-290b-4ba0-8b38-0ad145ac888f\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Manage certificate lifetime action triggers\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.KeyVault.Data\u0022,\u0022description\u0022:\u0022This policy manages the configuration for certificate lifetime action triggers before certificate expiration.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Key Vault\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022maximumPercentageLife\u0022:{\u0022type\u0022:\u0022Integer\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: The maximum lifetime percentage\u0022,\u0022description\u0022:\u0022Enter the percentage of lifetime of the certificate when you want to trigger the policy action. For example, to trigger a policy action at 80% of the certificate\u0027s valid life, enter \u002780\u0027.\u0022}},\u0022minimumDaysBeforeExpiry\u0022:{\u0022type\u0022:\u0022Integer\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: The minimum days before expiry\u0022,\u0022description\u0022:\u0022Enter the days before expiration of the certificate when you want to trigger the policy action. For example, to trigger a policy action 90 days before the certificate\u0027s expiration, enter \u002790\u0027.\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022audit\u0022,\u0022deny\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/lifetimeAction.daysBeforeExpiry\u0022,\u0022exists\u0022:true},{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/lifetimeAction.daysBeforeExpiry\u0022,\u0022less\u0022:\u0022[parameters(\u0027minimumDaysBeforeExpiry\u0027)]\u0022}]},{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/lifetimeAction.lifetimePercentage\u0022,\u0022exists\u0022:true},{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/lifetimeAction.lifetimePercentage\u0022,\u0022greater\u0022:\u0022[parameters(\u0027maximumPercentageLife\u0027)]\u0022}]}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/12ef42cb-9903-4e39-9c26-422d29570417\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002212ef42cb-9903-4e39-9c26-422d29570417\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Limited Preview]: [AKS] Enforce labels on pods in AKS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.ContainerService.Data\u0022,\u0022description\u0022:\u0022This policy enforces the specified labels are provided for pods in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022commaSeparatedListOfLabels\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Comma-separated list of labels\u0022,\u0022description\u0022:\u0022A comma-separated list of labels to be specified on Pods in Kubernetes cluster. E.g. test1,test2\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022EnforceRegoPolicy\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022EnforceRegoPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022policyId\u0022:\u0022PodEnforceLabels\u0022,\u0022policy\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/pod-enforce-labels/limited-preview/gatekeeperpolicy.rego\u0022,\u0022policyParameters\u0022:{\u0022commaSeparatedListOfLabels\u0022:\u0022[parameters(\u0027commaSeparatedListOfLabels\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/16c6ca72-89d2-4798-b87e-496f9de7fcb7\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002216c6ca72-89d2-4798-b87e-496f9de7fcb7\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Enforce HTTPS ingress in Kubernetes cluster\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.Kubernetes.Data\u0022,\u0022description\u0022:\u0022This policy enforces HTTPS ingress in a Kubernetes cluster. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00223.0.0-preview\u0022,\u0022category\u0022:\u0022Kubernetes\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022enforceOPAConstraint\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceOPAConstraint\u0022},\u0022excludedNamespaces\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Namespace exclusions\u0022,\u0022description\u0022:\u0022List of Kubernetes namespaces to exclude from policy evaluation. Providing a value for this parameter is optional.\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022AKS Engine\u0022,\u0022Microsoft.Kubernetes/connectedClusters\u0022,\u0022Microsoft.ContainerService/managedClusters\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022constraintTemplate\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/ingress-https-only/template.yaml\u0022,\u0022constraint\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/ingress-https-only/constraint.yaml\u0022,\u0022values\u0022:{\u0022excludedNamespaces\u0022:\u0022[parameters(\u0027excludedNamespaces\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221a5b4dca-0b6f-4cf5-907c-56316bc1bf3d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Configure log filter expressions and datastore to be used for full logs for specified Azure Machine Learning computes\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.MachineLearningServices.Data\u0022,\u0022description\u0022:\u0022This policy helps provide log filter expression and datastore to be used for full logs in specified Azure Machine Learning computes and can be assigned at the workspace. For more information, visit https://aka.ms/amlpolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Machine Learning\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022computeNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Compute names where Azure ML jobs run\u0022,\u0022description\u0022:\u0022List of compute names where this policy should be applied. Ex. cpu-cluster;gpu-cluster. If no value is provided to this parameter then policy is applicable to all computes.\u0022},\u0022defaultValue\u0022:[]},\u0022logFilters\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Log filter expressions\u0022,\u0022description\u0022:\u0022List of log filter expressions used to filter logs. Ex. ^prefix1.*$\u0022},\u0022defaultValue\u0022:[]},\u0022datastore\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Datastore\u0022,\u0022description\u0022:\u0022Datastore used to store filtered logs. Ex. LogsDatastore which is configured in AML.\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy.\u0022},\u0022allowedValues\u0022:[\u0022enforceSetting\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceSetting\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.MachineLearningServices.Data/workspaces/computes/name\u0022,\u0022in\u0022:\u0022[parameters(\u0027computeNames\u0027)]\u0022},{\u0022value\u0022:\u0022[length(parameters(\u0027computeNames\u0027))]\u0022,\u0022equals\u0022:0}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022setting\u0022:{\u0022name\u0022:\u0022logFilter\u0022,\u0022value\u0022:{\u0022filters\u0022:\u0022[parameters(\u0027logFilters\u0027)]\u0022,\u0022datastore\u0022:\u0022[parameters(\u0027datastore\u0027)]\u0022}}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/1d413020-63de-11ea-bc55-0242ac130003\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00221d413020-63de-11ea-bc55-0242ac130003\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Ensure services listen only on allowed ports in Kubernetes cluster\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.Kubernetes.Data\u0022,\u0022description\u0022:\u0022This policy enforces services to listen only on allowed ports in a Kubernetes cluster. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00223.0.0-preview\u0022,\u0022category\u0022:\u0022Kubernetes\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022allowedServicePortsList\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allowed service ports list\u0022,\u0022description\u0022:\u0022The list of service ports allowed in a Kubernetes cluster.\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022enforceOPAConstraint\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceOPAConstraint\u0022},\u0022excludedNamespaces\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Namespace exclusions\u0022,\u0022description\u0022:\u0022List of Kubernetes namespaces to exclude from policy evaluation. Providing a value for this parameter is optional.\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022AKS Engine\u0022,\u0022Microsoft.Kubernetes/connectedClusters\u0022,\u0022Microsoft.ContainerService/managedClusters\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022constraintTemplate\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/service-allowed-ports/template.yaml\u0022,\u0022constraint\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/service-allowed-ports/constraint.yaml\u0022,\u0022values\u0022:{\u0022allowedServicePorts\u0022:\u0022[parameters(\u0027allowedServicePortsList\u0027)]\u0022,\u0022excludedNamespaces\u0022:\u0022[parameters(\u0027excludedNamespaces\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/233a2a17-77ca-4fb1-9b6b-69223d272a44\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022233a2a17-77ca-4fb1-9b6b-69223d272a44\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Limited Preview]: [AKS] Ensure services listen only on allowed ports in AKS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.ContainerService.Data\u0022,\u0022description\u0022:\u0022This policy enforces services to listen only on allowed ports in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022allowedServicePortsRegex\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allowed service ports regex\u0022,\u0022description\u0022:\u0022Regex representing service ports allowed in Kubernetes cluster. E.g. Regex for allowing ports 443,446 is ^(443|446)$\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022EnforceRegoPolicy\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022EnforceRegoPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022policyId\u0022:\u0022ServiceAllowedPorts\u0022,\u0022policy\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/service-allowed-ports/limited-preview/gatekeeperpolicy.rego\u0022,\u0022policyParameters\u0022:{\u0022allowedServicePortsRegex\u0022:\u0022[parameters(\u0027allowedServicePortsRegex\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/25dee3db-6ce0-4c02-ab5d-245887b24077\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002225dee3db-6ce0-4c02-ab5d-245887b24077\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Limited Preview]: [AKS] Enforce HTTPS ingress in AKS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.ContainerService.Data\u0022,\u0022description\u0022:\u0022This policy enforces HTTPS ingress in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022EnforceRegoPolicy\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022EnforceRegoPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022policyId\u0022:\u0022HttpsIngressOnly\u0022,\u0022policy\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/ingress-https-only/limited-preview/gatekeeperpolicy.rego\u0022}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/2fbff515-eecc-4b7e-9b63-fcc7138b7dc3\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00222fbff515-eecc-4b7e-9b63-fcc7138b7dc3\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Configure an approval endpoint called prior to jobs running for specified Azure Machine Learning computes\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.MachineLearningServices.Data\u0022,\u0022description\u0022:\u0022This policy helps configure an approval endpoint called prior to jobs running for specified Azure Machine Learning computes and can be assigned at the workspace. For more information. For more information, visit https://aka.ms/amlpolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Machine Learning\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022computeNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Compute names where Azure ML jobs run\u0022,\u0022description\u0022:\u0022List of compute names where this policy should be applied. Ex. cpu-cluster;gpu-cluster. If no value is provided to this parameter then policy is applicable to all computes.\u0022},\u0022defaultValue\u0022:[]},\u0022approvalEndpoint\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Approval endpoint\u0022,\u0022description\u0022:\u0022Approval endpoint that needs to be called before an Azure ML job is run. Ex. http://amlrunapproval/approve\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy.\u0022},\u0022allowedValues\u0022:[\u0022enforceSetting\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceSetting\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.MachineLearningServices.Data/workspaces/computes/name\u0022,\u0022in\u0022:\u0022[parameters(\u0027computeNames\u0027)]\u0022},{\u0022value\u0022:\u0022[length(parameters(\u0027computeNames\u0027))]\u0022,\u0022equals\u0022:0}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022setting\u0022:{\u0022name\u0022:\u0022approvalEndpoint\u0022,\u0022value\u0022:\u0022[parameters(\u0027approvalEndpoint\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3948394e-63de-11ea-bc55-0242ac130003\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223948394e-63de-11ea-bc55-0242ac130003\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Enforce internal load balancers in Kubernetes cluster\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.Kubernetes.Data\u0022,\u0022description\u0022:\u0022This policy enforces load balancers do not have public IPs in a Kubernetes cluster. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00223.0.0-preview\u0022,\u0022category\u0022:\u0022Kubernetes\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022enforceOPAConstraint\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceOPAConstraint\u0022},\u0022excludedNamespaces\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Namespace exclusions\u0022,\u0022description\u0022:\u0022List of Kubernetes namespaces to exclude from policy evaluation. Providing a value for this parameter is optional.\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022AKS Engine\u0022,\u0022Microsoft.Kubernetes/connectedClusters\u0022,\u0022Microsoft.ContainerService/managedClusters\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022constraintTemplate\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/load-balancer-no-public-ips/template.yaml\u0022,\u0022constraint\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/load-balancer-no-public-ips/constraint.yaml\u0022,\u0022values\u0022:{\u0022excludedNamespaces\u0022:\u0022[parameters(\u0027excludedNamespaces\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/3fc4dc25-5baf-40d8-9b05-7fe74c1bc64e\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00223fc4dc25-5baf-40d8-9b05-7fe74c1bc64e\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Ensure containers listen only on allowed ports in Kubernetes cluster\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.Kubernetes.Data\u0022,\u0022description\u0022:\u0022This policy enforces containers to listen only on allowed ports in a Kubernetes cluster. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00223.0.0-preview\u0022,\u0022category\u0022:\u0022Kubernetes\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022allowedContainerPortsList\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allowed container ports list\u0022,\u0022description\u0022:\u0022The list of container ports allowed in a Kubernetes cluster.\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022enforceOPAConstraint\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceOPAConstraint\u0022},\u0022excludedNamespaces\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Namespace exclusions\u0022,\u0022description\u0022:\u0022List of Kubernetes namespaces to exclude from policy evaluation. Providing a value for this parameter is optional.\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022AKS Engine\u0022,\u0022Microsoft.Kubernetes/connectedClusters\u0022,\u0022Microsoft.ContainerService/managedClusters\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022constraintTemplate\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/container-allowed-ports/template.yaml\u0022,\u0022constraint\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/container-allowed-ports/constraint.yaml\u0022,\u0022values\u0022:{\u0022allowedContainerPorts\u0022:\u0022[parameters(\u0027allowedContainerPortsList\u0027)]\u0022,\u0022excludedNamespaces\u0022:\u0022[parameters(\u0027excludedNamespaces\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/440b515e-a580-421e-abeb-b159a61ddcbc\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022440b515e-a580-421e-abeb-b159a61ddcbc\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Enforce labels on pods in Kubernetes cluster\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.Kubernetes.Data\u0022,\u0022description\u0022:\u0022This policy enforces the specified labels are provided for pods in a Kubernetes cluster. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00223.0.0-preview\u0022,\u0022category\u0022:\u0022Kubernetes\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022labelsList\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: List of labels\u0022,\u0022description\u0022:\u0022The list of labels to be specified on Pods in a Kubernetes cluster.\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022enforceOPAConstraint\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceOPAConstraint\u0022},\u0022excludedNamespaces\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Namespace exclusions\u0022,\u0022description\u0022:\u0022List of Kubernetes namespaces to exclude from policy evaluation. Providing a value for this parameter is optional.\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022AKS Engine\u0022,\u0022Microsoft.Kubernetes/connectedClusters\u0022,\u0022Microsoft.ContainerService/managedClusters\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022constraintTemplate\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/pod-enforce-labels/template.yaml\u0022,\u0022constraint\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/pod-enforce-labels/constraint.yaml\u0022,\u0022values\u0022:{\u0022labels\u0022:\u0022[parameters(\u0027labelsList\u0027)]\u0022,\u0022excludedNamespaces\u0022:\u0022[parameters(\u0027excludedNamespaces\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/46592696-4c7b-4bf3-9e45-6c2763bdc0a6\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002246592696-4c7b-4bf3-9e45-6c2763bdc0a6\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Configure allowed module authors for specified Azure Machine Learning computes\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.MachineLearningServices.Data\u0022,\u0022description\u0022:\u0022This policy helps provide allowed module authors in specified Azure Machine Learning computes and can be assigned at the workspace. For more information, visit https://aka.ms/amlpolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Machine Learning\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022computeNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Compute names where Azure ML jobs run\u0022,\u0022description\u0022:\u0022List of compute names where this policy should be applied. Ex. cpu-cluster;gpu-cluster. If no value is provided to this parameter then policy is applicable to all computes.\u0022},\u0022defaultValue\u0022:[]},\u0022allowedModuleAuthors\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Allowed module authors\u0022,\u0022description\u0022:\u0022List of allowed module authors. Ex. authorname@contoso.com\u0022},\u0022defaultValue\u0022:[]},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy.\u0022},\u0022allowedValues\u0022:[\u0022enforceSetting\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceSetting\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.MachineLearningServices.Data/workspaces/computes/name\u0022,\u0022in\u0022:\u0022[parameters(\u0027computeNames\u0027)]\u0022},{\u0022value\u0022:\u0022[length(parameters(\u0027computeNames\u0027))]\u0022,\u0022equals\u0022:0}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022setting\u0022:{\u0022name\u0022:\u0022allowedModuleAuthors\u0022,\u0022value\u0022:\u0022[parameters(\u0027allowedModuleAuthors\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/53c70b02-63dd-11ea-bc55-0242ac130003\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002253c70b02-63dd-11ea-bc55-0242ac130003\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Configure allowed registries for specified Azure Machine Learning computes\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.MachineLearningServices.Data\u0022,\u0022description\u0022:\u0022This policy helps provide registries that are allowed in specified Azure Machine Learning computes and can be assigned at the workspace. For more information, visit https://aka.ms/amlpolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Machine Learning\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022computeNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Compute names where Azure ML jobs run\u0022,\u0022description\u0022:\u0022List of compute names where this policy should be applied. Ex. cpu-cluster;gpu-cluster. If no value is provided to this parameter then policy is applicable to all computes.\u0022},\u0022defaultValue\u0022:[]},\u0022allowedACRs\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Azure Container Registries\u0022,\u0022description\u0022:\u0022List of Azure Container Registries that can be used with Azure ML. Ex. amlrepo.azurecr.io;amlrepo.azurecr.io/foo\u0022},\u0022defaultValue\u0022:[]},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy.\u0022},\u0022allowedValues\u0022:[\u0022enforceSetting\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceSetting\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.MachineLearningServices.Data/workspaces/computes/name\u0022,\u0022in\u0022:\u0022[parameters(\u0027computeNames\u0027)]\u0022},{\u0022value\u0022:\u0022[length(parameters(\u0027computeNames\u0027))]\u0022,\u0022equals\u0022:0}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022setting\u0022:{\u0022name\u0022:\u0022allowedACRs\u0022,\u0022value\u0022:\u0022[parameters(\u0027allowedACRs\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5853517a-63de-11ea-bc55-0242ac130003\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225853517a-63de-11ea-bc55-0242ac130003\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Limited Preview]: [AKS] Ensure only allowed container images in AKS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.ContainerService.Data\u0022,\u0022description\u0022:\u0022This policy ensures only allowed container images are running in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022allowedContainerImagesRegex\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Allowed container images regex\u0022,\u0022description\u0022:\u0022Regex representing container images allowed in Kubernetes cluster. E.g. Regex of azure container registry images is ^.\u002Bazurecr.io/.\u002B$\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022EnforceRegoPolicy\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022EnforceRegoPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022policyId\u0022:\u0022ContainerAllowedImages\u0022,\u0022policy\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-allowed-images/limited-preview/gatekeeperpolicy.rego\u0022,\u0022policyParameters\u0022:{\u0022allowedContainerImagesRegex\u0022:\u0022[parameters(\u0027allowedContainerImagesRegex\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/5f86cb6e-c4da-441b-807c-44bd0cc14e66\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00225f86cb6e-c4da-441b-807c-44bd0cc14e66\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Configure allowed Python packages for specified Azure Machine Learning computes\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.MachineLearningServices.Data\u0022,\u0022description\u0022:\u0022 This policy helps provide allowed Python packages in specified Azure Machine Learning computes and can be assigned at the workspace. For more information, visit https://aka.ms/amlpolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Machine Learning\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022computeNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Compute names where Azure ML jobs run\u0022,\u0022description\u0022:\u0022List of compute names where this policy should be applied. Ex. cpu-cluster;gpu-cluster. If no value is provided to this parameter then policy is applicable to all computes.\u0022},\u0022defaultValue\u0022:[]},\u0022allowedPythonPackageChannels\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Allowed Python package indexes\u0022,\u0022description\u0022:\u0022List of allowed Python package indexes. Ex. http://somepythonindex.org \u0022},\u0022defaultValue\u0022:[]},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy.\u0022},\u0022allowedValues\u0022:[\u0022enforceSetting\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceSetting\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022anyOf\u0022:[{\u0022field\u0022:\u0022Microsoft.MachineLearningServices.Data/workspaces/computes/name\u0022,\u0022in\u0022:\u0022[parameters(\u0027computeNames\u0027)]\u0022},{\u0022value\u0022:\u0022[length(parameters(\u0027computeNames\u0027))]\u0022,\u0022equals\u0022:0}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022setting\u0022:{\u0022name\u0022:\u0022allowedPythonPackageChannels\u0022,\u0022value\u0022:\u0022[parameters(\u0027allowedPythonPackageChannels\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/77eeea86-7e81-4a7d-9067-de844d096752\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002277eeea86-7e81-4a7d-9067-de844d096752\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Limited Preview]: [AKS] Do not allow privileged containers in AKS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.ContainerService.Data\u0022,\u0022description\u0022:\u0022This policy does not allow privileged containers creation in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022EnforceRegoPolicy\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022EnforceRegoPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022policyId\u0022:\u0022ContainerNoPrivilege\u0022,\u0022policy\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-no-privilege/limited-preview/gatekeeperpolicy.rego\u0022}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/7ce7ac02-a5c6-45d6-8d1b-844feb1c1531\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00227ce7ac02-a5c6-45d6-8d1b-844feb1c1531\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Manage certificates issued by an integrated CA\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.KeyVault.Data\u0022,\u0022description\u0022:\u0022This policy manages certificates are issued by a specified key vault integrated Certificate Authority.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Key Vault\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022allowedCAs\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allowed Azure Key Vault Supported CAs\u0022,\u0022description\u0022:\u0022The list of allowed certificate authorities supported by Azure Key Vault.\u0022},\u0022allowedValues\u0022:[\u0022DigiCert\u0022,\u0022GlobalSign\u0022],\u0022defaultValue\u0022:[\u0022DigiCert\u0022,\u0022GlobalSign\u0022]},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022audit\u0022,\u0022deny\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/issuer.name\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027allowedCAs\u0027)]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/8e826246-c976-48f6-b03e-619bb92b3d82\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u00228e826246-c976-48f6-b03e-619bb92b3d82\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Do not allow privileged containers in Kubernetes cluster\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.Kubernetes.Data\u0022,\u0022description\u0022:\u0022This policy does not allow privileged containers creation in a Kubernetes cluster. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00223.0.0-preview\u0022,\u0022category\u0022:\u0022Kubernetes\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022enforceOPAConstraint\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceOPAConstraint\u0022},\u0022excludedNamespaces\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Namespace exclusions\u0022,\u0022description\u0022:\u0022List of Kubernetes namespaces to exclude from policy evaluation. Providing a value for this parameter is optional.\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022AKS Engine\u0022,\u0022Microsoft.Kubernetes/connectedClusters\u0022,\u0022Microsoft.ContainerService/managedClusters\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022constraintTemplate\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/container-no-privilege/template.yaml\u0022,\u0022constraint\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/container-no-privilege/constraint.yaml\u0022,\u0022values\u0022:{\u0022excludedNamespaces\u0022:\u0022[parameters(\u0027excludedNamespaces\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u002295edb821-ddaf-4404-9732-666045e056b4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Manage certificates issued by a non-integrated CA\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.KeyVault.Data\u0022,\u0022description\u0022:\u0022This policy manages certificates are issued by a specified non-integrated Certificate Authority.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Key Vault\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022caCommonName\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: The common name of the certificate authority\u0022,\u0022description\u0022:\u0022The common name (CN) of the Certificate Authority (CA) provider. For example, for an issuer CN = Contoso, OU = .., DC = .., you can specify Contoso\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022audit\u0022,\u0022deny\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/issuer.commonName\u0022,\u0022notContains\u0022:\u0022[parameters(\u0027caCommonName\u0027)]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a22f4a40-01d3-4c7d-8071-da157eeff341\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a22f4a40-01d3-4c7d-8071-da157eeff341\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Limited Preview]: [AKS] Ensure CPU and memory resource limits defined on containers in AKS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.ContainerService.Data\u0022,\u0022description\u0022:\u0022This policy ensures CPU and memory resource limits are defined on containers in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022EnforceRegoPolicy\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022EnforceRegoPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022policyId\u0022:\u0022ContainerResourceLimits\u0022,\u0022policy\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/container-resource-limits/limited-preview/gatekeeperpolicy.rego\u0022}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a2d3ed81-8d11-4079-80a5-1faadc0024f4\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a2d3ed81-8d11-4079-80a5-1faadc0024f4\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Limited Preview]: [AKS] Enforce internal load balancers in AKS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.ContainerService.Data\u0022,\u0022description\u0022:\u0022This policy enforces load balancers do not have public IPs in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022EnforceRegoPolicy\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022EnforceRegoPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022policyId\u0022:\u0022LoadBalancersInternal\u0022,\u0022policy\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/loadbalancer-no-publicips/limited-preview/gatekeeperpolicy.rego\u0022}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/a74d8f00-2fd9-4ce4-968e-0ee1eb821698\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022a74d8f00-2fd9-4ce4-968e-0ee1eb821698\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Enforce unique ingress hostnames across namespaces in Kubernetes cluster\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.Kubernetes.Data\u0022,\u0022description\u0022:\u0022This policy enforces unique ingress hostnames across namespaces in a Kubernetes cluster. For instructions on using this policy, please go to https://aka.ms/kubepolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00222.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022enforceOPAConstraint\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceOPAConstraint\u0022},\u0022excludedNamespaces\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Namespace exclusions\u0022,\u0022description\u0022:\u0022List of Kubernetes namespaces to exclude from policy evaluation. Providing a value for this parameter is optional.\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022AKS Engine\u0022,\u0022Microsoft.Kubernetes/connectedClusters\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022constraintTemplate\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/ingress-hostnames-conflict/template.yaml\u0022,\u0022constraint\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/ingress-hostnames-conflict/constraint.yaml\u0022,\u0022values\u0022:{\u0022excludedNamespaces\u0022:\u0022[parameters(\u0027excludedNamespaces\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/b2fd3e59-6390-4f2b-8247-ea676bd03e2d\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022b2fd3e59-6390-4f2b-8247-ea676bd03e2d\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Manage allowed curve names for elliptic curve cryptography certificates\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.KeyVault.Data\u0022,\u0022description\u0022:\u0022This policy manages the allowed elliptic curve names for elliptic curve cryptography certificates.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Key Vault\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022allowedECNames\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allowed elliptic curve names\u0022,\u0022description\u0022:\u0022The list of allowed curve names for elliptic curve cryptography certificates.\u0022},\u0022allowedValues\u0022:[\u0022P-256\u0022,\u0022P-256K\u0022,\u0022P-384\u0022,\u0022P-521\u0022],\u0022defaultValue\u0022:[\u0022P-256\u0022,\u0022P-256K\u0022,\u0022P-384\u0022,\u0022P-521\u0022]},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022audit\u0022,\u0022deny\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/keyProperties.keyType\u0022,\u0022in\u0022:[\u0022EC\u0022,\u0022EC-HSM\u0022]},{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/keyProperties.ellipticCurveName\u0022,\u0022notIn\u0022:\u0022[parameters(\u0027allowedECNames\u0027)]\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/bd78111f-4953-4367-9fd5-7e08808b54bf\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022bd78111f-4953-4367-9fd5-7e08808b54bf\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Manage minimum key size for RSA certificates\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.KeyVault.Data\u0022,\u0022description\u0022:\u0022This policy manages the minimum key size for RSA certificates.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Key Vault\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022minimumRSAKeySize\u0022:{\u0022type\u0022:\u0022Integer\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Minimum RSA key size\u0022,\u0022description\u0022:\u0022The minimum key size for RSA certificates.\u0022},\u0022allowedValues\u0022:[2048,3072,4096]},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022audit\u0022,\u0022deny\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022allOf\u0022:[{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/keyProperties.keyType\u0022,\u0022in\u0022:[\u0022RSA\u0022,\u0022RSA-HSM\u0022]},{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/keyProperties.keySize\u0022,\u0022less\u0022:\u0022[parameters(\u0027minimumRSAKeySize\u0027)]\u0022}]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/cee51871-e572-4576-855c-047c820360f0\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022cee51871-e572-4576-855c-047c820360f0\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Limited Preview]: [AKS] Enforce unique ingress hostnames across namespaces in AKS\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.ContainerService.Data\u0022,\u0022description\u0022:\u0022This policy enforces unique ingress hostnames across namespaces in an Azure Kubernetes Service cluster. Limited Preview policies only work for registered subscriptions. To register, please go to https://aka.ms/akspolicyonboarding. For instruction on using this policy, please go to https://aka.ms/akspolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.1-deprecated\u0022,\u0022category\u0022:\u0022Kubernetes service\u0022,\u0022deprecated\u0022:true},\u0022parameters\u0022:{\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Deprecated]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022EnforceRegoPolicy\u0022,\u0022Disabled\u0022],\u0022defaultValue\u0022:\u0022EnforceRegoPolicy\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022equals\u0022:\u0022Microsoft.ContainerService/managedClusters\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022policyId\u0022:\u0022UniqueIngressHostnames\u0022,\u0022policy\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/KubernetesService/ingress-hostnames-conflict/limited-preview/gatekeeperpolicy.rego\u0022}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/d011d9f7-ba32-4005-b727-b3d09371ca60\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022d011d9f7-ba32-4005-b727-b3d09371ca60\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Ensure container CPU and memory resource limits do not exceed the specified limits in Kubernetes cluster\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.Kubernetes.Data\u0022,\u0022description\u0022:\u0022This policy ensures container CPU and memory resource limits are defined and do not exceed the specified limits in a Kubernetes cluster. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00223.0.0-preview\u0022,\u0022category\u0022:\u0022Kubernetes\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022cpuLimit\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Max allowed CPU units\u0022,\u0022description\u0022:\u0022The maximum CPU units allowed for a container. E.g. 200m. For more information, please refer https://aka.ms/k8s-policy-pod-limits\u0022}},\u0022memoryLimit\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Max allowed memory bytes\u0022,\u0022description\u0022:\u0022The maximum memory bytes allowed for a container. E.g. 1Gi. For more information, please refer https://aka.ms/k8s-policy-pod-limits\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022enforceOPAConstraint\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceOPAConstraint\u0022},\u0022excludedNamespaces\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Namespace exclusions\u0022,\u0022description\u0022:\u0022List of Kubernetes namespaces to exclude from policy evaluation. Providing a value for this parameter is optional.\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022AKS Engine\u0022,\u0022Microsoft.Kubernetes/connectedClusters\u0022,\u0022Microsoft.ContainerService/managedClusters\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022constraintTemplate\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/container-resource-limits/template.yaml\u0022,\u0022constraint\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/container-resource-limits/constraint.yaml\u0022,\u0022values\u0022:{\u0022cpuLimit\u0022:\u0022[parameters(\u0027cpuLimit\u0027)]\u0022,\u0022memoryLimit\u0022:\u0022[parameters(\u0027memoryLimit\u0027)]\u0022,\u0022excludedNamespaces\u0022:\u0022[parameters(\u0027excludedNamespaces\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/e345eecc-fa47-480f-9e88-67dcc122b164\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022e345eecc-fa47-480f-9e88-67dcc122b164\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Manage certificates that are within a specified number of days of expiration\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.KeyVault.Data\u0022,\u0022description\u0022:\u0022This policy manages certificates that are within a specified number of days to their expiration date.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00221.0.0-preview\u0022,\u0022category\u0022:\u0022Key Vault\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022daysToExpire\u0022:{\u0022type\u0022:\u0022Integer\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Days to expire\u0022,\u0022description\u0022:\u0022The number of days for a certificate to expire.\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022audit\u0022,\u0022deny\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022audit\u0022}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022Microsoft.KeyVault.Data/vaults/certificates/attributes.expiresOn\u0022,\u0022lessOrEquals\u0022:\u0022[addDays(utcNow(), parameters(\u0027daysToExpire\u0027))]\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/f772fb64-8e40-40ad-87bc-7706e1949427\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022f772fb64-8e40-40ad-87bc-7706e1949427\u0022},{\u0022properties\u0022:{\u0022displayName\u0022:\u0022[Preview]: Ensure only allowed container images in Kubernetes cluster\u0022,\u0022policyType\u0022:\u0022BuiltIn\u0022,\u0022mode\u0022:\u0022Microsoft.Kubernetes.Data\u0022,\u0022description\u0022:\u0022This policy ensures only allowed container images are running in a Kubernetes cluster. For instructions on using this policy, visit https://aka.ms/kubepolicydoc.\u0022,\u0022metadata\u0022:{\u0022version\u0022:\u00223.0.0-preview\u0022,\u0022category\u0022:\u0022Kubernetes\u0022,\u0022preview\u0022:true},\u0022parameters\u0022:{\u0022allowedContainerImagesRegex\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Allowed container images regex\u0022,\u0022description\u0022:\u0022The RegEx rule used to match allowed container images in a Kubernetes cluster. For example, to allow any Azure Container Registry image by matching partial path: ^.\u002Bazurecr.io/.\u002B$\u0022}},\u0022effect\u0022:{\u0022type\u0022:\u0022String\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Effect\u0022,\u0022description\u0022:\u0022Enable or disable the execution of the policy\u0022},\u0022allowedValues\u0022:[\u0022enforceOPAConstraint\u0022,\u0022disabled\u0022],\u0022defaultValue\u0022:\u0022enforceOPAConstraint\u0022},\u0022excludedNamespaces\u0022:{\u0022type\u0022:\u0022Array\u0022,\u0022metadata\u0022:{\u0022displayName\u0022:\u0022[Preview]: Namespace exclusions\u0022,\u0022description\u0022:\u0022List of Kubernetes namespaces to exclude from policy evaluation. Providing a value for this parameter is optional.\u0022},\u0022defaultValue\u0022:[]}},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022type\u0022,\u0022in\u0022:[\u0022AKS Engine\u0022,\u0022Microsoft.Kubernetes/connectedClusters\u0022,\u0022Microsoft.ContainerService/managedClusters\u0022]},\u0022then\u0022:{\u0022effect\u0022:\u0022[parameters(\u0027effect\u0027)]\u0022,\u0022details\u0022:{\u0022constraintTemplate\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/container-allowed-images/template.yaml\u0022,\u0022constraint\u0022:\u0022https://raw.githubusercontent.com/Azure/azure-policy/master/built-in-references/Kubernetes/container-allowed-images/constraint.yaml\u0022,\u0022values\u0022:{\u0022allowedContainerImagesRegex\u0022:\u0022[parameters(\u0027allowedContainerImagesRegex\u0027)]\u0022,\u0022excludedNamespaces\u0022:\u0022[parameters(\u0027excludedNamespaces\u0027)]\u0022}}}}},\u0022id\u0022:\u0022/providers/Microsoft.Authorization/policyDefinitions/febd0533-8e55-448f-b837-bd0e06f16469\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022febd0533-8e55-448f-b837-bd0e06f16469\u0022},{\u0022properties\u0022:{\u0022policyType\u0022:\u0022Custom\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022metadata\u0022:{\u0022createdBy\u0022:\u002230aa469e-e248-40b6-bc03-e320b05037b9\u0022,\u0022createdOn\u0022:\u00222020-05-29T02:50:17.3520566Z\u0022,\u0022updatedBy\u0022:\u002230aa469e-e248-40b6-bc03-e320b05037b9\u0022,\u0022updatedOn\u0022:\u00222020-05-29T02:54:44.7052081Z\u0022},\u0022parameters\u0022:{},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022northeurope\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/policy2\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022policy2\u0022},{\u0022properties\u0022:{\u0022policyType\u0022:\u0022Custom\u0022,\u0022mode\u0022:\u0022Indexed\u0022,\u0022metadata\u0022:{\u0022createdBy\u0022:\u0022b8aeaa91-5c34-4947-9a7c-3c9bc2ca8271\u0022,\u0022createdOn\u0022:\u00222020-05-08T21:28:38.0681774Z\u0022,\u0022updatedBy\u0022:null,\u0022updatedOn\u0022:null},\u0022policyRule\u0022:{\u0022if\u0022:{\u0022field\u0022:\u0022location\u0022,\u0022equals\u0022:\u0022northeurope\u0022},\u0022then\u0022:{\u0022effect\u0022:\u0022deny\u0022}}},\u0022id\u0022:\u0022/subscriptions/b9f138a1-1d64-4108-8413-9ea3be1c1b2d/providers/Microsoft.Authorization/policyDefinitions/policy-for-what-if-test\u0022,\u0022type\u0022:\u0022Microsoft.Authorization/policyDefinitions\u0022,\u0022name\u0022:\u0022policy-for-what-if-test\u0022}]}"
    }
  ],
  "Variables": {
    "RandomSeed": "1291668089",
    "SUBSCRIPTION_ID": "b9f138a1-1d64-4108-8413-9ea3be1c1b2d"
  }
}