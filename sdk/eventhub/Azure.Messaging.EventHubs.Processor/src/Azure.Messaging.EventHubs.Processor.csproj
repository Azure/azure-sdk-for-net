<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <Description>Azure Event Hubs is a highly scalable publish-subscribe service that can ingest millions of events per second and stream them to multiple consumers.  This library extends its Event Processor with durable storage for checkpoint information using Azure Blob storage.  For more information about Event Hubs, see https://azure.microsoft.com/en-us/services/event-hubs/</Description>
    <Version>5.3.0-beta.1</Version>
    <ApiCompatVersion>5.2.0</ApiCompatVersion>
    <PackageTags>Azure;Event Hubs;EventHubs;.NET;Event Processor;EventProcessor;$(PackageCommonTags)</PackageTags>
    <TargetFrameworks>$(RequiredTargetFrameworks)</TargetFrameworks>
  </PropertyGroup>

  <ItemGroup>
    <Folder Include="Properties\" />
  </ItemGroup>
  
  <ItemGroup>
    <!-- Version overrides are specific to the v5.3.0-beta.1 release from the branch; this will be removed and the package properties updated when merged to master -->
    <PackageReference Include="Azure.Messaging.EventHubs" VersionOverride="5.3.0-beta.1" />
    <PackageReference Include="Azure.Storage.Blobs" VersionOverride="12.6.0"/>
    <PackageReference Include="Microsoft.Azure.Amqp" VersionOverride="2.4.6"/>
    <!-- END v5.3.0-beta.1 SPECIFIC OVERRIDES -->
      
    <PackageReference Include="Microsoft.Azure.Amqp" />
    <PackageReference Include="System.Diagnostics.DiagnosticSource" />
    <PackageReference Include="System.Reflection.TypeExtensions" />
    <PackageReference Include="Microsoft.Bcl.AsyncInterfaces" />
    <PackageReference Include="System.Threading.Channels" />
    <PackageReference Include="System.Threading.Tasks.Extensions" />
  </ItemGroup>

  <!-- Import Event Hubs shared source -->
  <Import Project="$(MSBuildThisFileDirectory)..\..\Azure.Messaging.EventHubs.Shared\src\Azure.Messaging.EventHubs.Shared.Core.projitems" Label="Core" />
  <Import Project="$(MSBuildThisFileDirectory)..\..\Azure.Messaging.EventHubs.Shared\src\Azure.Messaging.EventHubs.Shared.Diagnostics.projitems" Label="Diagnostics" />
  <Import Project="$(MSBuildThisFileDirectory)..\..\Azure.Messaging.EventHubs.Shared\src\Azure.Messaging.EventHubs.Shared.Authorization.projitems" Label="Authorization" />
  <Import Project="$(MSBuildThisFileDirectory)..\..\Azure.Messaging.EventHubs.Shared\src\Azure.Messaging.EventHubs.Shared.Processor.projitems" Label="Processor" />

  <!-- Import Azure.Core shared source -->
  <ItemGroup>
    <Compile Include="$(AzureCoreSharedSources)Argument.cs" Link="SharedSource\Azure.Core\Argument.cs" />
    <Compile Include="$(AzureCoreSharedSources)TaskExtensions.cs" Link="SharedSource\Azure.Core\TaskExtensions.cs" />
  </ItemGroup>

  <!--Embed the shared resources -->
  <ItemGroup>
    <Compile Update="Resources.Local.cs">
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>

    <Compile Include="$(MSBuildThisFileDirectory)..\..\Azure.Messaging.EventHubs.Shared\src\Resources.Designer.cs">
      <Link>Resources.Designer.cs</Link>
      <DesignTime>True</DesignTime>
      <AutoGen>True</AutoGen>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>

    <EmbeddedResource Include="$(MSBuildThisFileDirectory)..\..\Azure.Messaging.EventHubs.Shared\src\Resources.resx">
      <Link>Resources.resx</Link>
      <CustomToolNamespace>Azure.Messaging.EventHubs</CustomToolNamespace>
    </EmbeddedResource>
  </ItemGroup>

  <!-- Import the Azure.Core reference -->
  <!-- <Import Project="$(MSBuildThisFileDirectory)..\..\..\core\Azure.Core\src\Azure.Core.props" /> -->

  <!-- 
    THIS SECTION IS SPECIFIC TO THE v5.3.0-beta.1 RELEASE

    These are normally set via the above reference to Azure.Core.props, but have been included here
    to allow a specific override to the Azure.Core version for Event Hubs only; when merged back to 
    master, this section should be removed and the above import restored.
  -->
  <ItemGroup>
    <PackageReference Include="Azure.Core" VersionOverride="1.5.0" />
  </ItemGroup>

  <!-- Nullability -->
  <PropertyGroup>
    <!-- Visual Studio 2019 version 16.1 shipped a version of .NET Core that used older 'NullableContextOptions' -->
    <Nullable Condition="'$(Nullable)'==''">$(NullableContextOptions)</Nullable>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Nullable)'=='enable' Or '$(UseAzureCoreNullableAttributes)'=='true'">
    <DefineConstants>$(DefineConstants);AZURE_NULLABLE</DefineConstants>
  </PropertyGroup>
  <ItemGroup Condition="'$(Nullable)'=='enable' Or '$(UseAzureCoreNullableAttributes)'=='true'">
    <Compile Include="$(AzureCoreSharedSources)NullableAttributes.cs" />
  </ItemGroup>
  <!-- END v5.3.0-beta.1 SPECIFIC OVERRIDES -->
</Project>
