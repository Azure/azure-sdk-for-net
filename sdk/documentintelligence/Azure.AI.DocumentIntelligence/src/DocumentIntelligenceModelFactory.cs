// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

using System;
using System.Collections.Generic;
using System.Linq;
using Azure.Core;

namespace Azure.AI.DocumentIntelligence
{
    // CUSTOM CODE NOTE: the generator started including AnalyzeDocumentOptions, ClassifierDocumentTypeDetails,
    // and ClassifyDocumentOptions in the factory after we hid their parameterless constructors. This is unnecessary
    // given that they are input-only models that can be directly instantiated by users. For this reason we're
    // suppressing their generation here.

    [CodeGenModel("AIDocumentIntelligenceModelFactory")]
    [CodeGenSuppress("AnalyzeDocumentOptions", typeof(Uri), typeof(BinaryData))]
    [CodeGenSuppress("ClassifierDocumentTypeDetails", typeof(ContentSourceKind?), typeof(BlobContentSource), typeof(BlobFileListContentSource))]
    [CodeGenSuppress("ClassifyDocumentOptions", typeof(Uri), typeof(BinaryData))]
    public partial class DocumentIntelligenceModelFactory
    {
        // CUSTOM CODE NOTE: the AnalyzeResult method must be added manually to the factory.
        // It stopped being autogenerated after we hid its 'StringIndexType' property.

        private const string DefaultStringIndexType = "utf16CodeUnit";

        /// <summary> Initializes a new instance of <see cref="DocumentIntelligence.AnalyzeResult"/>. </summary>
        /// <param name="apiVersion"> API version used to produce this result. </param>
        /// <param name="modelId"> Document model ID used to produce this result. </param>
        /// <param name="contentFormat"> Format of the analyze result top-level content. </param>
        /// <param name="content">
        /// Concatenate string representation of all textual and visual elements in reading
        /// order.
        /// </param>
        /// <param name="pages"> Analyzed pages. </param>
        /// <param name="paragraphs"> Extracted paragraphs. </param>
        /// <param name="tables"> Extracted tables. </param>
        /// <param name="figures"> Extracted figures. </param>
        /// <param name="sections"> Extracted sections. </param>
        /// <param name="keyValuePairs"> Extracted key-value pairs. </param>
        /// <param name="styles"> Extracted font styles. </param>
        /// <param name="languages"> Detected languages. </param>
        /// <param name="documents"> Extracted documents. </param>
        /// <param name="warnings"> List of warnings encountered. </param>
        /// <returns> A new <see cref="DocumentIntelligence.AnalyzeResult"/> instance for mocking. </returns>
        public static AnalyzeResult AnalyzeResult(string apiVersion = null, string modelId = null, DocumentContentFormat? contentFormat = null, string content = null, IEnumerable<DocumentPage> pages = null, IEnumerable<DocumentParagraph> paragraphs = null, IEnumerable<DocumentTable> tables = null, IEnumerable<DocumentFigure> figures = null, IEnumerable<DocumentSection> sections = null, IEnumerable<DocumentKeyValuePair> keyValuePairs = null, IEnumerable<DocumentStyle> styles = null, IEnumerable<DocumentLanguage> languages = null, IEnumerable<AnalyzedDocument> documents = null, IEnumerable<DocumentIntelligenceWarning> warnings = null)
        {
            pages ??= new List<DocumentPage>();
            paragraphs ??= new List<DocumentParagraph>();
            tables ??= new List<DocumentTable>();
            figures ??= new List<DocumentFigure>();
            sections ??= new List<DocumentSection>();
            keyValuePairs ??= new List<DocumentKeyValuePair>();
            styles ??= new List<DocumentStyle>();
            languages ??= new List<DocumentLanguage>();
            documents ??= new List<AnalyzedDocument>();
            warnings ??= new List<DocumentIntelligenceWarning>();

            return new AnalyzeResult(
                apiVersion,
                modelId,
                DefaultStringIndexType,
                contentFormat,
                content,
                pages?.ToList(),
                paragraphs?.ToList(),
                tables?.ToList(),
                figures?.ToList(),
                sections?.ToList(),
                keyValuePairs?.ToList(),
                styles?.ToList(),
                languages?.ToList(),
                documents?.ToList(),
                warnings?.ToList(),
                serializedAdditionalRawData: null);
        }
    }
}
