{
  "Entries": [
    {
      "RequestUri": "https://management.azure.com/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c?api-version=2021-01-01",
      "RequestMethod": "GET",
      "RequestHeaders": {
        "Accept": "application/json",
        "Authorization": "Sanitized",
        "traceparent": "00-ba8049663db37f4f9e9402b354e24b6d-522bb19ed2837d41-00",
        "User-Agent": "azsdk-net-ResourceManager/1.3.1 (.NET Core 3.1.30; Microsoft Windows 10.0.22621)",
        "x-ms-client-request-id": "1a5045d2e75f2eb889436de155118302",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "747",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Thu, 13 Oct 2022 06:55:08 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "9dcff514-000d-4ee7-9731-ef8acf132bad",
        "x-ms-ratelimit-remaining-subscription-reads": "11997",
        "x-ms-request-id": "9dcff514-000d-4ee7-9731-ef8acf132bad",
        "x-ms-routing-request-id": "SOUTHEASTASIA:20221013T065509Z:9dcff514-000d-4ee7-9731-ef8acf132bad"
      },
      "ResponseBody": {
        "id": "/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c",
        "authorizationSource": "RoleBased",
        "managedByTenants": [],
        "tags": {
          "TagKey-9823": "TagValue-566",
          "TagKey-3481": "TagValue-320",
          "TagKey-4926": "TagValue-1187",
          "TagKey-751": "TagValue-3921",
          "TagKey-1866": "TagValue-8559",
          "TagKey-3094": "TagValue-9190",
          "TagKey-2449": "TagValue-9",
          "TagKey-8379": "TagValue-164",
          "TagKey-7470": "TagValue-2205",
          "TagKey-4236": "TagValue-3698",
          "TagKey-5316": "TagValue-2725"
        },
        "subscriptionId": "db1ab6f0-4769-4b27-930e-01e2ef9c123c",
        "tenantId": "72f988bf-86f1-41af-91ab-2d7cd011db47",
        "displayName": ".NET Mgmt SDK Test with TTL = 1 Day",
        "state": "Enabled",
        "subscriptionPolicies": {
          "locationPlacementId": "Internal_2014-09-01",
          "quotaId": "Internal_2014-09-01",
          "spendingLimit": "Off"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c/providers/Microsoft.Security/locations/centralus?api-version=2015-06-01-preview",
      "RequestMethod": "GET",
      "RequestHeaders": {
        "Accept": "application/json",
        "Authorization": "Sanitized",
        "traceparent": "00-cf5513bdae2eb54f831327b324838e12-fa9d329abf249a41-00",
        "User-Agent": "azsdk-net-ResourceManager.SecurityCenter/1.0.0-alpha.20221013.1 (.NET Core 3.1.30; Microsoft Windows 10.0.22621)",
        "x-ms-client-request-id": "6f79c8d4175d1df70074d1ec65b897cf",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "api-supported-versions": "1.0",
        "Cache-Control": "no-cache",
        "Content-Length": "210",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Thu, 13 Oct 2022 06:55:09 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Server": "Kestrel",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "909614a6-59af-4bc1-b5fd-c1b10238a0fe",
        "x-ms-ratelimit-remaining-subscription-resource-requests": "97",
        "x-ms-request-id": "e96a8675-a7e6-43ff-9dc5-ebb73f431e5c",
        "x-ms-routing-request-id": "SOUTHEASTASIA:20221013T065509Z:909614a6-59af-4bc1-b5fd-c1b10238a0fe"
      },
      "ResponseBody": {
        "id": "/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c/providers/Microsoft.Security/locations/centralus",
        "name": "centralus",
        "type": "Microsoft.Security/locations",
        "properties": {
          "homeRegionName": "centralus"
        }
      }
    },
    {
      "RequestUri": "https://management.azure.com/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c/providers/Microsoft.Security/locations/centralus/alerts/2517370881989999999_7d56ae12-07f3-4f0a-8406-97650a437505?api-version=2022-01-01",
      "RequestMethod": "GET",
      "RequestHeaders": {
        "Accept": "application/json",
        "Authorization": "Sanitized",
        "traceparent": "00-8afcabc2c289fe4ea5e608d5db059954-129f3e1596533546-00",
        "User-Agent": "azsdk-net-ResourceManager.SecurityCenter/1.0.0-alpha.20221013.1 (.NET Core 3.1.30; Microsoft Windows 10.0.22621)",
        "x-ms-client-request-id": "7aa20aa1f6a7f2b059a61ae58003f9fc",
        "x-ms-return-client-request-id": "true"
      },
      "RequestBody": null,
      "StatusCode": 200,
      "ResponseHeaders": {
        "Cache-Control": "no-cache",
        "Content-Length": "4628",
        "Content-Type": "application/json; charset=utf-8",
        "Date": "Thu, 13 Oct 2022 06:55:09 GMT",
        "Expires": "-1",
        "Pragma": "no-cache",
        "Server": "Kestrel",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "X-Content-Type-Options": "nosniff",
        "x-ms-correlation-request-id": "0f55709c-af08-40f3-b119-3f437e06e25f",
        "x-ms-ratelimit-remaining-subscription-resource-requests": "748",
        "x-ms-request-id": "0f55709c-af08-40f3-b119-3f437e06e25f",
        "x-ms-routing-request-id": "SOUTHEASTASIA:20221013T065510Z:0f55709c-af08-40f3-b119-3f437e06e25f"
      },
      "ResponseBody": {
        "id": "/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c/providers/Microsoft.Security/locations/centralus/alerts/2517370881989999999_7d56ae12-07f3-4f0a-8406-97650a437505",
        "name": "2517370881989999999_7d56ae12-07f3-4f0a-8406-97650a437505",
        "type": "Microsoft.Security/Locations/alerts",
        "properties": {
          "status": "Active",
          "timeGeneratedUtc": "2022-10-08T08:50:17.8211432Z",
          "processingEndTimeUtc": "2022-10-08T08:50:17.2957361Z",
          "version": "2022-01-01.0",
          "vendorName": "Microsoft",
          "productName": "Microsoft Defender for Cloud",
          "productComponentName": "ARM",
          "alertType": "ARM_AnomalousServiceOperation.DefenseEvasion",
          "startTimeUtc": "2022-10-08T07:03:21Z",
          "endTimeUtc": "2022-10-08T07:10:50Z",
          "severity": "Medium",
          "isIncident": false,
          "systemAlertId": "2517370881989999999_7d56ae12-07f3-4f0a-8406-97650a437505",
          "intent": "DefenseEvasion",
          "resourceIdentifiers": [
            {
              "$id": "centralus_1",
              "azureResourceId": "/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c",
              "type": "AzureResource",
              "azureResourceTenantId": "72f988bf-86f1-41af-91ab-2d7cd011db47"
            }
          ],
          "compromisedEntity": "Principal:7bee3764-dbea-4729-9c33-446f321aa721",
          "alertDisplayName": "Suspicious invocation of a high-risk \u0027Defense Evasion\u0027 operation by a service principal detected (Preview)",
          "description": "Microsoft Defender for Resource Manager identified a suspicious invocation of a high-risk operation in your subscription which might indicate an attempt to evade defenses.\nThe identified operations are designed to allow administrators to efficiently manage the security posture of their environments.\nWhile this activity may be legitimate, a threat actor might utilize such operations to avoid being detected while compromising resources in your environment.\nThe activity is deemed suspicious as this service principal rarely invokes such operations.\nThis can indicate that the service principal is compromised and is being used with malicious intent.",
          "remediationSteps": [
            "1. Contact the service/application owner to determine whether the activity was intentional\n2. If the activity was intentional, dismiss the alert. Otherwise, turn-on the defense mechanism that was abused and treat the service principal account, subscription, and resource as compromised, and continue with the next steps.\n3. Remediate the compromised service principal account: change credentials, review all activities performed by the service principal via Azure Activity Logs, and locate suspicious activities.\n4. Remediate the compromised resources and subscription: review IAM permissions for the subscription and resources and remove permissions for any unfamiliar user account, review all Azure resources in the subscription and delete any unfamiliar Azure Resource, review all alerts in Azure Security Center related to the subscription and resources and investigate them, review all activities performed in this subscription and the resources via Azure Activity Logs and locate suspicious activities."
          ],
          "extendedProperties": {
            "operations": "microsoft.advisor/configurations/write",
            "principal ID": "7bee3764-dbea-4729-9c33-446f321aa721",
            "principal IP": "167.220.255.14",
            "first operation timestamp": "10/08/2022 07:03:21",
            "last operation timestamp": "10/08/2022 07:10:50",
            "user Agent": "azsdk-net-ResourceManager.Advisor/1.0.0-alpha.20221008.1 (.NET Core 3.1.29; Microsoft Windows 10.0.22621)",
            "resourceType": "ARM",
            "end Time UTC": "2022-10-08T07:10:50.0000000Z",
            "killChainIntent": "DefenseEvasion"
          },
          "entities": [
            {
              "$id": "centralus_2",
              "address": "167.220.255.14",
              "location": {
                "countryCode": "SG",
                "countryName": "Singapore",
                "state": "Central Singapore",
                "city": "Singapore",
                "longitude": 103.85178,
                "latitude": 1.28795,
                "asn": 3598,
                "carrier": "Microsoft Corporation",
                "organization": "Microsoft Singapore Pte. Ltd."
              },
              "type": "ip"
            },
            {
              "$id": "centralus_3",
              "resourceId": "/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c/providers/microsoft.advisor/configurations/default",
              "type": "azure-resource"
            },
            {
              "$id": "centralus_4",
              "resourceId": "/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c/resourcegroups/advisorrg9701/providers/microsoft.advisor/configurations/default",
              "type": "azure-resource"
            },
            {
              "$id": "centralus_5",
              "resourceId": "/subscriptions/db1ab6f0-4769-4b27-930e-01e2ef9c123c/resourcegroups/advisorrg412/providers/microsoft.advisor/configurations/default",
              "type": "azure-resource"
            },
            {
              "$id": "centralus_6",
              "sourceAddress": {
                "$ref": "centralus_2"
              },
              "type": "network-connection"
            }
          ],
          "alertUri": "https://portal.azure.com/#blade/Microsoft_Azure_Security_AzureDefenderForData/AlertBlade/alertId/2517370881989999999_7d56ae12-07f3-4f0a-8406-97650a437505/subscriptionId/db1ab6f0-4769-4b27-930e-01e2ef9c123c/referencedFrom/alertDeepLink/location/centralus"
        }
      }
    }
  ],
  "Variables": {
    "AZURE_AUTHORITY_HOST": "https://login.microsoftonline.com",
    "RandomSeed": "1701896395",
    "RESOURCE_MANAGER_URL": null,
    "SUBSCRIPTION_ID": "db1ab6f0-4769-4b27-930e-01e2ef9c123c"
  }
}
