// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

using System;

namespace Azure.Messaging.ServiceBus
{
    /// <summary>
    /// Contains information about the entity whose processing threw an exception, as well as
    /// the exception that has been thrown.
    /// </summary>
    public sealed class ProcessErrorEventArgs : EventArgs
    {
        /// <summary>
        /// Initializes a new instance of the <see cref="ProcessErrorEventArgs" /> class.
        /// </summary>
        ///
        /// <param name="exception">The exception that this event data belongs to.</param>
        /// <param name="action">The action associated with the message.</param>
        /// <param name="fullyQualifiedNamespace">The endpoint used when this exception occurred.</param>
        /// <param name="entityPath">The entity path used when this exception occurred.</param>
        public ProcessErrorEventArgs(
            Exception exception,
            ExceptionReceivedEventArgsAction action,
            string fullyQualifiedNamespace,
            string entityPath)
        {
            Exception = exception;
            Action = action;
            FullyQualifiedNamespace = fullyQualifiedNamespace;
            EntityPath = entityPath;
        }

        /// <summary>Gets the parent class exception to which this Service bus message belongs.</summary>
        ///
        /// <value>The exception, generated by the parent class, to which this event data belongs.</value>
        public Exception Exception { get; }

        /// <summary>Gets the action associated with the message.</summary>
        ///
        /// <value>The action associated with the event.</value>
        public ExceptionReceivedEventArgsAction Action { get; }

        /// <summary>The namespace name used when this exception occurred. This is likely
        ///  to be similar to <c>{yournamespace}.servicebus.windows.net</c>.</summary>
        public string FullyQualifiedNamespace { get; }

        /// <summary>The entity path used when this exception occurred.</summary>
        public string EntityPath { get; }
    }
}
