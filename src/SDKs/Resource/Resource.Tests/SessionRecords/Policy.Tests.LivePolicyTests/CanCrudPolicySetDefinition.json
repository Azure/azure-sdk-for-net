{
  "Entries": [
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0ODQ2OD9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Definition $[Auto Test]\",\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  }\r\n}",
      "RequestHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "338"
        ],
        "x-ms-client-request-id": [
          "63ec63e4-188a-478e-9dd8-120ad86ceb3b"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"azsmnet8468\"\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "457"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:08 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:042b3c47-6c74-4cd3-b17d-9675badad3ab"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1197"
        ],
        "x-ms-correlation-request-id": [
          "7495f428-4f43-4ac8-a6f2-cb7f73af2960"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203209Z:7495f428-4f43-4ac8-a6f2-cb7f73af2960"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 201
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0ODQ2OD9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"azsmnet8468\",\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"[parameters('foo')]\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    },\r\n    \"parameters\": {\r\n      \"foo\": {\r\n        \"type\": \"String\"\r\n      }\r\n    }\r\n  }\r\n}",
      "RequestHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "318"
        ],
        "x-ms-client-request-id": [
          "b7ea9250-b09f-424a-a081-b509dca45aa1"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"azsmnet8468\",\r\n    \"policyType\": \"Custom\",\r\n    \"parameters\": {\r\n      \"foo\": {\r\n        \"type\": \"String\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"[parameters('foo')]\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"azsmnet8468\"\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "396"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:12 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:965b8010-1070-456a-85c0-3fb8688ed087"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1193"
        ],
        "x-ms-correlation-request-id": [
          "ed7a5b6f-a189-4a48-b6d3-475c1001abf7"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203213Z:ed7a5b6f-a189-4a48-b6d3-475c1001abf7"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 201
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\"\r\n      }\r\n    ]\r\n  }\r\n}",
      "RequestHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "315"
        ],
        "x-ms-client-request-id": [
          "cae0ba00-9c16-4daf-9e16-a79b97c7e956"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"1487664155026092119\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"azsmnet3095\"\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "532"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:09 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:b0a4c3ef-5d6a-4483-9211-89d92dee1163"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1196"
        ],
        "x-ms-correlation-request-id": [
          "1431cfd1-8b7b-46b6-81f5-7a32cebe79fb"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203209Z:1431cfd1-8b7b-46b6-81f5-7a32cebe79fb"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 201
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\"\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\"\r\n      },\r\n      {\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336\"\r\n      }\r\n    ]\r\n  }\r\n}",
      "RequestHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "588"
        ],
        "x-ms-client-request-id": [
          "59a4df25-26e0-4aa2-9c28-a2239b517abc"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\"\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"1487664155026092119\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"1986915615792559811\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"azsmnet3095\"\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:10 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:027a616f-b0f4-40c8-b268-9da89057afa1"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1194"
        ],
        "x-ms-correlation-request-id": [
          "702cb953-adda-4644-8f84-f54c8cec6f86"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203211Z:702cb953-adda-4644-8f84-f54c8cec6f86"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"parameters\": {\r\n      \"fooSet\": {\r\n        \"type\": \"String\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\",\r\n        \"parameters\": {\r\n          \"foo\": {\r\n            \"value\": \"[parameters('fooSet')]\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}",
      "RequestHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "515"
        ],
        "x-ms-client-request-id": [
          "fdef1c5c-0456-44e6-9602-c9e07af3917a"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"parameters\": {\r\n      \"fooSet\": {\r\n        \"type\": \"String\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"5863935852193654655\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\",\r\n        \"parameters\": {\r\n          \"foo\": {\r\n            \"value\": \"[parameters('fooSet')]\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"azsmnet3095\"\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "630"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:15 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:3f41a0ef-de2a-493e-8610-3e45299e56cd"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1192"
        ],
        "x-ms-correlation-request-id": [
          "8fe40b1f-ae7e-48cf-97aa-bd97f8d9acf4"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203216Z:8fe40b1f-ae7e-48cf-97aa-bd97f8d9acf4"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 201
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "ada8d33e-82ca-41e8-a44b-f0c5f6175192"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"1487664155026092119\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"azsmnet3095\"\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:09 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:a654a28d-2688-4e5d-b64d-3c3d4dd67393"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14993"
        ],
        "x-ms-correlation-request-id": [
          "5d4b39c6-a8e9-48d7-8dff-18237e881b2c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203209Z:5d4b39c6-a8e9-48d7-8dff-18237e881b2c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "4ace7472-6af3-4a01-982c-27c39bec07a1"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\"\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"1487664155026092119\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"1986915615792559811\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"azsmnet3095\"\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:10 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:217d83bb-d795-46d0-9d53-baec9e89b25b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14991"
        ],
        "x-ms-correlation-request-id": [
          "85de52f5-42b0-445a-842a-4286343b03cf"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203211Z:85de52f5-42b0-445a-842a-4286343b03cf"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "1038cb7d-4311-44c9-8cc3-dec281e33d84"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'azsmnet3095' could not be found.\"\r\n  }\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "120"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:11 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:1f463eb1-454e-4530-9408-491eb4401177"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14990"
        ],
        "x-ms-correlation-request-id": [
          "28a7fdf0-1b99-4ea7-af60-037dfb0ee8cf"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203211Z:28a7fdf0-1b99-4ea7-af60-037dfb0ee8cf"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 404
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "ce0692a5-b892-4665-ae85-edfcfa3a9d87"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"parameters\": {\r\n      \"fooSet\": {\r\n        \"type\": \"String\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"5863935852193654655\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\",\r\n        \"parameters\": {\r\n          \"foo\": {\r\n            \"value\": \"[parameters('fooSet')]\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"azsmnet3095\"\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:15 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:c21125e5-09bb-43d0-8ede-b9ec275b77d9"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14984"
        ],
        "x-ms-correlation-request-id": [
          "67f28152-2146-4623-979f-3181990db122"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203216Z:67f28152-2146-4623-979f-3181990db122"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "dd46d375-44d4-465c-98f8-f05a42fbbbde"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicySetDefinitionNotFound\",\r\n    \"message\": \"The policy set definition 'azsmnet3095' could not be found.\"\r\n  }\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "120"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:15 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:60a58762-f70c-454a-a454-d89e72adf505"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14983"
        ],
        "x-ms-correlation-request-id": [
          "b805fd59-308d-4225-b7da-6c3beac087ca"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203216Z:b805fd59-308d-4225-b7da-6c3beac087ca"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 404
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "e701f6f4-4869-417f-b5c6-ba14228f6d6f"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Enable Monitoring in Azure Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Monitor all the available security recommendations in Azure Security Center. This is the default policy for Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"systemUpdatesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor system updates \",\r\n              \"description\": \"Enable or disable system updates monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"systemConfigurationsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor OS vulnerabilities\",\r\n              \"description\": \"Enable or disable OS vulnerabilities monitoring (based on a configured baseline)\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"endpointProtectionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor endpoint protection\",\r\n              \"description\": \"Enable or disable endpoint protection monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diskEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor disk encryption\",\r\n              \"description\": \"Enable or disable Enable or disable the monitoring of unencrypted VM disks\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"networkSecurityGroupsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor network security groups\",\r\n              \"description\": \"Enable or disable monitoring of Network Security Groups with too permissive rules\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"webApplicationFirewallMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor web application firewall\",\r\n              \"description\": \"Enable or disable the monitoring of unprotected web application\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"nextGenerationFirewallMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable next generation firewall monitoring\",\r\n              \"description\": \"Enable or disable monitoring network endpoints without a Next Generation Firewall\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"vulnerabilityAssesmentMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor vulnerability assesment\",\r\n              \"description\": \"Enable or disable the detection of VM Vulnerabilities by a Vulnerability Assessment solution\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"storageEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor storage encryption\",\r\n              \"description\": \"Enable or disable the monitoring of blob encryption for storage accounts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"jitNetworkAccessMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor JIT network access\",\r\n              \"description\": \"Enable or disable the monitoring of network Just In Time access\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"adaptiveApplicationControlsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor application whitelisting\",\r\n              \"description\": \"Enable or disable the monitoring of a possible application whitelist in Security Center\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlAuditingMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor SQL auditing\",\r\n              \"description\": \"Enable or disable the monitoring of unaudited SQL database\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor SQL encryption\",\r\n              \"description\": \"Enable or disable the monitoring of unencrypted SQL database\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlAuditingMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('systemUpdatesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('storageEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('jitNetworkAccessMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('adaptiveApplicationControlsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('networkSecurityGroupsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('systemConfigurationsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('endpointProtectionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diskEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vulnerabilityAssesmentMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('webApplicationFirewallMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('nextGenerationFirewallMonitoringEffect')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"1f3afdf9-d0c9-4c3d-847f-89da613e70a8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"carolynz - audit location and encryption of SA\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"foo bar\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynz - test\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name 2\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14799174781370023846\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"18108209265335873469\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSkus\": {\r\n                \"value\": [\r\n                  \"sku1\",\r\n                  \" sku2\",\r\n                  \" sku3\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17446851636164155301\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"2124621540977569058\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"centralus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15798722305728538898\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"westeurope\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/12b58873-e0f8-4b95-936c-86cbe7c9d697\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"12b58873-e0f8-4b95-936c-86cbe7c9d697\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cost management (SKUs)\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Manage the cost of storage accounts and virtual machines\",\r\n        \"metadata\": {\r\n          \"category\": \"Demo 323\",\r\n          \"parameterScopes\": {\r\n            \"listOfAllowedSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12146513388135597923\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e90ee\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": [\r\n                  \"Premium_LRS\",\r\n                  \"Standard_GRS\",\r\n                  \"Standard_LRS\",\r\n                  \"Standard_RAGRS\",\r\n                  \"Standard_ZRS\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12586357152368927652\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e9170\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": [\r\n                  \"Standard_DS1_v2\",\r\n                  \"Standard_DS13_v2\",\r\n                  \"Standard_B1s\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/17646efe-447c-45e0-b2a6-6d484923c0ab\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"17646efe-447c-45e0-b2a6-6d484923c0ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Editing Initiative 1st time creates duplicates edited\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Editing Initiative for the 1st time creates duplicates edited\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/183de28d-8524-4210-a176-b0a7ff48e58f\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"183de28d-8524-4210-a176-b0a7ff48e58f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"reference id test\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"reference id test,\\nupdate description with this line. \",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1865496205296516112\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"australiaeast\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16196890149489440782\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"australiasoutheast\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/1e2d3bb5-a398-479d-93e6-eb7332344164\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"1e2d3bb5-a398-479d-93e6-eb7332344164\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce VM Port Lockdown\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces that specific port ranges have access restricted to either CorpNet or SAW (depending on source IP range chosen during assignment)\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\",\r\n          \"parameterScopes\": {\r\n            \"access\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"SOURCEADDRESSPREFIXES_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5930870351761903477\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389\",\r\n                  \"3389-3390\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14554220312663270802\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"5986\",\r\n                  \"5985\",\r\n                  \"5985-5986\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9245329265770241913\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"22\",\r\n                  \"22-22\",\r\n                  \"22-23\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17233112498738905251\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"23\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"11847028610508251009\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"1433\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5782128531867937477\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"445\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6932989581576954984\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"797444469315623872\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/d7b13c30-e6aa-47e1-b50a-8e33f152d086\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389\",\r\n                  \"3389-3390\",\r\n                  \"5986\",\r\n                  \"5985\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"22-22\",\r\n                  \"22-23\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6167651208609008778\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ebcd21e9-b89f-4a22-8654-dd3a4d8b9321\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5487397055645750292\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/210ed8bd-6b07-4d5e-a62c-c34f07293288\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5721159336579598604\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"3997\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Allow\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_ControlledPorts_Restrict\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"783328307102833297\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": [\r\n                  \"VirtualNetwork\"\r\n                ]\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"3998\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Allow\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_ControlledPorts_AllowVnet\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13264874163570265928\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": [\r\n                  \"*\"\r\n                ]\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"3999\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Deny\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_ControlledPorts_Deny\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"10868451132156218171\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": [\r\n                  \"*\"\r\n                ]\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"*\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"4000\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Allow\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_AllowAll\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7115\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"20c4afd0-8a77-4433-b8b0-4ad06e4c7115\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Tigrans test\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4378874036917710292\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"TEst\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12598286750235766370\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"Test\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/2ef31cab-1f9e-4b33-8f6e-c44902f3a193\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"2ef31cab-1f9e-4b33-8f6e-c44902f3a193\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Sev 3: Id 66931737: CSS | Azure Policy | Unable to use portal to edit an Initiative Definition with Allowed Locations definition\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Sev 3: Id 66931737: CSS | Azure Policy | Unable to use portal to edit an Initiative Definition with Allowed Locations definition repro\\nSelected locations JP East, JP West\",\r\n        \"metadata\": {\r\n          \"category\": \"CSS Incident\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7915382897531231755\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"japaneast\",\r\n                  \"japanwest\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/369623ec-bdac-47a7-9ed9-d6076248407c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"369623ec-bdac-47a7-9ed9-d6076248407c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"cosmosdb new aliases test\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5701618597132748228\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9148562625737659571\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1317257300482699336\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"636235743263978372\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6540762518326135304\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16237668974108817340\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/37501145-d01b-4bc8-92d0-c795a19fd164\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd164\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Bulent's super important initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"My super important policies\",\r\n        \"metadata\": {\r\n          \"category\": \"Bulent\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"MyTag\",\r\n              \"description\": null\r\n            }\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"MyTagValue\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7154720483946859542\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9917626541889498072\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e275e2e-a157-4ade-8f91-43b3ea370007\",\r\n            \"parameters\": {\r\n              \"prefix\": {\r\n                \"value\": \"bulent\"\r\n              },\r\n              \"suffix\": {\r\n                \"value\": \"00\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/3e275e2e-a157-4ade-8f91-43b3ea37000c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"3e275e2e-a157-4ade-8f91-43b3ea37000c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cost Management\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Applies policies designed to control costs across the organization.\",\r\n        \"metadata\": {\r\n          \"category\": \"Cost\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e34c8\",\r\n            \"parameters\": {\r\n              \"allowedSkuTemplate\": {\r\n                \"value\": \"Standard_A*\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\",\r\n                  \"northcentralus\",\r\n                  \"westus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSkus\": {\r\n                \"value\": [\r\n                  \"Standard_LRS\",\r\n                  \"Standard_GRS\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Department\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e338c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"3e3807c1-65c9-49e0-a406-82d8ae3e338c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce VM/VMSS Extension autoUpgrade\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces that autoUpgrade is enabled for VM/VMSS extensions\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"2330549015838520635\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f783\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12257407672931668348\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a3\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5263811718943508557\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f772\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a7\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f7a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MSIT - AppServices Controls\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14479134515782949491\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc23\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6846729414517926069\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc12\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc27\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39fc27\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim set param name edit\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"jilim\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"SETTING_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Setting 22\",\r\n              \"description\": null\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          },\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13422402288225237808\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {\r\n              \"setting\": {\r\n                \"value\": \"[parameters('SETTING_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3372703735187041190\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"a\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/50aae093-0033-4d01-9431-64d55230b06d\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"50aae093-0033-4d01-9431-64d55230b06d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Get Secure\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"The initiative has been created to handle all policy definitions associated with securing resources.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/54b6e5f7-09d5-4531-9ee7-1b6e362a1009\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"54b6e5f7-09d5-4531-9ee7-1b6e362a1009\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Marcin's bucket of policies\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces specific resource types, locations, and automatically appends an Owner tag on each resource created.\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          },\r\n          \"LISTOFRESOURCETYPESALLOWED_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Types\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          },\r\n          \"LISTOFALLOWEDLOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Locations\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c\",\r\n            \"parameters\": {\r\n              \"listOfResourceTypesAllowed\": {\r\n                \"value\": \"[parameters('LISTOFRESOURCETYPESALLOWED_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('LISTOFALLOWEDLOCATIONS_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/6531f253-2bbe-43ef-a065-691cf8db3efb\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6531f253-2bbe-43ef-a065-691cf8db3efb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"carolyn - Async initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynz - test\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15774191813331482292\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/6a8172c0-40ff-43eb-8a33-4e98fe18ea01\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6a8172c0-40ff-43eb-8a33-4e98fe18ea01\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testing_enforce tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Tag\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"CC\"\r\n            }\r\n          },\r\n          \"TAGVALUE_2\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"onwer\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3014549339258383315\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_2')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15875422940156637081\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"costcenter\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/6bb6349d-8402-455b-9944-c43963a7d07a\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6bb6349d-8402-455b-9944-c43963a7d07a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny encryption and type\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4179431845482785358\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719a\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16794371140515931233\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"eastasia\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719e\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"74d5cf40-7293-46a4-a285-7ea971e3719e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim strong set 2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"2\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\",\r\n          \"parameterScopes\": {\r\n            \"omsWorkspace\": \"/subscriptions/bc8edd8f-a09f-499d-978d-6b5ed2f84852\",\r\n            \"listOfAllowedSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"listOfAllowedLocations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedResourceGroups\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"ALLOWEDRESOURCEGROUPS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed resource groups\",\r\n              \"description\": null,\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"LISTOFALLOWEDSKUS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"description\": null,\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          },\r\n          \"LISTOFALLOWEDLOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": null,\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7480492474426352997\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/9c1ba477-ff0c-41ea-8a5d-826c4ca18208\",\r\n            \"parameters\": {\r\n              \"omsWorkspace\": {\r\n                \"value\": \"/subscriptions/bc8edd8f-a09f-499d-978d-6b5ed2f84852/resourcegroups/mms-weu/providers/microsoft.operationalinsights/workspaces/jilimweu\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16469547035695750259\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": \"[parameters('LISTOFALLOWEDSKUS_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"11585898879207960213\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('LISTOFALLOWEDLOCATIONS_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"181565554491747128\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/72c0c41a-c752-4bc0-9c61-0d6adc567066\",\r\n            \"parameters\": {\r\n              \"allowedResourceGroups\": {\r\n                \"value\": \"[parameters('ALLOWEDRESOURCEGROUPS_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/7df2a8a0-316f-4479-8bbb-fccd2d4de2a1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"7df2a8a0-316f-4479-8bbb-fccd2d4de2a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ISO 627261 Compliance\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"ISO 627261 Compliance\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Value\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/89b27f38-e9e4-4468-ab81-801c84b8c01b\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"89b27f38-e9e4-4468-ab81-801c84b8c01b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GokmenhTestPolicySet2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test\",\r\n        \"metadata\": {\r\n          \"category\": \"Tag\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"Classification\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"required value for Classification tag\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8422391210290007553\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Classification\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('Classification')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/91d1aa14-ee36-4e03-ae40-a7a5096e5192\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"91d1aa14-ee36-4e03-ae40-a7a5096e5192\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"params in params\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAG_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16248441765056103\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"tags\": {\r\n                \"value\": [\r\n                  \"[parameters('TAG_1')]\"\r\n                ]\r\n              },\r\n              \"tag\": {\r\n                \"value\": \"\\\"hallO\\\"\"\r\n              },\r\n              \"allowedTags\": {\r\n                \"value\": [\r\n                  \"[parameters('TAG_1')]\",\r\n                  \"FirstName\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/94cf3430-dfc7-4eb4-8e4a-796bcb2854d2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"94cf3430-dfc7-4eb4-8e4a-796bcb2854d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ComplianceTestInitiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Compliance test initiative \",\r\n        \"metadata\": {\r\n          \"category\": \"Compliance test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4047897157028507992\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4859121137597195236\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"centralus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8935913113203900114\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus2\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a03db67e-a286-43c3-9098-b2da83d361ad\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a03db67e-a286-43c3-9098-b2da83d361ad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[cstack] Test Initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Some initiative\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"ALLOWEDLOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"eastus2\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8027870979889329152\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/763dcd1d-a4a9-46a8-8bd3-357c4533a335\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": \"[parameters('ALLOWEDLOCATIONS_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a309ad64-0bae-48d9-a6b1-d99c0b42177b\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a309ad64-0bae-48d9-a6b1-d99c0b42177b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test initiative @Notifications BUG 02\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test initiative @Notifications BUG description 02\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"anytag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"sometag\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a46c5bfd-fcc5-41e2-bea1-41355d42618e\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a46c5bfd-fcc5-41e2-bea1-41355d42618e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription tags\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3747236589400509393\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d82a2\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"18121629460155146291\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8339\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1111868914241026960\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8635\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a752f8cb-6498-4e40-8431-b658ca4d833d\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d833d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test 500 parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16519767739334285097\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"\\\"\\\"\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"\\\"\\\"\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a8f95acf-554e-459e-adee-a78aab3a808a\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a8f95acf-554e-459e-adee-a78aab3a808a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1487664155026092119\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"azsmnet3095\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"1\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"1\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/bafcd34b-58c6-47b4-bc8b-f35198d6a025\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"bafcd34b-58c6-47b4-bc8b-f35198d6a025\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Camille's evil initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"<img src=\\\"initiativeparam\\\" onerror=\\\"alert('category') />\",\r\n        \"metadata\": {\r\n          \"category\": \"</option><!--\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"SETTING_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"<!--\",\r\n              \"description\": null\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13422402288225237808\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {\r\n              \"setting\": {\r\n                \"value\": \"[parameters('SETTING_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8044870099827093134\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/c579c575-2ac1-44a2-aa4d-75bcc479b23c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"c579c575-2ac1-44a2-aa4d-75bcc479b23c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TEST TAG 2\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FREE\",\r\n              \" PAID\",\r\n              \" WHATEVER\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4700085587567108372\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"ENVIRONMENT\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/d52d0dbe-1903-4915-bd54-1920b2c9e2e1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"d52d0dbe-1903-4915-bd54-1920b2c9e2e1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TEST TAG\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"INT\",\r\n              \"PROD\",\r\n              \"TEST\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4700085587567108372\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"ENVIRONMENT\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/db2d139d-613a-4f3b-9ea5-0a29c91ba0f2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"db2d139d-613a-4f3b-9ea5-0a29c91ba0f2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh123\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/db6c5074-a529-4cc8-8882-43f10ef42002\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"db6c5074-a529-4cc8-8882-43f10ef42002\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit a resource based on owner tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Deny a resource if the owner tag is not equal to \\\"Akif\\\"s Resource Group\\\"\",\r\n        \"metadata\": {\r\n          \"category\": \"Beyond Nit\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"Akif\\\"s Resource Group\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/Deny a resource if based on owner tag\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"Deny a resource if based on owner tag\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MuratTest\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"murat\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"ersan\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and its value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"testupdate\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"ignite\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Initiative with my parameterized effect policy\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\",\r\n          \"parameterScopes\": {\r\n            \"logAnalytics\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"EFFECT_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Initiative effect\",\r\n              \"description\": null\r\n            },\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16025301204423402856\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"audit\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15232055014610564026\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('EFFECT_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/e6884163-54c6-4f5e-9570-9e4cbd95b078\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"e6884163-54c6-4f5e-9570-9e4cbd95b078\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"rohitbh: Initiative with at least one DeployIfNotExists effect\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3664111848684398324\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13792248241033558297\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"foo\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"bar\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/e8bd5973-5cc3-4431-838c-95f1ab570095\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"e8bd5973-5cc3-4431-838c-95f1ab570095\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"defaultValue: Initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"defaultValue\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16431059056652047295\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"tag\": {\r\n                \"value\": \"lolz\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b4\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"ea1688b3-022e-4add-af39-2fe60689a3b4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"defaultValue: initiative parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"defaultValue\",\r\n          \"parameterScopes\": {\r\n            \"locations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"location\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"resourceGroups\": \"/subscriptions/bc8edd8f-a09f-499d-978d-6b5ed2f84852\",\r\n            \"resourceGroup\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedLocations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedLocation\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedStorageSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedStorageSKU\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedTags\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedTag\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"LOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array)\",\r\n              \"description\": null,\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"LOCATION_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string)\",\r\n              \"description\": null,\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"RESOURCEGROUPS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array)\",\r\n              \"description\": null,\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"camarvin\"\r\n            ]\r\n          },\r\n          \"RESOURCEGROUP_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string)\",\r\n              \"description\": null,\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"TAGS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array)\",\r\n              \"description\": null\r\n            },\r\n            \"defaultValue\": [\r\n              \"FirstName\"\r\n            ]\r\n          },\r\n          \"TAG_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": null\r\n            },\r\n            \"defaultValue\": \"Age\"\r\n          },\r\n          \"ALLOWEDSTORAGESKUS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array, av)\",\r\n              \"description\": null,\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"ALLOWEDSTORAGESKU_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": null,\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"defaultValue\": \"Standard_LRS\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7107752599248540199\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"locations\": {\r\n                \"value\": \"[parameters('LOCATIONS_1')]\"\r\n              },\r\n              \"location\": {\r\n                \"value\": \"[parameters('LOCATION_1')]\"\r\n              },\r\n              \"resourceGroups\": {\r\n                \"value\": \"[parameters('RESOURCEGROUPS_1')]\"\r\n              },\r\n              \"resourceGroup\": {\r\n                \"value\": \"[parameters('RESOURCEGROUP_1')]\"\r\n              },\r\n              \"tags\": {\r\n                \"value\": \"[parameters('TAGS_1')]\"\r\n              },\r\n              \"tag\": {\r\n                \"value\": \"[parameters('TAG_1')]\"\r\n              },\r\n              \"allowedLocations\": {\r\n                \"value\": \"[parameters('LOCATIONS_1')]\"\r\n              },\r\n              \"allowedLocation\": {\r\n                \"value\": \"[parameters('LOCATION_1')]\"\r\n              },\r\n              \"allowedStorageSKUs\": {\r\n                \"value\": \"[parameters('ALLOWEDSTORAGESKUS_1')]\"\r\n              },\r\n              \"allowedStorageSKU\": {\r\n                \"value\": \"[parameters('ALLOWEDSTORAGESKU_1')]\"\r\n              },\r\n              \"allowedTags\": {\r\n                \"value\": \"[parameters('TAGS_1')]\"\r\n              },\r\n              \"allowedTag\": {\r\n                \"value\": \"[parameters('TAG_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16431059056652047295\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14628640572431045873\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"location\": {\r\n                \"value\": \"\"\r\n              },\r\n              \"resourceGroup\": {\r\n                \"value\": \"\"\r\n              },\r\n              \"allowedLocation\": {\r\n                \"value\": \"westus\"\r\n              },\r\n              \"allowedStorageSKU\": {\r\n                \"value\": \"Standard_ZRS\"\r\n              },\r\n              \"allowedTag\": {\r\n                \"value\": \"LastName\"\r\n              },\r\n              \"resourceGroups\": {\r\n                \"value\": [\r\n                  \"1seau\",\r\n                  \"4seaurg\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/ea1688b3-022e-4add-af39-2fe60689a4d0\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"ea1688b3-022e-4add-af39-2fe60689a4d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Do_not_delete_Initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Do_not_delete_Initiative\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4a0425e4-97bf-4ad0-ab36-145b94083c60\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"centralUS\",\r\n                  \"eus\",\r\n                  \"weu\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/f2e1010b-86fe-4bee-b076-cb3358394150\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"f2e1010b-86fe-4bee-b076-cb3358394150\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"OS Configuration\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Password Length\"\r\n            }\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"System Cryptography\"\r\n            }\r\n          },\r\n          \"TAGNAME_2\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Client Assign Communication\"\r\n            }\r\n          },\r\n          \"TAGVALUE_2\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Retention Policy\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7154720483946859542\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17532129644436783767\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_2')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_2')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/f4644c04-68ae-4354-9d82-28e0ca3990f3\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"f4644c04-68ae-4354-9d82-28e0ca3990f3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test for Demo- Remove me\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"ENV\",\r\n              \"OWNER\"\r\n            ]\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"PROD\",\r\n              \"TEST\",\r\n              \"STAGE\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9329878778137326421\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13058340743646448970\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"Sarah\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/fad75568-aaf8-4d0d-9d55-9cc20bcaa0f3\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"fad75568-aaf8-4d0d-9d55-9cc20bcaa0f3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GetSecure\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/GetSecure\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"GetSecure\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GetSecure2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/GetSecure2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"GetSecure2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security for HBI applications\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures HBI applications meet security requirements.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/hbiApplicationSecurity\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"hbiApplicationSecurity\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Location initiative definition\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"This initiative enables you to restrict the locations of deploying resources, Audit the deploying resource location and Append a tag in case of successful deploymen.\",\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"allowedValues\": [\r\n              [\r\n                \"East Asia\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ]\r\n            ]\r\n          },\r\n          \"tagName\": {\r\n            \"type\": \"String\"\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"allowedValues\": [\r\n              \"Finance\",\r\n              \"HR\",\r\n              \"Engineering\"\r\n            ]\r\n          },\r\n          \"listOfAuditLocations\": {\r\n            \"type\": \"Array\",\r\n            \"allowedValues\": [\r\n              [\r\n                \"East Asia\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ]\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('listOfAllowedLocations')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('listOfAuditLocations')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/LocationInitiativeDefinition\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"LocationInitiativeDefinition\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configuration to enable monitoring and service management tools\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces configuration settings that enable the usage of monitoring and service management tooling.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/monitoringConfiguration\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"monitoringConfiguration\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Regulatory compliance requirements for PCI-DSS\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures Azure resources meet PCI-DSS compliance requirements.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/pciDssCompliance\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"pciDssCompliance\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Pol int test\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/Pol int test\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"Pol int test\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security for PROD applications\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures PROD applications meet security requirements.\",\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/prodApplicationSecurity\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"prodApplicationSecurity\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Architectural requirements for PROD applications\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces architectural requirements for PROD applications.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/prodArchitecture\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"prodArchitecture\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"sandipsh-Initiative2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"test\",\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": \"[parameters('listOfAllowedSKUs')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/sandipsh-Initiative2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"sandipsh-Initiative2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"sandipsh_test_9_8_1\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"test test\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/sandipsh_test_9_8_1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"sandipsh_test_9_8_1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"sandipshrg-Initiative1\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"testing purpose....\",\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": \"[parameters('listOfAllowedSKUs')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/sandipshrg-Initiative1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"sandipshrg-Initiative1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configuration requirements for service reliability in PROD\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces configuration settings that support service reliability.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/serviceReliability\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"serviceReliability\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Best practice requirements for centrally managed subscriptions\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces best practices for management of Azure subscriptions.\",\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/subManagementBestPractices\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"subManagementBestPractices\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security for all Azure subscriptions\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures Azure subscriptions meet basic security requirements.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/subscriptionSecurity\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"subscriptionSecurity\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Tag resources\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"If required tags are not assigned, append the resources with appropriate tags\",\r\n        \"metadata\": {\r\n          \"category\": \"Tag\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Application owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"VitalyV\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/Tag resources\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"Tag resources\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test initiative\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test initiative\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"test\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\",\r\n              \"displayName\": \"tagName\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\",\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test_sandipsh\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test_sandipsh\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh1\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\",\r\n              \"displayName\": \"tagName\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\",\r\n              \"displayName\": \"tagValue\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test_sandipsh1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test_sandipsh1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh_Audit_Deny_Append\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"testing\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"AuditTag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"tagValue\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"DenyTag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"tagValue\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"AppendTag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"tagValueAppended123\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test_sandipsh_Audit_Deny_Append\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test_sandipsh_Audit_Deny_Append\"\r\n    }\r\n  ]\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:09 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:c3d56340-b1dd-461c-9c85-0542a112600b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14992"
        ],
        "x-ms-correlation-request-id": [
          "c661f987-2484-4bd1-91ad-b61a1998e3ec"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203210Z:c661f987-2484-4bd1-91ad-b61a1998e3ec"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "2f9834eb-410e-430c-898d-e1a1109e1348"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Enable Monitoring in Azure Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Monitor all the available security recommendations in Azure Security Center. This is the default policy for Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"systemUpdatesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor system updates \",\r\n              \"description\": \"Enable or disable system updates monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"systemConfigurationsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor OS vulnerabilities\",\r\n              \"description\": \"Enable or disable OS vulnerabilities monitoring (based on a configured baseline)\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"endpointProtectionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor endpoint protection\",\r\n              \"description\": \"Enable or disable endpoint protection monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diskEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor disk encryption\",\r\n              \"description\": \"Enable or disable Enable or disable the monitoring of unencrypted VM disks\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"networkSecurityGroupsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor network security groups\",\r\n              \"description\": \"Enable or disable monitoring of Network Security Groups with too permissive rules\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"webApplicationFirewallMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor web application firewall\",\r\n              \"description\": \"Enable or disable the monitoring of unprotected web application\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"nextGenerationFirewallMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable next generation firewall monitoring\",\r\n              \"description\": \"Enable or disable monitoring network endpoints without a Next Generation Firewall\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"vulnerabilityAssesmentMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor vulnerability assesment\",\r\n              \"description\": \"Enable or disable the detection of VM Vulnerabilities by a Vulnerability Assessment solution\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"storageEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor storage encryption\",\r\n              \"description\": \"Enable or disable the monitoring of blob encryption for storage accounts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"jitNetworkAccessMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor JIT network access\",\r\n              \"description\": \"Enable or disable the monitoring of network Just In Time access\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"adaptiveApplicationControlsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor application whitelisting\",\r\n              \"description\": \"Enable or disable the monitoring of a possible application whitelist in Security Center\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlAuditingMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor SQL auditing\",\r\n              \"description\": \"Enable or disable the monitoring of unaudited SQL database\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor SQL encryption\",\r\n              \"description\": \"Enable or disable the monitoring of unencrypted SQL database\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlAuditingMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('systemUpdatesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('storageEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('jitNetworkAccessMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('adaptiveApplicationControlsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('networkSecurityGroupsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('systemConfigurationsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('endpointProtectionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diskEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vulnerabilityAssesmentMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('webApplicationFirewallMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('nextGenerationFirewallMonitoringEffect')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"1f3afdf9-d0c9-4c3d-847f-89da613e70a8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"carolynz - audit location and encryption of SA\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"foo bar\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynz - test\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name 2\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14799174781370023846\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"18108209265335873469\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSkus\": {\r\n                \"value\": [\r\n                  \"sku1\",\r\n                  \" sku2\",\r\n                  \" sku3\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17446851636164155301\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"2124621540977569058\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"centralus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15798722305728538898\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"westeurope\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/12b58873-e0f8-4b95-936c-86cbe7c9d697\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"12b58873-e0f8-4b95-936c-86cbe7c9d697\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cost management (SKUs)\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Manage the cost of storage accounts and virtual machines\",\r\n        \"metadata\": {\r\n          \"category\": \"Demo 323\",\r\n          \"parameterScopes\": {\r\n            \"listOfAllowedSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12146513388135597923\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e90ee\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": [\r\n                  \"Premium_LRS\",\r\n                  \"Standard_GRS\",\r\n                  \"Standard_LRS\",\r\n                  \"Standard_RAGRS\",\r\n                  \"Standard_ZRS\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12586357152368927652\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e9170\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": [\r\n                  \"Standard_DS1_v2\",\r\n                  \"Standard_DS13_v2\",\r\n                  \"Standard_B1s\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/17646efe-447c-45e0-b2a6-6d484923c0ab\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"17646efe-447c-45e0-b2a6-6d484923c0ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Editing Initiative 1st time creates duplicates edited\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Editing Initiative for the 1st time creates duplicates edited\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/183de28d-8524-4210-a176-b0a7ff48e58f\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"183de28d-8524-4210-a176-b0a7ff48e58f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"reference id test\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"reference id test,\\nupdate description with this line. \",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1865496205296516112\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"australiaeast\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16196890149489440782\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"australiasoutheast\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/1e2d3bb5-a398-479d-93e6-eb7332344164\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"1e2d3bb5-a398-479d-93e6-eb7332344164\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce VM Port Lockdown\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces that specific port ranges have access restricted to either CorpNet or SAW (depending on source IP range chosen during assignment)\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\",\r\n          \"parameterScopes\": {\r\n            \"access\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"SOURCEADDRESSPREFIXES_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5930870351761903477\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389\",\r\n                  \"3389-3390\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14554220312663270802\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"5986\",\r\n                  \"5985\",\r\n                  \"5985-5986\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9245329265770241913\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"22\",\r\n                  \"22-22\",\r\n                  \"22-23\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17233112498738905251\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"23\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"11847028610508251009\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"1433\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5782128531867937477\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"445\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6932989581576954984\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"797444469315623872\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/d7b13c30-e6aa-47e1-b50a-8e33f152d086\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389\",\r\n                  \"3389-3390\",\r\n                  \"5986\",\r\n                  \"5985\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"22-22\",\r\n                  \"22-23\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6167651208609008778\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ebcd21e9-b89f-4a22-8654-dd3a4d8b9321\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5487397055645750292\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/210ed8bd-6b07-4d5e-a62c-c34f07293288\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5721159336579598604\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"3997\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Allow\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_ControlledPorts_Restrict\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"783328307102833297\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": [\r\n                  \"VirtualNetwork\"\r\n                ]\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"3998\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Allow\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_ControlledPorts_AllowVnet\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13264874163570265928\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": [\r\n                  \"*\"\r\n                ]\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"3999\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Deny\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_ControlledPorts_Deny\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"10868451132156218171\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": [\r\n                  \"*\"\r\n                ]\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"*\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"4000\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Allow\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_AllowAll\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7115\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"20c4afd0-8a77-4433-b8b0-4ad06e4c7115\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Tigrans test\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4378874036917710292\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"TEst\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12598286750235766370\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"Test\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/2ef31cab-1f9e-4b33-8f6e-c44902f3a193\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"2ef31cab-1f9e-4b33-8f6e-c44902f3a193\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Sev 3: Id 66931737: CSS | Azure Policy | Unable to use portal to edit an Initiative Definition with Allowed Locations definition\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Sev 3: Id 66931737: CSS | Azure Policy | Unable to use portal to edit an Initiative Definition with Allowed Locations definition repro\\nSelected locations JP East, JP West\",\r\n        \"metadata\": {\r\n          \"category\": \"CSS Incident\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7915382897531231755\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"japaneast\",\r\n                  \"japanwest\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/369623ec-bdac-47a7-9ed9-d6076248407c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"369623ec-bdac-47a7-9ed9-d6076248407c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"cosmosdb new aliases test\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5701618597132748228\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9148562625737659571\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1317257300482699336\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"636235743263978372\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6540762518326135304\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16237668974108817340\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/37501145-d01b-4bc8-92d0-c795a19fd164\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd164\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Bulent's super important initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"My super important policies\",\r\n        \"metadata\": {\r\n          \"category\": \"Bulent\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"MyTag\",\r\n              \"description\": null\r\n            }\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"MyTagValue\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7154720483946859542\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9917626541889498072\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e275e2e-a157-4ade-8f91-43b3ea370007\",\r\n            \"parameters\": {\r\n              \"prefix\": {\r\n                \"value\": \"bulent\"\r\n              },\r\n              \"suffix\": {\r\n                \"value\": \"00\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/3e275e2e-a157-4ade-8f91-43b3ea37000c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"3e275e2e-a157-4ade-8f91-43b3ea37000c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cost Management\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Applies policies designed to control costs across the organization.\",\r\n        \"metadata\": {\r\n          \"category\": \"Cost\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e34c8\",\r\n            \"parameters\": {\r\n              \"allowedSkuTemplate\": {\r\n                \"value\": \"Standard_A*\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\",\r\n                  \"northcentralus\",\r\n                  \"westus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSkus\": {\r\n                \"value\": [\r\n                  \"Standard_LRS\",\r\n                  \"Standard_GRS\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Department\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e338c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"3e3807c1-65c9-49e0-a406-82d8ae3e338c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce VM/VMSS Extension autoUpgrade\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces that autoUpgrade is enabled for VM/VMSS extensions\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"2330549015838520635\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f783\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12257407672931668348\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a3\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5263811718943508557\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f772\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a7\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f7a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MSIT - AppServices Controls\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14479134515782949491\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc23\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6846729414517926069\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc12\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc27\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39fc27\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim set param name edit\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"jilim\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"SETTING_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Setting 22\",\r\n              \"description\": null\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          },\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13422402288225237808\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {\r\n              \"setting\": {\r\n                \"value\": \"[parameters('SETTING_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3372703735187041190\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"a\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/50aae093-0033-4d01-9431-64d55230b06d\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"50aae093-0033-4d01-9431-64d55230b06d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Get Secure\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"The initiative has been created to handle all policy definitions associated with securing resources.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/54b6e5f7-09d5-4531-9ee7-1b6e362a1009\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"54b6e5f7-09d5-4531-9ee7-1b6e362a1009\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Marcin's bucket of policies\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces specific resource types, locations, and automatically appends an Owner tag on each resource created.\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          },\r\n          \"LISTOFRESOURCETYPESALLOWED_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Types\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          },\r\n          \"LISTOFALLOWEDLOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Locations\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c\",\r\n            \"parameters\": {\r\n              \"listOfResourceTypesAllowed\": {\r\n                \"value\": \"[parameters('LISTOFRESOURCETYPESALLOWED_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('LISTOFALLOWEDLOCATIONS_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/6531f253-2bbe-43ef-a065-691cf8db3efb\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6531f253-2bbe-43ef-a065-691cf8db3efb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"carolyn - Async initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynz - test\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15774191813331482292\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/6a8172c0-40ff-43eb-8a33-4e98fe18ea01\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6a8172c0-40ff-43eb-8a33-4e98fe18ea01\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testing_enforce tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Tag\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"CC\"\r\n            }\r\n          },\r\n          \"TAGVALUE_2\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"onwer\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3014549339258383315\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_2')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15875422940156637081\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"costcenter\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/6bb6349d-8402-455b-9944-c43963a7d07a\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6bb6349d-8402-455b-9944-c43963a7d07a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny encryption and type\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4179431845482785358\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719a\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16794371140515931233\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"eastasia\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719e\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"74d5cf40-7293-46a4-a285-7ea971e3719e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim strong set 2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"2\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\",\r\n          \"parameterScopes\": {\r\n            \"omsWorkspace\": \"/subscriptions/bc8edd8f-a09f-499d-978d-6b5ed2f84852\",\r\n            \"listOfAllowedSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"listOfAllowedLocations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedResourceGroups\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"ALLOWEDRESOURCEGROUPS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed resource groups\",\r\n              \"description\": null,\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"LISTOFALLOWEDSKUS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"description\": null,\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          },\r\n          \"LISTOFALLOWEDLOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": null,\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7480492474426352997\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/9c1ba477-ff0c-41ea-8a5d-826c4ca18208\",\r\n            \"parameters\": {\r\n              \"omsWorkspace\": {\r\n                \"value\": \"/subscriptions/bc8edd8f-a09f-499d-978d-6b5ed2f84852/resourcegroups/mms-weu/providers/microsoft.operationalinsights/workspaces/jilimweu\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16469547035695750259\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": \"[parameters('LISTOFALLOWEDSKUS_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"11585898879207960213\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('LISTOFALLOWEDLOCATIONS_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"181565554491747128\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/72c0c41a-c752-4bc0-9c61-0d6adc567066\",\r\n            \"parameters\": {\r\n              \"allowedResourceGroups\": {\r\n                \"value\": \"[parameters('ALLOWEDRESOURCEGROUPS_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/7df2a8a0-316f-4479-8bbb-fccd2d4de2a1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"7df2a8a0-316f-4479-8bbb-fccd2d4de2a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ISO 627261 Compliance\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"ISO 627261 Compliance\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Value\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/89b27f38-e9e4-4468-ab81-801c84b8c01b\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"89b27f38-e9e4-4468-ab81-801c84b8c01b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GokmenhTestPolicySet2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test\",\r\n        \"metadata\": {\r\n          \"category\": \"Tag\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"Classification\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"required value for Classification tag\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8422391210290007553\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Classification\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('Classification')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/91d1aa14-ee36-4e03-ae40-a7a5096e5192\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"91d1aa14-ee36-4e03-ae40-a7a5096e5192\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"params in params\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAG_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16248441765056103\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"tags\": {\r\n                \"value\": [\r\n                  \"[parameters('TAG_1')]\"\r\n                ]\r\n              },\r\n              \"tag\": {\r\n                \"value\": \"\\\"hallO\\\"\"\r\n              },\r\n              \"allowedTags\": {\r\n                \"value\": [\r\n                  \"[parameters('TAG_1')]\",\r\n                  \"FirstName\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/94cf3430-dfc7-4eb4-8e4a-796bcb2854d2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"94cf3430-dfc7-4eb4-8e4a-796bcb2854d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ComplianceTestInitiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Compliance test initiative \",\r\n        \"metadata\": {\r\n          \"category\": \"Compliance test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4047897157028507992\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4859121137597195236\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"centralus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8935913113203900114\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus2\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a03db67e-a286-43c3-9098-b2da83d361ad\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a03db67e-a286-43c3-9098-b2da83d361ad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[cstack] Test Initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Some initiative\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"ALLOWEDLOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"eastus2\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8027870979889329152\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/763dcd1d-a4a9-46a8-8bd3-357c4533a335\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": \"[parameters('ALLOWEDLOCATIONS_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a309ad64-0bae-48d9-a6b1-d99c0b42177b\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a309ad64-0bae-48d9-a6b1-d99c0b42177b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test initiative @Notifications BUG 02\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test initiative @Notifications BUG description 02\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"anytag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"sometag\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a46c5bfd-fcc5-41e2-bea1-41355d42618e\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a46c5bfd-fcc5-41e2-bea1-41355d42618e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription tags\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3747236589400509393\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d82a2\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"18121629460155146291\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8339\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1111868914241026960\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8635\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a752f8cb-6498-4e40-8431-b658ca4d833d\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d833d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test 500 parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16519767739334285097\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"\\\"\\\"\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"\\\"\\\"\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a8f95acf-554e-459e-adee-a78aab3a808a\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a8f95acf-554e-459e-adee-a78aab3a808a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"1\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"1\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/bafcd34b-58c6-47b4-bc8b-f35198d6a025\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"bafcd34b-58c6-47b4-bc8b-f35198d6a025\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Camille's evil initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"<img src=\\\"initiativeparam\\\" onerror=\\\"alert('category') />\",\r\n        \"metadata\": {\r\n          \"category\": \"</option><!--\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"SETTING_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"<!--\",\r\n              \"description\": null\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13422402288225237808\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {\r\n              \"setting\": {\r\n                \"value\": \"[parameters('SETTING_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8044870099827093134\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/c579c575-2ac1-44a2-aa4d-75bcc479b23c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"c579c575-2ac1-44a2-aa4d-75bcc479b23c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TEST TAG 2\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FREE\",\r\n              \" PAID\",\r\n              \" WHATEVER\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4700085587567108372\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"ENVIRONMENT\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/d52d0dbe-1903-4915-bd54-1920b2c9e2e1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"d52d0dbe-1903-4915-bd54-1920b2c9e2e1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TEST TAG\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"INT\",\r\n              \"PROD\",\r\n              \"TEST\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4700085587567108372\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"ENVIRONMENT\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/db2d139d-613a-4f3b-9ea5-0a29c91ba0f2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"db2d139d-613a-4f3b-9ea5-0a29c91ba0f2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh123\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/db6c5074-a529-4cc8-8882-43f10ef42002\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"db6c5074-a529-4cc8-8882-43f10ef42002\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit a resource based on owner tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Deny a resource if the owner tag is not equal to \\\"Akif\\\"s Resource Group\\\"\",\r\n        \"metadata\": {\r\n          \"category\": \"Beyond Nit\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"Akif\\\"s Resource Group\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/Deny a resource if based on owner tag\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"Deny a resource if based on owner tag\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MuratTest\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"murat\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"ersan\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and its value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"testupdate\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"ignite\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Initiative with my parameterized effect policy\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\",\r\n          \"parameterScopes\": {\r\n            \"logAnalytics\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"EFFECT_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Initiative effect\",\r\n              \"description\": null\r\n            },\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16025301204423402856\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"audit\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15232055014610564026\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('EFFECT_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/e6884163-54c6-4f5e-9570-9e4cbd95b078\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"e6884163-54c6-4f5e-9570-9e4cbd95b078\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"rohitbh: Initiative with at least one DeployIfNotExists effect\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3664111848684398324\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13792248241033558297\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"foo\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"bar\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/e8bd5973-5cc3-4431-838c-95f1ab570095\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"e8bd5973-5cc3-4431-838c-95f1ab570095\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"defaultValue: Initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"defaultValue\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16431059056652047295\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"tag\": {\r\n                \"value\": \"lolz\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b4\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"ea1688b3-022e-4add-af39-2fe60689a3b4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"defaultValue: initiative parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"defaultValue\",\r\n          \"parameterScopes\": {\r\n            \"locations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"location\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"resourceGroups\": \"/subscriptions/bc8edd8f-a09f-499d-978d-6b5ed2f84852\",\r\n            \"resourceGroup\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedLocations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedLocation\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedStorageSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedStorageSKU\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedTags\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedTag\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"LOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array)\",\r\n              \"description\": null,\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"LOCATION_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string)\",\r\n              \"description\": null,\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"RESOURCEGROUPS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array)\",\r\n              \"description\": null,\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"camarvin\"\r\n            ]\r\n          },\r\n          \"RESOURCEGROUP_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string)\",\r\n              \"description\": null,\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"TAGS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array)\",\r\n              \"description\": null\r\n            },\r\n            \"defaultValue\": [\r\n              \"FirstName\"\r\n            ]\r\n          },\r\n          \"TAG_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": null\r\n            },\r\n            \"defaultValue\": \"Age\"\r\n          },\r\n          \"ALLOWEDSTORAGESKUS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array, av)\",\r\n              \"description\": null,\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"ALLOWEDSTORAGESKU_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": null,\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"defaultValue\": \"Standard_LRS\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7107752599248540199\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"locations\": {\r\n                \"value\": \"[parameters('LOCATIONS_1')]\"\r\n              },\r\n              \"location\": {\r\n                \"value\": \"[parameters('LOCATION_1')]\"\r\n              },\r\n              \"resourceGroups\": {\r\n                \"value\": \"[parameters('RESOURCEGROUPS_1')]\"\r\n              },\r\n              \"resourceGroup\": {\r\n                \"value\": \"[parameters('RESOURCEGROUP_1')]\"\r\n              },\r\n              \"tags\": {\r\n                \"value\": \"[parameters('TAGS_1')]\"\r\n              },\r\n              \"tag\": {\r\n                \"value\": \"[parameters('TAG_1')]\"\r\n              },\r\n              \"allowedLocations\": {\r\n                \"value\": \"[parameters('LOCATIONS_1')]\"\r\n              },\r\n              \"allowedLocation\": {\r\n                \"value\": \"[parameters('LOCATION_1')]\"\r\n              },\r\n              \"allowedStorageSKUs\": {\r\n                \"value\": \"[parameters('ALLOWEDSTORAGESKUS_1')]\"\r\n              },\r\n              \"allowedStorageSKU\": {\r\n                \"value\": \"[parameters('ALLOWEDSTORAGESKU_1')]\"\r\n              },\r\n              \"allowedTags\": {\r\n                \"value\": \"[parameters('TAGS_1')]\"\r\n              },\r\n              \"allowedTag\": {\r\n                \"value\": \"[parameters('TAG_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16431059056652047295\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14628640572431045873\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"location\": {\r\n                \"value\": \"\"\r\n              },\r\n              \"resourceGroup\": {\r\n                \"value\": \"\"\r\n              },\r\n              \"allowedLocation\": {\r\n                \"value\": \"westus\"\r\n              },\r\n              \"allowedStorageSKU\": {\r\n                \"value\": \"Standard_ZRS\"\r\n              },\r\n              \"allowedTag\": {\r\n                \"value\": \"LastName\"\r\n              },\r\n              \"resourceGroups\": {\r\n                \"value\": [\r\n                  \"1seau\",\r\n                  \"4seaurg\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/ea1688b3-022e-4add-af39-2fe60689a4d0\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"ea1688b3-022e-4add-af39-2fe60689a4d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Do_not_delete_Initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Do_not_delete_Initiative\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4a0425e4-97bf-4ad0-ab36-145b94083c60\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"centralUS\",\r\n                  \"eus\",\r\n                  \"weu\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/f2e1010b-86fe-4bee-b076-cb3358394150\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"f2e1010b-86fe-4bee-b076-cb3358394150\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"OS Configuration\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Password Length\"\r\n            }\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"System Cryptography\"\r\n            }\r\n          },\r\n          \"TAGNAME_2\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Client Assign Communication\"\r\n            }\r\n          },\r\n          \"TAGVALUE_2\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Retention Policy\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7154720483946859542\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17532129644436783767\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_2')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_2')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/f4644c04-68ae-4354-9d82-28e0ca3990f3\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"f4644c04-68ae-4354-9d82-28e0ca3990f3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test for Demo- Remove me\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"ENV\",\r\n              \"OWNER\"\r\n            ]\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"PROD\",\r\n              \"TEST\",\r\n              \"STAGE\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9329878778137326421\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13058340743646448970\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"Sarah\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/fad75568-aaf8-4d0d-9d55-9cc20bcaa0f3\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"fad75568-aaf8-4d0d-9d55-9cc20bcaa0f3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GetSecure\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/GetSecure\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"GetSecure\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GetSecure2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/GetSecure2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"GetSecure2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security for HBI applications\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures HBI applications meet security requirements.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/hbiApplicationSecurity\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"hbiApplicationSecurity\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Location initiative definition\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"This initiative enables you to restrict the locations of deploying resources, Audit the deploying resource location and Append a tag in case of successful deploymen.\",\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"allowedValues\": [\r\n              [\r\n                \"East Asia\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ]\r\n            ]\r\n          },\r\n          \"tagName\": {\r\n            \"type\": \"String\"\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"allowedValues\": [\r\n              \"Finance\",\r\n              \"HR\",\r\n              \"Engineering\"\r\n            ]\r\n          },\r\n          \"listOfAuditLocations\": {\r\n            \"type\": \"Array\",\r\n            \"allowedValues\": [\r\n              [\r\n                \"East Asia\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ]\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('listOfAllowedLocations')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('listOfAuditLocations')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/LocationInitiativeDefinition\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"LocationInitiativeDefinition\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configuration to enable monitoring and service management tools\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces configuration settings that enable the usage of monitoring and service management tooling.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/monitoringConfiguration\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"monitoringConfiguration\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Regulatory compliance requirements for PCI-DSS\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures Azure resources meet PCI-DSS compliance requirements.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/pciDssCompliance\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"pciDssCompliance\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Pol int test\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/Pol int test\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"Pol int test\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security for PROD applications\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures PROD applications meet security requirements.\",\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/prodApplicationSecurity\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"prodApplicationSecurity\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Architectural requirements for PROD applications\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces architectural requirements for PROD applications.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/prodArchitecture\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"prodArchitecture\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"sandipsh-Initiative2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"test\",\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": \"[parameters('listOfAllowedSKUs')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/sandipsh-Initiative2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"sandipsh-Initiative2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"sandipsh_test_9_8_1\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"test test\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/sandipsh_test_9_8_1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"sandipsh_test_9_8_1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"sandipshrg-Initiative1\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"testing purpose....\",\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": \"[parameters('listOfAllowedSKUs')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/sandipshrg-Initiative1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"sandipshrg-Initiative1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configuration requirements for service reliability in PROD\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces configuration settings that support service reliability.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/serviceReliability\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"serviceReliability\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Best practice requirements for centrally managed subscriptions\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces best practices for management of Azure subscriptions.\",\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/subManagementBestPractices\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"subManagementBestPractices\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security for all Azure subscriptions\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures Azure subscriptions meet basic security requirements.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/subscriptionSecurity\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"subscriptionSecurity\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Tag resources\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"If required tags are not assigned, append the resources with appropriate tags\",\r\n        \"metadata\": {\r\n          \"category\": \"Tag\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Application owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"VitalyV\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/Tag resources\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"Tag resources\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test initiative\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test initiative\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"test\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\",\r\n              \"displayName\": \"tagName\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\",\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test_sandipsh\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test_sandipsh\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh1\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\",\r\n              \"displayName\": \"tagName\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\",\r\n              \"displayName\": \"tagValue\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test_sandipsh1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test_sandipsh1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh_Audit_Deny_Append\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"testing\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"AuditTag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"tagValue\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"DenyTag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"tagValue\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"AppendTag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"tagValueAppended123\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test_sandipsh_Audit_Deny_Append\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test_sandipsh_Audit_Deny_Append\"\r\n    }\r\n  ]\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:11 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:1876ba0a-585d-490c-9ff6-be4c1a133f0b"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14989"
        ],
        "x-ms-correlation-request-id": [
          "69476cdb-39f2-43a2-95e9-6dd93c6ab70a"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203211Z:69476cdb-39f2-43a2-95e9-6dd93c6ab70a"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "1fc4df7b-9b03-4c23-b8a2-2b567b7619bf"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Enable Monitoring in Azure Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Monitor all the available security recommendations in Azure Security Center. This is the default policy for Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"systemUpdatesMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor system updates \",\r\n              \"description\": \"Enable or disable system updates monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"systemConfigurationsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor OS vulnerabilities\",\r\n              \"description\": \"Enable or disable OS vulnerabilities monitoring (based on a configured baseline)\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"endpointProtectionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor endpoint protection\",\r\n              \"description\": \"Enable or disable endpoint protection monitoring\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"diskEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor disk encryption\",\r\n              \"description\": \"Enable or disable Enable or disable the monitoring of unencrypted VM disks\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"networkSecurityGroupsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor network security groups\",\r\n              \"description\": \"Enable or disable monitoring of Network Security Groups with too permissive rules\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"webApplicationFirewallMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor web application firewall\",\r\n              \"description\": \"Enable or disable the monitoring of unprotected web application\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"nextGenerationFirewallMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Enable next generation firewall monitoring\",\r\n              \"description\": \"Enable or disable monitoring network endpoints without a Next Generation Firewall\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"vulnerabilityAssesmentMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor vulnerability assesment\",\r\n              \"description\": \"Enable or disable the detection of VM Vulnerabilities by a Vulnerability Assessment solution\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"storageEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor storage encryption\",\r\n              \"description\": \"Enable or disable the monitoring of blob encryption for storage accounts\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          },\r\n          \"jitNetworkAccessMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor JIT network access\",\r\n              \"description\": \"Enable or disable the monitoring of network Just In Time access\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"adaptiveApplicationControlsMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor application whitelisting\",\r\n              \"description\": \"Enable or disable the monitoring of a possible application whitelist in Security Center\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlAuditingMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor SQL auditing\",\r\n              \"description\": \"Enable or disable the monitoring of unaudited SQL database\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          },\r\n          \"sqlEncryptionMonitoringEffect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Monitor SQL encryption\",\r\n              \"description\": \"Enable or disable the monitoring of unencrypted SQL database\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('sqlAuditingMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('systemUpdatesMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('storageEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('jitNetworkAccessMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('adaptiveApplicationControlsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('networkSecurityGroupsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('systemConfigurationsMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('endpointProtectionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('diskEncryptionMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('vulnerabilityAssesmentMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('webApplicationFirewallMonitoringEffect')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('nextGenerationFirewallMonitoringEffect')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"1f3afdf9-d0c9-4c3d-847f-89da613e70a8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"carolynz - audit location and encryption of SA\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"foo bar\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynz - test\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name 2\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14799174781370023846\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"18108209265335873469\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSkus\": {\r\n                \"value\": [\r\n                  \"sku1\",\r\n                  \" sku2\",\r\n                  \" sku3\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17446851636164155301\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"2124621540977569058\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"centralus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15798722305728538898\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"westeurope\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/12b58873-e0f8-4b95-936c-86cbe7c9d697\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"12b58873-e0f8-4b95-936c-86cbe7c9d697\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cost management (SKUs)\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Manage the cost of storage accounts and virtual machines\",\r\n        \"metadata\": {\r\n          \"category\": \"Demo 323\",\r\n          \"parameterScopes\": {\r\n            \"listOfAllowedSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12146513388135597923\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e90ee\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": [\r\n                  \"Premium_LRS\",\r\n                  \"Standard_GRS\",\r\n                  \"Standard_LRS\",\r\n                  \"Standard_RAGRS\",\r\n                  \"Standard_ZRS\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12586357152368927652\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e9170\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": [\r\n                  \"Standard_DS1_v2\",\r\n                  \"Standard_DS13_v2\",\r\n                  \"Standard_B1s\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/17646efe-447c-45e0-b2a6-6d484923c0ab\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"17646efe-447c-45e0-b2a6-6d484923c0ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Editing Initiative 1st time creates duplicates edited\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Editing Initiative for the 1st time creates duplicates edited\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/183de28d-8524-4210-a176-b0a7ff48e58f\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"183de28d-8524-4210-a176-b0a7ff48e58f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"reference id test\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"reference id test,\\nupdate description with this line. \",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1865496205296516112\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"australiaeast\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16196890149489440782\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"australiasoutheast\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/1e2d3bb5-a398-479d-93e6-eb7332344164\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"1e2d3bb5-a398-479d-93e6-eb7332344164\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce VM Port Lockdown\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces that specific port ranges have access restricted to either CorpNet or SAW (depending on source IP range chosen during assignment)\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\",\r\n          \"parameterScopes\": {\r\n            \"access\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"SOURCEADDRESSPREFIXES_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5930870351761903477\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389\",\r\n                  \"3389-3390\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14554220312663270802\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"5986\",\r\n                  \"5985\",\r\n                  \"5985-5986\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9245329265770241913\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"22\",\r\n                  \"22-22\",\r\n                  \"22-23\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17233112498738905251\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"23\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"11847028610508251009\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"1433\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5782128531867937477\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"445\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6932989581576954984\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"797444469315623872\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/d7b13c30-e6aa-47e1-b50a-8e33f152d086\",\r\n            \"parameters\": {\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389\",\r\n                  \"3389-3390\",\r\n                  \"5986\",\r\n                  \"5985\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"22-22\",\r\n                  \"22-23\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6167651208609008778\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ebcd21e9-b89f-4a22-8654-dd3a4d8b9321\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5487397055645750292\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/210ed8bd-6b07-4d5e-a62c-c34f07293288\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5721159336579598604\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": \"[parameters('SOURCEADDRESSPREFIXES_1')]\"\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"3997\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Allow\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_ControlledPorts_Restrict\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"783328307102833297\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": [\r\n                  \"VirtualNetwork\"\r\n                ]\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"3998\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Allow\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_ControlledPorts_AllowVnet\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13264874163570265928\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": [\r\n                  \"*\"\r\n                ]\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"3389-3390\",\r\n                  \"5985-5986\",\r\n                  \"22\",\r\n                  \"23\",\r\n                  \"1433\",\r\n                  \"445\",\r\n                  \"135\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"3999\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Deny\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_ControlledPorts_Deny\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"10868451132156218171\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n            \"parameters\": {\r\n              \"nsgPrefix\": {\r\n                \"value\": \"PortLockdown\"\r\n              },\r\n              \"sourceAddressPrefixes\": {\r\n                \"value\": [\r\n                  \"*\"\r\n                ]\r\n              },\r\n              \"destinationPortRanges\": {\r\n                \"value\": [\r\n                  \"*\"\r\n                ]\r\n              },\r\n              \"priority\": {\r\n                \"value\": \"4000\"\r\n              },\r\n              \"access\": {\r\n                \"value\": \"Allow\"\r\n              },\r\n              \"name\": {\r\n                \"value\": \"PortLockdown_AllowAll\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7115\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"20c4afd0-8a77-4433-b8b0-4ad06e4c7115\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Tigrans test\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4378874036917710292\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"TEst\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12598286750235766370\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"Test\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/2ef31cab-1f9e-4b33-8f6e-c44902f3a193\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"2ef31cab-1f9e-4b33-8f6e-c44902f3a193\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Sev 3: Id 66931737: CSS | Azure Policy | Unable to use portal to edit an Initiative Definition with Allowed Locations definition\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Sev 3: Id 66931737: CSS | Azure Policy | Unable to use portal to edit an Initiative Definition with Allowed Locations definition repro\\nSelected locations JP East, JP West\",\r\n        \"metadata\": {\r\n          \"category\": \"CSS Incident\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7915382897531231755\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"japaneast\",\r\n                  \"japanwest\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/369623ec-bdac-47a7-9ed9-d6076248407c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"369623ec-bdac-47a7-9ed9-d6076248407c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"cosmosdb new aliases test\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5701618597132748228\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9148562625737659571\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1317257300482699336\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"636235743263978372\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6540762518326135304\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16237668974108817340\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/37501145-d01b-4bc8-92d0-c795a19fd164\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd164\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Bulent's super important initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"My super important policies\",\r\n        \"metadata\": {\r\n          \"category\": \"Bulent\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"MyTag\",\r\n              \"description\": null\r\n            }\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"MyTagValue\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7154720483946859542\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9917626541889498072\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e275e2e-a157-4ade-8f91-43b3ea370007\",\r\n            \"parameters\": {\r\n              \"prefix\": {\r\n                \"value\": \"bulent\"\r\n              },\r\n              \"suffix\": {\r\n                \"value\": \"00\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/3e275e2e-a157-4ade-8f91-43b3ea37000c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"3e275e2e-a157-4ade-8f91-43b3ea37000c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Cost Management\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Applies policies designed to control costs across the organization.\",\r\n        \"metadata\": {\r\n          \"category\": \"Cost\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e34c8\",\r\n            \"parameters\": {\r\n              \"allowedSkuTemplate\": {\r\n                \"value\": \"Standard_A*\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\",\r\n                  \"northcentralus\",\r\n                  \"westus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSkus\": {\r\n                \"value\": [\r\n                  \"Standard_LRS\",\r\n                  \"Standard_GRS\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Department\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e338c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"3e3807c1-65c9-49e0-a406-82d8ae3e338c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce VM/VMSS Extension autoUpgrade\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces that autoUpgrade is enabled for VM/VMSS extensions\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"2330549015838520635\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f783\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"12257407672931668348\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a3\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"5263811718943508557\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f772\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a7\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f7a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MSIT - AppServices Controls\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14479134515782949491\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc23\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"6846729414517926069\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc12\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc27\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39fc27\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim set param name edit\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"jilim\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"SETTING_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Setting 22\",\r\n              \"description\": null\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          },\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13422402288225237808\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {\r\n              \"setting\": {\r\n                \"value\": \"[parameters('SETTING_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3372703735187041190\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"a\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/50aae093-0033-4d01-9431-64d55230b06d\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"50aae093-0033-4d01-9431-64d55230b06d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Get Secure\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"The initiative has been created to handle all policy definitions associated with securing resources.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/54b6e5f7-09d5-4531-9ee7-1b6e362a1009\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"54b6e5f7-09d5-4531-9ee7-1b6e362a1009\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Marcin's bucket of policies\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces specific resource types, locations, and automatically appends an Owner tag on each resource created.\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          },\r\n          \"LISTOFRESOURCETYPESALLOWED_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Types\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          },\r\n          \"LISTOFALLOWEDLOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Locations\",\r\n              \"description\": null,\r\n              \"strongType\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c\",\r\n            \"parameters\": {\r\n              \"listOfResourceTypesAllowed\": {\r\n                \"value\": \"[parameters('LISTOFRESOURCETYPESALLOWED_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('LISTOFALLOWEDLOCATIONS_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/6531f253-2bbe-43ef-a065-691cf8db3efb\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6531f253-2bbe-43ef-a065-691cf8db3efb\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"carolyn - Async initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynz - test\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15774191813331482292\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/6a8172c0-40ff-43eb-8a33-4e98fe18ea01\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6a8172c0-40ff-43eb-8a33-4e98fe18ea01\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testing_enforce tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Tag\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"CC\"\r\n            }\r\n          },\r\n          \"TAGVALUE_2\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"onwer\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3014549339258383315\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_2')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15875422940156637081\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"costcenter\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/6bb6349d-8402-455b-9944-c43963a7d07a\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"6bb6349d-8402-455b-9944-c43963a7d07a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny encryption and type\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4179431845482785358\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719a\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16794371140515931233\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": [\r\n                  \"eastasia\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719e\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"74d5cf40-7293-46a4-a285-7ea971e3719e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim strong set 2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"2\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\",\r\n          \"parameterScopes\": {\r\n            \"omsWorkspace\": \"/subscriptions/bc8edd8f-a09f-499d-978d-6b5ed2f84852\",\r\n            \"listOfAllowedSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"listOfAllowedLocations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedResourceGroups\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"ALLOWEDRESOURCEGROUPS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed resource groups\",\r\n              \"description\": null,\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"LISTOFALLOWEDSKUS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"description\": null,\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          },\r\n          \"LISTOFALLOWEDLOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": null,\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7480492474426352997\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/9c1ba477-ff0c-41ea-8a5d-826c4ca18208\",\r\n            \"parameters\": {\r\n              \"omsWorkspace\": {\r\n                \"value\": \"/subscriptions/bc8edd8f-a09f-499d-978d-6b5ed2f84852/resourcegroups/mms-weu/providers/microsoft.operationalinsights/workspaces/jilimweu\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16469547035695750259\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": \"[parameters('LISTOFALLOWEDSKUS_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"11585898879207960213\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('LISTOFALLOWEDLOCATIONS_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"181565554491747128\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Management/managementGroups/AzGovTest1/providers/Microsoft.Authorization/policyDefinitions/72c0c41a-c752-4bc0-9c61-0d6adc567066\",\r\n            \"parameters\": {\r\n              \"allowedResourceGroups\": {\r\n                \"value\": \"[parameters('ALLOWEDRESOURCEGROUPS_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/7df2a8a0-316f-4479-8bbb-fccd2d4de2a1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"7df2a8a0-316f-4479-8bbb-fccd2d4de2a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ISO 627261 Compliance\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"ISO 627261 Compliance\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Value\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/89b27f38-e9e4-4468-ab81-801c84b8c01b\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"89b27f38-e9e4-4468-ab81-801c84b8c01b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GokmenhTestPolicySet2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test\",\r\n        \"metadata\": {\r\n          \"category\": \"Tag\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"Classification\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"required value for Classification tag\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8422391210290007553\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Classification\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('Classification')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/91d1aa14-ee36-4e03-ae40-a7a5096e5192\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"91d1aa14-ee36-4e03-ae40-a7a5096e5192\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"params in params\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAG_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16248441765056103\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"tags\": {\r\n                \"value\": [\r\n                  \"[parameters('TAG_1')]\"\r\n                ]\r\n              },\r\n              \"tag\": {\r\n                \"value\": \"\\\"hallO\\\"\"\r\n              },\r\n              \"allowedTags\": {\r\n                \"value\": [\r\n                  \"[parameters('TAG_1')]\",\r\n                  \"FirstName\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/94cf3430-dfc7-4eb4-8e4a-796bcb2854d2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"94cf3430-dfc7-4eb4-8e4a-796bcb2854d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ComplianceTestInitiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Compliance test initiative \",\r\n        \"metadata\": {\r\n          \"category\": \"Compliance test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4047897157028507992\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4859121137597195236\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"centralus\"\r\n                ]\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8935913113203900114\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"eastus2\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a03db67e-a286-43c3-9098-b2da83d361ad\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a03db67e-a286-43c3-9098-b2da83d361ad\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[cstack] Test Initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Some initiative\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"ALLOWEDLOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"eastus2\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8027870979889329152\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/763dcd1d-a4a9-46a8-8bd3-357c4533a335\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": \"[parameters('ALLOWEDLOCATIONS_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a309ad64-0bae-48d9-a6b1-d99c0b42177b\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a309ad64-0bae-48d9-a6b1-d99c0b42177b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test initiative @Notifications BUG 02\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test initiative @Notifications BUG description 02\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"anytag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"sometag\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a46c5bfd-fcc5-41e2-bea1-41355d42618e\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a46c5bfd-fcc5-41e2-bea1-41355d42618e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Subscription tags\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3747236589400509393\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d82a2\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"18121629460155146291\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8339\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"1111868914241026960\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8635\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a752f8cb-6498-4e40-8431-b658ca4d833d\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d833d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test 500 parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16519767739334285097\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"\\\"\\\"\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"\\\"\\\"\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/a8f95acf-554e-459e-adee-a78aab3a808a\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"a8f95acf-554e-459e-adee-a78aab3a808a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"1\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"1\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/bafcd34b-58c6-47b4-bc8b-f35198d6a025\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"bafcd34b-58c6-47b4-bc8b-f35198d6a025\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Camille's evil initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"<img src=\\\"initiativeparam\\\" onerror=\\\"alert('category') />\",\r\n        \"metadata\": {\r\n          \"category\": \"</option><!--\",\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"SETTING_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"<!--\",\r\n              \"description\": null\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13422402288225237808\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n            \"parameters\": {\r\n              \"setting\": {\r\n                \"value\": \"[parameters('SETTING_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"8044870099827093134\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/c579c575-2ac1-44a2-aa4d-75bcc479b23c\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"c579c575-2ac1-44a2-aa4d-75bcc479b23c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TEST TAG 2\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FREE\",\r\n              \" PAID\",\r\n              \" WHATEVER\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4700085587567108372\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"ENVIRONMENT\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/d52d0dbe-1903-4915-bd54-1920b2c9e2e1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"d52d0dbe-1903-4915-bd54-1920b2c9e2e1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TEST TAG\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"INT\",\r\n              \"PROD\",\r\n              \"TEST\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"4700085587567108372\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"ENVIRONMENT\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/db2d139d-613a-4f3b-9ea5-0a29c91ba0f2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"db2d139d-613a-4f3b-9ea5-0a29c91ba0f2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh123\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/db6c5074-a529-4cc8-8882-43f10ef42002\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"db6c5074-a529-4cc8-8882-43f10ef42002\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit a resource based on owner tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Deny a resource if the owner tag is not equal to \\\"Akif\\\"s Resource Group\\\"\",\r\n        \"metadata\": {\r\n          \"category\": \"Beyond Nit\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"Akif\\\"s Resource Group\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/Deny a resource if based on owner tag\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"Deny a resource if based on owner tag\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MuratTest\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"murat\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"ersan\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and its value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"testupdate\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"ignite\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"e4a08f18-4e3e-47af-a2eb-cc96d8c9a01f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Initiative with my parameterized effect policy\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\",\r\n          \"parameterScopes\": {\r\n            \"logAnalytics\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"EFFECT_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Initiative effect\",\r\n              \"description\": null\r\n            },\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16025301204423402856\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"audit\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"15232055014610564026\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2\",\r\n            \"parameters\": {\r\n              \"effect\": {\r\n                \"value\": \"[parameters('EFFECT_1')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/e6884163-54c6-4f5e-9570-9e4cbd95b078\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"e6884163-54c6-4f5e-9570-9e4cbd95b078\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"rohitbh: Initiative with at least one DeployIfNotExists effect\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"3664111848684398324\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13792248241033558297\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"foo\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"bar\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/e8bd5973-5cc3-4431-838c-95f1ab570095\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"e8bd5973-5cc3-4431-838c-95f1ab570095\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"defaultValue: Initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"defaultValue\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16431059056652047295\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"tag\": {\r\n                \"value\": \"lolz\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b4\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"ea1688b3-022e-4add-af39-2fe60689a3b4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"defaultValue: initiative parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"defaultValue\",\r\n          \"parameterScopes\": {\r\n            \"locations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"location\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"resourceGroups\": \"/subscriptions/bc8edd8f-a09f-499d-978d-6b5ed2f84852\",\r\n            \"resourceGroup\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedLocations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedLocation\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedStorageSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedStorageSKU\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedTags\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n            \"allowedTag\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n          }\r\n        },\r\n        \"parameters\": {\r\n          \"LOCATIONS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array)\",\r\n              \"description\": null,\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"LOCATION_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string)\",\r\n              \"description\": null,\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"RESOURCEGROUPS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array)\",\r\n              \"description\": null,\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"camarvin\"\r\n            ]\r\n          },\r\n          \"RESOURCEGROUP_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string)\",\r\n              \"description\": null,\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"TAGS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array)\",\r\n              \"description\": null\r\n            },\r\n            \"defaultValue\": [\r\n              \"FirstName\"\r\n            ]\r\n          },\r\n          \"TAG_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": null\r\n            },\r\n            \"defaultValue\": \"Age\"\r\n          },\r\n          \"ALLOWEDSTORAGESKUS_1\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array, av)\",\r\n              \"description\": null,\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"ALLOWEDSTORAGESKU_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": null,\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"defaultValue\": \"Standard_LRS\"\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7107752599248540199\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"locations\": {\r\n                \"value\": \"[parameters('LOCATIONS_1')]\"\r\n              },\r\n              \"location\": {\r\n                \"value\": \"[parameters('LOCATION_1')]\"\r\n              },\r\n              \"resourceGroups\": {\r\n                \"value\": \"[parameters('RESOURCEGROUPS_1')]\"\r\n              },\r\n              \"resourceGroup\": {\r\n                \"value\": \"[parameters('RESOURCEGROUP_1')]\"\r\n              },\r\n              \"tags\": {\r\n                \"value\": \"[parameters('TAGS_1')]\"\r\n              },\r\n              \"tag\": {\r\n                \"value\": \"[parameters('TAG_1')]\"\r\n              },\r\n              \"allowedLocations\": {\r\n                \"value\": \"[parameters('LOCATIONS_1')]\"\r\n              },\r\n              \"allowedLocation\": {\r\n                \"value\": \"[parameters('LOCATION_1')]\"\r\n              },\r\n              \"allowedStorageSKUs\": {\r\n                \"value\": \"[parameters('ALLOWEDSTORAGESKUS_1')]\"\r\n              },\r\n              \"allowedStorageSKU\": {\r\n                \"value\": \"[parameters('ALLOWEDSTORAGESKU_1')]\"\r\n              },\r\n              \"allowedTags\": {\r\n                \"value\": \"[parameters('TAGS_1')]\"\r\n              },\r\n              \"allowedTag\": {\r\n                \"value\": \"[parameters('TAG_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"16431059056652047295\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"14628640572431045873\",\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n            \"parameters\": {\r\n              \"location\": {\r\n                \"value\": \"\"\r\n              },\r\n              \"resourceGroup\": {\r\n                \"value\": \"\"\r\n              },\r\n              \"allowedLocation\": {\r\n                \"value\": \"westus\"\r\n              },\r\n              \"allowedStorageSKU\": {\r\n                \"value\": \"Standard_ZRS\"\r\n              },\r\n              \"allowedTag\": {\r\n                \"value\": \"LastName\"\r\n              },\r\n              \"resourceGroups\": {\r\n                \"value\": [\r\n                  \"1seau\",\r\n                  \"4seaurg\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/ea1688b3-022e-4add-af39-2fe60689a4d0\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"ea1688b3-022e-4add-af39-2fe60689a4d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Do_not_delete_Initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Do_not_delete_Initiative\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4a0425e4-97bf-4ad0-ab36-145b94083c60\",\r\n            \"parameters\": {\r\n              \"allowedLocations\": {\r\n                \"value\": [\r\n                  \"centralUS\",\r\n                  \"eus\",\r\n                  \"weu\"\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/f2e1010b-86fe-4bee-b076-cb3358394150\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"f2e1010b-86fe-4bee-b076-cb3358394150\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"OS Configuration\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Password Length\"\r\n            }\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"System Cryptography\"\r\n            }\r\n          },\r\n          \"TAGNAME_2\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Network Client Assign Communication\"\r\n            }\r\n          },\r\n          \"TAGVALUE_2\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Retention Policy\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"7154720483946859542\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"17532129644436783767\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_2')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_2')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/f4644c04-68ae-4354-9d82-28e0ca3990f3\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"f4644c04-68ae-4354-9d82-28e0ca3990f3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test for Demo- Remove me\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"parameterScopes\": {}\r\n        },\r\n        \"parameters\": {\r\n          \"TAGNAME_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"ENV\",\r\n              \"OWNER\"\r\n            ]\r\n          },\r\n          \"TAGVALUE_1\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"PROD\",\r\n              \"TEST\",\r\n              \"STAGE\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionReferenceId\": \"9329878778137326421\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('TAGVALUE_1')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionReferenceId\": \"13058340743646448970\",\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('TAGNAME_1')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"Sarah\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/fad75568-aaf8-4d0d-9d55-9cc20bcaa0f3\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"fad75568-aaf8-4d0d-9d55-9cc20bcaa0f3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GetSecure\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/GetSecure\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"GetSecure\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GetSecure2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Test\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/GetSecure2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"GetSecure2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security for HBI applications\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures HBI applications meet security requirements.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/hbiApplicationSecurity\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"hbiApplicationSecurity\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Location initiative definition\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"This initiative enables you to restrict the locations of deploying resources, Audit the deploying resource location and Append a tag in case of successful deploymen.\",\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"allowedValues\": [\r\n              [\r\n                \"East Asia\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ]\r\n            ]\r\n          },\r\n          \"tagName\": {\r\n            \"type\": \"String\"\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"allowedValues\": [\r\n              \"Finance\",\r\n              \"HR\",\r\n              \"Engineering\"\r\n            ]\r\n          },\r\n          \"listOfAuditLocations\": {\r\n            \"type\": \"Array\",\r\n            \"allowedValues\": [\r\n              [\r\n                \"East Asia\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ],\r\n              [\r\n                \"East Asia\",\r\n                \"Southeast Asia\",\r\n                \"Central US\",\r\n                \"East US\"\r\n              ]\r\n            ]\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('listOfAllowedLocations')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n            \"parameters\": {\r\n              \"listOfAllowedLocations\": {\r\n                \"value\": \"[parameters('listOfAuditLocations')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/LocationInitiativeDefinition\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"LocationInitiativeDefinition\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configuration to enable monitoring and service management tools\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces configuration settings that enable the usage of monitoring and service management tooling.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/monitoringConfiguration\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"monitoringConfiguration\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Regulatory compliance requirements for PCI-DSS\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures Azure resources meet PCI-DSS compliance requirements.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/pciDssCompliance\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"pciDssCompliance\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Pol int test\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n            \"parameters\": {}\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/Pol int test\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"Pol int test\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security for PROD applications\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures PROD applications meet security requirements.\",\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/prodApplicationSecurity\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"prodApplicationSecurity\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Architectural requirements for PROD applications\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces architectural requirements for PROD applications.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/prodArchitecture\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"prodArchitecture\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"sandipsh-Initiative2\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"test\",\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": \"[parameters('listOfAllowedSKUs')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/sandipsh-Initiative2\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"sandipsh-Initiative2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"sandipsh_test_9_8_1\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"test test\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/sandipsh_test_9_8_1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"sandipsh_test_9_8_1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"sandipshrg-Initiative1\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"testing purpose....\",\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n            \"parameters\": {\r\n              \"listOfAllowedSKUs\": {\r\n                \"value\": \"[parameters('listOfAllowedSKUs')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/sandipshrg-Initiative1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"sandipshrg-Initiative1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Configuration requirements for service reliability in PROD\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces configuration settings that support service reliability.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/serviceReliability\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"serviceReliability\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Best practice requirements for centrally managed subscriptions\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Enforces best practices for management of Azure subscriptions.\",\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/subManagementBestPractices\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"subManagementBestPractices\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security for all Azure subscriptions\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures Azure subscriptions meet basic security requirements.\",\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/subscriptionSecurity\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"subscriptionSecurity\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Tag resources\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"If required tags are not assigned, append the resources with appropriate tags\",\r\n        \"metadata\": {\r\n          \"category\": \"Tag\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"Application owner\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"VitalyV\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/Tag resources\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"Tag resources\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test initiative\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test initiative\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test initiative\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"test\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\",\r\n              \"displayName\": \"tagName\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\",\r\n              \"displayName\": \"tagValue\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test_sandipsh\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test_sandipsh\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh1\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\",\r\n              \"displayName\": \"tagName\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\",\r\n              \"displayName\": \"tagValue\"\r\n            }\r\n          }\r\n        },\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"[parameters('tagName')]\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\",\r\n            \"parameters\": {}\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test_sandipsh1\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test_sandipsh1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_sandipsh_Audit_Deny_Append\",\r\n        \"policyType\": \"Custom\",\r\n        \"metadata\": {\r\n          \"category\": \"testing\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyDefinitions\": [\r\n          {\r\n            \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"AuditTag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"tagValue\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"DenyTag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"tagValue\"\r\n              }\r\n            }\r\n          },\r\n          {\r\n            \"policyDefinitionId\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n            \"parameters\": {\r\n              \"tagName\": {\r\n                \"value\": \"AppendTag\"\r\n              },\r\n              \"tagValue\": {\r\n                \"value\": \"tagValueAppended123\"\r\n              }\r\n            }\r\n          }\r\n        ]\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/test_sandipsh_Audit_Deny_Append\",\r\n      \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n      \"name\": \"test_sandipsh_Audit_Deny_Append\"\r\n    }\r\n  ]\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:16 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:ef16c9d6-cad0-436d-bcb5-6a0d4e98ffd7"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14982"
        ],
        "x-ms-correlation-request-id": [
          "6011ff8e-d34b-4504-bb75-643feab2f26b"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203216Z:6011ff8e-d34b-4504-bb75-643feab2f26b"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0NjMzNj9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "PUT",
      "RequestBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Definition $[Auto Test]\",\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  }\r\n}",
      "RequestHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Content-Length": [
          "338"
        ],
        "x-ms-client-request-id": [
          "a363cb81-656b-47c6-81fa-ab69200d5ca8"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"azsmnet6336\"\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "457"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:10 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:9905c800-31bb-42f8-99cb-4a7ba143f0e5"
        ],
        "x-ms-ratelimit-remaining-subscription-writes": [
          "1195"
        ],
        "x-ms-correlation-request-id": [
          "13d8b756-601e-4d26-bfa1-b6ca35325c65"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203210Z:13d8b756-601e-4d26-bfa1-b6ca35325c65"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 201
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "920a28a7-d140-4bda-a659-7f37a2cc1819"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"Updated CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"description\": \"Description text\",\r\n    \"metadata\": {\r\n      \"category\": \"sdk test\"\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"1487664155026092119\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\"\r\n      },\r\n      {\r\n        \"policyDefinitionReferenceId\": \"1986915615792559811\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336\"\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"azsmnet3095\"\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:10 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:5643c5e7-f399-49f4-acd9-7356d6b4b65b"
        ],
        "x-ms-ratelimit-remaining-subscription-deletes": [
          "14996"
        ],
        "x-ms-correlation-request-id": [
          "14790f76-12ba-40e1-a71b-a0bbcca7ca6d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203211Z:14790f76-12ba-40e1-a71b-a0bbcca7ca6d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lTZXREZWZpbml0aW9ucy9henNtbmV0MzA5NT9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "451faa4a-4a21-447c-8a01-40c2f35d570f"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Set Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"parameters\": {\r\n      \"fooSet\": {\r\n        \"type\": \"String\"\r\n      }\r\n    },\r\n    \"policyDefinitions\": [\r\n      {\r\n        \"policyDefinitionReferenceId\": \"5863935852193654655\",\r\n        \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\",\r\n        \"parameters\": {\r\n          \"foo\": {\r\n            \"value\": \"[parameters('fooSet')]\"\r\n          }\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/azsmnet3095\",\r\n  \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n  \"name\": \"azsmnet3095\"\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:15 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:cb4251d0-a8e1-4ff4-a422-bf502a1b3da0"
        ],
        "x-ms-ratelimit-remaining-subscription-deletes": [
          "14993"
        ],
        "x-ms-correlation-request-id": [
          "af3cfb5b-ab07-4b4e-b6cd-dcf3e63d180f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203216Z:af3cfb5b-ab07-4b4e-b6cd-dcf3e63d180f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0ODQ2OD9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "777234c2-44e3-4801-909f-e6fe1c5d62b7"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"azsmnet8468\"\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:11 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:ce3c30ce-f20a-4f36-90b2-eb34c74cb6b5"
        ],
        "x-ms-ratelimit-remaining-subscription-deletes": [
          "14995"
        ],
        "x-ms-correlation-request-id": [
          "68550bdb-1b58-4922-a97f-219f061d85b8"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203211Z:68550bdb-1b58-4922-a97f-219f061d85b8"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0ODQ2OD9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "831e22e2-8f6f-48ff-ae1f-d407a94262e2"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"azsmnet8468\",\r\n    \"policyType\": \"Custom\",\r\n    \"parameters\": {\r\n      \"foo\": {\r\n        \"type\": \"String\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"[parameters('foo')]\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"azsmnet8468\"\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:16 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:27f605ed-7412-4e01-9bb0-fb38b18120ee"
        ],
        "x-ms-ratelimit-remaining-subscription-deletes": [
          "14992"
        ],
        "x-ms-correlation-request-id": [
          "78f52ab7-d588-4551-bc63-b7e3548b3e1f"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203217Z:78f52ab7-d588-4551-bc63-b7e3548b3e1f"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0ODQ2OD9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "bb9508c2-5d09-48a9-b171-9ddd03f598ff"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'azsmnet8468' could not be found.\"\r\n  }\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "113"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:11 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:dd402de2-a28e-421f-b047-35b770ee570c"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14988"
        ],
        "x-ms-correlation-request-id": [
          "ff58a278-cc6a-42a2-9eb1-7273715286af"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203211Z:ff58a278-cc6a-42a2-9eb1-7273715286af"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 404
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet8468?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0ODQ2OD9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "7236a986-657c-490f-afae-70e0d4f66de6"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'azsmnet8468' could not be found.\"\r\n  }\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "113"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:16 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:f6f46da4-f42f-4050-85d9-e64c5969a25a"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14981"
        ],
        "x-ms-correlation-request-id": [
          "4e0cb614-84a7-48c6-8757-70aa3680796c"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203217Z:4e0cb614-84a7-48c6-8757-70aa3680796c"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 404
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "8de119a8-00af-4bd4-9e36-7a9ff79e1a97"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit SQL DB Level Audit Setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit DB level audit setting for SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                    \"equals\": \"[parameters('setting')]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit VMs that do not use managed disks\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits VMs that do not use managed disks\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                        \"exists\": \"True\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                        \"exists\": \"True\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a4d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy default OMS VM Extension for Windows VMs.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"NotSpecified\",\r\n        \"description\": \"This policy deploys OMS VM Extensions on Windows VMs, and connects to the selected Log Analytics workspace\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"MicrosoftWindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"WindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"2008-R2-SP1\",\r\n                  \"2008-R2-SP1-smalldisk\",\r\n                  \"2012-Datacenter\",\r\n                  \"2012-Datacenter-smalldisk\",\r\n                  \"2012-R2-Datacenter\",\r\n                  \"2012-R2-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter\",\r\n                  \"2016-Datacenter-Server-Core\",\r\n                  \"2016-Datacenter-Server-Core-smalldisk\",\r\n                  \"2016-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter-with-Containers\",\r\n                  \"2016-Datacenter-with-RDSH\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"MicrosoftMonitoringAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/omsPolicy')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                          \"type\": \"MicrosoftMonitoringAgent\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled monitoring for Windows VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0868462e-646c-4fe3-9ced-a733534b6a2c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unencrypted VM Disks in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"VMs without an enabled disk encryption will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"encryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0961003e-5a0a-4549-abde-af6a37f2724d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit resource location matches resource group location\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit that the resource location matches its resource group location\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notIn\": [\r\n              \"[resourcegroup().location]\",\r\n              \"global\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a914e76-4921-4c19-b460-a2d36003525a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit transparent data encryption status\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit transparent data encryption status for SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                    \"equals\": \"enabled\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17k78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Enforces a required tag and its value. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e30110a-5ceb-460c-a204-c1c3969c6d62\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unprotected web application in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Web applications without a Web Application Firewall protection will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.ClassicCompute/domainNames\",\r\n              \"Microsoft.Web/hostingEnvironments\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"201ea587-7c90-41c3-910f-c280ae01cfd6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy default Microsoft IaaSAntimalware extension for Windows Server\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys a Microsoft IaaSAntimalware extension with a default configuraion when a VM is not configured with the antimalware extension.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"MicrosoftWindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"WindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"2008-R2-SP1\",\r\n                  \"2008-R2-SP1-smalldisk\",\r\n                  \"2012-Datacenter\",\r\n                  \"2012-Datacenter-smalldisk\",\r\n                  \"2012-R2-Datacenter\",\r\n                  \"2012-R2-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter\",\r\n                  \"2016-Datacenter-Server-Core\",\r\n                  \"2016-Datacenter-Server-Core-smalldisk\",\r\n                  \"2016-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter-with-Containers\",\r\n                  \"2016-Datacenter-with-RDSH\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"IaaSAntimalware\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ExclusionsPaths\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file paths or locations to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsExtensions\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file extensions to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsProcesses\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of process names to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"RealtimeProtectionEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not real time protection is enabled (default is true)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsIsEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"false\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not custom scheduled scan settings are enabled (default is false)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsScanType\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Quick\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether scheduled scan setting type is set to Quick or Full (default is Quick)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsDay\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"7\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Day of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsTime\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"120\",\r\n                        \"metadata\": {\r\n                          \"description\": \"When to perform the scheduled scan, measured in minutes from midnight (0-1440). For example: 0 = 12AM, 60 = 1AM, 120 = 2AM.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/IaaSAntimalware')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Security\",\r\n                          \"type\": \"IaaSAntimalware\",\r\n                          \"typeHandlerVersion\": \"1.3\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"AntimalwareEnabled\": true,\r\n                            \"RealtimeProtectionEnabled\": \"[parameters('RealtimeProtectionEnabled')]\",\r\n                            \"ScheduledScanSettings\": {\r\n                              \"isEnabled\": \"[parameters('ScheduledScanSettingsIsEnabled')]\",\r\n                              \"day\": \"[parameters('ScheduledScanSettingsDay')]\",\r\n                              \"time\": \"[parameters('ScheduledScanSettingsTime')]\",\r\n                              \"scanType\": \"[parameters('ScheduledScanSettingsScanType')]\"\r\n                            },\r\n                            \"Exclusions\": {\r\n                              \"Extensions\": \"[parameters('ExclusionsExtensions')]\",\r\n                              \"Paths\": \"[parameters('ExclusionsPaths')]\",\r\n                              \"Processes\": \"[parameters('ExclusionsProcesses')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"RealtimeProtectionEnabled\": {\r\n                      \"value\": \"true\"\r\n                    },\r\n                    \"ScheduledScanSettingsIsEnabled\": {\r\n                      \"value\": \"true\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2835b622-407b-4114-9198-6f7064cbe0dc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Apply tag and its default value\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Applies a required tag and its default value if it is not specified by the user. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a0e14a6-b0a6-4fab-991a-187a4f81c498\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy default OMS VM Extension for Ubuntu VMs.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"NotSpecified\",\r\n        \"description\": \"This policy deploys OMS VM Extensions on Ubuntu VMs, and connects to the selected Log Analytics workspace\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"Canonical\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"UbuntuServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"14.04.2-LTS\",\r\n                  \"12.04.5-LTS\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"OmsAgentForLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/omsPolicy')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                          \"type\": \"OmsAgentForLinux\",\r\n                          \"typeHandlerVersion\": \"1.4\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled monitoring for Linux VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor permissive network access in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Network Security Groups with too permissive rules will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.ClassicNetwork/virtualNetworks\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"permissiveNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"44452482-524f-4bf4-b852-0bff7cc4a3ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require SQL Server version 12.0\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy ensures all SQL servers use version 12.0.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Sql/servers/version\",\r\n                  \"equals\": \"12.0\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce automatic OS upgrade with app health checks on VMSS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enforces usage of automatic OS upgrade with application health checks through health probes, which enables safer rollout by evaluating application health after each OS upgrade batch.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade\",\r\n                      \"equals\": \"True\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/networkProfile.healthProbe.id\",\r\n                    \"exists\": \"False\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"465f0161-0087-490a-9ad9-ad6217f4f43a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor possible app Whitelisting in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Possible Application Whitelist configuration will be monitored by Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"applicationWhitelisting\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"47a6b606-51aa-4496-8bb7-64b11cf66adc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Apply tag and its default value to resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Applies a required tag and its default value to resource groups if it is not specified by the user.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in India data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: West India, South India, Central India\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"westindia\",\r\n                \"southindia\",\r\n                \"centralindia\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit missing blob encryption for storage accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits storage accounts without blob encryption. It only applies to Microsoft.Storage resource types, not other storage providers.Possible network Just In Time access will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"655cb504-bcee-4362-bd4c-402e6aa38759\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Not allowed resource types\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization cannot deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of resource types that cannot be deployed.\",\r\n              \"displayName\": \"Not allowed resource types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypesNotAllowed')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6c112d4e-5bc7-47ae-a041-ea2d9dccd749\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6fdb9205-3462-4cfc-87d8-16c7860b53f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed storage account SKUs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify a set of storage account SKUs that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7433c107-6db4-4ad1-b57a-a76dce0154a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor VM Vulnerabilities in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Monitors vulnerabilities detected by Vulnerability Assessment solution and VMs without a Vulnerability Assessment solution in Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"vulnerabilityAssessment\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"760a85ff-6162-42b3-8d70-698e268f648c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require blob encryption for storage accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy ensures blob encryption for storage accounts is turned on. It only applies to Microsoft.Storage resource types, not other storage providers.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit diagnostic setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit diagnostic setting for selected resource types\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypes')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7f89b1eb-583c-429a-8828-af049802c1d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy SQL DB transparent data encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enables transparent data encryption on SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                    \"equals\": \"Enabled\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullDbName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('fullDbName'), '/current')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n                        \"apiVersion\": \"2014-04-01\",\r\n                        \"properties\": {\r\n                          \"status\": \"Enabled\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullDbName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"86a912f6-9a06-4e26-b447-11b16ba8659f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor missing system updates in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Missing security system updates on your servers will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.OperationalInsights/workspaces\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"systemUpdates\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"86b3d65f-7626-441e-b690-81a8b71cff60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value on resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"notEquals\": \"[parameters('tagValue')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8ce3da23-7156-49e4-b145-24f95f9dcb46\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in European data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: North Europe, West Europe\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"northeurope\",\r\n                \"westeurope\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"94c19f19-8192-48cd-a11b-e37099d3e36b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in United States data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: Central US, East US, East US2, North Central US, South Central US, West US\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"centralus\",\r\n                \"eastus\",\r\n                \"eastus2\",\r\n                \"northcentralus\",\r\n                \"southcentralus\",\r\n                \"westus\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"983211ba-f348-4758-983b-21fa29294869\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unprotected network endpoints in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Network endpoints without a Next Generation Firewall's protection will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.ClassicCompute/domainNames\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedNetworkEndpoint\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9daedab3-fb2d-461e-b861-71790eead4f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed resource types\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of resource types that can be deployed.\",\r\n              \"displayName\": \"Allowed resource types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"type\",\r\n              \"in\": \"[parameters('listOfResourceTypesAllowed')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a08ec900-254a-4555-9bf5-e42af04b5c5c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit SQL server level Auditing settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"NotSpecified\",\r\n        \"description\": \"Audits the existence of SQL Auditing at the server level\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Desired Auditing setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"enabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                \"equals\": \"[parameters('setting')]\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce encryption on DataLakeStore accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures encryption is enabled on all DataLakeStore accounts\",\r\n        \"metadata\": {\r\n          \"category\": \"Data Lake\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DataLakeStore/accounts/encryptionState\",\r\n                \"equals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a7ff3161-0087-490a-9ad9-ad6217f4f43a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unencrypted SQL database in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unencrypted SQL servers or databases will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.SQL/servers\",\r\n              \"Microsoft.SQL/servers/databases\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"encryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a8bef009-a5c9-4d0f-90d7-6018734e8a16\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy network watcher when virtual networks are created\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a network watcher resource in regions with virtual networks. You need to ensure existence of a resource group named networkWatcherRG, which will be used to deploy network watcher instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkWatchers\",\r\n              \"resourceGroupName\": \"networkWatcherRG\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[field('location')]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2016-09-01\",\r\n                        \"type\": \"Microsoft.Network/networkWatchers\",\r\n                        \"name\": \"[concat('networkWacher_', parameters('location'))]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Automatic provisioning of security monitoring agent\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Installs security agent on VMs for advanced security alerts and preventions in Azure Security Center. Applies only for subscriptions that use Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"securityAgent\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"abcc6037-1fc4-47f6-aac5-89706589be24\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation if 'environment' tag value in allowed values\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation if the 'environment' tag is set to one of the following values: production, dev, test, staging\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"tags.environment\",\r\n              \"in\": [\r\n                \"production\",\r\n                \"dev\",\r\n                \"test\",\r\n                \"staging\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ac7e5fc0-c029-4b12-91d4-a8500ce697f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor missing Endpoint Protection in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Servers without an installed Endpoint Protection agent will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.OperationalInsights/workspaces\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"endpointProtection\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"af6cd1bd-1635-48cb-bde7-5b15693900b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unaudited SQL database in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"SQL servers and databases which doesn't have SQL auditing turned on will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.SQL/servers\",\r\n              \"Microsoft.SQL/servers/databases\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"auditing\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"af8051bf-258b-44e2-a2bf-165330459f9d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor possible network JIT access in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Possible network Just In Time access will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"jitNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b0f33259-77d7-4c9e-aac6-3aabcfae693c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Asia data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: East Asia, Southeast Asia, West India, South India, Central India, Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"eastasia\",\r\n                \"southeastasia\",\r\n                \"westindia\",\r\n                \"southindia\",\r\n                \"centralindia\",\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Apply Diagnostic Settings for Network Security Groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy automatically deploys diagnostic settings to network security groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"storagePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Storage Account Prefix for Regional Storage Account\"\r\n            }\r\n          },\r\n          \"rgName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Group Name for Storage Account (must exist)\",\r\n              \"description\": \"This resource group must already exist.\",\r\n              \"strongType\": \"ExistingResourceGroups\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"setbypolicy\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"notlike\": \"*\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"storagePrefix\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"rgName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\",\r\n                        \"name\": \"[concat(parameters('nsgName'),'/Microsoft.Insights/setbypolicy')]\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [\r\n                          \"deployStorageAccount\"\r\n                        ],\r\n                        \"properties\": {\r\n                          \"storageAccountId\": \"[reference('deployStorageAccount').outputs.storageAccountId.value]\",\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"NetworkSecurityGroupEvent\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            },\r\n                            {\r\n                              \"category\": \"NetworkSecurityGroupRuleCounter\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"deployStorageAccount\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[parameters('rgName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"incremental\",\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"storagePrefix\": {\r\n                              \"value\": \"[parameters('storagePrefix')]\"\r\n                            }\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"location\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"storagePrefix\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"apiVersion\": \"2017-06-01\",\r\n                                \"type\": \"Microsoft.Storage/storageAccounts\",\r\n                                \"name\": \"[concat(parameters('storageprefix'), parameters('location'))]\",\r\n                                \"sku\": {\r\n                                  \"name\": \"Standard_LRS\",\r\n                                  \"tier\": \"Standard\"\r\n                                },\r\n                                \"kind\": \"Storage\",\r\n                                \"location\": \"[parameters('location')]\",\r\n                                \"tags\": {\r\n                                  \"created-by\": \"policy\"\r\n                                },\r\n                                \"scale\": null,\r\n                                \"properties\": {\r\n                                  \"networkAcls\": {\r\n                                    \"bypass\": \"AzureServices\",\r\n                                    \"defaultAction\": \"Allow\",\r\n                                    \"ipRules\": [],\r\n                                    \"virtualNetworkRules\": []\r\n                                  },\r\n                                  \"supportsHttpsTrafficOnly\": false\r\n                                }\r\n                              }\r\n                            ],\r\n                            \"outputs\": {\r\n                              \"storageAccountId\": {\r\n                                \"type\": \"string\",\r\n                                \"value\": \"[resourceId('Microsoft.Storage/storageAccounts',concat(parameters('storagePrefix'), parameters('location')))]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"storagePrefix\": {\r\n                      \"value\": \"[parameters('storagePrefix')]\"\r\n                    },\r\n                    \"rgName\": {\r\n                      \"value\": \"[parameters('rgName')]\"\r\n                    },\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed virtual machine SKUs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify a set of virtual machine SKUs that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for virtual machines.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"VMSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cccc23c7-8427-4f53-ad12-b6a63eb452b3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation if 'department' tag set\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation only if the 'department' tag is set\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"tags\",\r\n              \"containsKey\": \"department\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cd8dc879-a2ae-43c3-8211-1877c5755064\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e01598e8-6538-41ed-95e8-8b29746cd697\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor OS vulnerabilities in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Servers which do not satisfy the configured baseline will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.OperationalInsights/workspaces\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"osVulnerabilities\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed locations\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the 'global' region.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that can be specified when deploying resources.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"notEquals\": \"global\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"notEquals\": \"Microsoft.AzureActiveDirectory/b2cDirectories\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e56962a6-4747-49cd-b67b-bf8b01975c4c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed locations for resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that resource groups can be created in.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e765b5de-1225-4ba3-bd56-1ac6695af988\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Auditing on SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures that Auditing is enabled on SQL Servers for enhanced security & compliance. It will automatically create a storage account in the same region as the SQL server to store audit records.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"retentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"The value in days of the retention period (0 indicates unlimited retention)\",\r\n              \"displayName\": \"Retention days (optional, 180 days if unspecified)\"\r\n            },\r\n            \"defaultValue\": \"180\"\r\n          },\r\n          \"storageAccountsResourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource group name for storage accounts\",\r\n              \"description\": \"Auditing writes database events to an audit log in your Azure Storage account (a storage account will be created in each region where a SQL Server is created that will be shared by all servers in that region). Important - for proper operation of Auditing do not delete or rename the resource group or the storage accounts.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                \"equals\": \"Enabled\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"serverName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"auditRetentionDays\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"storageAccountsResourceGroup\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"retentionDays\": \"[int(parameters('auditRetentionDays'))]\",\r\n                      \"subscriptionId\": \"[subscription().subscriptionId]\",\r\n                      \"uniqueStorage\": \"[uniqueString(variables('subscriptionId'), parameters('location'), parameters('storageAccountsResourceGroup'))]\",\r\n                      \"locationCode\": \"[substring(parameters('location'), 0, 3)]\",\r\n                      \"storageName\": \"[tolower(concat('sqlaudit', variables('locationCode'), variables('uniqueStorage')))]\",\r\n                      \"createStorageAccountDeploymentName\": \"[concat('sqlServerAuditingStorageAccount-', variables('locationCode'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[variables('createStorageAccountDeploymentName')]\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[parameters('storageAccountsResourceGroup')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"storageName\": {\r\n                              \"value\": \"[variables('storageName')]\"\r\n                            }\r\n                          },\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n                        \"apiVersion\": \"2017-03-01-preview\",\r\n                        \"properties\": {\r\n                          \"state\": \"Enabled\",\r\n                          \"storageEndpoint\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountEndPoint.value]\",\r\n                          \"storageAccountAccessKey\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountKey.value]\",\r\n                          \"retentionDays\": \"[variables('retentionDays')]\",\r\n                          \"auditActionsAndGroups\": null,\r\n                          \"storageAccountSubscriptionId\": \"[subscription().subscriptionId]\",\r\n                          \"isStorageSecondaryKeyInUse\": false\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"serverName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"auditRetentionDays\": {\r\n                      \"value\": \"[parameters('retentionDays')]\"\r\n                    },\r\n                    \"storageAccountsResourceGroup\": {\r\n                      \"value\": \"[parameters('storageAccountsResourceGroup')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f4c68484-132f-41f9-9b6d-3e4b1cb55036\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"mitest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"mitest desccription\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/0368a0a3-7484-47e0-887d-aa479d32c190\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0368a0a3-7484-47e0-887d-aa479d32c190\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Carolyn-Audit-Sql-DB-tde-disabled\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynz - test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.SQL/servers/databases/transparentDataEncryption\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                \"notEquals\": \"enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/05065268-5c0e-49b9-a13d-95cdd81cae5a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05065268-5c0e-49b9-a13d-95cdd81cae5a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testing\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Cost\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/0837b50a-1e9c-4125-b37e-45419750146f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0837b50a-1e9c-4125-b37e-45419750146f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value on resource groups\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"[concat('tags[',parameters('tagName'), ']')]\",\r\n                  \"equals\": \"[parameters('tagValue')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/08a4edc4-6048-4884-98ae-612ead5b9086\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08a4edc4-6048-4884-98ae-612ead5b9086\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"miTestPolicy01\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"miTestPolicy01 description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/09078deb-cfd0-4257-a8e6-6682a873b1a2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09078deb-cfd0-4257-a8e6-6682a873b1a2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe incident 66953948\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"66953948 \",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"uksouth\",\r\n                \"ukwest\",\r\n                \"global\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/0c28073f-e8d5-4608-ab49-c1a5347c9109\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0c28073f-e8d5-4608-ab49-c1a5347c9109\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testSandipsh metric alert policy3\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"testSandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": \"The description of alert.\"\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ]\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ]\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The operator comparing the current value with the threshold value.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold value at which the alert is activated.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"How the data that is collected should be combined over time.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"How often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-', field('name'))]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-',  parameters('targetResourceName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/123c6354-fc96-4f54-984e-8d49d06a80a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"123c6354-fc96-4f54-984e-8d49d06a80a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Editing Policy 1st time creates duplicates\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Editing Policy for the 1st time creates duplicates - only on 1st time edited policies\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/183de28d-8524-4210-a176-b0a7ff48ef44\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"183de28d-8524-4210-a176-b0a7ff48ef44\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"carolyn auditifnotexists for rg location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynauditifnotexiststest\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Resources/subscriptions/resourceGroups\",\r\n              \"resourceGroupName\": \"carolynauditifnotexiststest\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"West US\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/196629c0-62fd-4768-8d46-02db129686e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"196629c0-62fd-4768-8d46-02db129686e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed resource group locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Allowed resource group locations\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"location\",\r\n                  \"in\": \"[parameters('allowedLocations')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/1f20036f-28c3-48f3-9266-05d50fe391f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f20036f-28c3-48f3-9266-05d50fe391f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"docdb_aliases_test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/isVirtualNetworkFilterEnabled\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/1f5360b7-fe59-43f7-8af5-825df420d09c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f5360b7-fe59-43f7-8af5-825df420d09c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy security rule with restricted source IPs\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Ovewrites security rules with IP restrictions at the securityRule level\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions. Limit to one protocol. The most inclusive should come last. I.e. 22;22-22;22-23\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to. I.e. 192.4.0.0/8;192.5.0.0/8\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"in\": \"[parameters('destinationPortRanges')]\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                              \"notLike\": \"*\"\r\n                            }\r\n                          },\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                              \"notIn\": [\r\n                                \"*\",\r\n                                \"Internet\"\r\n                              ]\r\n                            }\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"notEquals\": \"VirtualNetwork\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notEquals\": \"\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"in\": [\r\n                              \"*\",\r\n                              \"Internet\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notEquals\": \"VirtualNetwork\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"equals\": \"\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"equals\": \"\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n              \"name\": \"DoesNotExist101\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullRuleName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"priority\": {\r\n                        \"type\": \"int\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[parameters('fullRuleName')]\",\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"properties\": {\r\n                          \"protocol\": \"*\",\r\n                          \"sourceAddressPrefixes\": \"[parameters('sourceAddressPrefixes')]\",\r\n                          \"destinationAddressPrefix\": \"*\",\r\n                          \"sourcePortRange\": \"*\",\r\n                          \"destinationPortRange\": \"[last(parameters('destinationPortRanges'))]\",\r\n                          \"access\": \"Allow\",\r\n                          \"direction\": \"Inbound\",\r\n                          \"priority\": \"[parameters('priority')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullRuleName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    },\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    },\r\n                    \"priority\": {\r\n                      \"value\": \"[field('Microsoft.Network/networksecurityGroups/securityRules/priority')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"20c4afd0-8a77-4433-b8b0-4ad06e4c7111\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy NSGs on Subnets\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforce that all subnets have a Network Security Group.  If a subnet does not have one an NSG with the default Internet Exposed Endpoint restrictions will be created and associated with it.\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"nsgPrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"NSG name prefix\",\r\n              \"description\": \"The prefix string to apply to all automatically created network security groups.\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to. I.e. 192.4.0.0/8;192.5.0.0/8\"\r\n            }\r\n          },\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions. Ranges must not overlap.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\",\r\n                        \"exists\": \"false\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\",\r\n                        \"equals\": \"\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\",\r\n                        \"exists\": \"false\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\",\r\n                          \"notEquals\": \"null\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n              \"name\": \"DoesNotExist101\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullResourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgPrefix\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"nsgName\": \"[concat(parameters('nsgPrefix'), '-', parameters('location'))]\",\r\n                      \"vnetName\": \"[split(parameters('fullResourceName'), '/')[0]]\",\r\n                      \"vnetResourceId\": \"[resourceId('Microsoft.Network/virtualNetworks', variables('vnetName'))]\",\r\n                      \"getVnetDeploymentName\": \"[concat('getVnet-', variables('vnetName'))]\",\r\n                      \"collectSubnetsDeploymentName\": \"[concat('collectSubnets-', variables('vnetName'))]\",\r\n                      \"overwriteVnetDeploymentName\": \"[concat('overwriteVnet-', variables('vnetName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('getVnetDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"resources\": [],\r\n                            \"outputs\": {\r\n                              \"vnetProperties\": {\r\n                                \"type\": \"object\",\r\n                                \"value\": \"[reference(variables('vnetResourceId'), '2018-03-01', 'Full')]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"name\": \"[variables('nsgName')]\",\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"securityRules\": [\r\n                            {\r\n                              \"name\": \"PortLockdown_ControlledPorts_Restrict\",\r\n                              \"properties\": {\r\n                                \"description\": \"Allow controlled port connections from specific IP ranges (either corpnet or SAW)\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"\",\r\n                                \"destinationPortRanges\": \"[parameters('destinationPortRanges')]\",\r\n                                \"sourceAddressPrefix\": \"\",\r\n                                \"sourceAddressPrefixes\": \"[parameters('sourceAddressPrefixes')]\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Allow\",\r\n                                \"priority\": 3997,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            },\r\n                            {\r\n                              \"name\": \"PortLockdown_ControlledPorts_AllowVnet\",\r\n                              \"properties\": {\r\n                                \"description\": \"Allow controlled port connections from within the VNET\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"\",\r\n                                \"destinationPortRanges\": \"[parameters('destinationPortRanges')]\",\r\n                                \"sourceAddressPrefix\": \"VirtualNetwork\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Allow\",\r\n                                \"priority\": 3998,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            },\r\n                            {\r\n                              \"name\": \"PortLockdown_ControlledPorts_Deny\",\r\n                              \"properties\": {\r\n                                \"description\": \"Deny any controlled port connections that aren't explicitly allowed in higher priority rules\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"\",\r\n                                \"destinationPortRanges\": \"[parameters('destinationPortRanges')]\",\r\n                                \"sourceAddressPrefix\": \"*\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Deny\",\r\n                                \"priority\": 3999,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            },\r\n                            {\r\n                              \"name\": \"PortLockdown_AllowAll\",\r\n                              \"properties\": {\r\n                                \"description\": \"Allow all inbound traffic that isn't explicitly blocked by Port Lockdown restrictions\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"*\",\r\n                                \"sourceAddressPrefix\": \"*\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Allow\",\r\n                                \"priority\": 4000,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('collectSubnetsDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_collectSubnets_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"vnetProperties\": {\r\n                              \"value\": \"[reference(variables('getVnetDeploymentName')).outputs.vnetProperties.value]\"\r\n                            },\r\n                            \"nsgResourceId\": {\r\n                              \"value\": \"[resourceid('Microsoft.Network/networkSecurityGroups', variables('nsgName'))]\"\r\n                            },\r\n                            \"vnetName\": {\r\n                              \"value\": \"[variables('vnetName')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"dependsOn\": [\r\n                          \"[variables('nsgName')]\"\r\n                        ],\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('overwriteVnetDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_overwriteVnet_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"vnetProperties\": {\r\n                              \"value\": \"[reference(variables('getVnetDeploymentName')).outputs.vnetProperties.value]\"\r\n                            },\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"updatedSubnets\": {\r\n                              \"value\": \"[reference(variables('collectSubnetsDeploymentName')).outputs.updatedSubnets.value]\"\r\n                            },\r\n                            \"vnetName\": {\r\n                              \"value\": \"[variables('vnetName')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullResourceName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"nsgPrefix\": {\r\n                      \"value\": \"[parameters('nsgPrefix')]\"\r\n                    },\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/210ed8bd-6b07-4d5e-a62c-c34f07293288\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"210ed8bd-6b07-4d5e-a62c-c34f07293288\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit existence of a tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audits that a required tag is present on resources\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags\",\r\n            \"notcontainsKey\": \"[parameters('tagName')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24813039-7534-408a-9842-eb99f45721b1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"storage ip rules append 2\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.ipRules\",\r\n                \"value\": [\r\n                  {\r\n                    \"value\": \"8.8.8.8\",\r\n                    \"action\": \"Allow\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/2b2317a7-ab02-47b5-8159-eb7e6227709f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b2317a7-ab02-47b5-8159-eb7e6227709f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Create a tag and value on resource group\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Specified tag name\",\r\n              \"description\": \"Tag Name\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Specified tag value\",\r\n              \"description\": \"Tag Value\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"[concat('tags[',parameters('tagName'), ']')]\",\r\n                  \"equals\": \"[parameters('tagValue')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3538acb4-c730-4da1-a384-c5caab70112a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3538acb4-c730-4da1-a384-c5caab70112a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test41432432\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/369a5575-450a-40d8-9458-cfc4e37e918b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"369a5575-450a-40d8-9458-cfc4e37e918b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_enableAutomaticFailover\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/enableAutomaticFailover\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0a0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_defaultConsistencyLevel\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.DocumentDB/databaseAccounts/consistencyPolicy.defaultConsistencyLevel\",\r\n                  \"equals\": \"lalala\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0b7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_readLocations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allof\": [\r\n                    {\r\n                      \"field\": \"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName\",\r\n                      \"equals\": \"lalala\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0bd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_writeLocations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allof\": [\r\n                    {\r\n                      \"field\": \"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName\",\r\n                      \"equals\": \"lalala\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_failoverPolicies\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allof\": [\r\n                    {\r\n                      \"field\": \"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName\",\r\n                      \"equals\": \"lalala\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd160\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"tt\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3859d794-fd26-44f6-b66b-b44995a2876e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3859d794-fd26-44f6-b66b-b44995a2876e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"          SampleTestPolicy \",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Test policy needed to confirm policy creation end-end\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/39ea2344-43b1-473e-8858-6b9925a911a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"39ea2344-43b1-473e-8858-6b9925a911a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Name should have prefix and suffix\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Name should have prefix and suffix\",\r\n        \"parameters\": {\r\n          \"prefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The prefix\",\r\n              \"description\": \"The name prefix\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"suffix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The suffix\",\r\n              \"description\": \"The name suffix.\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat(parameters('prefix'), '*', parameters('suffix'))]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e275e2e-a157-4ade-8f91-43b3ea370007\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e275e2e-a157-4ade-8f91-43b3ea370007\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Restrict VM skus\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Restricts allowed VM skus to a predefined regex\",\r\n        \"parameters\": {\r\n          \"allowedSkuTemplate\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed VM sku template\",\r\n              \"description\": \"The VM sku template. Supports wildcards via '*'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                \"like\": \"[parameters('allowedSkuTemplate')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e34c8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e3807c1-65c9-49e0-a406-82d8ae3e34c8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit storage account SKU\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audits the use of storage account SKUs that don't meet organizational cost policy.\",\r\n        \"parameters\": {\r\n          \"listOfAllowedSkus\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of allowed SKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSkus')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e3807c1-65c9-49e0-a406-82d8ae3e3682\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Docker Extension (VMSS)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deploys the Docker extension automatically to any VM scale sets that are created.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                \"equals\": \"DockerExtension\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmssName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"name\": \"[concat(parameters('vmssName'), '/', 'dockerExtension')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Extensions\",\r\n                          \"type\": \"DockerExtension\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmssName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f740\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f740\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Docker Extension (VM)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deploys the Docker extension automatically to any VM that is created.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"DockerExtension\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', 'dockerExtension')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Extensions\",\r\n                          \"type\": \"DockerExtension\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f761\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f761\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce autoUpgrade on VM/VMSS extensions\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Denies any VM or VMSS extensions that do not have autoUpgradeMinorVersion set to true.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines/extensions\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f772\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f772\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append autoUpgrade to VM extensions\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Automatically enabled autoUpgradeMinorVersion on VM extensions\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines/extensions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\",\r\n                \"value\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f783\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f783\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append autoUpgrade to VM scale set extensions\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Automatically appends autoUpgradeMinorVersion=true to VMSS extensions\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion\",\r\n                \"value\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f7a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MSIT - AppService must use serverFarm\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/serverFarmId\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/serverFarmId\",\r\n                    \"equals\": \"\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39fc12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MSIT - AppService serverFarm must have capacity > 1\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/serverFarms\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/serverFarms/sku.capacity\",\r\n                \"in\": [\r\n                  \"0\",\r\n                  \"1\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc23\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39fc23\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_123\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"test def\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/499dfea1-dfac-4a64-a3a4-5d4c1d987368\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"499dfea1-dfac-4a64-a3a4-5d4c1d987368\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Do_Not_Delete\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy is used for unit tests. Please do not delete it.\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4a0425e4-97bf-4ad0-ab36-145b94083c60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4a0425e4-97bf-4ad0-ab36-145b94083c60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"elpere_kv_test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/vaults\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.KeyVault/vaults/sku.name\",\r\n                  \"equals\": \"Premium\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4c4c2cc2-c363-45a6-bd38-6b653b9b80ac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4c4c2cc2-c363-45a6-bd38-6b653b9b80ac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure auto-created NSG rules exist\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Ensures that security rules created in auto-created PortLockdown NSGs are not tampered with\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"nsgPrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"NSG name prefix\",\r\n              \"description\": \"The prefix string applied to automatically created network security groups.\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to in the expected security rule. I.e. 192.4.0.0/8;192.5.0.0/8 or *\"\r\n            }\r\n          },\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions in the expected security rule\"\r\n            }\r\n          },\r\n          \"priority\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected priority\",\r\n              \"description\": \"The priority of the expected security rule.\"\r\n            }\r\n          },\r\n          \"access\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected access\",\r\n              \"description\": \"The access (allow/deny) of the expected security rule.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Allow\",\r\n              \"Deny\"\r\n            ]\r\n          },\r\n          \"name\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected name\",\r\n              \"description\": \"The name of the expected security rule.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"[concat(parameters('nsgPrefix'), '-', field('location'))]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/priority\",\r\n                    \"equals\": \"[parameters('priority')]\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                        \"in\": \"[parameters('sourceAddressPrefixes')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"in\": \"[parameters('sourceAddressPrefixes')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                    \"in\": \"[parameters('destinationPortRanges')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"[parameters('access')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"name\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"priority\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"access\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"isSinglePrefix\": \"[equals(count(parameters('sourceAddressPrefixes')), 1)]\",\r\n                      \"isSinglePortRange\": \"[equals(count(parameters('destinationPortRanges')), 1)]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('nsgName'), '/', parameters('name'))]\",\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"properties\": {\r\n                          \"description\": \"Rule auto-created by Internet Exposed Endpoints protection\",\r\n                          \"protocol\": \"*\",\r\n                          \"sourcePortRange\": \"*\",\r\n                          \"destinationPortRange\": \"[if(variables('isSinglePortRange'), first(parameters('destinationPortRanges')), '')]\",\r\n                          \"destinationPortRanges\": \"[if(not(variables('isSinglePortRange')), parameters('destinationPortRanges'), json('[]'))]\",\r\n                          \"sourceAddressPrefix\": \"[if(variables('isSinglePrefix'), first(parameters('sourceAddressPrefixes')), '')]\",\r\n                          \"sourceAddressPrefixes\": \"[if(not(variables('isSinglePrefix')), parameters('sourceAddressPrefixes'), json('[]'))]\",\r\n                          \"destinationAddressPrefix\": \"*\",\r\n                          \"access\": \"[parameters('access')]\",\r\n                          \"priority\": \"[int(parameters('priority'))]\",\r\n                          \"direction\": \"Inbound\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    },\r\n                    \"name\": {\r\n                      \"value\": \"[parameters('name')]\"\r\n                    },\r\n                    \"priority\": {\r\n                      \"value\": \"[parameters('priority')]\"\r\n                    },\r\n                    \"access\": {\r\n                      \"value\": \"[parameters('access')]\"\r\n                    },\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4f283ec4-25a9-46df-bbf2-806ed5a3e115\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"My New policy Def\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"My New policy Def\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/593b5110-2614-4528-adca-5424c7a6a0ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"593b5110-2614-4528-adca-5424c7a6a0ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GokmenhAuditLocation\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit if not west us\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"westus\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5948d091-78b7-4d3b-a404-cc6a0329b0c6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5948d091-78b7-4d3b-a404-cc6a0329b0c6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Testing Policy - Allegion\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Thisst policy - feel free to delete\",\r\n        \"metadata\": {\r\n          \"category\": \"Category Testing Allegion\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5a0a0876-375a-424e-8484-1c699a87916e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5a0a0876-375a-424e-8484-1c699a87916e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Array and object parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"tags\": {\r\n            \"type\": \"Object\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tags to append\",\r\n              \"description\": \"Tags to append to the object.\"\r\n            },\r\n            \"defaultValue\": {\r\n              \"properties\": {\r\n                \"displayName\": \"defaultValue: initiative parameters\",\r\n                \"policyType\": \"Custom\",\r\n                \"metadata\": {\r\n                  \"category\": \"defaultValue\",\r\n                  \"parameterScopes\": {\r\n                    \"locations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"location\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"resourceGroups\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"resourceGroup\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedLocations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedLocation\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedStorageSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedStorageSKU\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedTags\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedTag\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n                  }\r\n                },\r\n                \"parameters\": {\r\n                  \"LOCATIONS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (no scope, array)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"location\"\r\n                    }\r\n                  },\r\n                  \"LOCATION_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (no scope, string)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"location\"\r\n                    }\r\n                  },\r\n                  \"RESOURCEGROUPS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (array)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"existingResourceGroups\"\r\n                    }\r\n                  },\r\n                  \"RESOURCEGROUP_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (string)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"existingResourceGroups\"\r\n                    }\r\n                  },\r\n                  \"TAGS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Non strong type (array)\",\r\n                      \"description\": null\r\n                    }\r\n                  },\r\n                  \"TAG_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Non strong type (string)\",\r\n                      \"description\": null\r\n                    }\r\n                  },\r\n                  \"ALLOWEDSTORAGESKUS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (array, av)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"storageSkus\"\r\n                    },\r\n                    \"allowedValues\": [\r\n                      \"Standard_LRS\",\r\n                      \"Standard_ZRS\",\r\n                      \"Standard_GRS\"\r\n                    ]\r\n                  },\r\n                  \"ALLOWEDSTORAGESKU_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (string, av)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"storageSkus\"\r\n                    },\r\n                    \"allowedValues\": [\r\n                      \"Standard_LRS\",\r\n                      \"Standard_ZRS\",\r\n                      \"Standard_GRS\"\r\n                    ]\r\n                  }\r\n                },\r\n                \"policyDefinitions\": [\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"7107752599248540199\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n                    \"parameters\": {\r\n                      \"locations\": {\r\n                        \"value\": \"[parameters('LOCATIONS_1')]\"\r\n                      },\r\n                      \"location\": {\r\n                        \"value\": \"[parameters('LOCATION_1')]\"\r\n                      },\r\n                      \"resourceGroups\": {\r\n                        \"value\": \"[parameters('RESOURCEGROUPS_1')]\"\r\n                      },\r\n                      \"resourceGroup\": {\r\n                        \"value\": \"[parameters('RESOURCEGROUP_1')]\"\r\n                      },\r\n                      \"tags\": {\r\n                        \"value\": \"[parameters('TAGS_1')]\"\r\n                      },\r\n                      \"tag\": {\r\n                        \"value\": \"[parameters('TAG_1')]\"\r\n                      },\r\n                      \"allowedLocations\": {\r\n                        \"value\": \"[parameters('LOCATIONS_1')]\"\r\n                      },\r\n                      \"allowedLocation\": {\r\n                        \"value\": \"[parameters('LOCATION_1')]\"\r\n                      },\r\n                      \"allowedStorageSKUs\": {\r\n                        \"value\": \"[parameters('ALLOWEDSTORAGESKUS_1')]\"\r\n                      },\r\n                      \"allowedStorageSKU\": {\r\n                        \"value\": \"[parameters('ALLOWEDSTORAGESKU_1')]\"\r\n                      },\r\n                      \"allowedTags\": {\r\n                        \"value\": \"[parameters('TAGS_1')]\"\r\n                      },\r\n                      \"allowedTag\": {\r\n                        \"value\": \"[parameters('TAG_1')]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"16431059056652047295\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n                    \"parameters\": {}\r\n                  },\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"14628640572431045873\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n                    \"parameters\": {\r\n                      \"locations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"location\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"resourceGroups\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"resourceGroup\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"tags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"tag\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"allowedLocations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedLocation\": {\r\n                        \"value\": \"eastus\"\r\n                      },\r\n                      \"allowedStorageSKU\": {\r\n                        \"value\": \"Standard_LRS\"\r\n                      },\r\n                      \"allowedStorageSKUs\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTag\": {\r\n                        \"value\": \"FirstName\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"12403738129896807824\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f3d8eb78-dac2-46d5-94eb-61ab140e56d0\",\r\n                    \"parameters\": {\r\n                      \"locations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"location\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"resourceGroups\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"resourceGroup\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"tags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"tag\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"allowedLocations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedLocation\": {\r\n                        \"value\": \"eastus\"\r\n                      },\r\n                      \"allowedStorageSKU\": {\r\n                        \"value\": \"Standard_LRS\"\r\n                      },\r\n                      \"allowedStorageSKUs\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTag\": {\r\n                        \"value\": \"FirstName\"\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/ea1688b3-022e-4add-af39-2fe60689a4d0\",\r\n              \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n              \"name\": \"ea1688b3-022e-4add-af39-2fe60689a4d0\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags\",\r\n                \"value\": \"[parameters('tags')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5d923625-354f-4884-8ca5-9dcde44c10a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5d923625-354f-4884-8ca5-9dcde44c10a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Test\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5f15b5d9-6596-4360-aae6-7952e65d670f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5f15b5d9-6596-4360-aae6-7952e65d670f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Not allowed resource as types\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization cannot deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Not allowed resource types asd\",\r\n              \"description\": \"The list of resource types that cannot be deployed.\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypesNotAllowed')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6054dcea-3f63-4378-a318-a99ca98dd0ab\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6054dcea-3f63-4378-a318-a99ca98dd0ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"dupitest8\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"1012_Editing_Policy_1st_time_creates_duplicate\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6217eaf6-5cae-4bfd-a692-a755e2f100d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6217eaf6-5cae-4bfd-a692-a755e2f100d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage accounts must be geo-replicated\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Denies creation of any storage account that is not geo-replicated. \",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"allOf\": [\r\n                {\r\n                  \"field\": \"type\",\r\n                  \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n                },\r\n                {\r\n                  \"not\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Storage/storageAccounts/accountType\",\r\n                        \"equals\": \"Standard-GRS\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Storage/storageAccounts/accountType\",\r\n                        \"equals\": \"Standard-RAGRS\"\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6531f253-2bbe-43ef-a065-691cf8db3fcd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6531f253-2bbe-43ef-a065-691cf8db3fcd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit named tag from resource group (testing)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Probably doesn't work\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag name\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[resourcegroup().tags.cc]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6cb4eca9-b204-4ab5-82f7-d48605fc011b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6cb4eca9-b204-4ab5-82f7-d48605fc011b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testSandipsh metric alert policy1\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"testSandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": null\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ],\r\n            \"defaultValue\": \"3\"\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"true\"\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"Metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The metric operator.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"The timeAggregation.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"The window size.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"The evaluation frequency.\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The action group id.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"like\": \"[concat(parameters('alertNamePrefix'), '*')]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(toLower(parameters('alertNamePrefix')), uniqueString(resourceGroup().id))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6f2c6354-fc96-4f54-984e-8d49d06a80a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6f2c6354-fc96-4f54-984e-8d49d06a80a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"dupitest7\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"1019_Delay_grid_data_Refresh_when_needed\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/744205a1-f297-4724-9973-7e7674d4613b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"744205a1-f297-4724-9973-7e7674d4613b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny if blob is not encrypted\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"74d5cf40-7293-46a4-a285-7ea971e3719a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TestPolicy for Edit workflow\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"TestPolicy for Edit workflow description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/75e13aeb-f25b-438f-a21f-ab469da20a58\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"75e13aeb-f25b-438f-a21f-ab469da20a58\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[cstack] Location restriction\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Policy to force allocations to a set of given locations\",\r\n        \"metadata\": {\r\n          \"category\": \"cstack\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/763dcd1d-a4a9-46a8-8bd3-357c4533a335\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"763dcd1d-a4a9-46a8-8bd3-357c4533a335\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Bad field function (blocks PUTS, do NOT apply!)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Dangerous field function (blocks PUTS, do NOT apply!)\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"[field('Microsoft.Cache/Redis/shardCount')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/7ccdb1b8-8600-49d3-82c6-759e0bdf220b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7ccdb1b8-8600-49d3-82c6-759e0bdf220b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CreatedByUItest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8122ed2c-b217-49f6-997a-2357729a2001\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8122ed2c-b217-49f6-997a-2357729a2001\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Parameterized effect (if location != eastus)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The policy effect.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"equals\": \"eastus\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"885f1dcb-a9c5-4c8c-8996-2702db44a2d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Dangerous field policy\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"exists\": \"true\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"location\",\r\n                  \"equals\": \"[field('location')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/890c48eb-8816-4959-9fe4-6591550f006b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"890c48eb-8816-4959-9fe4-6591550f006b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"rg network watcher deployment\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkWatchers\",\r\n              \"resourceGroupName\": \"[resourcegroup().name]\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[resourcegroup().location]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2016-09-01\",\r\n                        \"type\": \"Microsoft.Network/networkWatchers\",\r\n                        \"name\": \"[concat('networkWatcher_', parameters('location'))]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[resourcegroup().location]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8abbc081-f6e3-48f0-a461-e31cd784e190\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8abbc081-f6e3-48f0-a461-e31cd784e190\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit named tag from resource group (doesn't work)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\",\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[concat('',concat('[','resourcegroup().tags.',parameters('tagName'),']'))]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8abbc081-f6e3-48f0-a461-e31cd784e225\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8abbc081-f6e3-48f0-a461-e31cd784e225\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Selector_tagsExistenanceCondition\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"tags.Prod\",\r\n                \"exists\": true\r\n              },\r\n              {\r\n                \"field\": \"tags.Ingestion\",\r\n                \"exists\": true\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"tags.Kusto-Loader\",\r\n                  \"exists\": true\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8dc019ba-6623-4421-acc6-b80872b5e0f8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8dc019ba-6623-4421-acc6-b80872b5e0f8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_ipRangeFilter\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.DocumentDB/databaseAccounts/ipRangeFilter\",\r\n                  \"equals\": \"lalala\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9012b1cd-b045-46c6-a510-6137e06a009c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Policy test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Testing\",\r\n        \"metadata\": {\r\n          \"category\": \"fernando\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9574b7be-5a51-4f1d-aa3a-547e3793713b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9574b7be-5a51-4f1d-aa3a-547e3793713b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TestDefinition_ICM_68617004\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedWindows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Windows VMs\",\r\n              \"description\": \"The list of allowed VMs for Windows.\"\r\n            }\r\n          },\r\n          \"listOfAllowedUbuntus\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Ubuntu VMs\",\r\n              \"description\": \"The list of allowed VMs for Ubuntu.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                ]\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"Canonical\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"UbuntuServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedUbuntus')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"MicrosoftWindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"WindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedWindows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/99869be6-5ded-4db4-b839-222895d6d091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"99869be6-5ded-4db4-b839-222895d6d091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit if subscription\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9fb08bda-022c-448b-b292-0bb0288422bd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9fb08bda-022c-448b-b292-0bb0288422bd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CreatedByUItest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a0c5912f-e951-4c78-a351-48ed69456001\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a0c5912f-e951-4c78-a351-48ed69456001\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe - Subscription Lvl test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Subscriptionlevel auditIfNotExist policy\",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/locks\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"testlock\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a1b067c8-2970-4c0b-b0da-31ae7f33d1de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a1b067c8-2970-4c0b-b0da-31ae7f33d1de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe - subscription non async test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a1b067c8-2970-4c0b-b0da-31ae7f33d2d3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a1b067c8-2970-4c0b-b0da-31ae7f33d2d3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Liz_storage_httpsTrafficOnly\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a23806bc-aa11-4fd8-8d03-4a5cb4b27420\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a23806bc-aa11-4fd8-8d03-4a5cb4b27420\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[cstack] Noop\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Don't do anything\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"yabba\",\r\n              \"dabba\",\r\n              \"doo\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a309ad64-0bae-48d9-a6b1-d99c0b4218b6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a309ad64-0bae-48d9-a6b1-d99c0b4218b6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"add subscription name tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"add subscription name tag\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.subscriptionname\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.subscriptionname\",\r\n                \"value\": \"[subscription().displayName]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d82a2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d82a2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Add subscription \\\"id\\\" tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.id\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.id\",\r\n                \"value\": \"[subscription().id]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8339\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d8339\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"add subscriptionId tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.subscriptionId\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.subscriptionId\",\r\n                \"value\": \"[subscription().subscriptionId]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8635\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d8635\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TestDefinition_ICM_68617004_2\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"The same as the original def with some properties removed to zero in on the issue\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedWindows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Windows VMs\",\r\n              \"description\": \"The list of allowed VMs for Windows.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                ]\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"MicrosoftWindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"WindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedWindows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a8da3197-6bbb-41b3-86ee-63b6071c1091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a8da3197-6bbb-41b3-86ee-63b6071c1091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testSandipsh metric alert policy2\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"testSandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": \"The description of alert.\"\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ]\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ]\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The operator comparing the current value with the threshold value.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold value at which the alert is activated.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"How the data that is collected should be combined over time.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"How often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"like\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '*')]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(parameters('alertNamePrefix'), '-', resourceGroup().name)]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/abcc6354-fc96-4f54-984e-8d49d06a80a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"abcc6354-fc96-4f54-984e-8d49d06a80a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe repo incident 67385980\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Copy definition from css, tags in indexed mode\",\r\n        \"metadata\": {\r\n          \"category\": \"taggy\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\",\r\n              \"description\": \"Name of the tag, such as costCenter\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed values\",\r\n              \"description\": \"The list of allowed values for resource tags.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n              \"in\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/akheICM67385980\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"akheICM67385980\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit if antiMalware extension does not exist\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"This policy audits if the anti malware extension .\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"IaaSAntimalware\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"antiMalwareExtensionExists\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Web socket must be disabled on App Services\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures web sockets are disabled on App Services.\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"foo\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"AppServiceWebSockets\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Security Center must be enabled\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures Azure Security Center is enabled.\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"foo\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ASCEnabled\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit a tag and it's value\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Audits if a tag and it's value doesn't exist for a given resource\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The name for the tag\",\r\n              \"description\": \"The name for the tag.\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The value for the tag\",\r\n              \"description\": \"The value for the tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags.',parameters('tagName'))]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Audit a tag and it's value\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit a tag and it's value\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Audits if a tag and it's value doesn't exist for a given resource\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The name for the tag\",\r\n              \"description\": \"The name for the tag.\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The value for the tag\",\r\n              \"description\": \"The value for the tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags.',parameters('tagName'))]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and its value\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Audit a tag and its value\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet2031\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet2031\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet3628\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet3628\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CanCrudPolicyAssignment Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet5365\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet5365\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet5466\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet5466\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CanCrudPolicySetDefinition Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet6336\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicySetDefinitionErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6756\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet6756\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicySetDefinitionErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7323\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7323\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7529\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7529\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicySetDefinitionErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7577\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7577\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7713\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7713\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"block the creation of VM disks and see what happens\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/disks\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b113f5e5-835c-4685-b2c8-e4fd24204091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b113f5e5-835c-4685-b2c8-e4fd24204091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Resource names must start with Resource Group Name\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Resource names must start with Resource Group Name\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat(resourceGroup().name,'*')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b50f5f4b-45fa-45d9-9488-71cbd37a4091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b50f5f4b-45fa-45d9-9488-71cbd37a4091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny VMs or VMSSs without managed disks\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"majastrz\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                        \"exists\": \"True\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                        \"exists\": \"True\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b82875bf-c4cc-490f-af1a-c54c17218278\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b82875bf-c4cc-490f-af1a-c54c17218278\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow specified VM image publishers\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Marketplace proposal\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedPublishers\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed VM image publishers\",\r\n              \"description\": \"The list of allowed VM image publishers.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/imagePublisher\",\r\n                    \"notIn\": \"[parameters('allowedPublishers')]\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"notIn\": \"[parameters('allowedPublishers')]\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b82875bf-c4cc-490f-af1a-c54c172188d2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b82875bf-c4cc-490f-af1a-c54c172188d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value on resource groups\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"[concat('tags[',parameters('tagName'), ']')]\",\r\n                  \"equals\": \"[parameters('tagValue')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/bab31351-bca0-44b0-8476-ba8f067f208b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bab31351-bca0-44b0-8476-ba8f067f208b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"NSG Rules exists test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].protocol\",\r\n                  \"notLike\": \"*\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/bb6a78ae-8737-41e0-9c41-cc777c8c00a0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bb6a78ae-8737-41e0-9c41-cc777c8c00a0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit allowed locations for resource groups\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of locations that resource groups can be created in.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c0f586f1-abe5-4801-8588-7332e49e60c2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c0f586f1-abe5-4801-8588-7332e49e60c2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit allowed locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c0f586f1-abe5-4801-8588-7332e49e60c9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c0f586f1-abe5-4801-8588-7332e49e60c9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe resource group auditIfNotExists\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/locks\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"testlock\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c7b9982d-2f50-4730-935f-5c241982a441\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c7b9982d-2f50-4730-935f-5c241982a441\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c8b79b49-a579-4045-984e-1b249ab8b474\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"miTestPolicy02\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"miTestPolicy02 description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/cb754054-9fe8-427d-8708-0eeca8e4e1a2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cb754054-9fe8-427d-8708-0eeca8e4e1a2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"miTestPolicy03\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"miTestPolicy03 description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/cb754054-9fe8-427d-8708-0eeca8e4e347\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cb754054-9fe8-427d-8708-0eeca8e4e347\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy security rule with restricted source IPs (NSG level)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Overwrites security rules with IP restrictions at the NSG level\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions. Ranges may overlap.\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to. I.e. 192.4.0.0/8;192.5.0.0/8\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\",\r\n                      \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\r\n                      \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"in\": \"[parameters('destinationPortRanges')]\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                              \"notLike\": \"*\"\r\n                            }\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"notIn\": [\r\n                              \"*\",\r\n                              \"Internet\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notEquals\": \"\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notIn\": [\r\n                              \"*\",\r\n                              \"Internet\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"getNsgDeploymentName\": \"[concat('getNSGContent-', parameters('nsgName'))]\",\r\n                      \"collectorDeploymentName\": \"[concat('collectRules-', parameters('nsgName'))]\",\r\n                      \"overwriteNsgDeploymentName\": \"[concat('overwriteNsg-', parameters('nsgName'))]\",\r\n                      \"nsgResourceId\": \"[resourceId(subscription().subscriptionId, resourceGroup().name, 'Microsoft.Network/networkSecurityGroups', parameters('nsgName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('getNsgDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"resources\": [],\r\n                            \"outputs\": {\r\n                              \"nsgProperties\": {\r\n                                \"type\": \"object\",\r\n                                \"value\": \"[reference(variables('nsgResourceId'), '2018-03-01', 'Full')]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('collectorDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_collectRules_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"nsgProperties\": {\r\n                              \"value\": \"[reference(variables('getNsgDeploymentName')).outputs.nsgProperties.value]\"\r\n                            },\r\n                            \"nsgName\": {\r\n                              \"value\": \"[parameters('nsgName')]\"\r\n                            },\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"portRangesToRestrict\": {\r\n                              \"value\": \"[parameters('destinationPortRanges')]\"\r\n                            },\r\n                            \"sourceAddressPrefixes\": {\r\n                              \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('overwriteNsgDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_overwriteNSG_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"originalNsgProperties\": {\r\n                              \"value\": \"[reference(variables('getNsgDeploymentName')).outputs.nsgProperties.value]\"\r\n                            },\r\n                            \"updatedSecurityRules\": {\r\n                              \"value\": \"[reference(variables('collectorDeploymentName')).outputs.updatedSecurityRules.value]\"\r\n                            },\r\n                            \"nsgName\": {\r\n                              \"value\": \"[parameters('nsgName')]\"\r\n                            },\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/d7b13c30-e6aa-47e1-b50a-8e33f152d086\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"d7b13c30-e6aa-47e1-b50a-8e33f152d086\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit storage account SKUs\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Demo 323\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audited skus\",\r\n              \"description\": \"The list of skus.\",\r\n              \"strongType\": \"storageSkus\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e90ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"dbe1e663-7265-4cf4-96b5-7435b21e90ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit virtual machines SKUs\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Demo 323\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List Of Allowed SKUs\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"vmSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e9170\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"dbe1e663-7265-4cf4-96b5-7435b21e9170\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Location must match resource group location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"{\\n  \\\"policyRule\\\": {\\n   \\\"if\\\": {\\n      \\\"allOf\\\" : {\\n        {\\n          \\\"field\\\": \\\"location\\\",\\n          \\\"exists\\\": \\\"true\\\"\\n        },\\n        {\\n          \\\"field\\\": \\\"location\\\",\\n          \\\"notEquals\\\": \\\"[resourcegroup().location]\\\"\\n        }\\n      }\\n   },\\n   \\\"then\\\": {\\n      \\\"effect\\\": \\\"deny\\\",\\n    }\\n  }\\n}\\n\\n\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notEquals\": \"[resourcegroup().location]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/def1e881-8abb-4d47-85cd-09f68f1ea09c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"def1e881-8abb-4d47-85cd-09f68f1ea09c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test Delete Policy \",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Test Delete Policy description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e277207d-8b6a-4b83-b8dd-056d90af4496\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e277207d-8b6a-4b83-b8dd-056d90af4496\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"allowedOS\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"test_sandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedWindows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Windows VMs\",\r\n              \"description\": \"The list of allowed VMs for Windows.\"\r\n            }\r\n          },\r\n          \"listOfAllowedUbuntus\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Ubuntu VMs\",\r\n              \"description\": \"The list of allowed VMs for Ubuntu.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/disks\",\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                ]\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"Canonical\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"UbuntuServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedUbuntus')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"MicrosoftWindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"WindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedWindows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"narine-testmode-lang\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e5fa2a59-bb7e-40f3-a23b-3793795832a7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e5fa2a59-bb7e-40f3-a23b-3793795832a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_123\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e6e62577-7b30-4419-ba72-382ecb0ee35c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e6e62577-7b30-4419-ba72-382ecb0ee35c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Block turning off transparent data encryption\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                \"equals\": \"disabled\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.SQL/servers/databases/transparentDataEncryption\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e8b79b63-7b19-4440-90cd-e4e45d6592b0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e8b79b63-7b19-4440-90cd-e4e45d6592b0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"defaultValue: all parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"defaultValue\"\r\n        },\r\n        \"parameters\": {\r\n          \"locations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array)\",\r\n              \"description\": \"The list of locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"eastus\",\r\n              \"westus\"\r\n            ]\r\n          },\r\n          \"location\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string)\",\r\n              \"description\": \"The location for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"resourceGroups\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array)\",\r\n              \"description\": \"The list of resource groups.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"camarvin\"\r\n            ]\r\n          },\r\n          \"resourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string)\",\r\n              \"description\": \"The resource group.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": \"camarvin\"\r\n          },\r\n          \"tags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array)\",\r\n              \"description\": \"The list of tags.\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"tag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": \"The tag.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array, av)\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"eastus\"\r\n            ]\r\n          },\r\n          \"allowedLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string, av)\",\r\n              \"description\": \"The allowed location for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ],\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"allowedStorageSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array, av)\",\r\n              \"description\": \"The list of allowed storage SKUs for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"allowedStorageSKU\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": \"The allowed storage SKU for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ],\r\n            \"defaultValue\": \"Standard_LRS\"\r\n          },\r\n          \"allowedTags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array, av)\",\r\n              \"description\": \"The list of allowed tags.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ]\r\n          },\r\n          \"allowedTag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string, av)\",\r\n              \"description\": \"The allowed tag.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ],\r\n            \"defaultValue\": \"FirstName\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('locations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('location')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('resourceGroups')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('resourceGroup')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('tags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('tag')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('allowedLocation')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedStorageSkus')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"Equals\": \"[parameters('allowedStorageSku')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedTags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"NotEquals\": \"[parameters('allowedTag')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ea1688b3-022e-4add-af39-2fe60689a3b0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny \\\"Allow All\\\" NSG rules\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Denies the creation of sourceAddressPrefix=\\\"*\\\", destinationPortRange=\\\"*\\\" NSG security rules\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"PortLockdown_AllowAll\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/priority\",\r\n                \"notEquals\": \"4000\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"equals\": \"*\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notEquals\": \"*\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"in\": [\r\n                          \"*\",\r\n                          \"Internet\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                          \"notIn\": [\r\n                            \"*\",\r\n                            \"Internet\"\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ebcd21e9-b89f-4a22-8654-dd3a4d8b9321\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ebcd21e9-b89f-4a22-8654-dd3a4d8b9321\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security - ServiceFabric - AuditStorageEncryption\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                    \"notEquals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/enableFileEncryption\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ef5ec5b2-2330-401d-8468-3f91615de0ef\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ef5ec5b2-2330-401d-8468-3f91615de0ef\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"marcin-test-policy\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"testing stuff\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"location\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"location\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"equals\": \"[parameters('location')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f04dc6b1-e426-4293-8aa9-2572bbce816a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f04dc6b1-e426-4293-8aa9-2572bbce816a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"must match resource group location (indexed)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"Indexed\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notEquals\": \"[resourcegroup().location]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f0e74307-cf4c-4009-89a5-c3b77d9cc12d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f0e74307-cf4c-4009-89a5-c3b77d9cc12d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"locations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array)\",\r\n              \"description\": \"The list of locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"location\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string)\",\r\n              \"description\": \"The location for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"resourceGroups\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array)\",\r\n              \"description\": \"The list of resource groups.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"resourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string)\",\r\n              \"description\": \"The resource group.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"tags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array)\",\r\n              \"description\": \"The list of tags.\"\r\n            }\r\n          },\r\n          \"tag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": \"The tag.\"\r\n            }\r\n          },\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array, av)\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ]\r\n          },\r\n          \"allowedLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string, av)\",\r\n              \"description\": \"The allowed location for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ]\r\n          },\r\n          \"allowedStorageSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array, av)\",\r\n              \"description\": \"The list of allowed storage SKUs for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"allowedStorageSKU\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": \"The allowed storage SKU for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"allowedTags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array, av)\",\r\n              \"description\": \"The list of allowed tags.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ]\r\n          },\r\n          \"allowedTag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string, av)\",\r\n              \"description\": \"The allowed tag.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('locations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('location')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('resourceGroups')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('resourceGroup')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('tags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('tag')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('allowedLocation')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedStorageSkus')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"Equals\": \"[parameters('allowedStorageSku')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedTags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"NotEquals\": \"[parameters('allowedTag')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f3d8eb78-dac2-46d5-94eb-61ab140e56d0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f3d8eb78-dac2-46d5-94eb-61ab140e56d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim def\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"notin\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f68d5d25-aa23-4373-b10d-4183b3627109\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f68d5d25-aa23-4373-b10d-4183b3627109\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TEST Deny VNet if specific NSGs are not used\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deny\",\r\n        \"parameters\": {\r\n          \"allowedNSGs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\",\r\n                \"notin\": \"[parameters('allowedNSGs')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f7b36161-3a62-4fff-abf2-8b1a469ed1d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f7b36161-3a62-4fff-abf2-8b1a469ed1d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"dupitest4\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"1019_Delay_grid_data_Refresh_when_needed\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/fb809d3a-efb2-4417-83fa-6dc6950d2340\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"fb809d3a-efb2-4417-83fa-6dc6950d2340\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CreatedByUItest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/fe875399-f94a-40e1-9a7b-af775d62f001\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"fe875399-f94a-40e1-9a7b-af775d62f001\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit all resource group tags\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Inherit all resource group tags\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags\",\r\n                \"value\": \"[resourcegroup().tags]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/inheritAllTags\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"inheritAllTags\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit resource group Cost Center tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Inherit resource group Cost Center tag\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.CostCenter\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.CostCenter\",\r\n                \"value\": \"[resourcegroup().tags.CostCenter]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/inheritCostCenter\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"inheritCostCenter\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit allowed locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"This policy enables you to audit your location.\",\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that can be specified when deploying resources.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('listOfAllowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"LocationAuditDefinition\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unit test junk: sorry for littering. Please delete me!\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/Subscriptions/ResourceGroups/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ps6032\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ps6032\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unit test junk: sorry for littering. Please delete me!\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/Subscriptions/ResourceGroups/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ps7280\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ps7280\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require Azure Monitor to be turned on for storage accounts\",\r\n        \"policyType\": \"Custom\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/networkSecurityGroup\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.insights/diagnosticSettings/logs.enabled\",\r\n                \"notequals\": \"True\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Require Azure Monitor to be turned on for storage accounts\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Require Azure Monitor to be turned on for storage accounts\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Restrict resource location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"cstack\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Restrict resource location\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Restrict resource location\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Resource group naming convention\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Resource group naming convention\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect\",\r\n              \"strongType\": \"effect\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat(resourceGroup().name,'*')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/rgnaming\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"rgnaming\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL Server Not Allowed\",\r\n        \"policyType\": \"Custom\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/SQL Server Not Allowed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"SQL Server Not Allowed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"like bug\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"like bug\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect\",\r\n              \"strongType\": \"effect\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat('test','this')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testbadlike\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"testbadlike\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"test policy\",\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": \"The description of alert.\"\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ]\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ]\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The operator comparing the current value with the threshold value.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold value at which the alert is activated.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"How the data that is collected should be combined over time.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"How often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-', field('name'))]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-',  parameters('targetResourceName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testSandipsh.draft\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"testSandipsh.draft\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testtest\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"testtest\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The name for the tag\",\r\n              \"description\": \"The name for the tag.\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The value for the tag\",\r\n              \"description\": \"The value for the tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags.',parameters('tagName'))]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"testtest\"\r\n    }\r\n  ]\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:11 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:9e8368ac-0260-4e28-8e08-a9e2405e5b37"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14987"
        ],
        "x-ms-correlation-request-id": [
          "e92cf0c4-2fa6-42bf-a011-71da3bad1342"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203212Z:e92cf0c4-2fa6-42bf-a011-71da3bad1342"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "95ccd455-59b4-4bd2-8602-72e52b4cf481"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit SQL DB Level Audit Setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit DB level audit setting for SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                    \"equals\": \"[parameters('setting')]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit VMs that do not use managed disks\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits VMs that do not use managed disks\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                        \"exists\": \"True\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                        \"exists\": \"True\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a4d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy default OMS VM Extension for Windows VMs.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"NotSpecified\",\r\n        \"description\": \"This policy deploys OMS VM Extensions on Windows VMs, and connects to the selected Log Analytics workspace\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"MicrosoftWindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"WindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"2008-R2-SP1\",\r\n                  \"2008-R2-SP1-smalldisk\",\r\n                  \"2012-Datacenter\",\r\n                  \"2012-Datacenter-smalldisk\",\r\n                  \"2012-R2-Datacenter\",\r\n                  \"2012-R2-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter\",\r\n                  \"2016-Datacenter-Server-Core\",\r\n                  \"2016-Datacenter-Server-Core-smalldisk\",\r\n                  \"2016-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter-with-Containers\",\r\n                  \"2016-Datacenter-with-RDSH\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"MicrosoftMonitoringAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/omsPolicy')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                          \"type\": \"MicrosoftMonitoringAgent\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled monitoring for Windows VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0868462e-646c-4fe3-9ced-a733534b6a2c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unencrypted VM Disks in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"VMs without an enabled disk encryption will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"encryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0961003e-5a0a-4549-abde-af6a37f2724d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit resource location matches resource group location\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit that the resource location matches its resource group location\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notIn\": [\r\n              \"[resourcegroup().location]\",\r\n              \"global\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a914e76-4921-4c19-b460-a2d36003525a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit transparent data encryption status\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit transparent data encryption status for SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                    \"equals\": \"enabled\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17k78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Enforces a required tag and its value. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e30110a-5ceb-460c-a204-c1c3969c6d62\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unprotected web application in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Web applications without a Web Application Firewall protection will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.ClassicCompute/domainNames\",\r\n              \"Microsoft.Web/hostingEnvironments\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"201ea587-7c90-41c3-910f-c280ae01cfd6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy default Microsoft IaaSAntimalware extension for Windows Server\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys a Microsoft IaaSAntimalware extension with a default configuraion when a VM is not configured with the antimalware extension.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"MicrosoftWindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"WindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"2008-R2-SP1\",\r\n                  \"2008-R2-SP1-smalldisk\",\r\n                  \"2012-Datacenter\",\r\n                  \"2012-Datacenter-smalldisk\",\r\n                  \"2012-R2-Datacenter\",\r\n                  \"2012-R2-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter\",\r\n                  \"2016-Datacenter-Server-Core\",\r\n                  \"2016-Datacenter-Server-Core-smalldisk\",\r\n                  \"2016-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter-with-Containers\",\r\n                  \"2016-Datacenter-with-RDSH\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"IaaSAntimalware\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ExclusionsPaths\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file paths or locations to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsExtensions\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file extensions to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsProcesses\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of process names to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"RealtimeProtectionEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not real time protection is enabled (default is true)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsIsEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"false\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not custom scheduled scan settings are enabled (default is false)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsScanType\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Quick\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether scheduled scan setting type is set to Quick or Full (default is Quick)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsDay\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"7\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Day of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsTime\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"120\",\r\n                        \"metadata\": {\r\n                          \"description\": \"When to perform the scheduled scan, measured in minutes from midnight (0-1440). For example: 0 = 12AM, 60 = 1AM, 120 = 2AM.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/IaaSAntimalware')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Security\",\r\n                          \"type\": \"IaaSAntimalware\",\r\n                          \"typeHandlerVersion\": \"1.3\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"AntimalwareEnabled\": true,\r\n                            \"RealtimeProtectionEnabled\": \"[parameters('RealtimeProtectionEnabled')]\",\r\n                            \"ScheduledScanSettings\": {\r\n                              \"isEnabled\": \"[parameters('ScheduledScanSettingsIsEnabled')]\",\r\n                              \"day\": \"[parameters('ScheduledScanSettingsDay')]\",\r\n                              \"time\": \"[parameters('ScheduledScanSettingsTime')]\",\r\n                              \"scanType\": \"[parameters('ScheduledScanSettingsScanType')]\"\r\n                            },\r\n                            \"Exclusions\": {\r\n                              \"Extensions\": \"[parameters('ExclusionsExtensions')]\",\r\n                              \"Paths\": \"[parameters('ExclusionsPaths')]\",\r\n                              \"Processes\": \"[parameters('ExclusionsProcesses')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"RealtimeProtectionEnabled\": {\r\n                      \"value\": \"true\"\r\n                    },\r\n                    \"ScheduledScanSettingsIsEnabled\": {\r\n                      \"value\": \"true\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2835b622-407b-4114-9198-6f7064cbe0dc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Apply tag and its default value\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Applies a required tag and its default value if it is not specified by the user. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a0e14a6-b0a6-4fab-991a-187a4f81c498\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy default OMS VM Extension for Ubuntu VMs.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"NotSpecified\",\r\n        \"description\": \"This policy deploys OMS VM Extensions on Ubuntu VMs, and connects to the selected Log Analytics workspace\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"Canonical\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"UbuntuServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"14.04.2-LTS\",\r\n                  \"12.04.5-LTS\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"OmsAgentForLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/omsPolicy')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                          \"type\": \"OmsAgentForLinux\",\r\n                          \"typeHandlerVersion\": \"1.4\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled monitoring for Linux VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor permissive network access in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Network Security Groups with too permissive rules will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.ClassicNetwork/virtualNetworks\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"permissiveNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"44452482-524f-4bf4-b852-0bff7cc4a3ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require SQL Server version 12.0\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy ensures all SQL servers use version 12.0.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Sql/servers/version\",\r\n                  \"equals\": \"12.0\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce automatic OS upgrade with app health checks on VMSS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enforces usage of automatic OS upgrade with application health checks through health probes, which enables safer rollout by evaluating application health after each OS upgrade batch.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade\",\r\n                      \"equals\": \"True\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/networkProfile.healthProbe.id\",\r\n                    \"exists\": \"False\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"465f0161-0087-490a-9ad9-ad6217f4f43a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor possible app Whitelisting in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Possible Application Whitelist configuration will be monitored by Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"applicationWhitelisting\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"47a6b606-51aa-4496-8bb7-64b11cf66adc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Apply tag and its default value to resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Applies a required tag and its default value to resource groups if it is not specified by the user.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in India data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: West India, South India, Central India\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"westindia\",\r\n                \"southindia\",\r\n                \"centralindia\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit missing blob encryption for storage accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits storage accounts without blob encryption. It only applies to Microsoft.Storage resource types, not other storage providers.Possible network Just In Time access will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"655cb504-bcee-4362-bd4c-402e6aa38759\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Not allowed resource types\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization cannot deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of resource types that cannot be deployed.\",\r\n              \"displayName\": \"Not allowed resource types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypesNotAllowed')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6c112d4e-5bc7-47ae-a041-ea2d9dccd749\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6fdb9205-3462-4cfc-87d8-16c7860b53f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed storage account SKUs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify a set of storage account SKUs that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7433c107-6db4-4ad1-b57a-a76dce0154a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor VM Vulnerabilities in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Monitors vulnerabilities detected by Vulnerability Assessment solution and VMs without a Vulnerability Assessment solution in Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"vulnerabilityAssessment\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"760a85ff-6162-42b3-8d70-698e268f648c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require blob encryption for storage accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy ensures blob encryption for storage accounts is turned on. It only applies to Microsoft.Storage resource types, not other storage providers.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit diagnostic setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit diagnostic setting for selected resource types\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypes')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7f89b1eb-583c-429a-8828-af049802c1d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy SQL DB transparent data encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enables transparent data encryption on SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                    \"equals\": \"Enabled\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullDbName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('fullDbName'), '/current')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n                        \"apiVersion\": \"2014-04-01\",\r\n                        \"properties\": {\r\n                          \"status\": \"Enabled\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullDbName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"86a912f6-9a06-4e26-b447-11b16ba8659f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor missing system updates in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Missing security system updates on your servers will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.OperationalInsights/workspaces\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"systemUpdates\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"86b3d65f-7626-441e-b690-81a8b71cff60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value on resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"notEquals\": \"[parameters('tagValue')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8ce3da23-7156-49e4-b145-24f95f9dcb46\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in European data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: North Europe, West Europe\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"northeurope\",\r\n                \"westeurope\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"94c19f19-8192-48cd-a11b-e37099d3e36b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in United States data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: Central US, East US, East US2, North Central US, South Central US, West US\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"centralus\",\r\n                \"eastus\",\r\n                \"eastus2\",\r\n                \"northcentralus\",\r\n                \"southcentralus\",\r\n                \"westus\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"983211ba-f348-4758-983b-21fa29294869\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unprotected network endpoints in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Network endpoints without a Next Generation Firewall's protection will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.ClassicCompute/domainNames\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedNetworkEndpoint\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9daedab3-fb2d-461e-b861-71790eead4f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed resource types\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of resource types that can be deployed.\",\r\n              \"displayName\": \"Allowed resource types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"type\",\r\n              \"in\": \"[parameters('listOfResourceTypesAllowed')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a08ec900-254a-4555-9bf5-e42af04b5c5c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit SQL server level Auditing settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"NotSpecified\",\r\n        \"description\": \"Audits the existence of SQL Auditing at the server level\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Desired Auditing setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"enabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                \"equals\": \"[parameters('setting')]\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce encryption on DataLakeStore accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures encryption is enabled on all DataLakeStore accounts\",\r\n        \"metadata\": {\r\n          \"category\": \"Data Lake\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DataLakeStore/accounts/encryptionState\",\r\n                \"equals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a7ff3161-0087-490a-9ad9-ad6217f4f43a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unencrypted SQL database in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unencrypted SQL servers or databases will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.SQL/servers\",\r\n              \"Microsoft.SQL/servers/databases\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"encryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a8bef009-a5c9-4d0f-90d7-6018734e8a16\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy network watcher when virtual networks are created\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a network watcher resource in regions with virtual networks. You need to ensure existence of a resource group named networkWatcherRG, which will be used to deploy network watcher instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkWatchers\",\r\n              \"resourceGroupName\": \"networkWatcherRG\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[field('location')]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2016-09-01\",\r\n                        \"type\": \"Microsoft.Network/networkWatchers\",\r\n                        \"name\": \"[concat('networkWacher_', parameters('location'))]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Automatic provisioning of security monitoring agent\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Installs security agent on VMs for advanced security alerts and preventions in Azure Security Center. Applies only for subscriptions that use Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"securityAgent\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"abcc6037-1fc4-47f6-aac5-89706589be24\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation if 'environment' tag value in allowed values\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation if the 'environment' tag is set to one of the following values: production, dev, test, staging\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"tags.environment\",\r\n              \"in\": [\r\n                \"production\",\r\n                \"dev\",\r\n                \"test\",\r\n                \"staging\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ac7e5fc0-c029-4b12-91d4-a8500ce697f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor missing Endpoint Protection in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Servers without an installed Endpoint Protection agent will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.OperationalInsights/workspaces\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"endpointProtection\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"af6cd1bd-1635-48cb-bde7-5b15693900b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unaudited SQL database in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"SQL servers and databases which doesn't have SQL auditing turned on will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.SQL/servers\",\r\n              \"Microsoft.SQL/servers/databases\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"auditing\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"af8051bf-258b-44e2-a2bf-165330459f9d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor possible network JIT access in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Possible network Just In Time access will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"jitNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b0f33259-77d7-4c9e-aac6-3aabcfae693c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Asia data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: East Asia, Southeast Asia, West India, South India, Central India, Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"eastasia\",\r\n                \"southeastasia\",\r\n                \"westindia\",\r\n                \"southindia\",\r\n                \"centralindia\",\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Apply Diagnostic Settings for Network Security Groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy automatically deploys diagnostic settings to network security groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"storagePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Storage Account Prefix for Regional Storage Account\"\r\n            }\r\n          },\r\n          \"rgName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Group Name for Storage Account (must exist)\",\r\n              \"description\": \"This resource group must already exist.\",\r\n              \"strongType\": \"ExistingResourceGroups\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"setbypolicy\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"notlike\": \"*\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"storagePrefix\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"rgName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\",\r\n                        \"name\": \"[concat(parameters('nsgName'),'/Microsoft.Insights/setbypolicy')]\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [\r\n                          \"deployStorageAccount\"\r\n                        ],\r\n                        \"properties\": {\r\n                          \"storageAccountId\": \"[reference('deployStorageAccount').outputs.storageAccountId.value]\",\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"NetworkSecurityGroupEvent\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            },\r\n                            {\r\n                              \"category\": \"NetworkSecurityGroupRuleCounter\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"deployStorageAccount\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[parameters('rgName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"incremental\",\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"storagePrefix\": {\r\n                              \"value\": \"[parameters('storagePrefix')]\"\r\n                            }\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"location\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"storagePrefix\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"apiVersion\": \"2017-06-01\",\r\n                                \"type\": \"Microsoft.Storage/storageAccounts\",\r\n                                \"name\": \"[concat(parameters('storageprefix'), parameters('location'))]\",\r\n                                \"sku\": {\r\n                                  \"name\": \"Standard_LRS\",\r\n                                  \"tier\": \"Standard\"\r\n                                },\r\n                                \"kind\": \"Storage\",\r\n                                \"location\": \"[parameters('location')]\",\r\n                                \"tags\": {\r\n                                  \"created-by\": \"policy\"\r\n                                },\r\n                                \"scale\": null,\r\n                                \"properties\": {\r\n                                  \"networkAcls\": {\r\n                                    \"bypass\": \"AzureServices\",\r\n                                    \"defaultAction\": \"Allow\",\r\n                                    \"ipRules\": [],\r\n                                    \"virtualNetworkRules\": []\r\n                                  },\r\n                                  \"supportsHttpsTrafficOnly\": false\r\n                                }\r\n                              }\r\n                            ],\r\n                            \"outputs\": {\r\n                              \"storageAccountId\": {\r\n                                \"type\": \"string\",\r\n                                \"value\": \"[resourceId('Microsoft.Storage/storageAccounts',concat(parameters('storagePrefix'), parameters('location')))]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"storagePrefix\": {\r\n                      \"value\": \"[parameters('storagePrefix')]\"\r\n                    },\r\n                    \"rgName\": {\r\n                      \"value\": \"[parameters('rgName')]\"\r\n                    },\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed virtual machine SKUs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify a set of virtual machine SKUs that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for virtual machines.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"VMSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cccc23c7-8427-4f53-ad12-b6a63eb452b3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation if 'department' tag set\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation only if the 'department' tag is set\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"tags\",\r\n              \"containsKey\": \"department\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cd8dc879-a2ae-43c3-8211-1877c5755064\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e01598e8-6538-41ed-95e8-8b29746cd697\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor OS vulnerabilities in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Servers which do not satisfy the configured baseline will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.OperationalInsights/workspaces\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"osVulnerabilities\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed locations\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the 'global' region.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that can be specified when deploying resources.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"notEquals\": \"global\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"notEquals\": \"Microsoft.AzureActiveDirectory/b2cDirectories\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e56962a6-4747-49cd-b67b-bf8b01975c4c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed locations for resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that resource groups can be created in.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e765b5de-1225-4ba3-bd56-1ac6695af988\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Auditing on SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures that Auditing is enabled on SQL Servers for enhanced security & compliance. It will automatically create a storage account in the same region as the SQL server to store audit records.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"retentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"The value in days of the retention period (0 indicates unlimited retention)\",\r\n              \"displayName\": \"Retention days (optional, 180 days if unspecified)\"\r\n            },\r\n            \"defaultValue\": \"180\"\r\n          },\r\n          \"storageAccountsResourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource group name for storage accounts\",\r\n              \"description\": \"Auditing writes database events to an audit log in your Azure Storage account (a storage account will be created in each region where a SQL Server is created that will be shared by all servers in that region). Important - for proper operation of Auditing do not delete or rename the resource group or the storage accounts.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                \"equals\": \"Enabled\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"serverName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"auditRetentionDays\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"storageAccountsResourceGroup\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"retentionDays\": \"[int(parameters('auditRetentionDays'))]\",\r\n                      \"subscriptionId\": \"[subscription().subscriptionId]\",\r\n                      \"uniqueStorage\": \"[uniqueString(variables('subscriptionId'), parameters('location'), parameters('storageAccountsResourceGroup'))]\",\r\n                      \"locationCode\": \"[substring(parameters('location'), 0, 3)]\",\r\n                      \"storageName\": \"[tolower(concat('sqlaudit', variables('locationCode'), variables('uniqueStorage')))]\",\r\n                      \"createStorageAccountDeploymentName\": \"[concat('sqlServerAuditingStorageAccount-', variables('locationCode'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[variables('createStorageAccountDeploymentName')]\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[parameters('storageAccountsResourceGroup')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"storageName\": {\r\n                              \"value\": \"[variables('storageName')]\"\r\n                            }\r\n                          },\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n                        \"apiVersion\": \"2017-03-01-preview\",\r\n                        \"properties\": {\r\n                          \"state\": \"Enabled\",\r\n                          \"storageEndpoint\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountEndPoint.value]\",\r\n                          \"storageAccountAccessKey\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountKey.value]\",\r\n                          \"retentionDays\": \"[variables('retentionDays')]\",\r\n                          \"auditActionsAndGroups\": null,\r\n                          \"storageAccountSubscriptionId\": \"[subscription().subscriptionId]\",\r\n                          \"isStorageSecondaryKeyInUse\": false\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"serverName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"auditRetentionDays\": {\r\n                      \"value\": \"[parameters('retentionDays')]\"\r\n                    },\r\n                    \"storageAccountsResourceGroup\": {\r\n                      \"value\": \"[parameters('storageAccountsResourceGroup')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f4c68484-132f-41f9-9b6d-3e4b1cb55036\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"mitest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"mitest desccription\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/0368a0a3-7484-47e0-887d-aa479d32c190\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0368a0a3-7484-47e0-887d-aa479d32c190\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Carolyn-Audit-Sql-DB-tde-disabled\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynz - test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.SQL/servers/databases/transparentDataEncryption\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                \"notEquals\": \"enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/05065268-5c0e-49b9-a13d-95cdd81cae5a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05065268-5c0e-49b9-a13d-95cdd81cae5a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testing\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Cost\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/0837b50a-1e9c-4125-b37e-45419750146f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0837b50a-1e9c-4125-b37e-45419750146f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value on resource groups\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"[concat('tags[',parameters('tagName'), ']')]\",\r\n                  \"equals\": \"[parameters('tagValue')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/08a4edc4-6048-4884-98ae-612ead5b9086\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08a4edc4-6048-4884-98ae-612ead5b9086\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"miTestPolicy01\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"miTestPolicy01 description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/09078deb-cfd0-4257-a8e6-6682a873b1a2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09078deb-cfd0-4257-a8e6-6682a873b1a2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe incident 66953948\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"66953948 \",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"uksouth\",\r\n                \"ukwest\",\r\n                \"global\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/0c28073f-e8d5-4608-ab49-c1a5347c9109\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0c28073f-e8d5-4608-ab49-c1a5347c9109\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testSandipsh metric alert policy3\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"testSandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": \"The description of alert.\"\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ]\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ]\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The operator comparing the current value with the threshold value.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold value at which the alert is activated.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"How the data that is collected should be combined over time.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"How often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-', field('name'))]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-',  parameters('targetResourceName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/123c6354-fc96-4f54-984e-8d49d06a80a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"123c6354-fc96-4f54-984e-8d49d06a80a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Editing Policy 1st time creates duplicates\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Editing Policy for the 1st time creates duplicates - only on 1st time edited policies\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/183de28d-8524-4210-a176-b0a7ff48ef44\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"183de28d-8524-4210-a176-b0a7ff48ef44\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"carolyn auditifnotexists for rg location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynauditifnotexiststest\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Resources/subscriptions/resourceGroups\",\r\n              \"resourceGroupName\": \"carolynauditifnotexiststest\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"West US\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/196629c0-62fd-4768-8d46-02db129686e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"196629c0-62fd-4768-8d46-02db129686e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed resource group locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Allowed resource group locations\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"location\",\r\n                  \"in\": \"[parameters('allowedLocations')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/1f20036f-28c3-48f3-9266-05d50fe391f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f20036f-28c3-48f3-9266-05d50fe391f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"docdb_aliases_test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/isVirtualNetworkFilterEnabled\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/1f5360b7-fe59-43f7-8af5-825df420d09c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f5360b7-fe59-43f7-8af5-825df420d09c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy security rule with restricted source IPs\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Ovewrites security rules with IP restrictions at the securityRule level\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions. Limit to one protocol. The most inclusive should come last. I.e. 22;22-22;22-23\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to. I.e. 192.4.0.0/8;192.5.0.0/8\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"in\": \"[parameters('destinationPortRanges')]\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                              \"notLike\": \"*\"\r\n                            }\r\n                          },\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                              \"notIn\": [\r\n                                \"*\",\r\n                                \"Internet\"\r\n                              ]\r\n                            }\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"notEquals\": \"VirtualNetwork\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notEquals\": \"\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"in\": [\r\n                              \"*\",\r\n                              \"Internet\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notEquals\": \"VirtualNetwork\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"equals\": \"\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"equals\": \"\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n              \"name\": \"DoesNotExist101\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullRuleName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"priority\": {\r\n                        \"type\": \"int\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[parameters('fullRuleName')]\",\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"properties\": {\r\n                          \"protocol\": \"*\",\r\n                          \"sourceAddressPrefixes\": \"[parameters('sourceAddressPrefixes')]\",\r\n                          \"destinationAddressPrefix\": \"*\",\r\n                          \"sourcePortRange\": \"*\",\r\n                          \"destinationPortRange\": \"[last(parameters('destinationPortRanges'))]\",\r\n                          \"access\": \"Allow\",\r\n                          \"direction\": \"Inbound\",\r\n                          \"priority\": \"[parameters('priority')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullRuleName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    },\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    },\r\n                    \"priority\": {\r\n                      \"value\": \"[field('Microsoft.Network/networksecurityGroups/securityRules/priority')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"20c4afd0-8a77-4433-b8b0-4ad06e4c7111\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy NSGs on Subnets\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforce that all subnets have a Network Security Group.  If a subnet does not have one an NSG with the default Internet Exposed Endpoint restrictions will be created and associated with it.\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"nsgPrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"NSG name prefix\",\r\n              \"description\": \"The prefix string to apply to all automatically created network security groups.\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to. I.e. 192.4.0.0/8;192.5.0.0/8\"\r\n            }\r\n          },\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions. Ranges must not overlap.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\",\r\n                        \"exists\": \"false\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\",\r\n                        \"equals\": \"\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\",\r\n                        \"exists\": \"false\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\",\r\n                          \"notEquals\": \"null\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n              \"name\": \"DoesNotExist101\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullResourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgPrefix\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"nsgName\": \"[concat(parameters('nsgPrefix'), '-', parameters('location'))]\",\r\n                      \"vnetName\": \"[split(parameters('fullResourceName'), '/')[0]]\",\r\n                      \"vnetResourceId\": \"[resourceId('Microsoft.Network/virtualNetworks', variables('vnetName'))]\",\r\n                      \"getVnetDeploymentName\": \"[concat('getVnet-', variables('vnetName'))]\",\r\n                      \"collectSubnetsDeploymentName\": \"[concat('collectSubnets-', variables('vnetName'))]\",\r\n                      \"overwriteVnetDeploymentName\": \"[concat('overwriteVnet-', variables('vnetName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('getVnetDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"resources\": [],\r\n                            \"outputs\": {\r\n                              \"vnetProperties\": {\r\n                                \"type\": \"object\",\r\n                                \"value\": \"[reference(variables('vnetResourceId'), '2018-03-01', 'Full')]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"name\": \"[variables('nsgName')]\",\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"securityRules\": [\r\n                            {\r\n                              \"name\": \"PortLockdown_ControlledPorts_Restrict\",\r\n                              \"properties\": {\r\n                                \"description\": \"Allow controlled port connections from specific IP ranges (either corpnet or SAW)\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"\",\r\n                                \"destinationPortRanges\": \"[parameters('destinationPortRanges')]\",\r\n                                \"sourceAddressPrefix\": \"\",\r\n                                \"sourceAddressPrefixes\": \"[parameters('sourceAddressPrefixes')]\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Allow\",\r\n                                \"priority\": 3997,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            },\r\n                            {\r\n                              \"name\": \"PortLockdown_ControlledPorts_AllowVnet\",\r\n                              \"properties\": {\r\n                                \"description\": \"Allow controlled port connections from within the VNET\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"\",\r\n                                \"destinationPortRanges\": \"[parameters('destinationPortRanges')]\",\r\n                                \"sourceAddressPrefix\": \"VirtualNetwork\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Allow\",\r\n                                \"priority\": 3998,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            },\r\n                            {\r\n                              \"name\": \"PortLockdown_ControlledPorts_Deny\",\r\n                              \"properties\": {\r\n                                \"description\": \"Deny any controlled port connections that aren't explicitly allowed in higher priority rules\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"\",\r\n                                \"destinationPortRanges\": \"[parameters('destinationPortRanges')]\",\r\n                                \"sourceAddressPrefix\": \"*\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Deny\",\r\n                                \"priority\": 3999,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            },\r\n                            {\r\n                              \"name\": \"PortLockdown_AllowAll\",\r\n                              \"properties\": {\r\n                                \"description\": \"Allow all inbound traffic that isn't explicitly blocked by Port Lockdown restrictions\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"*\",\r\n                                \"sourceAddressPrefix\": \"*\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Allow\",\r\n                                \"priority\": 4000,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('collectSubnetsDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_collectSubnets_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"vnetProperties\": {\r\n                              \"value\": \"[reference(variables('getVnetDeploymentName')).outputs.vnetProperties.value]\"\r\n                            },\r\n                            \"nsgResourceId\": {\r\n                              \"value\": \"[resourceid('Microsoft.Network/networkSecurityGroups', variables('nsgName'))]\"\r\n                            },\r\n                            \"vnetName\": {\r\n                              \"value\": \"[variables('vnetName')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"dependsOn\": [\r\n                          \"[variables('nsgName')]\"\r\n                        ],\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('overwriteVnetDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_overwriteVnet_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"vnetProperties\": {\r\n                              \"value\": \"[reference(variables('getVnetDeploymentName')).outputs.vnetProperties.value]\"\r\n                            },\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"updatedSubnets\": {\r\n                              \"value\": \"[reference(variables('collectSubnetsDeploymentName')).outputs.updatedSubnets.value]\"\r\n                            },\r\n                            \"vnetName\": {\r\n                              \"value\": \"[variables('vnetName')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullResourceName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"nsgPrefix\": {\r\n                      \"value\": \"[parameters('nsgPrefix')]\"\r\n                    },\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/210ed8bd-6b07-4d5e-a62c-c34f07293288\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"210ed8bd-6b07-4d5e-a62c-c34f07293288\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit existence of a tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audits that a required tag is present on resources\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags\",\r\n            \"notcontainsKey\": \"[parameters('tagName')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24813039-7534-408a-9842-eb99f45721b1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"storage ip rules append 2\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.ipRules\",\r\n                \"value\": [\r\n                  {\r\n                    \"value\": \"8.8.8.8\",\r\n                    \"action\": \"Allow\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/2b2317a7-ab02-47b5-8159-eb7e6227709f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b2317a7-ab02-47b5-8159-eb7e6227709f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Create a tag and value on resource group\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Specified tag name\",\r\n              \"description\": \"Tag Name\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Specified tag value\",\r\n              \"description\": \"Tag Value\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"[concat('tags[',parameters('tagName'), ']')]\",\r\n                  \"equals\": \"[parameters('tagValue')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3538acb4-c730-4da1-a384-c5caab70112a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3538acb4-c730-4da1-a384-c5caab70112a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test41432432\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/369a5575-450a-40d8-9458-cfc4e37e918b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"369a5575-450a-40d8-9458-cfc4e37e918b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_enableAutomaticFailover\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/enableAutomaticFailover\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0a0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_defaultConsistencyLevel\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.DocumentDB/databaseAccounts/consistencyPolicy.defaultConsistencyLevel\",\r\n                  \"equals\": \"lalala\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0b7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_readLocations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allof\": [\r\n                    {\r\n                      \"field\": \"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName\",\r\n                      \"equals\": \"lalala\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0bd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_writeLocations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allof\": [\r\n                    {\r\n                      \"field\": \"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName\",\r\n                      \"equals\": \"lalala\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_failoverPolicies\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allof\": [\r\n                    {\r\n                      \"field\": \"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName\",\r\n                      \"equals\": \"lalala\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd160\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"tt\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3859d794-fd26-44f6-b66b-b44995a2876e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3859d794-fd26-44f6-b66b-b44995a2876e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"          SampleTestPolicy \",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Test policy needed to confirm policy creation end-end\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/39ea2344-43b1-473e-8858-6b9925a911a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"39ea2344-43b1-473e-8858-6b9925a911a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Name should have prefix and suffix\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Name should have prefix and suffix\",\r\n        \"parameters\": {\r\n          \"prefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The prefix\",\r\n              \"description\": \"The name prefix\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"suffix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The suffix\",\r\n              \"description\": \"The name suffix.\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat(parameters('prefix'), '*', parameters('suffix'))]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e275e2e-a157-4ade-8f91-43b3ea370007\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e275e2e-a157-4ade-8f91-43b3ea370007\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Restrict VM skus\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Restricts allowed VM skus to a predefined regex\",\r\n        \"parameters\": {\r\n          \"allowedSkuTemplate\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed VM sku template\",\r\n              \"description\": \"The VM sku template. Supports wildcards via '*'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                \"like\": \"[parameters('allowedSkuTemplate')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e34c8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e3807c1-65c9-49e0-a406-82d8ae3e34c8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit storage account SKU\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audits the use of storage account SKUs that don't meet organizational cost policy.\",\r\n        \"parameters\": {\r\n          \"listOfAllowedSkus\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of allowed SKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSkus')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e3807c1-65c9-49e0-a406-82d8ae3e3682\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Docker Extension (VMSS)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deploys the Docker extension automatically to any VM scale sets that are created.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                \"equals\": \"DockerExtension\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmssName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"name\": \"[concat(parameters('vmssName'), '/', 'dockerExtension')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Extensions\",\r\n                          \"type\": \"DockerExtension\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmssName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f740\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f740\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Docker Extension (VM)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deploys the Docker extension automatically to any VM that is created.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"DockerExtension\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', 'dockerExtension')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Extensions\",\r\n                          \"type\": \"DockerExtension\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f761\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f761\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce autoUpgrade on VM/VMSS extensions\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Denies any VM or VMSS extensions that do not have autoUpgradeMinorVersion set to true.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines/extensions\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f772\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f772\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append autoUpgrade to VM extensions\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Automatically enabled autoUpgradeMinorVersion on VM extensions\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines/extensions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\",\r\n                \"value\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f783\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f783\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append autoUpgrade to VM scale set extensions\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Automatically appends autoUpgradeMinorVersion=true to VMSS extensions\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion\",\r\n                \"value\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f7a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MSIT - AppService must use serverFarm\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/serverFarmId\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/serverFarmId\",\r\n                    \"equals\": \"\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39fc12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MSIT - AppService serverFarm must have capacity > 1\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/serverFarms\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/serverFarms/sku.capacity\",\r\n                \"in\": [\r\n                  \"0\",\r\n                  \"1\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc23\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39fc23\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_123\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"test def\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/499dfea1-dfac-4a64-a3a4-5d4c1d987368\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"499dfea1-dfac-4a64-a3a4-5d4c1d987368\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Do_Not_Delete\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy is used for unit tests. Please do not delete it.\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4a0425e4-97bf-4ad0-ab36-145b94083c60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4a0425e4-97bf-4ad0-ab36-145b94083c60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"elpere_kv_test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/vaults\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.KeyVault/vaults/sku.name\",\r\n                  \"equals\": \"Premium\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4c4c2cc2-c363-45a6-bd38-6b653b9b80ac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4c4c2cc2-c363-45a6-bd38-6b653b9b80ac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure auto-created NSG rules exist\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Ensures that security rules created in auto-created PortLockdown NSGs are not tampered with\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"nsgPrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"NSG name prefix\",\r\n              \"description\": \"The prefix string applied to automatically created network security groups.\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to in the expected security rule. I.e. 192.4.0.0/8;192.5.0.0/8 or *\"\r\n            }\r\n          },\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions in the expected security rule\"\r\n            }\r\n          },\r\n          \"priority\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected priority\",\r\n              \"description\": \"The priority of the expected security rule.\"\r\n            }\r\n          },\r\n          \"access\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected access\",\r\n              \"description\": \"The access (allow/deny) of the expected security rule.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Allow\",\r\n              \"Deny\"\r\n            ]\r\n          },\r\n          \"name\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected name\",\r\n              \"description\": \"The name of the expected security rule.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"[concat(parameters('nsgPrefix'), '-', field('location'))]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/priority\",\r\n                    \"equals\": \"[parameters('priority')]\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                        \"in\": \"[parameters('sourceAddressPrefixes')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"in\": \"[parameters('sourceAddressPrefixes')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                    \"in\": \"[parameters('destinationPortRanges')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"[parameters('access')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"name\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"priority\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"access\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"isSinglePrefix\": \"[equals(count(parameters('sourceAddressPrefixes')), 1)]\",\r\n                      \"isSinglePortRange\": \"[equals(count(parameters('destinationPortRanges')), 1)]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('nsgName'), '/', parameters('name'))]\",\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"properties\": {\r\n                          \"description\": \"Rule auto-created by Internet Exposed Endpoints protection\",\r\n                          \"protocol\": \"*\",\r\n                          \"sourcePortRange\": \"*\",\r\n                          \"destinationPortRange\": \"[if(variables('isSinglePortRange'), first(parameters('destinationPortRanges')), '')]\",\r\n                          \"destinationPortRanges\": \"[if(not(variables('isSinglePortRange')), parameters('destinationPortRanges'), json('[]'))]\",\r\n                          \"sourceAddressPrefix\": \"[if(variables('isSinglePrefix'), first(parameters('sourceAddressPrefixes')), '')]\",\r\n                          \"sourceAddressPrefixes\": \"[if(not(variables('isSinglePrefix')), parameters('sourceAddressPrefixes'), json('[]'))]\",\r\n                          \"destinationAddressPrefix\": \"*\",\r\n                          \"access\": \"[parameters('access')]\",\r\n                          \"priority\": \"[int(parameters('priority'))]\",\r\n                          \"direction\": \"Inbound\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    },\r\n                    \"name\": {\r\n                      \"value\": \"[parameters('name')]\"\r\n                    },\r\n                    \"priority\": {\r\n                      \"value\": \"[parameters('priority')]\"\r\n                    },\r\n                    \"access\": {\r\n                      \"value\": \"[parameters('access')]\"\r\n                    },\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4f283ec4-25a9-46df-bbf2-806ed5a3e115\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"My New policy Def\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"My New policy Def\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/593b5110-2614-4528-adca-5424c7a6a0ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"593b5110-2614-4528-adca-5424c7a6a0ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GokmenhAuditLocation\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit if not west us\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"westus\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5948d091-78b7-4d3b-a404-cc6a0329b0c6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5948d091-78b7-4d3b-a404-cc6a0329b0c6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Testing Policy - Allegion\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Thisst policy - feel free to delete\",\r\n        \"metadata\": {\r\n          \"category\": \"Category Testing Allegion\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5a0a0876-375a-424e-8484-1c699a87916e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5a0a0876-375a-424e-8484-1c699a87916e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Array and object parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"tags\": {\r\n            \"type\": \"Object\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tags to append\",\r\n              \"description\": \"Tags to append to the object.\"\r\n            },\r\n            \"defaultValue\": {\r\n              \"properties\": {\r\n                \"displayName\": \"defaultValue: initiative parameters\",\r\n                \"policyType\": \"Custom\",\r\n                \"metadata\": {\r\n                  \"category\": \"defaultValue\",\r\n                  \"parameterScopes\": {\r\n                    \"locations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"location\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"resourceGroups\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"resourceGroup\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedLocations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedLocation\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedStorageSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedStorageSKU\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedTags\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedTag\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n                  }\r\n                },\r\n                \"parameters\": {\r\n                  \"LOCATIONS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (no scope, array)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"location\"\r\n                    }\r\n                  },\r\n                  \"LOCATION_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (no scope, string)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"location\"\r\n                    }\r\n                  },\r\n                  \"RESOURCEGROUPS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (array)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"existingResourceGroups\"\r\n                    }\r\n                  },\r\n                  \"RESOURCEGROUP_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (string)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"existingResourceGroups\"\r\n                    }\r\n                  },\r\n                  \"TAGS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Non strong type (array)\",\r\n                      \"description\": null\r\n                    }\r\n                  },\r\n                  \"TAG_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Non strong type (string)\",\r\n                      \"description\": null\r\n                    }\r\n                  },\r\n                  \"ALLOWEDSTORAGESKUS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (array, av)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"storageSkus\"\r\n                    },\r\n                    \"allowedValues\": [\r\n                      \"Standard_LRS\",\r\n                      \"Standard_ZRS\",\r\n                      \"Standard_GRS\"\r\n                    ]\r\n                  },\r\n                  \"ALLOWEDSTORAGESKU_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (string, av)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"storageSkus\"\r\n                    },\r\n                    \"allowedValues\": [\r\n                      \"Standard_LRS\",\r\n                      \"Standard_ZRS\",\r\n                      \"Standard_GRS\"\r\n                    ]\r\n                  }\r\n                },\r\n                \"policyDefinitions\": [\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"7107752599248540199\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n                    \"parameters\": {\r\n                      \"locations\": {\r\n                        \"value\": \"[parameters('LOCATIONS_1')]\"\r\n                      },\r\n                      \"location\": {\r\n                        \"value\": \"[parameters('LOCATION_1')]\"\r\n                      },\r\n                      \"resourceGroups\": {\r\n                        \"value\": \"[parameters('RESOURCEGROUPS_1')]\"\r\n                      },\r\n                      \"resourceGroup\": {\r\n                        \"value\": \"[parameters('RESOURCEGROUP_1')]\"\r\n                      },\r\n                      \"tags\": {\r\n                        \"value\": \"[parameters('TAGS_1')]\"\r\n                      },\r\n                      \"tag\": {\r\n                        \"value\": \"[parameters('TAG_1')]\"\r\n                      },\r\n                      \"allowedLocations\": {\r\n                        \"value\": \"[parameters('LOCATIONS_1')]\"\r\n                      },\r\n                      \"allowedLocation\": {\r\n                        \"value\": \"[parameters('LOCATION_1')]\"\r\n                      },\r\n                      \"allowedStorageSKUs\": {\r\n                        \"value\": \"[parameters('ALLOWEDSTORAGESKUS_1')]\"\r\n                      },\r\n                      \"allowedStorageSKU\": {\r\n                        \"value\": \"[parameters('ALLOWEDSTORAGESKU_1')]\"\r\n                      },\r\n                      \"allowedTags\": {\r\n                        \"value\": \"[parameters('TAGS_1')]\"\r\n                      },\r\n                      \"allowedTag\": {\r\n                        \"value\": \"[parameters('TAG_1')]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"16431059056652047295\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n                    \"parameters\": {}\r\n                  },\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"14628640572431045873\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n                    \"parameters\": {\r\n                      \"locations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"location\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"resourceGroups\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"resourceGroup\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"tags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"tag\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"allowedLocations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedLocation\": {\r\n                        \"value\": \"eastus\"\r\n                      },\r\n                      \"allowedStorageSKU\": {\r\n                        \"value\": \"Standard_LRS\"\r\n                      },\r\n                      \"allowedStorageSKUs\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTag\": {\r\n                        \"value\": \"FirstName\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"12403738129896807824\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f3d8eb78-dac2-46d5-94eb-61ab140e56d0\",\r\n                    \"parameters\": {\r\n                      \"locations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"location\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"resourceGroups\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"resourceGroup\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"tags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"tag\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"allowedLocations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedLocation\": {\r\n                        \"value\": \"eastus\"\r\n                      },\r\n                      \"allowedStorageSKU\": {\r\n                        \"value\": \"Standard_LRS\"\r\n                      },\r\n                      \"allowedStorageSKUs\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTag\": {\r\n                        \"value\": \"FirstName\"\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/ea1688b3-022e-4add-af39-2fe60689a4d0\",\r\n              \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n              \"name\": \"ea1688b3-022e-4add-af39-2fe60689a4d0\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags\",\r\n                \"value\": \"[parameters('tags')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5d923625-354f-4884-8ca5-9dcde44c10a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5d923625-354f-4884-8ca5-9dcde44c10a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Test\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5f15b5d9-6596-4360-aae6-7952e65d670f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5f15b5d9-6596-4360-aae6-7952e65d670f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Not allowed resource as types\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization cannot deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Not allowed resource types asd\",\r\n              \"description\": \"The list of resource types that cannot be deployed.\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypesNotAllowed')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6054dcea-3f63-4378-a318-a99ca98dd0ab\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6054dcea-3f63-4378-a318-a99ca98dd0ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"dupitest8\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"1012_Editing_Policy_1st_time_creates_duplicate\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6217eaf6-5cae-4bfd-a692-a755e2f100d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6217eaf6-5cae-4bfd-a692-a755e2f100d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage accounts must be geo-replicated\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Denies creation of any storage account that is not geo-replicated. \",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"allOf\": [\r\n                {\r\n                  \"field\": \"type\",\r\n                  \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n                },\r\n                {\r\n                  \"not\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Storage/storageAccounts/accountType\",\r\n                        \"equals\": \"Standard-GRS\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Storage/storageAccounts/accountType\",\r\n                        \"equals\": \"Standard-RAGRS\"\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6531f253-2bbe-43ef-a065-691cf8db3fcd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6531f253-2bbe-43ef-a065-691cf8db3fcd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit named tag from resource group (testing)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Probably doesn't work\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag name\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[resourcegroup().tags.cc]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6cb4eca9-b204-4ab5-82f7-d48605fc011b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6cb4eca9-b204-4ab5-82f7-d48605fc011b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testSandipsh metric alert policy1\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"testSandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": null\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ],\r\n            \"defaultValue\": \"3\"\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"true\"\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"Metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The metric operator.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"The timeAggregation.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"The window size.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"The evaluation frequency.\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The action group id.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"like\": \"[concat(parameters('alertNamePrefix'), '*')]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(toLower(parameters('alertNamePrefix')), uniqueString(resourceGroup().id))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6f2c6354-fc96-4f54-984e-8d49d06a80a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6f2c6354-fc96-4f54-984e-8d49d06a80a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"dupitest7\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"1019_Delay_grid_data_Refresh_when_needed\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/744205a1-f297-4724-9973-7e7674d4613b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"744205a1-f297-4724-9973-7e7674d4613b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny if blob is not encrypted\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"74d5cf40-7293-46a4-a285-7ea971e3719a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TestPolicy for Edit workflow\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"TestPolicy for Edit workflow description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/75e13aeb-f25b-438f-a21f-ab469da20a58\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"75e13aeb-f25b-438f-a21f-ab469da20a58\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[cstack] Location restriction\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Policy to force allocations to a set of given locations\",\r\n        \"metadata\": {\r\n          \"category\": \"cstack\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/763dcd1d-a4a9-46a8-8bd3-357c4533a335\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"763dcd1d-a4a9-46a8-8bd3-357c4533a335\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Bad field function (blocks PUTS, do NOT apply!)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Dangerous field function (blocks PUTS, do NOT apply!)\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"[field('Microsoft.Cache/Redis/shardCount')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/7ccdb1b8-8600-49d3-82c6-759e0bdf220b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7ccdb1b8-8600-49d3-82c6-759e0bdf220b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CreatedByUItest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8122ed2c-b217-49f6-997a-2357729a2001\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8122ed2c-b217-49f6-997a-2357729a2001\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Parameterized effect (if location != eastus)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The policy effect.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"equals\": \"eastus\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"885f1dcb-a9c5-4c8c-8996-2702db44a2d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Dangerous field policy\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"exists\": \"true\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"location\",\r\n                  \"equals\": \"[field('location')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/890c48eb-8816-4959-9fe4-6591550f006b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"890c48eb-8816-4959-9fe4-6591550f006b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"rg network watcher deployment\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkWatchers\",\r\n              \"resourceGroupName\": \"[resourcegroup().name]\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[resourcegroup().location]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2016-09-01\",\r\n                        \"type\": \"Microsoft.Network/networkWatchers\",\r\n                        \"name\": \"[concat('networkWatcher_', parameters('location'))]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[resourcegroup().location]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8abbc081-f6e3-48f0-a461-e31cd784e190\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8abbc081-f6e3-48f0-a461-e31cd784e190\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit named tag from resource group (doesn't work)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\",\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[concat('',concat('[','resourcegroup().tags.',parameters('tagName'),']'))]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8abbc081-f6e3-48f0-a461-e31cd784e225\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8abbc081-f6e3-48f0-a461-e31cd784e225\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Selector_tagsExistenanceCondition\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"tags.Prod\",\r\n                \"exists\": true\r\n              },\r\n              {\r\n                \"field\": \"tags.Ingestion\",\r\n                \"exists\": true\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"tags.Kusto-Loader\",\r\n                  \"exists\": true\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8dc019ba-6623-4421-acc6-b80872b5e0f8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8dc019ba-6623-4421-acc6-b80872b5e0f8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_ipRangeFilter\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.DocumentDB/databaseAccounts/ipRangeFilter\",\r\n                  \"equals\": \"lalala\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9012b1cd-b045-46c6-a510-6137e06a009c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Policy test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Testing\",\r\n        \"metadata\": {\r\n          \"category\": \"fernando\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9574b7be-5a51-4f1d-aa3a-547e3793713b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9574b7be-5a51-4f1d-aa3a-547e3793713b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TestDefinition_ICM_68617004\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedWindows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Windows VMs\",\r\n              \"description\": \"The list of allowed VMs for Windows.\"\r\n            }\r\n          },\r\n          \"listOfAllowedUbuntus\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Ubuntu VMs\",\r\n              \"description\": \"The list of allowed VMs for Ubuntu.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                ]\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"Canonical\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"UbuntuServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedUbuntus')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"MicrosoftWindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"WindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedWindows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/99869be6-5ded-4db4-b839-222895d6d091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"99869be6-5ded-4db4-b839-222895d6d091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit if subscription\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9fb08bda-022c-448b-b292-0bb0288422bd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9fb08bda-022c-448b-b292-0bb0288422bd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CreatedByUItest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a0c5912f-e951-4c78-a351-48ed69456001\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a0c5912f-e951-4c78-a351-48ed69456001\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe - Subscription Lvl test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Subscriptionlevel auditIfNotExist policy\",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/locks\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"testlock\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a1b067c8-2970-4c0b-b0da-31ae7f33d1de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a1b067c8-2970-4c0b-b0da-31ae7f33d1de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe - subscription non async test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a1b067c8-2970-4c0b-b0da-31ae7f33d2d3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a1b067c8-2970-4c0b-b0da-31ae7f33d2d3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Liz_storage_httpsTrafficOnly\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a23806bc-aa11-4fd8-8d03-4a5cb4b27420\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a23806bc-aa11-4fd8-8d03-4a5cb4b27420\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[cstack] Noop\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Don't do anything\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"yabba\",\r\n              \"dabba\",\r\n              \"doo\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a309ad64-0bae-48d9-a6b1-d99c0b4218b6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a309ad64-0bae-48d9-a6b1-d99c0b4218b6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"add subscription name tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"add subscription name tag\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.subscriptionname\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.subscriptionname\",\r\n                \"value\": \"[subscription().displayName]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d82a2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d82a2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Add subscription \\\"id\\\" tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.id\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.id\",\r\n                \"value\": \"[subscription().id]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8339\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d8339\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"add subscriptionId tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.subscriptionId\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.subscriptionId\",\r\n                \"value\": \"[subscription().subscriptionId]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8635\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d8635\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TestDefinition_ICM_68617004_2\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"The same as the original def with some properties removed to zero in on the issue\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedWindows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Windows VMs\",\r\n              \"description\": \"The list of allowed VMs for Windows.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                ]\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"MicrosoftWindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"WindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedWindows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a8da3197-6bbb-41b3-86ee-63b6071c1091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a8da3197-6bbb-41b3-86ee-63b6071c1091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testSandipsh metric alert policy2\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"testSandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": \"The description of alert.\"\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ]\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ]\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The operator comparing the current value with the threshold value.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold value at which the alert is activated.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"How the data that is collected should be combined over time.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"How often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"like\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '*')]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(parameters('alertNamePrefix'), '-', resourceGroup().name)]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/abcc6354-fc96-4f54-984e-8d49d06a80a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"abcc6354-fc96-4f54-984e-8d49d06a80a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe repo incident 67385980\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Copy definition from css, tags in indexed mode\",\r\n        \"metadata\": {\r\n          \"category\": \"taggy\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\",\r\n              \"description\": \"Name of the tag, such as costCenter\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed values\",\r\n              \"description\": \"The list of allowed values for resource tags.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n              \"in\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/akheICM67385980\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"akheICM67385980\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit if antiMalware extension does not exist\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"This policy audits if the anti malware extension .\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"IaaSAntimalware\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"antiMalwareExtensionExists\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Web socket must be disabled on App Services\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures web sockets are disabled on App Services.\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"foo\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"AppServiceWebSockets\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Security Center must be enabled\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures Azure Security Center is enabled.\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"foo\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ASCEnabled\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit a tag and it's value\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Audits if a tag and it's value doesn't exist for a given resource\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The name for the tag\",\r\n              \"description\": \"The name for the tag.\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The value for the tag\",\r\n              \"description\": \"The value for the tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags.',parameters('tagName'))]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Audit a tag and it's value\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit a tag and it's value\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Audits if a tag and it's value doesn't exist for a given resource\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The name for the tag\",\r\n              \"description\": \"The name for the tag.\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The value for the tag\",\r\n              \"description\": \"The value for the tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags.',parameters('tagName'))]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and its value\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Audit a tag and its value\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet2031\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet2031\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet3628\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet3628\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CanCrudPolicyAssignment Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet5365\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet5365\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet5466\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet5466\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicySetDefinitionErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6756\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet6756\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicySetDefinitionErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7323\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7323\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7529\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7529\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicySetDefinitionErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7577\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7577\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7713\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7713\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"block the creation of VM disks and see what happens\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/disks\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b113f5e5-835c-4685-b2c8-e4fd24204091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b113f5e5-835c-4685-b2c8-e4fd24204091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Resource names must start with Resource Group Name\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Resource names must start with Resource Group Name\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat(resourceGroup().name,'*')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b50f5f4b-45fa-45d9-9488-71cbd37a4091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b50f5f4b-45fa-45d9-9488-71cbd37a4091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny VMs or VMSSs without managed disks\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"majastrz\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                        \"exists\": \"True\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                        \"exists\": \"True\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b82875bf-c4cc-490f-af1a-c54c17218278\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b82875bf-c4cc-490f-af1a-c54c17218278\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow specified VM image publishers\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Marketplace proposal\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedPublishers\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed VM image publishers\",\r\n              \"description\": \"The list of allowed VM image publishers.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/imagePublisher\",\r\n                    \"notIn\": \"[parameters('allowedPublishers')]\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"notIn\": \"[parameters('allowedPublishers')]\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b82875bf-c4cc-490f-af1a-c54c172188d2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b82875bf-c4cc-490f-af1a-c54c172188d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value on resource groups\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"[concat('tags[',parameters('tagName'), ']')]\",\r\n                  \"equals\": \"[parameters('tagValue')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/bab31351-bca0-44b0-8476-ba8f067f208b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bab31351-bca0-44b0-8476-ba8f067f208b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"NSG Rules exists test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].protocol\",\r\n                  \"notLike\": \"*\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/bb6a78ae-8737-41e0-9c41-cc777c8c00a0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bb6a78ae-8737-41e0-9c41-cc777c8c00a0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit allowed locations for resource groups\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of locations that resource groups can be created in.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c0f586f1-abe5-4801-8588-7332e49e60c2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c0f586f1-abe5-4801-8588-7332e49e60c2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit allowed locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c0f586f1-abe5-4801-8588-7332e49e60c9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c0f586f1-abe5-4801-8588-7332e49e60c9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe resource group auditIfNotExists\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/locks\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"testlock\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c7b9982d-2f50-4730-935f-5c241982a441\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c7b9982d-2f50-4730-935f-5c241982a441\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c8b79b49-a579-4045-984e-1b249ab8b474\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"miTestPolicy02\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"miTestPolicy02 description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/cb754054-9fe8-427d-8708-0eeca8e4e1a2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cb754054-9fe8-427d-8708-0eeca8e4e1a2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"miTestPolicy03\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"miTestPolicy03 description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/cb754054-9fe8-427d-8708-0eeca8e4e347\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cb754054-9fe8-427d-8708-0eeca8e4e347\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy security rule with restricted source IPs (NSG level)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Overwrites security rules with IP restrictions at the NSG level\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions. Ranges may overlap.\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to. I.e. 192.4.0.0/8;192.5.0.0/8\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\",\r\n                      \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\r\n                      \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"in\": \"[parameters('destinationPortRanges')]\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                              \"notLike\": \"*\"\r\n                            }\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"notIn\": [\r\n                              \"*\",\r\n                              \"Internet\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notEquals\": \"\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notIn\": [\r\n                              \"*\",\r\n                              \"Internet\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"getNsgDeploymentName\": \"[concat('getNSGContent-', parameters('nsgName'))]\",\r\n                      \"collectorDeploymentName\": \"[concat('collectRules-', parameters('nsgName'))]\",\r\n                      \"overwriteNsgDeploymentName\": \"[concat('overwriteNsg-', parameters('nsgName'))]\",\r\n                      \"nsgResourceId\": \"[resourceId(subscription().subscriptionId, resourceGroup().name, 'Microsoft.Network/networkSecurityGroups', parameters('nsgName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('getNsgDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"resources\": [],\r\n                            \"outputs\": {\r\n                              \"nsgProperties\": {\r\n                                \"type\": \"object\",\r\n                                \"value\": \"[reference(variables('nsgResourceId'), '2018-03-01', 'Full')]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('collectorDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_collectRules_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"nsgProperties\": {\r\n                              \"value\": \"[reference(variables('getNsgDeploymentName')).outputs.nsgProperties.value]\"\r\n                            },\r\n                            \"nsgName\": {\r\n                              \"value\": \"[parameters('nsgName')]\"\r\n                            },\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"portRangesToRestrict\": {\r\n                              \"value\": \"[parameters('destinationPortRanges')]\"\r\n                            },\r\n                            \"sourceAddressPrefixes\": {\r\n                              \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('overwriteNsgDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_overwriteNSG_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"originalNsgProperties\": {\r\n                              \"value\": \"[reference(variables('getNsgDeploymentName')).outputs.nsgProperties.value]\"\r\n                            },\r\n                            \"updatedSecurityRules\": {\r\n                              \"value\": \"[reference(variables('collectorDeploymentName')).outputs.updatedSecurityRules.value]\"\r\n                            },\r\n                            \"nsgName\": {\r\n                              \"value\": \"[parameters('nsgName')]\"\r\n                            },\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/d7b13c30-e6aa-47e1-b50a-8e33f152d086\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"d7b13c30-e6aa-47e1-b50a-8e33f152d086\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit storage account SKUs\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Demo 323\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audited skus\",\r\n              \"description\": \"The list of skus.\",\r\n              \"strongType\": \"storageSkus\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e90ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"dbe1e663-7265-4cf4-96b5-7435b21e90ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit virtual machines SKUs\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Demo 323\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List Of Allowed SKUs\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"vmSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e9170\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"dbe1e663-7265-4cf4-96b5-7435b21e9170\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Location must match resource group location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"{\\n  \\\"policyRule\\\": {\\n   \\\"if\\\": {\\n      \\\"allOf\\\" : {\\n        {\\n          \\\"field\\\": \\\"location\\\",\\n          \\\"exists\\\": \\\"true\\\"\\n        },\\n        {\\n          \\\"field\\\": \\\"location\\\",\\n          \\\"notEquals\\\": \\\"[resourcegroup().location]\\\"\\n        }\\n      }\\n   },\\n   \\\"then\\\": {\\n      \\\"effect\\\": \\\"deny\\\",\\n    }\\n  }\\n}\\n\\n\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notEquals\": \"[resourcegroup().location]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/def1e881-8abb-4d47-85cd-09f68f1ea09c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"def1e881-8abb-4d47-85cd-09f68f1ea09c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test Delete Policy \",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Test Delete Policy description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e277207d-8b6a-4b83-b8dd-056d90af4496\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e277207d-8b6a-4b83-b8dd-056d90af4496\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"allowedOS\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"test_sandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedWindows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Windows VMs\",\r\n              \"description\": \"The list of allowed VMs for Windows.\"\r\n            }\r\n          },\r\n          \"listOfAllowedUbuntus\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Ubuntu VMs\",\r\n              \"description\": \"The list of allowed VMs for Ubuntu.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/disks\",\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                ]\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"Canonical\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"UbuntuServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedUbuntus')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"MicrosoftWindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"WindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedWindows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"narine-testmode-lang\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e5fa2a59-bb7e-40f3-a23b-3793795832a7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e5fa2a59-bb7e-40f3-a23b-3793795832a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_123\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e6e62577-7b30-4419-ba72-382ecb0ee35c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e6e62577-7b30-4419-ba72-382ecb0ee35c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Block turning off transparent data encryption\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                \"equals\": \"disabled\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.SQL/servers/databases/transparentDataEncryption\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e8b79b63-7b19-4440-90cd-e4e45d6592b0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e8b79b63-7b19-4440-90cd-e4e45d6592b0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"defaultValue: all parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"defaultValue\"\r\n        },\r\n        \"parameters\": {\r\n          \"locations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array)\",\r\n              \"description\": \"The list of locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"eastus\",\r\n              \"westus\"\r\n            ]\r\n          },\r\n          \"location\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string)\",\r\n              \"description\": \"The location for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"resourceGroups\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array)\",\r\n              \"description\": \"The list of resource groups.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"camarvin\"\r\n            ]\r\n          },\r\n          \"resourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string)\",\r\n              \"description\": \"The resource group.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": \"camarvin\"\r\n          },\r\n          \"tags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array)\",\r\n              \"description\": \"The list of tags.\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"tag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": \"The tag.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array, av)\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"eastus\"\r\n            ]\r\n          },\r\n          \"allowedLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string, av)\",\r\n              \"description\": \"The allowed location for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ],\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"allowedStorageSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array, av)\",\r\n              \"description\": \"The list of allowed storage SKUs for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"allowedStorageSKU\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": \"The allowed storage SKU for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ],\r\n            \"defaultValue\": \"Standard_LRS\"\r\n          },\r\n          \"allowedTags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array, av)\",\r\n              \"description\": \"The list of allowed tags.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ]\r\n          },\r\n          \"allowedTag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string, av)\",\r\n              \"description\": \"The allowed tag.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ],\r\n            \"defaultValue\": \"FirstName\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('locations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('location')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('resourceGroups')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('resourceGroup')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('tags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('tag')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('allowedLocation')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedStorageSkus')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"Equals\": \"[parameters('allowedStorageSku')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedTags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"NotEquals\": \"[parameters('allowedTag')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ea1688b3-022e-4add-af39-2fe60689a3b0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny \\\"Allow All\\\" NSG rules\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Denies the creation of sourceAddressPrefix=\\\"*\\\", destinationPortRange=\\\"*\\\" NSG security rules\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"PortLockdown_AllowAll\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/priority\",\r\n                \"notEquals\": \"4000\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"equals\": \"*\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notEquals\": \"*\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"in\": [\r\n                          \"*\",\r\n                          \"Internet\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                          \"notIn\": [\r\n                            \"*\",\r\n                            \"Internet\"\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ebcd21e9-b89f-4a22-8654-dd3a4d8b9321\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ebcd21e9-b89f-4a22-8654-dd3a4d8b9321\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security - ServiceFabric - AuditStorageEncryption\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                    \"notEquals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/enableFileEncryption\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ef5ec5b2-2330-401d-8468-3f91615de0ef\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ef5ec5b2-2330-401d-8468-3f91615de0ef\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"marcin-test-policy\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"testing stuff\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"location\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"location\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"equals\": \"[parameters('location')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f04dc6b1-e426-4293-8aa9-2572bbce816a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f04dc6b1-e426-4293-8aa9-2572bbce816a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"must match resource group location (indexed)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"Indexed\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notEquals\": \"[resourcegroup().location]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f0e74307-cf4c-4009-89a5-c3b77d9cc12d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f0e74307-cf4c-4009-89a5-c3b77d9cc12d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"locations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array)\",\r\n              \"description\": \"The list of locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"location\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string)\",\r\n              \"description\": \"The location for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"resourceGroups\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array)\",\r\n              \"description\": \"The list of resource groups.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"resourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string)\",\r\n              \"description\": \"The resource group.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"tags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array)\",\r\n              \"description\": \"The list of tags.\"\r\n            }\r\n          },\r\n          \"tag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": \"The tag.\"\r\n            }\r\n          },\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array, av)\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ]\r\n          },\r\n          \"allowedLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string, av)\",\r\n              \"description\": \"The allowed location for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ]\r\n          },\r\n          \"allowedStorageSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array, av)\",\r\n              \"description\": \"The list of allowed storage SKUs for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"allowedStorageSKU\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": \"The allowed storage SKU for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"allowedTags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array, av)\",\r\n              \"description\": \"The list of allowed tags.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ]\r\n          },\r\n          \"allowedTag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string, av)\",\r\n              \"description\": \"The allowed tag.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('locations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('location')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('resourceGroups')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('resourceGroup')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('tags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('tag')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('allowedLocation')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedStorageSkus')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"Equals\": \"[parameters('allowedStorageSku')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedTags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"NotEquals\": \"[parameters('allowedTag')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f3d8eb78-dac2-46d5-94eb-61ab140e56d0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f3d8eb78-dac2-46d5-94eb-61ab140e56d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim def\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"notin\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f68d5d25-aa23-4373-b10d-4183b3627109\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f68d5d25-aa23-4373-b10d-4183b3627109\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TEST Deny VNet if specific NSGs are not used\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deny\",\r\n        \"parameters\": {\r\n          \"allowedNSGs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\",\r\n                \"notin\": \"[parameters('allowedNSGs')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f7b36161-3a62-4fff-abf2-8b1a469ed1d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f7b36161-3a62-4fff-abf2-8b1a469ed1d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"dupitest4\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"1019_Delay_grid_data_Refresh_when_needed\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/fb809d3a-efb2-4417-83fa-6dc6950d2340\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"fb809d3a-efb2-4417-83fa-6dc6950d2340\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CreatedByUItest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/fe875399-f94a-40e1-9a7b-af775d62f001\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"fe875399-f94a-40e1-9a7b-af775d62f001\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit all resource group tags\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Inherit all resource group tags\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags\",\r\n                \"value\": \"[resourcegroup().tags]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/inheritAllTags\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"inheritAllTags\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit resource group Cost Center tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Inherit resource group Cost Center tag\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.CostCenter\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.CostCenter\",\r\n                \"value\": \"[resourcegroup().tags.CostCenter]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/inheritCostCenter\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"inheritCostCenter\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit allowed locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"This policy enables you to audit your location.\",\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that can be specified when deploying resources.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('listOfAllowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"LocationAuditDefinition\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unit test junk: sorry for littering. Please delete me!\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/Subscriptions/ResourceGroups/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ps6032\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ps6032\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unit test junk: sorry for littering. Please delete me!\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/Subscriptions/ResourceGroups/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ps7280\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ps7280\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require Azure Monitor to be turned on for storage accounts\",\r\n        \"policyType\": \"Custom\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/networkSecurityGroup\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.insights/diagnosticSettings/logs.enabled\",\r\n                \"notequals\": \"True\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Require Azure Monitor to be turned on for storage accounts\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Require Azure Monitor to be turned on for storage accounts\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Restrict resource location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"cstack\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Restrict resource location\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Restrict resource location\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Resource group naming convention\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Resource group naming convention\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect\",\r\n              \"strongType\": \"effect\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat(resourceGroup().name,'*')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/rgnaming\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"rgnaming\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL Server Not Allowed\",\r\n        \"policyType\": \"Custom\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/SQL Server Not Allowed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"SQL Server Not Allowed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"like bug\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"like bug\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect\",\r\n              \"strongType\": \"effect\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat('test','this')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testbadlike\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"testbadlike\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"test policy\",\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": \"The description of alert.\"\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ]\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ]\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The operator comparing the current value with the threshold value.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold value at which the alert is activated.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"How the data that is collected should be combined over time.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"How often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-', field('name'))]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-',  parameters('targetResourceName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testSandipsh.draft\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"testSandipsh.draft\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testtest\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"testtest\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The name for the tag\",\r\n              \"description\": \"The name for the tag.\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The value for the tag\",\r\n              \"description\": \"The value for the tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags.',parameters('tagName'))]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"testtest\"\r\n    }\r\n  ]\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:12 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:8e803686-4e79-425b-b93b-13ceab687267"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14985"
        ],
        "x-ms-correlation-request-id": [
          "b1905be9-8c76-4745-9e66-0b5fd17764d9"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203213Z:b1905be9-8c76-4745-9e66-0b5fd17764d9"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucz9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "7b21c954-911a-46f9-8eb5-9345cfdf7162"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"value\": [\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit SQL DB Level Audit Setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit DB level audit setting for SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audit Setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                    \"equals\": \"[parameters('setting')]\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit VMs that do not use managed disks\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits VMs that do not use managed disks\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                        \"exists\": \"True\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                        \"exists\": \"True\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/06a78e20-9358-41c9-923c-fb736d382a4d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"06a78e20-9358-41c9-923c-fb736d382a4d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy default OMS VM Extension for Windows VMs.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"NotSpecified\",\r\n        \"description\": \"This policy deploys OMS VM Extensions on Windows VMs, and connects to the selected Log Analytics workspace\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"MicrosoftWindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"WindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"2008-R2-SP1\",\r\n                  \"2008-R2-SP1-smalldisk\",\r\n                  \"2012-Datacenter\",\r\n                  \"2012-Datacenter-smalldisk\",\r\n                  \"2012-R2-Datacenter\",\r\n                  \"2012-R2-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter\",\r\n                  \"2016-Datacenter-Server-Core\",\r\n                  \"2016-Datacenter-Server-Core-smalldisk\",\r\n                  \"2016-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter-with-Containers\",\r\n                  \"2016-Datacenter-with-RDSH\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"MicrosoftMonitoringAgent\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/omsPolicy')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                          \"type\": \"MicrosoftMonitoringAgent\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled monitoring for Windows VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0868462e-646c-4fe3-9ced-a733534b6a2c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0868462e-646c-4fe3-9ced-a733534b6a2c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unencrypted VM Disks in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"VMs without an enabled disk encryption will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"encryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0961003e-5a0a-4549-abde-af6a37f2724d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit resource location matches resource group location\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit that the resource location matches its resource group location\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notIn\": [\r\n              \"[resourcegroup().location]\",\r\n              \"global\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/0a914e76-4921-4c19-b460-a2d36003525a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0a914e76-4921-4c19-b460-a2d36003525a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit transparent data encryption status\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Audit transparent data encryption status for SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                    \"equals\": \"enabled\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"17k78e20-9358-41c9-923c-fb736d382a12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Enforces a required tag and its value. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/1e30110a-5ceb-460c-a204-c1c3969c6d62\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1e30110a-5ceb-460c-a204-c1c3969c6d62\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unprotected web application in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Web applications without a Web Application Firewall protection will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.ClassicCompute/domainNames\",\r\n              \"Microsoft.Web/hostingEnvironments\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedWebApplication\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/201ea587-7c90-41c3-910f-c280ae01cfd6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"201ea587-7c90-41c3-910f-c280ae01cfd6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy default Microsoft IaaSAntimalware extension for Windows Server\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy deploys a Microsoft IaaSAntimalware extension with a default configuraion when a VM is not configured with the antimalware extension.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"MicrosoftWindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"WindowsServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"2008-R2-SP1\",\r\n                  \"2008-R2-SP1-smalldisk\",\r\n                  \"2012-Datacenter\",\r\n                  \"2012-Datacenter-smalldisk\",\r\n                  \"2012-R2-Datacenter\",\r\n                  \"2012-R2-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter\",\r\n                  \"2016-Datacenter-Server-Core\",\r\n                  \"2016-Datacenter-Server-Core-smalldisk\",\r\n                  \"2016-Datacenter-smalldisk\",\r\n                  \"2016-Datacenter-with-Containers\",\r\n                  \"2016-Datacenter-with-RDSH\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"IaaSAntimalware\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"ExclusionsPaths\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file paths or locations to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsExtensions\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of file extensions to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"ExclusionsProcesses\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Semicolon delimited list of process names to exclude from scanning\"\r\n                        }\r\n                      },\r\n                      \"RealtimeProtectionEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not real time protection is enabled (default is true)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsIsEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"false\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether or not custom scheduled scan settings are enabled (default is false)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsScanType\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Quick\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Indicates whether scheduled scan setting type is set to Quick or Full (default is Quick)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsDay\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"7\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Day of the week for scheduled scan (1-Sunday, 2-Monday, ..., 7-Saturday)\"\r\n                        }\r\n                      },\r\n                      \"ScheduledScanSettingsTime\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"120\",\r\n                        \"metadata\": {\r\n                          \"description\": \"When to perform the scheduled scan, measured in minutes from midnight (0-1440). For example: 0 = 12AM, 60 = 1AM, 120 = 2AM.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/IaaSAntimalware')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Security\",\r\n                          \"type\": \"IaaSAntimalware\",\r\n                          \"typeHandlerVersion\": \"1.3\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"AntimalwareEnabled\": true,\r\n                            \"RealtimeProtectionEnabled\": \"[parameters('RealtimeProtectionEnabled')]\",\r\n                            \"ScheduledScanSettings\": {\r\n                              \"isEnabled\": \"[parameters('ScheduledScanSettingsIsEnabled')]\",\r\n                              \"day\": \"[parameters('ScheduledScanSettingsDay')]\",\r\n                              \"time\": \"[parameters('ScheduledScanSettingsTime')]\",\r\n                              \"scanType\": \"[parameters('ScheduledScanSettingsScanType')]\"\r\n                            },\r\n                            \"Exclusions\": {\r\n                              \"Extensions\": \"[parameters('ExclusionsExtensions')]\",\r\n                              \"Paths\": \"[parameters('ExclusionsPaths')]\",\r\n                              \"Processes\": \"[parameters('ExclusionsProcesses')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"RealtimeProtectionEnabled\": {\r\n                      \"value\": \"true\"\r\n                    },\r\n                    \"ScheduledScanSettingsIsEnabled\": {\r\n                      \"value\": \"true\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2835b622-407b-4114-9198-6f7064cbe0dc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2835b622-407b-4114-9198-6f7064cbe0dc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Apply tag and its default value\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Applies a required tag and its default value if it is not specified by the user. Does not apply to resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/2a0e14a6-b0a6-4fab-991a-187a4f81c498\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2a0e14a6-b0a6-4fab-991a-187a4f81c498\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy default OMS VM Extension for Ubuntu VMs.\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"NotSpecified\",\r\n        \"description\": \"This policy deploys OMS VM Extensions on Ubuntu VMs, and connects to the selected Log Analytics workspace\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"logAnalytics\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Log Analytics workspace\",\r\n              \"description\": \"Select Log Analytics workspace from dropdown list\",\r\n              \"strongType\": \"omsWorkspace\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                \"equals\": \"Canonical\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageOffer\",\r\n                \"equals\": \"UbuntuServer\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/imageSKU\",\r\n                \"in\": [\r\n                  \"14.04.2-LTS\",\r\n                  \"12.04.5-LTS\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"OmsAgentForLinux\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.EnterpriseCloud.Monitoring\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"logAnalytics\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('vmName'),'/omsPolicy')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"apiVersion\": \"2017-12-01\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.EnterpriseCloud.Monitoring\",\r\n                          \"type\": \"OmsAgentForLinux\",\r\n                          \"typeHandlerVersion\": \"1.4\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {\r\n                            \"workspaceId\": \"[reference(parameters('logAnalytics'), '2015-03-20').customerId]\"\r\n                          },\r\n                          \"protectedSettings\": {\r\n                            \"workspaceKey\": \"[listKeys(parameters('logAnalytics'), '2015-03-20').primarySharedKey]\"\r\n                          }\r\n                        }\r\n                      }\r\n                    ],\r\n                    \"outputs\": {\r\n                      \"policy\": {\r\n                        \"type\": \"string\",\r\n                        \"value\": \"[concat('Enabled monitoring for Linux VM', ': ', parameters('vmName'))]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"logAnalytics\": {\r\n                      \"value\": \"[parameters('logAnalytics')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3d8640fc-63f6-4734-8dcb-cfd3d8c78f38\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor permissive network access in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Network Security Groups with too permissive rules will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.Network/virtualNetworks\",\r\n              \"Microsoft.ClassicNetwork/virtualNetworks\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"permissiveNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/44452482-524f-4bf4-b852-0bff7cc4a3ed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"44452482-524f-4bf4-b852-0bff7cc4a3ed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require SQL Server version 12.0\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy ensures all SQL servers use version 12.0.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Sql/servers\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Sql/servers/version\",\r\n                  \"equals\": \"12.0\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"464dbb85-3d5f-4a1d-bb09-95a9b5dd19cf\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce automatic OS upgrade with app health checks on VMSS\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enforces usage of automatic OS upgrade with application health checks through health probes, which enables safer rollout by evaluating application health after each OS upgrade batch.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/upgradePolicy.automaticOSUpgrade\",\r\n                      \"equals\": \"True\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/networkProfile.healthProbe.id\",\r\n                    \"exists\": \"False\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/465f0161-0087-490a-9ad9-ad6217f4f43a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"465f0161-0087-490a-9ad9-ad6217f4f43a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor possible app Whitelisting in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Possible Application Whitelist configuration will be monitored by Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"applicationWhitelisting\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/47a6b606-51aa-4496-8bb7-64b11cf66adc\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"47a6b606-51aa-4496-8bb7-64b11cf66adc\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Apply tag and its default value to resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Applies a required tag and its default value to resource groups if it is not specified by the user.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"exists\": \"false\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"49c88fc8-6fd1-46fd-a676-f12d1d3a4c71\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in India data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: West India, South India, Central India\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"westindia\",\r\n                \"southindia\",\r\n                \"centralindia\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5ee85ce5-e7eb-44d6-b4a2-32a24be1ca54\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Audit missing blob encryption for storage accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy audits storage accounts without blob encryption. It only applies to Microsoft.Storage resource types, not other storage providers.Possible network Just In Time access will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Audit\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"Audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/655cb504-bcee-4362-bd4c-402e6aa38759\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"655cb504-bcee-4362-bd4c-402e6aa38759\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Not allowed resource types\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization cannot deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of resource types that cannot be deployed.\",\r\n              \"displayName\": \"Not allowed resource types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypesNotAllowed')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6c112d4e-5bc7-47ae-a041-ea2d9dccd749\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6c112d4e-5bc7-47ae-a041-ea2d9dccd749\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/6fdb9205-3462-4cfc-87d8-16c7860b53f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6fdb9205-3462-4cfc-87d8-16c7860b53f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed storage account SKUs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify a set of storage account SKUs that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for storage accounts.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"StorageSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7433c107-6db4-4ad1-b57a-a76dce0154a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor VM Vulnerabilities in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Monitors vulnerabilities detected by Vulnerability Assessment solution and VMs without a Vulnerability Assessment solution in Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"vulnerabilityAssessment\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/760a85ff-6162-42b3-8d70-698e268f648c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"760a85ff-6162-42b3-8d70-698e268f648c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require blob encryption for storage accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy ensures blob encryption for storage accounts is turned on. It only applies to Microsoft.Storage resource types, not other storage providers.\",\r\n        \"metadata\": {\r\n          \"category\": \"Storage\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7c5a74bf-ae94-4a74-8fcf-644d1e0e6e6f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit diagnostic setting\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit diagnostic setting for selected resource types\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypes')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/logs.enabled\",\r\n                    \"equals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Insights/diagnosticSettings/metrics.enabled\",\r\n                    \"equals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/7f89b1eb-583c-429a-8828-af049802c1d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7f89b1eb-583c-429a-8828-af049802c1d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy SQL DB transparent data encryption\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Enables transparent data encryption on SQL databases\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers/databases\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n              \"name\": \"current\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                    \"equals\": \"Enabled\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullDbName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('fullDbName'), '/current')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/databases/transparentDataEncryption\",\r\n                        \"apiVersion\": \"2014-04-01\",\r\n                        \"properties\": {\r\n                          \"status\": \"Enabled\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullDbName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"86a912f6-9a06-4e26-b447-11b16ba8659f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor missing system updates in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Missing security system updates on your servers will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.OperationalInsights/workspaces\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"systemUpdates\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"86b3d65f-7626-441e-b690-81a8b71cff60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value on resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\",\r\n              \"description\": \"Name of the tag, such as 'environment'\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Value\",\r\n              \"description\": \"Value of the tag, such as 'production'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"notEquals\": \"[parameters('tagValue')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/8ce3da23-7156-49e4-b145-24f95f9dcb46\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8ce3da23-7156-49e4-b145-24f95f9dcb46\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in European data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: North Europe, West Europe\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"northeurope\",\r\n                \"westeurope\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/94c19f19-8192-48cd-a11b-e37099d3e36b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"94c19f19-8192-48cd-a11b-e37099d3e36b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in United States data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: Central US, East US, East US2, North Central US, South Central US, West US\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"centralus\",\r\n                \"eastus\",\r\n                \"eastus2\",\r\n                \"northcentralus\",\r\n                \"southcentralus\",\r\n                \"westus\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/983211ba-f348-4758-983b-21fa29294869\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"983211ba-f348-4758-983b-21fa29294869\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unprotected network endpoints in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Network endpoints without a Next Generation Firewall's protection will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Network/publicIPAddresses\",\r\n              \"Microsoft.ClassicCompute/domainNames\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"unprotectedNetworkEndpoint\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9daedab3-fb2d-461e-b861-71790eead4f6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed resource types\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of resource types that can be deployed.\",\r\n              \"displayName\": \"Allowed resource types\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"type\",\r\n              \"in\": \"[parameters('listOfResourceTypesAllowed')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a08ec900-254a-4555-9bf5-e42af04b5c5c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a08ec900-254a-4555-9bf5-e42af04b5c5c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit SQL server level Auditing settings\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"NotSpecified\",\r\n        \"description\": \"Audits the existence of SQL Auditing at the server level\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"setting\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Desired Auditing setting\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"enabled\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"enabled\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                \"equals\": \"[parameters('setting')]\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce encryption on DataLakeStore accounts\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures encryption is enabled on all DataLakeStore accounts\",\r\n        \"metadata\": {\r\n          \"category\": \"Data Lake\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DataLakeStore/accounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DataLakeStore/accounts/encryptionState\",\r\n                \"equals\": \"Disabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a7ff3161-0087-490a-9ad9-ad6217f4f43a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a7ff3161-0087-490a-9ad9-ad6217f4f43a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unencrypted SQL database in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unencrypted SQL servers or databases will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.SQL/servers\",\r\n              \"Microsoft.SQL/servers/databases\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"encryption\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a8bef009-a5c9-4d0f-90d7-6018734e8a16\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a8bef009-a5c9-4d0f-90d7-6018734e8a16\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy network watcher when virtual networks are created\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy creates a network watcher resource in regions with virtual networks. You need to ensure existence of a resource group named networkWatcherRG, which will be used to deploy network watcher instances.\",\r\n        \"metadata\": {\r\n          \"category\": \"Network\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkWatchers\",\r\n              \"resourceGroupName\": \"networkWatcherRG\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[field('location')]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2016-09-01\",\r\n                        \"type\": \"Microsoft.Network/networkWatchers\",\r\n                        \"name\": \"[concat('networkWacher_', parameters('location'))]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a9b99dd8-06c5-4317-8629-9d86a3c6e7d9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Automatic provisioning of security monitoring agent\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Installs security agent on VMs for advanced security alerts and preventions in Azure Security Center. Applies only for subscriptions that use Azure Security Center.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"securityAgent\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/abcc6037-1fc4-47f6-aac5-89706589be24\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"abcc6037-1fc4-47f6-aac5-89706589be24\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation if 'environment' tag value in allowed values\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation if the 'environment' tag is set to one of the following values: production, dev, test, staging\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"tags.environment\",\r\n              \"in\": [\r\n                \"production\",\r\n                \"dev\",\r\n                \"test\",\r\n                \"staging\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/ac7e5fc0-c029-4b12-91d4-a8500ce697f9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ac7e5fc0-c029-4b12-91d4-a8500ce697f9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor missing Endpoint Protection in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Servers without an installed Endpoint Protection agent will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.OperationalInsights/workspaces\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"endpointProtection\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"af6cd1bd-1635-48cb-bde7-5b15693900b9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor unaudited SQL database in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"SQL servers and databases which doesn't have SQL auditing turned on will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.SQL/servers\",\r\n              \"Microsoft.SQL/servers/databases\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"auditing\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/af8051bf-258b-44e2-a2bf-165330459f9d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"af8051bf-258b-44e2-a2bf-165330459f9d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor possible network JIT access in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Possible network Just In Time access will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"jitNetworkAccess\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b0f33259-77d7-4c9e-aac6-3aabcfae693c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Asia data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: East Asia, Southeast Asia, West India, South India, Central India, Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"eastasia\",\r\n                \"southeastasia\",\r\n                \"westindia\",\r\n                \"southindia\",\r\n                \"centralindia\",\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c1b9cbed-08e3-427d-b9ce-7c535b1e9b94\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Apply Diagnostic Settings for Network Security Groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy automatically deploys diagnostic settings to network security groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"Monitoring\"\r\n        },\r\n        \"parameters\": {\r\n          \"storagePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Storage Account Prefix for Regional Storage Account\"\r\n            }\r\n          },\r\n          \"rgName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Group Name for Storage Account (must exist)\",\r\n              \"description\": \"This resource group must already exist.\",\r\n              \"strongType\": \"ExistingResourceGroups\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"name\": \"setbypolicy\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"notlike\": \"*\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"storagePrefix\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"rgName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings\",\r\n                        \"name\": \"[concat(parameters('nsgName'),'/Microsoft.Insights/setbypolicy')]\",\r\n                        \"apiVersion\": \"2017-05-01-preview\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"dependsOn\": [\r\n                          \"deployStorageAccount\"\r\n                        ],\r\n                        \"properties\": {\r\n                          \"storageAccountId\": \"[reference('deployStorageAccount').outputs.storageAccountId.value]\",\r\n                          \"logs\": [\r\n                            {\r\n                              \"category\": \"NetworkSecurityGroupEvent\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            },\r\n                            {\r\n                              \"category\": \"NetworkSecurityGroupRuleCounter\",\r\n                              \"enabled\": true,\r\n                              \"retentionPolicy\": {\r\n                                \"enabled\": false,\r\n                                \"days\": 0\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"deployStorageAccount\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[parameters('rgName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"incremental\",\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"storagePrefix\": {\r\n                              \"value\": \"[parameters('storagePrefix')]\"\r\n                            }\r\n                          },\r\n                          \"template\": {\r\n                            \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"parameters\": {\r\n                              \"location\": {\r\n                                \"type\": \"string\"\r\n                              },\r\n                              \"storagePrefix\": {\r\n                                \"type\": \"string\"\r\n                              }\r\n                            },\r\n                            \"resources\": [\r\n                              {\r\n                                \"apiVersion\": \"2017-06-01\",\r\n                                \"type\": \"Microsoft.Storage/storageAccounts\",\r\n                                \"name\": \"[concat(parameters('storageprefix'), parameters('location'))]\",\r\n                                \"sku\": {\r\n                                  \"name\": \"Standard_LRS\",\r\n                                  \"tier\": \"Standard\"\r\n                                },\r\n                                \"kind\": \"Storage\",\r\n                                \"location\": \"[parameters('location')]\",\r\n                                \"tags\": {\r\n                                  \"created-by\": \"policy\"\r\n                                },\r\n                                \"scale\": null,\r\n                                \"properties\": {\r\n                                  \"networkAcls\": {\r\n                                    \"bypass\": \"AzureServices\",\r\n                                    \"defaultAction\": \"Allow\",\r\n                                    \"ipRules\": [],\r\n                                    \"virtualNetworkRules\": []\r\n                                  },\r\n                                  \"supportsHttpsTrafficOnly\": false\r\n                                }\r\n                              }\r\n                            ],\r\n                            \"outputs\": {\r\n                              \"storageAccountId\": {\r\n                                \"type\": \"string\",\r\n                                \"value\": \"[resourceId('Microsoft.Storage/storageAccounts',concat(parameters('storagePrefix'), parameters('location')))]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"storagePrefix\": {\r\n                      \"value\": \"[parameters('storagePrefix')]\"\r\n                    },\r\n                    \"rgName\": {\r\n                      \"value\": \"[parameters('rgName')]\"\r\n                    },\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c9c29499-c1d1-4195-99bd-2ec9e3a9dc89\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed virtual machine SKUs\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to specify a set of virtual machine SKUs that your organization can deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of SKUs that can be specified for virtual machines.\",\r\n              \"displayName\": \"Allowed SKUs\",\r\n              \"strongType\": \"VMSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cccc23c7-8427-4f53-ad12-b6a63eb452b3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation if 'department' tag set\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation only if the 'department' tag is set\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"tags\",\r\n              \"containsKey\": \"department\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/cd8dc879-a2ae-43c3-8211-1877c5755064\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cd8dc879-a2ae-43c3-8211-1877c5755064\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow resource creation only in Japan data centers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"Allows resource creation in the following locations only: Japan East, Japan West\",\r\n        \"metadata\": {\r\n          \"category\": \"General\",\r\n          \"deprecated\": true\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"japaneast\",\r\n                \"japanwest\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e01598e8-6538-41ed-95e8-8b29746cd697\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e01598e8-6538-41ed-95e8-8b29746cd697\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Monitor OS vulnerabilities in Security Center\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Servers which do not satisfy the configured baseline will be monitored by Azure Security Center as recommendations.\",\r\n        \"metadata\": {\r\n          \"category\": \"Security Center\",\r\n          \"preview\": true\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"Enable or disable the execution of the policy\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"AuditIfNotExists\",\r\n              \"Disabled\"\r\n            ],\r\n            \"defaultValue\": \"AuditIfNotExists\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/virtualMachines\",\r\n              \"Microsoft.ClassicCompute/virtualMachines\",\r\n              \"Microsoft.OperationalInsights/workspaces\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Security/complianceResults\",\r\n              \"name\": \"osVulnerabilities\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Security/complianceResults/resourceStatus\",\r\n                \"equals\": \"Monitored\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed locations\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can specify when deploying resources. Use to enforce your geo-compliance requirements. Excludes resource groups, Microsoft.AzureActiveDirectory/b2cDirectories, and resources that use the 'global' region.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that can be specified when deploying resources.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"notEquals\": \"global\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"notEquals\": \"Microsoft.AzureActiveDirectory/b2cDirectories\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e56962a6-4747-49cd-b67b-bf8b01975c4c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed locations for resource groups\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.\",\r\n        \"metadata\": {\r\n          \"category\": \"General\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that resource groups can be created in.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/e765b5de-1225-4ba3-bd56-1ac6695af988\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e765b5de-1225-4ba3-bd56-1ac6695af988\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[Preview]: Deploy Auditing on SQL servers\",\r\n        \"policyType\": \"BuiltIn\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"This policy ensures that Auditing is enabled on SQL Servers for enhanced security & compliance. It will automatically create a storage account in the same region as the SQL server to store audit records.\",\r\n        \"metadata\": {\r\n          \"category\": \"SQL\"\r\n        },\r\n        \"parameters\": {\r\n          \"retentionDays\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"The value in days of the retention period (0 indicates unlimited retention)\",\r\n              \"displayName\": \"Retention days (optional, 180 days if unspecified)\"\r\n            },\r\n            \"defaultValue\": \"180\"\r\n          },\r\n          \"storageAccountsResourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource group name for storage accounts\",\r\n              \"description\": \"Auditing writes database events to an audit log in your Azure Storage account (a storage account will be created in each region where a SQL Server is created that will be shared by all servers in that region). Important - for proper operation of Auditing do not delete or rename the resource group or the storage accounts.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Sql/servers\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n              \"name\": \"Default\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Sql/auditingSettings.state\",\r\n                \"equals\": \"Enabled\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"serverName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"auditRetentionDays\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"storageAccountsResourceGroup\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"retentionDays\": \"[int(parameters('auditRetentionDays'))]\",\r\n                      \"subscriptionId\": \"[subscription().subscriptionId]\",\r\n                      \"uniqueStorage\": \"[uniqueString(variables('subscriptionId'), parameters('location'), parameters('storageAccountsResourceGroup'))]\",\r\n                      \"locationCode\": \"[substring(parameters('location'), 0, 3)]\",\r\n                      \"storageName\": \"[tolower(concat('sqlaudit', variables('locationCode'), variables('uniqueStorage')))]\",\r\n                      \"createStorageAccountDeploymentName\": \"[concat('sqlServerAuditingStorageAccount-', variables('locationCode'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-05-10\",\r\n                        \"name\": \"[variables('createStorageAccountDeploymentName')]\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"resourceGroup\": \"[parameters('storageAccountsResourceGroup')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"parameters\": {\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"storageName\": {\r\n                              \"value\": \"[variables('storageName')]\"\r\n                            }\r\n                          },\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://raw.githubusercontent.com/Azure/azure-policy/master/samples/SQL/deploy-sql-server-auditing/createStorage.template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"name\": \"[concat(parameters('serverName'), '/Default')]\",\r\n                        \"type\": \"Microsoft.Sql/servers/auditingSettings\",\r\n                        \"apiVersion\": \"2017-03-01-preview\",\r\n                        \"properties\": {\r\n                          \"state\": \"Enabled\",\r\n                          \"storageEndpoint\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountEndPoint.value]\",\r\n                          \"storageAccountAccessKey\": \"[reference(variables('createStorageAccountDeploymentName')).outputs.storageAccountKey.value]\",\r\n                          \"retentionDays\": \"[variables('retentionDays')]\",\r\n                          \"auditActionsAndGroups\": null,\r\n                          \"storageAccountSubscriptionId\": \"[subscription().subscriptionId]\",\r\n                          \"isStorageSecondaryKeyInUse\": false\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"serverName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"auditRetentionDays\": {\r\n                      \"value\": \"[parameters('retentionDays')]\"\r\n                    },\r\n                    \"storageAccountsResourceGroup\": {\r\n                      \"value\": \"[parameters('storageAccountsResourceGroup')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/providers/Microsoft.Authorization/policyDefinitions/f4c68484-132f-41f9-9b6d-3e4b1cb55036\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f4c68484-132f-41f9-9b6d-3e4b1cb55036\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"mitest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"mitest desccription\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/0368a0a3-7484-47e0-887d-aa479d32c190\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0368a0a3-7484-47e0-887d-aa479d32c190\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Carolyn-Audit-Sql-DB-tde-disabled\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynz - test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.SQL/servers/databases/transparentDataEncryption\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                \"notEquals\": \"enabled\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/05065268-5c0e-49b9-a13d-95cdd81cae5a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"05065268-5c0e-49b9-a13d-95cdd81cae5a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testing\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Cost\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/0837b50a-1e9c-4125-b37e-45419750146f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0837b50a-1e9c-4125-b37e-45419750146f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value on resource groups\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"[concat('tags[',parameters('tagName'), ']')]\",\r\n                  \"equals\": \"[parameters('tagValue')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/08a4edc4-6048-4884-98ae-612ead5b9086\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"08a4edc4-6048-4884-98ae-612ead5b9086\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"miTestPolicy01\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"miTestPolicy01 description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/09078deb-cfd0-4257-a8e6-6682a873b1a2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"09078deb-cfd0-4257-a8e6-6682a873b1a2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe incident 66953948\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"66953948 \",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"uksouth\",\r\n                \"ukwest\",\r\n                \"global\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/0c28073f-e8d5-4608-ab49-c1a5347c9109\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"0c28073f-e8d5-4608-ab49-c1a5347c9109\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testSandipsh metric alert policy3\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"testSandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": \"The description of alert.\"\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ]\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ]\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The operator comparing the current value with the threshold value.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold value at which the alert is activated.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"How the data that is collected should be combined over time.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"How often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-', field('name'))]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-',  parameters('targetResourceName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/123c6354-fc96-4f54-984e-8d49d06a80a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"123c6354-fc96-4f54-984e-8d49d06a80a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Editing Policy 1st time creates duplicates\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Editing Policy for the 1st time creates duplicates - only on 1st time edited policies\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/183de28d-8524-4210-a176-b0a7ff48ef44\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"183de28d-8524-4210-a176-b0a7ff48ef44\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"carolyn auditifnotexists for rg location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"carolynauditifnotexiststest\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Resources/subscriptions/resourceGroups\",\r\n              \"resourceGroupName\": \"carolynauditifnotexiststest\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"West US\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/196629c0-62fd-4768-8d46-02db129686e9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"196629c0-62fd-4768-8d46-02db129686e9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allowed resource group locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Allowed resource group locations\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"location\",\r\n                  \"in\": \"[parameters('allowedLocations')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/1f20036f-28c3-48f3-9266-05d50fe391f4\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f20036f-28c3-48f3-9266-05d50fe391f4\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"docdb_aliases_test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/isVirtualNetworkFilterEnabled\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/1f5360b7-fe59-43f7-8af5-825df420d09c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"1f5360b7-fe59-43f7-8af5-825df420d09c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy security rule with restricted source IPs\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Ovewrites security rules with IP restrictions at the securityRule level\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions. Limit to one protocol. The most inclusive should come last. I.e. 22;22-22;22-23\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to. I.e. 192.4.0.0/8;192.5.0.0/8\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"in\": \"[parameters('destinationPortRanges')]\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                              \"notLike\": \"*\"\r\n                            }\r\n                          },\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                              \"notIn\": [\r\n                                \"*\",\r\n                                \"Internet\"\r\n                              ]\r\n                            }\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"notEquals\": \"VirtualNetwork\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notEquals\": \"\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"in\": [\r\n                              \"*\",\r\n                              \"Internet\"\r\n                            ]\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notEquals\": \"VirtualNetwork\"\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"equals\": \"\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"equals\": \"\"\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n              \"name\": \"DoesNotExist101\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullRuleName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"priority\": {\r\n                        \"type\": \"int\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[parameters('fullRuleName')]\",\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"properties\": {\r\n                          \"protocol\": \"*\",\r\n                          \"sourceAddressPrefixes\": \"[parameters('sourceAddressPrefixes')]\",\r\n                          \"destinationAddressPrefix\": \"*\",\r\n                          \"sourcePortRange\": \"*\",\r\n                          \"destinationPortRange\": \"[last(parameters('destinationPortRanges'))]\",\r\n                          \"access\": \"Allow\",\r\n                          \"direction\": \"Inbound\",\r\n                          \"priority\": \"[parameters('priority')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullRuleName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    },\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    },\r\n                    \"priority\": {\r\n                      \"value\": \"[field('Microsoft.Network/networksecurityGroups/securityRules/priority')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/20c4afd0-8a77-4433-b8b0-4ad06e4c7111\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"20c4afd0-8a77-4433-b8b0-4ad06e4c7111\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy NSGs on Subnets\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforce that all subnets have a Network Security Group.  If a subnet does not have one an NSG with the default Internet Exposed Endpoint restrictions will be created and associated with it.\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"nsgPrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"NSG name prefix\",\r\n              \"description\": \"The prefix string to apply to all automatically created network security groups.\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to. I.e. 192.4.0.0/8;192.5.0.0/8\"\r\n            }\r\n          },\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions. Ranges must not overlap.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Network/virtualNetworks/subnets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\",\r\n                        \"exists\": \"false\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id\",\r\n                        \"equals\": \"\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\",\r\n                        \"exists\": \"false\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\",\r\n                          \"notEquals\": \"null\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/policyAssignments\",\r\n              \"name\": \"DoesNotExist101\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"fullResourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"resourceName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgPrefix\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"nsgName\": \"[concat(parameters('nsgPrefix'), '-', parameters('location'))]\",\r\n                      \"vnetName\": \"[split(parameters('fullResourceName'), '/')[0]]\",\r\n                      \"vnetResourceId\": \"[resourceId('Microsoft.Network/virtualNetworks', variables('vnetName'))]\",\r\n                      \"getVnetDeploymentName\": \"[concat('getVnet-', variables('vnetName'))]\",\r\n                      \"collectSubnetsDeploymentName\": \"[concat('collectSubnets-', variables('vnetName'))]\",\r\n                      \"overwriteVnetDeploymentName\": \"[concat('overwriteVnet-', variables('vnetName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('getVnetDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"resources\": [],\r\n                            \"outputs\": {\r\n                              \"vnetProperties\": {\r\n                                \"type\": \"object\",\r\n                                \"value\": \"[reference(variables('vnetResourceId'), '2018-03-01', 'Full')]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"name\": \"[variables('nsgName')]\",\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"securityRules\": [\r\n                            {\r\n                              \"name\": \"PortLockdown_ControlledPorts_Restrict\",\r\n                              \"properties\": {\r\n                                \"description\": \"Allow controlled port connections from specific IP ranges (either corpnet or SAW)\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"\",\r\n                                \"destinationPortRanges\": \"[parameters('destinationPortRanges')]\",\r\n                                \"sourceAddressPrefix\": \"\",\r\n                                \"sourceAddressPrefixes\": \"[parameters('sourceAddressPrefixes')]\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Allow\",\r\n                                \"priority\": 3997,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            },\r\n                            {\r\n                              \"name\": \"PortLockdown_ControlledPorts_AllowVnet\",\r\n                              \"properties\": {\r\n                                \"description\": \"Allow controlled port connections from within the VNET\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"\",\r\n                                \"destinationPortRanges\": \"[parameters('destinationPortRanges')]\",\r\n                                \"sourceAddressPrefix\": \"VirtualNetwork\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Allow\",\r\n                                \"priority\": 3998,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            },\r\n                            {\r\n                              \"name\": \"PortLockdown_ControlledPorts_Deny\",\r\n                              \"properties\": {\r\n                                \"description\": \"Deny any controlled port connections that aren't explicitly allowed in higher priority rules\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"\",\r\n                                \"destinationPortRanges\": \"[parameters('destinationPortRanges')]\",\r\n                                \"sourceAddressPrefix\": \"*\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Deny\",\r\n                                \"priority\": 3999,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            },\r\n                            {\r\n                              \"name\": \"PortLockdown_AllowAll\",\r\n                              \"properties\": {\r\n                                \"description\": \"Allow all inbound traffic that isn't explicitly blocked by Port Lockdown restrictions\",\r\n                                \"protocol\": \"*\",\r\n                                \"sourcePortRange\": \"*\",\r\n                                \"destinationPortRange\": \"*\",\r\n                                \"sourceAddressPrefix\": \"*\",\r\n                                \"destinationAddressPrefix\": \"*\",\r\n                                \"access\": \"Allow\",\r\n                                \"priority\": 4000,\r\n                                \"direction\": \"Inbound\"\r\n                              }\r\n                            }\r\n                          ]\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('collectSubnetsDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_collectSubnets_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"vnetProperties\": {\r\n                              \"value\": \"[reference(variables('getVnetDeploymentName')).outputs.vnetProperties.value]\"\r\n                            },\r\n                            \"nsgResourceId\": {\r\n                              \"value\": \"[resourceid('Microsoft.Network/networkSecurityGroups', variables('nsgName'))]\"\r\n                            },\r\n                            \"vnetName\": {\r\n                              \"value\": \"[variables('vnetName')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"dependsOn\": [\r\n                          \"[variables('nsgName')]\"\r\n                        ],\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('overwriteVnetDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/Subnet_OverwriteWithNsg_overwriteVnet_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"vnetProperties\": {\r\n                              \"value\": \"[reference(variables('getVnetDeploymentName')).outputs.vnetProperties.value]\"\r\n                            },\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"updatedSubnets\": {\r\n                              \"value\": \"[reference(variables('collectSubnetsDeploymentName')).outputs.updatedSubnets.value]\"\r\n                            },\r\n                            \"vnetName\": {\r\n                              \"value\": \"[variables('vnetName')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"fullResourceName\": {\r\n                      \"value\": \"[field('fullName')]\"\r\n                    },\r\n                    \"resourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    },\r\n                    \"nsgPrefix\": {\r\n                      \"value\": \"[parameters('nsgPrefix')]\"\r\n                    },\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/210ed8bd-6b07-4d5e-a62c-c34f07293288\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"210ed8bd-6b07-4d5e-a62c-c34f07293288\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit existence of a tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audits that a required tag is present on resources\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag Name\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags\",\r\n            \"notcontainsKey\": \"[parameters('tagName')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/24813039-7534-408a-9842-eb99f45721b1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"24813039-7534-408a-9842-eb99f45721b1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"storage ip rules append 2\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.Storage/storageAccounts/networkAcls.ipRules\",\r\n                \"value\": [\r\n                  {\r\n                    \"value\": \"8.8.8.8\",\r\n                    \"action\": \"Allow\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/2b2317a7-ab02-47b5-8159-eb7e6227709f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"2b2317a7-ab02-47b5-8159-eb7e6227709f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Create a tag and value on resource group\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Specified tag name\",\r\n              \"description\": \"Tag Name\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Specified tag value\",\r\n              \"description\": \"Tag Value\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"[concat('tags[',parameters('tagName'), ']')]\",\r\n                  \"equals\": \"[parameters('tagValue')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[parameters('tagValue')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3538acb4-c730-4da1-a384-c5caab70112a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3538acb4-c730-4da1-a384-c5caab70112a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test41432432\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/369a5575-450a-40d8-9458-cfc4e37e918b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"369a5575-450a-40d8-9458-cfc4e37e918b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_enableAutomaticFailover\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.DocumentDB/databaseAccounts/enableAutomaticFailover\",\r\n                \"equals\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0a0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0a0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_defaultConsistencyLevel\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.DocumentDB/databaseAccounts/consistencyPolicy.defaultConsistencyLevel\",\r\n                  \"equals\": \"lalala\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0b7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0b7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_readLocations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allof\": [\r\n                    {\r\n                      \"field\": \"Microsoft.DocumentDB/databaseAccounts/readLocations[*].locationName\",\r\n                      \"equals\": \"lalala\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0bd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0bd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_writeLocations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allof\": [\r\n                    {\r\n                      \"field\": \"Microsoft.DocumentDB/databaseAccounts/writeLocations[*].locationName\",\r\n                      \"equals\": \"lalala\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd0ce\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd0ce\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_failoverPolicies\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allof\": [\r\n                    {\r\n                      \"field\": \"Microsoft.DocumentDB/databaseAccounts/failoverPolicies[*].locationName\",\r\n                      \"equals\": \"lalala\"\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/37501145-d01b-4bc8-92d0-c795a19fd160\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"37501145-d01b-4bc8-92d0-c795a19fd160\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"tt\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3859d794-fd26-44f6-b66b-b44995a2876e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3859d794-fd26-44f6-b66b-b44995a2876e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"          SampleTestPolicy \",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Test policy needed to confirm policy creation end-end\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/39ea2344-43b1-473e-8858-6b9925a911a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"39ea2344-43b1-473e-8858-6b9925a911a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Name should have prefix and suffix\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Name should have prefix and suffix\",\r\n        \"parameters\": {\r\n          \"prefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The prefix\",\r\n              \"description\": \"The name prefix\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"suffix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The suffix\",\r\n              \"description\": \"The name suffix.\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat(parameters('prefix'), '*', parameters('suffix'))]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e275e2e-a157-4ade-8f91-43b3ea370007\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e275e2e-a157-4ade-8f91-43b3ea370007\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Restrict VM skus\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Restricts allowed VM skus to a predefined regex\",\r\n        \"parameters\": {\r\n          \"allowedSkuTemplate\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed VM sku template\",\r\n              \"description\": \"The VM sku template. Supports wildcards via '*'\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                \"like\": \"[parameters('allowedSkuTemplate')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e34c8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e3807c1-65c9-49e0-a406-82d8ae3e34c8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit storage account SKU\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audits the use of storage account SKUs that don't meet organizational cost policy.\",\r\n        \"parameters\": {\r\n          \"listOfAllowedSkus\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List of allowed SKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSkus')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/3e3807c1-65c9-49e0-a406-82d8ae3e3682\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"3e3807c1-65c9-49e0-a406-82d8ae3e3682\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Docker Extension (VMSS)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deploys the Docker extension automatically to any VM scale sets that are created.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachineScaleSets\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/type\",\r\n                \"equals\": \"DockerExtension\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmssName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"name\": \"[concat(parameters('vmssName'), '/', 'dockerExtension')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Extensions\",\r\n                          \"type\": \"DockerExtension\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmssName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f740\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f740\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy Docker Extension (VM)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deploys the Docker extension automatically to any VM that is created.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                \"equals\": \"DockerExtension\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"vmName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2017-03-30\",\r\n                        \"name\": \"[concat(parameters('vmName'), '/', 'dockerExtension')]\",\r\n                        \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n                        \"location\": \"[parameters('location')]\",\r\n                        \"properties\": {\r\n                          \"publisher\": \"Microsoft.Azure.Extensions\",\r\n                          \"type\": \"DockerExtension\",\r\n                          \"typeHandlerVersion\": \"1.0\",\r\n                          \"autoUpgradeMinorVersion\": true,\r\n                          \"settings\": {}\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"vmName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f761\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f761\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce autoUpgrade on VM/VMSS extensions\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Denies any VM or VMSS extensions that do not have autoUpgradeMinorVersion set to true.\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines/extensions\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f772\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f772\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append autoUpgrade to VM extensions\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Automatically enabled autoUpgradeMinorVersion on VM extensions\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines/extensions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachines/extensions/autoUpgradeMinorVersion\",\r\n                \"value\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f783\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f783\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Append autoUpgrade to VM scale set extensions\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Automatically appends autoUpgradeMinorVersion=true to VMSS extensions\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachineScaleSets/extensions\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion\",\r\n                \"exists\": \"false\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"Microsoft.Compute/virtualMachineScaleSets/extensions/autoUpgradeMinorVersion\",\r\n                \"value\": \"true\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39f7a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39f7a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MSIT - AppService must use serverFarm\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/sites\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/serverFarmId\",\r\n                    \"exists\": \"false\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Web/sites/serverFarmId\",\r\n                    \"equals\": \"\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc12\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39fc12\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"MSIT - AppService serverFarm must have capacity > 1\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Web/serverFarms\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Web/serverFarms/sku.capacity\",\r\n                \"in\": [\r\n                  \"0\",\r\n                  \"1\"\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/41f9e24d-1586-455f-811a-92a2ca39fc23\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"41f9e24d-1586-455f-811a-92a2ca39fc23\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_123\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"test def\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/499dfea1-dfac-4a64-a3a4-5d4c1d987368\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"499dfea1-dfac-4a64-a3a4-5d4c1d987368\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Do_Not_Delete\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy is used for unit tests. Please do not delete it.\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4a0425e4-97bf-4ad0-ab36-145b94083c60\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4a0425e4-97bf-4ad0-ab36-145b94083c60\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"elpere_kv_test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.KeyVault/vaults\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.KeyVault/vaults/sku.name\",\r\n                  \"equals\": \"Premium\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4c4c2cc2-c363-45a6-bd38-6b653b9b80ac\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4c4c2cc2-c363-45a6-bd38-6b653b9b80ac\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Ensure auto-created NSG rules exist\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Ensures that security rules created in auto-created PortLockdown NSGs are not tampered with\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"nsgPrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"NSG name prefix\",\r\n              \"description\": \"The prefix string applied to automatically created network security groups.\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to in the expected security rule. I.e. 192.4.0.0/8;192.5.0.0/8 or *\"\r\n            }\r\n          },\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions in the expected security rule\"\r\n            }\r\n          },\r\n          \"priority\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected priority\",\r\n              \"description\": \"The priority of the expected security rule.\"\r\n            }\r\n          },\r\n          \"access\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected access\",\r\n              \"description\": \"The access (allow/deny) of the expected security rule.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Allow\",\r\n              \"Deny\"\r\n            ]\r\n          },\r\n          \"name\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Expected name\",\r\n              \"description\": \"The name of the expected security rule.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"name\",\r\n                \"equals\": \"[concat(parameters('nsgPrefix'), '-', field('location'))]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/priority\",\r\n                    \"equals\": \"[parameters('priority')]\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                        \"in\": \"[parameters('sourceAddressPrefixes')]\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"in\": \"[parameters('sourceAddressPrefixes')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                    \"in\": \"[parameters('destinationPortRanges')]\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"[parameters('access')]\"\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"name\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"priority\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"access\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"isSinglePrefix\": \"[equals(count(parameters('sourceAddressPrefixes')), 1)]\",\r\n                      \"isSinglePortRange\": \"[equals(count(parameters('destinationPortRanges')), 1)]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[concat(parameters('nsgName'), '/', parameters('name'))]\",\r\n                        \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"properties\": {\r\n                          \"description\": \"Rule auto-created by Internet Exposed Endpoints protection\",\r\n                          \"protocol\": \"*\",\r\n                          \"sourcePortRange\": \"*\",\r\n                          \"destinationPortRange\": \"[if(variables('isSinglePortRange'), first(parameters('destinationPortRanges')), '')]\",\r\n                          \"destinationPortRanges\": \"[if(not(variables('isSinglePortRange')), parameters('destinationPortRanges'), json('[]'))]\",\r\n                          \"sourceAddressPrefix\": \"[if(variables('isSinglePrefix'), first(parameters('sourceAddressPrefixes')), '')]\",\r\n                          \"sourceAddressPrefixes\": \"[if(not(variables('isSinglePrefix')), parameters('sourceAddressPrefixes'), json('[]'))]\",\r\n                          \"destinationAddressPrefix\": \"*\",\r\n                          \"access\": \"[parameters('access')]\",\r\n                          \"priority\": \"[int(parameters('priority'))]\",\r\n                          \"direction\": \"Inbound\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    },\r\n                    \"name\": {\r\n                      \"value\": \"[parameters('name')]\"\r\n                    },\r\n                    \"priority\": {\r\n                      \"value\": \"[parameters('priority')]\"\r\n                    },\r\n                    \"access\": {\r\n                      \"value\": \"[parameters('access')]\"\r\n                    },\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/4f283ec4-25a9-46df-bbf2-806ed5a3e115\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"4f283ec4-25a9-46df-bbf2-806ed5a3e115\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"My New policy Def\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"My New policy Def\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/593b5110-2614-4528-adca-5424c7a6a0ba\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"593b5110-2614-4528-adca-5424c7a6a0ba\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"GokmenhAuditLocation\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Audit if not west us\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": [\r\n                \"westus\"\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5948d091-78b7-4d3b-a404-cc6a0329b0c6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5948d091-78b7-4d3b-a404-cc6a0329b0c6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Testing Policy - Allegion\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Thisst policy - feel free to delete\",\r\n        \"metadata\": {\r\n          \"category\": \"Category Testing Allegion\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5a0a0876-375a-424e-8484-1c699a87916e\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5a0a0876-375a-424e-8484-1c699a87916e\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Array and object parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"tags\": {\r\n            \"type\": \"Object\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tags to append\",\r\n              \"description\": \"Tags to append to the object.\"\r\n            },\r\n            \"defaultValue\": {\r\n              \"properties\": {\r\n                \"displayName\": \"defaultValue: initiative parameters\",\r\n                \"policyType\": \"Custom\",\r\n                \"metadata\": {\r\n                  \"category\": \"defaultValue\",\r\n                  \"parameterScopes\": {\r\n                    \"locations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"location\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"resourceGroups\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"resourceGroup\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedLocations\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedLocation\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedStorageSKUs\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedStorageSKU\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedTags\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\",\r\n                    \"allowedTag\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5\"\r\n                  }\r\n                },\r\n                \"parameters\": {\r\n                  \"LOCATIONS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (no scope, array)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"location\"\r\n                    }\r\n                  },\r\n                  \"LOCATION_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (no scope, string)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"location\"\r\n                    }\r\n                  },\r\n                  \"RESOURCEGROUPS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (array)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"existingResourceGroups\"\r\n                    }\r\n                  },\r\n                  \"RESOURCEGROUP_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (string)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"existingResourceGroups\"\r\n                    }\r\n                  },\r\n                  \"TAGS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Non strong type (array)\",\r\n                      \"description\": null\r\n                    }\r\n                  },\r\n                  \"TAG_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Non strong type (string)\",\r\n                      \"description\": null\r\n                    }\r\n                  },\r\n                  \"ALLOWEDSTORAGESKUS_1\": {\r\n                    \"type\": \"Array\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (array, av)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"storageSkus\"\r\n                    },\r\n                    \"allowedValues\": [\r\n                      \"Standard_LRS\",\r\n                      \"Standard_ZRS\",\r\n                      \"Standard_GRS\"\r\n                    ]\r\n                  },\r\n                  \"ALLOWEDSTORAGESKU_1\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"Strong type (string, av)\",\r\n                      \"description\": null,\r\n                      \"strongType\": \"storageSkus\"\r\n                    },\r\n                    \"allowedValues\": [\r\n                      \"Standard_LRS\",\r\n                      \"Standard_ZRS\",\r\n                      \"Standard_GRS\"\r\n                    ]\r\n                  }\r\n                },\r\n                \"policyDefinitions\": [\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"7107752599248540199\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n                    \"parameters\": {\r\n                      \"locations\": {\r\n                        \"value\": \"[parameters('LOCATIONS_1')]\"\r\n                      },\r\n                      \"location\": {\r\n                        \"value\": \"[parameters('LOCATION_1')]\"\r\n                      },\r\n                      \"resourceGroups\": {\r\n                        \"value\": \"[parameters('RESOURCEGROUPS_1')]\"\r\n                      },\r\n                      \"resourceGroup\": {\r\n                        \"value\": \"[parameters('RESOURCEGROUP_1')]\"\r\n                      },\r\n                      \"tags\": {\r\n                        \"value\": \"[parameters('TAGS_1')]\"\r\n                      },\r\n                      \"tag\": {\r\n                        \"value\": \"[parameters('TAG_1')]\"\r\n                      },\r\n                      \"allowedLocations\": {\r\n                        \"value\": \"[parameters('LOCATIONS_1')]\"\r\n                      },\r\n                      \"allowedLocation\": {\r\n                        \"value\": \"[parameters('LOCATION_1')]\"\r\n                      },\r\n                      \"allowedStorageSKUs\": {\r\n                        \"value\": \"[parameters('ALLOWEDSTORAGESKUS_1')]\"\r\n                      },\r\n                      \"allowedStorageSKU\": {\r\n                        \"value\": \"[parameters('ALLOWEDSTORAGESKU_1')]\"\r\n                      },\r\n                      \"allowedTags\": {\r\n                        \"value\": \"[parameters('TAGS_1')]\"\r\n                      },\r\n                      \"allowedTag\": {\r\n                        \"value\": \"[parameters('TAG_1')]\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"16431059056652047295\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n                    \"parameters\": {}\r\n                  },\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"14628640572431045873\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n                    \"parameters\": {\r\n                      \"locations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"location\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"resourceGroups\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"resourceGroup\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"tags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"tag\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"allowedLocations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedLocation\": {\r\n                        \"value\": \"eastus\"\r\n                      },\r\n                      \"allowedStorageSKU\": {\r\n                        \"value\": \"Standard_LRS\"\r\n                      },\r\n                      \"allowedStorageSKUs\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTag\": {\r\n                        \"value\": \"FirstName\"\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"policyDefinitionReferenceId\": \"12403738129896807824\",\r\n                    \"policyDefinitionId\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f3d8eb78-dac2-46d5-94eb-61ab140e56d0\",\r\n                    \"parameters\": {\r\n                      \"locations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"location\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"resourceGroups\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"resourceGroup\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"tags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"tag\": {\r\n                        \"value\": \"\"\r\n                      },\r\n                      \"allowedLocations\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedLocation\": {\r\n                        \"value\": \"eastus\"\r\n                      },\r\n                      \"allowedStorageSKU\": {\r\n                        \"value\": \"Standard_LRS\"\r\n                      },\r\n                      \"allowedStorageSKUs\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTags\": {\r\n                        \"value\": []\r\n                      },\r\n                      \"allowedTag\": {\r\n                        \"value\": \"FirstName\"\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policySetDefinitions/ea1688b3-022e-4add-af39-2fe60689a4d0\",\r\n              \"type\": \"Microsoft.Authorization/policySetDefinitions\",\r\n              \"name\": \"ea1688b3-022e-4add-af39-2fe60689a4d0\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags\",\r\n                \"value\": \"[parameters('tags')]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5d923625-354f-4884-8ca5-9dcde44c10a1\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5d923625-354f-4884-8ca5-9dcde44c10a1\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Test\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/5f15b5d9-6596-4360-aae6-7952e65d670f\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"5f15b5d9-6596-4360-aae6-7952e65d670f\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Not allowed resource as types\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to specify the resource types that your organization cannot deploy.\",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfResourceTypesNotAllowed\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Not allowed resource types asd\",\r\n              \"description\": \"The list of resource types that cannot be deployed.\",\r\n              \"strongType\": \"resourceTypes\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": \"[parameters('listOfResourceTypesNotAllowed')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6054dcea-3f63-4378-a318-a99ca98dd0ab\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6054dcea-3f63-4378-a318-a99ca98dd0ab\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"dupitest8\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"1012_Editing_Policy_1st_time_creates_duplicate\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6217eaf6-5cae-4bfd-a692-a755e2f100d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6217eaf6-5cae-4bfd-a692-a755e2f100d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Storage accounts must be geo-replicated\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Denies creation of any storage account that is not geo-replicated. \",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"allOf\": [\r\n                {\r\n                  \"field\": \"type\",\r\n                  \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n                },\r\n                {\r\n                  \"not\": {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Storage/storageAccounts/accountType\",\r\n                        \"equals\": \"Standard-GRS\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Storage/storageAccounts/accountType\",\r\n                        \"equals\": \"Standard-RAGRS\"\r\n                      }\r\n                    ]\r\n                  }\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6531f253-2bbe-43ef-a065-691cf8db3fcd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6531f253-2bbe-43ef-a065-691cf8db3fcd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit named tag from resource group (testing)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Probably doesn't work\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Tag name\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[resourcegroup().tags.cc]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6cb4eca9-b204-4ab5-82f7-d48605fc011b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6cb4eca9-b204-4ab5-82f7-d48605fc011b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testSandipsh metric alert policy1\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"testSandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": null\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ],\r\n            \"defaultValue\": \"3\"\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ],\r\n            \"defaultValue\": \"true\"\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"Metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The metric operator.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"The timeAggregation.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"The window size.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"The evaluation frequency.\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The action group id.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"like\": \"[concat(parameters('alertNamePrefix'), '*')]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(toLower(parameters('alertNamePrefix')), uniqueString(resourceGroup().id))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/6f2c6354-fc96-4f54-984e-8d49d06a80a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"6f2c6354-fc96-4f54-984e-8d49d06a80a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"dupitest7\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"1019_Delay_grid_data_Refresh_when_needed\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/744205a1-f297-4724-9973-7e7674d4613b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"744205a1-f297-4724-9973-7e7674d4613b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny if blob is not encrypted\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/74d5cf40-7293-46a4-a285-7ea971e3719a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"74d5cf40-7293-46a4-a285-7ea971e3719a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TestPolicy for Edit workflow\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"TestPolicy for Edit workflow description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/75e13aeb-f25b-438f-a21f-ab469da20a58\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"75e13aeb-f25b-438f-a21f-ab469da20a58\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[cstack] Location restriction\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Policy to force allocations to a set of given locations\",\r\n        \"metadata\": {\r\n          \"category\": \"cstack\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/763dcd1d-a4a9-46a8-8bd3-357c4533a335\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"763dcd1d-a4a9-46a8-8bd3-357c4533a335\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Bad field function (blocks PUTS, do NOT apply!)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Dangerous field function (blocks PUTS, do NOT apply!)\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"[field('Microsoft.Cache/Redis/shardCount')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/7ccdb1b8-8600-49d3-82c6-759e0bdf220b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"7ccdb1b8-8600-49d3-82c6-759e0bdf220b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CreatedByUItest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8122ed2c-b217-49f6-997a-2357729a2001\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8122ed2c-b217-49f6-997a-2357729a2001\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Parameterized effect (if location != eastus)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The policy effect.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"equals\": \"eastus\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/885f1dcb-a9c5-4c8c-8996-2702db44a2d2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"885f1dcb-a9c5-4c8c-8996-2702db44a2d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Dangerous field policy\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"exists\": \"true\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"location\",\r\n                  \"equals\": \"[field('location')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/890c48eb-8816-4959-9fe4-6591550f006b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"890c48eb-8816-4959-9fe4-6591550f006b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"rg network watcher deployment\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkWatchers\",\r\n              \"resourceGroupName\": \"[resourcegroup().name]\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[resourcegroup().location]\"\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      }\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2016-09-01\",\r\n                        \"type\": \"Microsoft.Network/networkWatchers\",\r\n                        \"name\": \"[concat('networkWatcher_', parameters('location'))]\",\r\n                        \"location\": \"[parameters('location')]\"\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"location\": {\r\n                      \"value\": \"[resourcegroup().location]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8abbc081-f6e3-48f0-a461-e31cd784e190\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8abbc081-f6e3-48f0-a461-e31cd784e190\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit named tag from resource group (doesn't work)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\",\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n                \"value\": \"[concat('',concat('[','resourcegroup().tags.',parameters('tagName'),']'))]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8abbc081-f6e3-48f0-a461-e31cd784e225\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8abbc081-f6e3-48f0-a461-e31cd784e225\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Selector_tagsExistenanceCondition\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"tags.Prod\",\r\n                \"exists\": true\r\n              },\r\n              {\r\n                \"field\": \"tags.Ingestion\",\r\n                \"exists\": true\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"tags.Kusto-Loader\",\r\n                  \"exists\": true\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/8dc019ba-6623-4421-acc6-b80872b5e0f8\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"8dc019ba-6623-4421-acc6-b80872b5e0f8\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit_cosmosdb_ipRangeFilter\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.DocumentDB/databaseAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.DocumentDB/databaseAccounts/ipRangeFilter\",\r\n                  \"equals\": \"lalala\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9012b1cd-b045-46c6-a510-6137e06a009c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9012b1cd-b045-46c6-a510-6137e06a009c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Policy test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Testing\",\r\n        \"metadata\": {\r\n          \"category\": \"fernando\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9574b7be-5a51-4f1d-aa3a-547e3793713b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9574b7be-5a51-4f1d-aa3a-547e3793713b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TestDefinition_ICM_68617004\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedWindows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Windows VMs\",\r\n              \"description\": \"The list of allowed VMs for Windows.\"\r\n            }\r\n          },\r\n          \"listOfAllowedUbuntus\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Ubuntu VMs\",\r\n              \"description\": \"The list of allowed VMs for Ubuntu.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                ]\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"Canonical\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"UbuntuServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedUbuntus')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"MicrosoftWindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"WindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedWindows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/99869be6-5ded-4db4-b839-222895d6d091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"99869be6-5ded-4db4-b839-222895d6d091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"audit if subscription\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/9fb08bda-022c-448b-b292-0bb0288422bd\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"9fb08bda-022c-448b-b292-0bb0288422bd\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CreatedByUItest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a0c5912f-e951-4c78-a351-48ed69456001\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a0c5912f-e951-4c78-a351-48ed69456001\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe - Subscription Lvl test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Subscriptionlevel auditIfNotExist policy\",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/locks\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"testlock\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a1b067c8-2970-4c0b-b0da-31ae7f33d1de\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a1b067c8-2970-4c0b-b0da-31ae7f33d1de\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe - subscription non async test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a1b067c8-2970-4c0b-b0da-31ae7f33d2d3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a1b067c8-2970-4c0b-b0da-31ae7f33d2d3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Liz_storage_httpsTrafficOnly\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/supportsHttpsTrafficOnly\",\r\n                  \"equals\": \"True\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a23806bc-aa11-4fd8-8d03-4a5cb4b27420\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a23806bc-aa11-4fd8-8d03-4a5cb4b27420\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"[cstack] Noop\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Don't do anything\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"yabba\",\r\n              \"dabba\",\r\n              \"doo\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a309ad64-0bae-48d9-a6b1-d99c0b4218b6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a309ad64-0bae-48d9-a6b1-d99c0b4218b6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"add subscription name tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"add subscription name tag\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.subscriptionname\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.subscriptionname\",\r\n                \"value\": \"[subscription().displayName]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d82a2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d82a2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Add subscription \\\"id\\\" tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.id\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.id\",\r\n                \"value\": \"[subscription().id]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8339\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d8339\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"add subscriptionId tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.subscriptionId\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.subscriptionId\",\r\n                \"value\": \"[subscription().subscriptionId]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a752f8cb-6498-4e40-8431-b658ca4d8635\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a752f8cb-6498-4e40-8431-b658ca4d8635\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TestDefinition_ICM_68617004_2\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"The same as the original def with some properties removed to zero in on the issue\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedWindows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Windows VMs\",\r\n              \"description\": \"The list of allowed VMs for Windows.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                ]\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"MicrosoftWindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"WindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedWindows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/a8da3197-6bbb-41b3-86ee-63b6071c1091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"a8da3197-6bbb-41b3-86ee-63b6071c1091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testSandipsh metric alert policy2\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"testSandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": \"The description of alert.\"\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ]\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ]\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The operator comparing the current value with the threshold value.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold value at which the alert is activated.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"How the data that is collected should be combined over time.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"How often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"like\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '*')]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(parameters('alertNamePrefix'), '-', resourceGroup().name)]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/abcc6354-fc96-4f54-984e-8d49d06a80a3\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"abcc6354-fc96-4f54-984e-8d49d06a80a3\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe repo incident 67385980\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"Indexed\",\r\n        \"description\": \"Copy definition from css, tags in indexed mode\",\r\n        \"metadata\": {\r\n          \"category\": \"taggy\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"tagName\",\r\n              \"description\": \"Name of the tag, such as costCenter\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed values\",\r\n              \"description\": \"The list of allowed values for resource tags.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags[', parameters('tagName'), ']')]\",\r\n              \"in\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/akheICM67385980\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"akheICM67385980\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit if antiMalware extension does not exist\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"This policy audits if the anti malware extension .\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Compute/virtualMachines/extensions\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/publisher\",\r\n                    \"equals\": \"Microsoft.Azure.Security\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/extensions/type\",\r\n                    \"equals\": \"IaaSAntimalware\"\r\n                  }\r\n                ]\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/antiMalwareExtensionExists\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"antiMalwareExtensionExists\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Web socket must be disabled on App Services\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures web sockets are disabled on App Services.\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"foo\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/AppServiceWebSockets\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"AppServiceWebSockets\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Azure Security Center must be enabled\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Ensures Azure Security Center is enabled.\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"equals\": \"foo\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ASCEnabled\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ASCEnabled\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit a tag and it's value\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Audits if a tag and it's value doesn't exist for a given resource\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The name for the tag\",\r\n              \"description\": \"The name for the tag.\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The value for the tag\",\r\n              \"description\": \"The value for the tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags.',parameters('tagName'))]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and it's value\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Audit a tag and it's value\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit a tag and it's value\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"Audits if a tag and it's value doesn't exist for a given resource\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The name for the tag\",\r\n              \"description\": \"The name for the tag.\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The value for the tag\",\r\n              \"description\": \"The value for the tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags.',parameters('tagName'))]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Audit a tag and its value\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Audit a tag and its value\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet2031\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet2031\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet3628\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet3628\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CanCrudPolicyAssignment Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet5365\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet5365\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet5466\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet5466\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicySetDefinitionErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6756\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet6756\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicySetDefinitionErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7323\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7323\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7529\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7529\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicySetDefinitionErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7577\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7577\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"ValidatePolicyAssignmentErrorHandling Policy Definition $[Auto Test]\",\r\n        \"policyType\": \"Custom\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet7713\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"azsmnet7713\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"block the creation of VM disks and see what happens\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"in\": [\r\n              \"Microsoft.Compute/disks\"\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b113f5e5-835c-4685-b2c8-e4fd24204091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b113f5e5-835c-4685-b2c8-e4fd24204091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Resource names must start with Resource Group Name\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Resource names must start with Resource Group Name\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat(resourceGroup().name,'*')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b50f5f4b-45fa-45d9-9488-71cbd37a4091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b50f5f4b-45fa-45d9-9488-71cbd37a4091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny VMs or VMSSs without managed disks\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"majastrz\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/osDisk.uri\",\r\n                    \"exists\": \"True\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osDisk.vhdContainers\",\r\n                        \"exists\": \"True\"\r\n                      },\r\n                      {\r\n                        \"field\": \"Microsoft.Compute/VirtualMachineScaleSets/osdisk.imageUrl\",\r\n                        \"exists\": \"True\"\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b82875bf-c4cc-490f-af1a-c54c17218278\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b82875bf-c4cc-490f-af1a-c54c17218278\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Allow specified VM image publishers\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Marketplace proposal\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedPublishers\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed VM image publishers\",\r\n              \"description\": \"The list of allowed VM image publishers.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"anyOf\": [\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/virtualMachines/imagePublisher\",\r\n                    \"notIn\": \"[parameters('allowedPublishers')]\"\r\n                  }\r\n                ]\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"field\": \"type\",\r\n                    \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                    \"notIn\": \"[parameters('allowedPublishers')]\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/b82875bf-c4cc-490f-af1a-c54c172188d2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"b82875bf-c4cc-490f-af1a-c54c172188d2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Enforce tag and its value on resource groups\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Enforces a required tag and its value on resource groups.\",\r\n        \"metadata\": {\r\n          \"category\": \"akhe\"\r\n        },\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Name of the tag, such as costCenter\",\r\n              \"strongType\": \"tagName\"\r\n            }\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"description\": \"Value of the tag, such as headquarter\",\r\n              \"strongType\": \"tagValue\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"[concat('tags[',parameters('tagName'), ']')]\",\r\n                  \"equals\": \"[parameters('tagValue')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/bab31351-bca0-44b0-8476-ba8f067f208b\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bab31351-bca0-44b0-8476-ba8f067f208b\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"NSG Rules exists test\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allof\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].protocol\",\r\n                  \"notLike\": \"*\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/bb6a78ae-8737-41e0-9c41-cc777c8c00a0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"bb6a78ae-8737-41e0-9c41-cc777c8c00a0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit allowed locations for resource groups\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"This policy enables you to restrict the locations your organization can create resource groups in. Use to enforce your geo-compliance requirements.\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of locations that resource groups can be created in.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"notIn\": \"[parameters('listOfAllowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c0f586f1-abe5-4801-8588-7332e49e60c2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c0f586f1-abe5-4801-8588-7332e49e60c2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit allowed locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c0f586f1-abe5-4801-8588-7332e49e60c9\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c0f586f1-abe5-4801-8588-7332e49e60c9\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"akhe resource group auditIfNotExists\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions/resourceGroups\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"auditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Authorization/locks\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"testlock\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c7b9982d-2f50-4730-935f-5c241982a441\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c7b9982d-2f50-4730-935f-5c241982a441\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/c8b79b49-a579-4045-984e-1b249ab8b474\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"c8b79b49-a579-4045-984e-1b249ab8b474\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"miTestPolicy02\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"miTestPolicy02 description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/cb754054-9fe8-427d-8708-0eeca8e4e1a2\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cb754054-9fe8-427d-8708-0eeca8e4e1a2\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"miTestPolicy03\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"miTestPolicy03 description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/cb754054-9fe8-427d-8708-0eeca8e4e347\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"cb754054-9fe8-427d-8708-0eeca8e4e347\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deploy security rule with restricted source IPs (NSG level)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Overwrites security rules with IP restrictions at the NSG level\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {\r\n          \"destinationPortRanges\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Destination port ranges\",\r\n              \"description\": \"Destination port ranges requiring IP restrictions. Ranges may overlap.\"\r\n            }\r\n          },\r\n          \"sourceAddressPrefixes\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"IP restriction prefixes\",\r\n              \"description\": \"The IP ranges incoming traffic will be restricted to. I.e. 192.4.0.0/8;192.5.0.0/8\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRange\",\r\n                      \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"not\": {\r\n                      \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules[*].destinationPortRanges[*]\",\r\n                      \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                    }\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Network/networkSecurityGroups/securityRules\",\r\n              \"existenceCondition\": {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"in\": \"[parameters('destinationPortRanges')]\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notIn\": \"[parameters('destinationPortRanges')]\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"not\": {\r\n                              \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                              \"notLike\": \"*\"\r\n                            }\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                            \"notIn\": [\r\n                              \"*\",\r\n                              \"Internet\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"exists\": \"true\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notEquals\": \"\"\r\n                          },\r\n                          {\r\n                            \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                            \"notIn\": [\r\n                              \"*\",\r\n                              \"Internet\"\r\n                            ]\r\n                          }\r\n                        ]\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              },\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"nsgName\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"location\": {\r\n                        \"type\": \"string\"\r\n                      },\r\n                      \"destinationPortRanges\": {\r\n                        \"type\": \"array\"\r\n                      },\r\n                      \"sourceAddressPrefixes\": {\r\n                        \"type\": \"array\"\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"getNsgDeploymentName\": \"[concat('getNSGContent-', parameters('nsgName'))]\",\r\n                      \"collectorDeploymentName\": \"[concat('collectRules-', parameters('nsgName'))]\",\r\n                      \"overwriteNsgDeploymentName\": \"[concat('overwriteNsg-', parameters('nsgName'))]\",\r\n                      \"nsgResourceId\": \"[resourceId(subscription().subscriptionId, resourceGroup().name, 'Microsoft.Network/networkSecurityGroups', parameters('nsgName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('getNsgDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"template\": {\r\n                            \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                            \"contentVersion\": \"1.0.0.0\",\r\n                            \"resources\": [],\r\n                            \"outputs\": {\r\n                              \"nsgProperties\": {\r\n                                \"type\": \"object\",\r\n                                \"value\": \"[reference(variables('nsgResourceId'), '2018-03-01', 'Full')]\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('collectorDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_collectRules_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"nsgProperties\": {\r\n                              \"value\": \"[reference(variables('getNsgDeploymentName')).outputs.nsgProperties.value]\"\r\n                            },\r\n                            \"nsgName\": {\r\n                              \"value\": \"[parameters('nsgName')]\"\r\n                            },\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            },\r\n                            \"portRangesToRestrict\": {\r\n                              \"value\": \"[parameters('destinationPortRanges')]\"\r\n                            },\r\n                            \"sourceAddressPrefixes\": {\r\n                              \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      },\r\n                      {\r\n                        \"apiVersion\": \"2018-02-01\",\r\n                        \"type\": \"Microsoft.Resources/deployments\",\r\n                        \"name\": \"[variables('overwriteNsgDeploymentName')]\",\r\n                        \"properties\": {\r\n                          \"mode\": \"Incremental\",\r\n                          \"templateLink\": {\r\n                            \"uri\": \"https://portlockdown.blob.core.windows.net/portlockdown-templates/SecurityRule_NSGLevel_overwriteNSG_template.json\",\r\n                            \"contentVersion\": \"1.0.0.0\"\r\n                          },\r\n                          \"parameters\": {\r\n                            \"originalNsgProperties\": {\r\n                              \"value\": \"[reference(variables('getNsgDeploymentName')).outputs.nsgProperties.value]\"\r\n                            },\r\n                            \"updatedSecurityRules\": {\r\n                              \"value\": \"[reference(variables('collectorDeploymentName')).outputs.updatedSecurityRules.value]\"\r\n                            },\r\n                            \"nsgName\": {\r\n                              \"value\": \"[parameters('nsgName')]\"\r\n                            },\r\n                            \"location\": {\r\n                              \"value\": \"[parameters('location')]\"\r\n                            }\r\n                          }\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"nsgName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    },\r\n                    \"sourceAddressPrefixes\": {\r\n                      \"value\": \"[parameters('sourceAddressPrefixes')]\"\r\n                    },\r\n                    \"destinationPortRanges\": {\r\n                      \"value\": \"[parameters('destinationPortRanges')]\"\r\n                    },\r\n                    \"location\": {\r\n                      \"value\": \"[field('location')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/d7b13c30-e6aa-47e1-b50a-8e33f152d086\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"d7b13c30-e6aa-47e1-b50a-8e33f152d086\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit storage account SKUs\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Demo 323\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Audited skus\",\r\n              \"description\": \"The list of skus.\",\r\n              \"strongType\": \"storageSkus\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Storage/storageAccounts/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e90ee\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"dbe1e663-7265-4cf4-96b5-7435b21e90ee\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit virtual machines SKUs\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Demo 323\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"List Of Allowed SKUs\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"vmSKUs\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"field\": \"Microsoft.Compute/virtualMachines/sku.name\",\r\n                  \"in\": \"[parameters('listOfAllowedSKUs')]\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/dbe1e663-7265-4cf4-96b5-7435b21e9170\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"dbe1e663-7265-4cf4-96b5-7435b21e9170\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Location must match resource group location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"{\\n  \\\"policyRule\\\": {\\n   \\\"if\\\": {\\n      \\\"allOf\\\" : {\\n        {\\n          \\\"field\\\": \\\"location\\\",\\n          \\\"exists\\\": \\\"true\\\"\\n        },\\n        {\\n          \\\"field\\\": \\\"location\\\",\\n          \\\"notEquals\\\": \\\"[resourcegroup().location]\\\"\\n        }\\n      }\\n   },\\n   \\\"then\\\": {\\n      \\\"effect\\\": \\\"deny\\\",\\n    }\\n  }\\n}\\n\\n\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notEquals\": \"[resourcegroup().location]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/def1e881-8abb-4d47-85cd-09f68f1ea09c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"def1e881-8abb-4d47-85cd-09f68f1ea09c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Test Delete Policy \",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Test Delete Policy description\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e277207d-8b6a-4b83-b8dd-056d90af4496\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e277207d-8b6a-4b83-b8dd-056d90af4496\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"allowedOS\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"test_sandipsh\"\r\n        },\r\n        \"parameters\": {\r\n          \"listOfAllowedWindows\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Windows VMs\",\r\n              \"description\": \"The list of allowed VMs for Windows.\"\r\n            }\r\n          },\r\n          \"listOfAllowedUbuntus\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed Ubuntu VMs\",\r\n              \"description\": \"The list of allowed VMs for Ubuntu.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"in\": [\r\n                  \"Microsoft.Compute/disks\",\r\n                  \"Microsoft.Compute/virtualMachines\",\r\n                  \"Microsoft.Compute/VirtualMachineScaleSets\"\r\n                ]\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"Canonical\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"UbuntuServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedUbuntus')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              },\r\n              {\r\n                \"not\": {\r\n                  \"allOf\": [\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imagePublisher\",\r\n                      \"in\": [\r\n                        \"MicrosoftWindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageOffer\",\r\n                      \"in\": [\r\n                        \"WindowsServer\"\r\n                      ]\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageSku\",\r\n                      \"in\": \"[parameters('listOfAllowedWindows')]\"\r\n                    },\r\n                    {\r\n                      \"field\": \"Microsoft.Compute/imageVersion\",\r\n                      \"in\": [\r\n                        \"latest\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e2bdec61-8c05-4ad6-b8bf-cd1b0a87c091\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"narine-testmode-lang\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Compute\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e5fa2a59-bb7e-40f3-a23b-3793795832a7\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e5fa2a59-bb7e-40f3-a23b-3793795832a7\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"test_123\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e6e62577-7b30-4419-ba72-382ecb0ee35c\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e6e62577-7b30-4419-ba72-382ecb0ee35c\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Block turning off transparent data encryption\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"camarvin\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Sql/transparentDataEncryption.status\",\r\n                \"equals\": \"disabled\"\r\n              },\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.SQL/servers/databases/transparentDataEncryption\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/e8b79b63-7b19-4440-90cd-e4e45d6592b0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"e8b79b63-7b19-4440-90cd-e4e45d6592b0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"defaultValue: all parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"defaultValue\"\r\n        },\r\n        \"parameters\": {\r\n          \"locations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array)\",\r\n              \"description\": \"The list of locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"eastus\",\r\n              \"westus\"\r\n            ]\r\n          },\r\n          \"location\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string)\",\r\n              \"description\": \"The location for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"resourceGroups\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array)\",\r\n              \"description\": \"The list of resource groups.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": [\r\n              \"camarvin\"\r\n            ]\r\n          },\r\n          \"resourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string)\",\r\n              \"description\": \"The resource group.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            },\r\n            \"defaultValue\": \"camarvin\"\r\n          },\r\n          \"tags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array)\",\r\n              \"description\": \"The list of tags.\"\r\n            },\r\n            \"defaultValue\": []\r\n          },\r\n          \"tag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": \"The tag.\"\r\n            },\r\n            \"defaultValue\": \"\"\r\n          },\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array, av)\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"eastus\"\r\n            ]\r\n          },\r\n          \"allowedLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string, av)\",\r\n              \"description\": \"The allowed location for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ],\r\n            \"defaultValue\": \"eastus\"\r\n          },\r\n          \"allowedStorageSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array, av)\",\r\n              \"description\": \"The list of allowed storage SKUs for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"allowedStorageSKU\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": \"The allowed storage SKU for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ],\r\n            \"defaultValue\": \"Standard_LRS\"\r\n          },\r\n          \"allowedTags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array, av)\",\r\n              \"description\": \"The list of allowed tags.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ],\r\n            \"defaultValue\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ]\r\n          },\r\n          \"allowedTag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string, av)\",\r\n              \"description\": \"The allowed tag.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ],\r\n            \"defaultValue\": \"FirstName\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('locations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('location')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('resourceGroups')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('resourceGroup')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('tags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('tag')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('allowedLocation')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedStorageSkus')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"Equals\": \"[parameters('allowedStorageSku')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedTags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"NotEquals\": \"[parameters('allowedTag')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ea1688b3-022e-4add-af39-2fe60689a3b0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ea1688b3-022e-4add-af39-2fe60689a3b0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Deny \\\"Allow All\\\" NSG rules\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Denies the creation of sourceAddressPrefix=\\\"*\\\", destinationPortRange=\\\"*\\\" NSG security rules\",\r\n        \"metadata\": {\r\n          \"category\": \"Port Lockdown\"\r\n        },\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/networkSecurityGroups/securityRules\"\r\n              },\r\n              {\r\n                \"field\": \"name\",\r\n                \"notEquals\": \"PortLockdown_AllowAll\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/priority\",\r\n                \"notEquals\": \"4000\"\r\n              },\r\n              {\r\n                \"allOf\": [\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange\",\r\n                        \"equals\": \"*\"\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]\",\r\n                          \"notEquals\": \"*\"\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/access\",\r\n                    \"equals\": \"Allow\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/direction\",\r\n                    \"equals\": \"Inbound\"\r\n                  },\r\n                  {\r\n                    \"anyOf\": [\r\n                      {\r\n                        \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix\",\r\n                        \"in\": [\r\n                          \"*\",\r\n                          \"Internet\"\r\n                        ]\r\n                      },\r\n                      {\r\n                        \"not\": {\r\n                          \"field\": \"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]\",\r\n                          \"notIn\": [\r\n                            \"*\",\r\n                            \"Internet\"\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ebcd21e9-b89f-4a22-8654-dd3a4d8b9321\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ebcd21e9-b89f-4a22-8654-dd3a4d8b9321\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Security - ServiceFabric - AuditStorageEncryption\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Storage/storageAccounts\"\r\n              },\r\n              {\r\n                \"anyOf\": [\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/enableBlobEncryption\",\r\n                    \"notEquals\": \"true\"\r\n                  },\r\n                  {\r\n                    \"field\": \"Microsoft.Storage/storageAccounts/enableFileEncryption\",\r\n                    \"notEquals\": \"true\"\r\n                  }\r\n                ]\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ef5ec5b2-2330-401d-8468-3f91615de0ef\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ef5ec5b2-2330-401d-8468-3f91615de0ef\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"marcin-test-policy\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"testing stuff\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"location\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"location\",\r\n              \"description\": null\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"equals\": \"[parameters('location')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f04dc6b1-e426-4293-8aa9-2572bbce816a\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f04dc6b1-e426-4293-8aa9-2572bbce816a\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"must match resource group location (indexed)\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"Indexed\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"location\",\r\n            \"notEquals\": \"[resourcegroup().location]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f0e74307-cf4c-4009-89a5-c3b77d9cc12d\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f0e74307-cf4c-4009-89a5-c3b77d9cc12d\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Parameters\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"Test\"\r\n        },\r\n        \"parameters\": {\r\n          \"locations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array)\",\r\n              \"description\": \"The list of locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"location\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string)\",\r\n              \"description\": \"The location for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          },\r\n          \"resourceGroups\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array)\",\r\n              \"description\": \"The list of resource groups.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"resourceGroup\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string)\",\r\n              \"description\": \"The resource group.\",\r\n              \"strongType\": \"existingResourceGroups\"\r\n            }\r\n          },\r\n          \"tags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array)\",\r\n              \"description\": \"The list of tags.\"\r\n            }\r\n          },\r\n          \"tag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string)\",\r\n              \"description\": \"The tag.\"\r\n            }\r\n          },\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, array, av)\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ]\r\n          },\r\n          \"allowedLocation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (no scope, string, av)\",\r\n              \"description\": \"The allowed location for resources.\",\r\n              \"strongType\": \"location\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"eastus\",\r\n              \"westus\",\r\n              \"southus\"\r\n            ]\r\n          },\r\n          \"allowedStorageSKUs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (array, av)\",\r\n              \"description\": \"The list of allowed storage SKUs for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"allowedStorageSKU\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Strong type (string, av)\",\r\n              \"description\": \"The allowed storage SKU for resources.\",\r\n              \"strongType\": \"storageSkus\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"Standard_LRS\",\r\n              \"Standard_ZRS\",\r\n              \"Standard_GRS\"\r\n            ]\r\n          },\r\n          \"allowedTags\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (array, av)\",\r\n              \"description\": \"The list of allowed tags.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ]\r\n          },\r\n          \"allowedTag\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Non strong type (string, av)\",\r\n              \"description\": \"The allowed tag.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"FirstName\",\r\n              \"LastName\",\r\n              \"Age\"\r\n            ]\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('locations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('location')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('resourceGroups')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('resourceGroup')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('tags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('tag')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedLocations')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"equals\": \"[parameters('allowedLocation')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedStorageSkus')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"Equals\": \"[parameters('allowedStorageSku')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"in\": \"[parameters('allowedTags')]\"\r\n              },\r\n              {\r\n                \"field\": \"location\",\r\n                \"NotEquals\": \"[parameters('allowedTag')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f3d8eb78-dac2-46d5-94eb-61ab140e56d0\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f3d8eb78-dac2-46d5-94eb-61ab140e56d0\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"jilim def\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\",\r\n              \"strongType\": \"location\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"notin\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f68d5d25-aa23-4373-b10d-4183b3627109\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f68d5d25-aa23-4373-b10d-4183b3627109\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"TEST Deny VNet if specific NSGs are not used\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Deny\",\r\n        \"parameters\": {\r\n          \"allowedNSGs\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"type\",\r\n                \"equals\": \"Microsoft.Network/virtualNetworks\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Network/virtualNetworks/subnets[*].networkSecurityGroup.id\",\r\n                \"notin\": \"[parameters('allowedNSGs')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/f7b36161-3a62-4fff-abf2-8b1a469ed1d6\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"f7b36161-3a62-4fff-abf2-8b1a469ed1d6\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"dupitest4\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"1019_Delay_grid_data_Refresh_when_needed\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/fb809d3a-efb2-4417-83fa-6dc6950d2340\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"fb809d3a-efb2-4417-83fa-6dc6950d2340\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"CreatedByUItest\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/fe875399-f94a-40e1-9a7b-af775d62f001\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"fe875399-f94a-40e1-9a7b-af775d62f001\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit all resource group tags\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Inherit all resource group tags\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags\",\r\n                \"value\": \"[resourcegroup().tags]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/inheritAllTags\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"inheritAllTags\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Inherit resource group Cost Center tag\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Inherit resource group Cost Center tag\",\r\n        \"metadata\": {},\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"tags.CostCenter\",\r\n            \"exists\": \"false\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"append\",\r\n            \"details\": [\r\n              {\r\n                \"field\": \"tags.CostCenter\",\r\n                \"value\": \"[resourcegroup().tags.CostCenter]\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/inheritCostCenter\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"inheritCostCenter\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Audit allowed locations\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"This policy enables you to audit your location.\",\r\n        \"parameters\": {\r\n          \"listOfAllowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"description\": \"The list of locations that can be specified when deploying resources.\",\r\n              \"strongType\": \"location\",\r\n              \"displayName\": \"Allowed locations\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('listOfAllowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"Audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/LocationAuditDefinition\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"LocationAuditDefinition\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unit test junk: sorry for littering. Please delete me!\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/Subscriptions/ResourceGroups/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ps6032\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ps6032\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Unit test junk: sorry for littering. Please delete me!\",\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"source\": \"action\",\r\n            \"equals\": \"Microsoft.Resources/Subscriptions/ResourceGroups/write\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/ps7280\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"ps7280\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Require Azure Monitor to be turned on for storage accounts\",\r\n        \"policyType\": \"Custom\",\r\n        \"parameters\": {},\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Network/networkSecurityGroup\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"AuditIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/diagnosticSettings\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"Microsoft.insights/diagnosticSettings/logs.enabled\",\r\n                \"notequals\": \"True\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Require Azure Monitor to be turned on for storage accounts\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Require Azure Monitor to be turned on for storage accounts\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Restrict resource location\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"metadata\": {\r\n          \"category\": \"cstack\"\r\n        },\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/Restrict resource location\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"Restrict resource location\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"Resource group naming convention\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"Resource group naming convention\",\r\n        \"metadata\": {},\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect\",\r\n              \"strongType\": \"effect\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat(resourceGroup().name,'*')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/rgnaming\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"rgnaming\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"SQL Server Not Allowed\",\r\n        \"policyType\": \"Custom\",\r\n        \"parameters\": {\r\n          \"allowedLocations\": {\r\n            \"type\": \"Array\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Allowed locations\",\r\n              \"description\": \"The list of allowed locations for resources.\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"location\",\r\n              \"in\": \"[parameters('allowedLocations')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"deny\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/SQL Server Not Allowed\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"SQL Server Not Allowed\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"like bug\",\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"like bug\",\r\n        \"parameters\": {\r\n          \"effect\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Effect\",\r\n              \"description\": \"The effect\",\r\n              \"strongType\": \"effect\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"audit\",\r\n              \"deny\",\r\n              \"disabled\"\r\n            ],\r\n            \"defaultValue\": \"audit\"\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"name\",\r\n              \"like\": \"[concat('test','this')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"[parameters('effect')]\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testbadlike\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"testbadlike\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"policyType\": \"Custom\",\r\n        \"mode\": \"All\",\r\n        \"description\": \"test policy\",\r\n        \"parameters\": {\r\n          \"resourceType\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Resource Type\",\r\n              \"description\": \"The target resource type.\"\r\n            }\r\n          },\r\n          \"alertNamePrefix\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert name prefix\",\r\n              \"description\": \"A prefix to be used for the metrics alert.\"\r\n            }\r\n          },\r\n          \"alertDescription\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Alert description.\",\r\n              \"description\": \"The description of alert.\"\r\n            }\r\n          },\r\n          \"alertSeverity\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"alertSeverity\",\r\n              \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"0\",\r\n              \"1\",\r\n              \"2\",\r\n              \"3\",\r\n              \"4\"\r\n            ]\r\n          },\r\n          \"isEnabled\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"isEnabled\",\r\n              \"description\": \"Specifies whether the alert is enabled.\"\r\n            },\r\n            \"allowedValues\": [\r\n              \"true\",\r\n              \"false\"\r\n            ]\r\n          },\r\n          \"metricName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Metric name\",\r\n              \"description\": \"The metric name.\"\r\n            }\r\n          },\r\n          \"operator\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Operator\",\r\n              \"description\": \"The operator comparing the current value with the threshold value.\"\r\n            }\r\n          },\r\n          \"threshold\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Threshold\",\r\n              \"description\": \"The threshold value at which the alert is activated.\"\r\n            }\r\n          },\r\n          \"timeAggregation\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"TimeAggregation\",\r\n              \"description\": \"How the data that is collected should be combined over time.\"\r\n            }\r\n          },\r\n          \"windowSize\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Window size\",\r\n              \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n            }\r\n          },\r\n          \"evaluationFrequency\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"Evaluation Frequency\",\r\n              \"description\": \"How often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n            }\r\n          },\r\n          \"actionGroupId\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"ActionGroupId\",\r\n              \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n            }\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"field\": \"type\",\r\n            \"equals\": \"[parameters('resourceType')]\"\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"DeployIfNotExists\",\r\n            \"details\": {\r\n              \"type\": \"Microsoft.Insights/metricAlerts\",\r\n              \"existenceCondition\": {\r\n                \"field\": \"name\",\r\n                \"equals\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-', field('name'))]\"\r\n              },\r\n              \"existenceScope\": \"subscription\",\r\n              \"deployment\": {\r\n                \"properties\": {\r\n                  \"mode\": \"incremental\",\r\n                  \"template\": {\r\n                    \"$schema\": \"http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                    \"contentVersion\": \"1.0.0.0\",\r\n                    \"parameters\": {\r\n                      \"alertNamePrefix\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"A prefix to be used for the metrics alert.\"\r\n                        }\r\n                      },\r\n                      \"alertDescription\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"This is a metric alert\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Description of alert\"\r\n                        }\r\n                      },\r\n                      \"alertSeverity\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"3\",\r\n                        \"allowedValues\": [\r\n                          \"0\",\r\n                          \"1\",\r\n                          \"2\",\r\n                          \"3\",\r\n                          \"4\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Severity of alert {0,1,2,3,4}\"\r\n                        }\r\n                      },\r\n                      \"isEnabled\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"true\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Specifies whether the alert is enabled\"\r\n                        }\r\n                      },\r\n                      \"metricName\": {\r\n                        \"type\": \"string\",\r\n                        \"minLength\": 1,\r\n                        \"metadata\": {\r\n                          \"description\": \"Name of the metric used in the comparison to activate the alert.\"\r\n                        }\r\n                      },\r\n                      \"operator\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"GreaterThan\",\r\n                        \"allowedValues\": [\r\n                          \"Equals\",\r\n                          \"NotEquals\",\r\n                          \"GreaterThan\",\r\n                          \"GreaterThanOrEqual\",\r\n                          \"LessThan\",\r\n                          \"LessThanOrEqual\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"Operator comparing the current value with the threshold value.\"\r\n                        }\r\n                      },\r\n                      \"threshold\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"0\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The threshold value at which the alert is activated.\"\r\n                        }\r\n                      },\r\n                      \"timeAggregation\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"Average\",\r\n                        \"allowedValues\": [\r\n                          \"Average\",\r\n                          \"Minimum\",\r\n                          \"Maximum\",\r\n                          \"Total\"\r\n                        ],\r\n                        \"metadata\": {\r\n                          \"description\": \"How the data that is collected should be combined over time.\"\r\n                        }\r\n                      },\r\n                      \"windowSize\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT5M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"Period of time used to monitor alert activity based on the threshold. Must be between five minutes and one day. ISO 8601 duration format.\"\r\n                        }\r\n                      },\r\n                      \"evaluationFrequency\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"PT1M\",\r\n                        \"metadata\": {\r\n                          \"description\": \"how often the metric alert is evaluated represented in ISO 8601 duration format\"\r\n                        }\r\n                      },\r\n                      \"actionGroupId\": {\r\n                        \"type\": \"string\",\r\n                        \"defaultValue\": \"\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The ID of the action group that is triggered when the alert is activated or deactivated\"\r\n                        }\r\n                      },\r\n                      \"resourceType\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The resource type of target resource.\"\r\n                        }\r\n                      },\r\n                      \"targetResourceName\": {\r\n                        \"type\": \"string\",\r\n                        \"metadata\": {\r\n                          \"description\": \"The target resource name.\"\r\n                        }\r\n                      }\r\n                    },\r\n                    \"variables\": {\r\n                      \"targetResourceType\": \"[parameters('resourceType')]\",\r\n                      \"resourceIdentifier\": \"[resourceId(variables('targetResourceType'), parameters('targetResourceName'))]\",\r\n                      \"alertName\": \"[concat(parameters('alertNamePrefix'), '-', resourcegroup().name, '-',  parameters('targetResourceName'))]\"\r\n                    },\r\n                    \"resources\": [\r\n                      {\r\n                        \"name\": \"[variables('alertName')]\",\r\n                        \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                        \"location\": \"global\",\r\n                        \"apiVersion\": \"2018-03-01\",\r\n                        \"tags\": {},\r\n                        \"properties\": {\r\n                          \"description\": \"[parameters('alertDescription')]\",\r\n                          \"severity\": \"[parameters('alertSeverity')]\",\r\n                          \"enabled\": \"[parameters('isEnabled')]\",\r\n                          \"scopes\": [\r\n                            \"[variables('resourceIdentifier')]\"\r\n                          ],\r\n                          \"evaluationFrequency\": \"[parameters('evaluationFrequency')]\",\r\n                          \"windowSize\": \"[parameters('windowSize')]\",\r\n                          \"criteria\": {\r\n                            \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\",\r\n                            \"allOf\": [\r\n                              {\r\n                                \"name\": \"1st criterion\",\r\n                                \"metricName\": \"[parameters('metricName')]\",\r\n                                \"dimensions\": [],\r\n                                \"operator\": \"[parameters('operator')]\",\r\n                                \"threshold\": \"[parameters('threshold')]\",\r\n                                \"timeAggregation\": \"[parameters('timeAggregation')]\"\r\n                              }\r\n                            ]\r\n                          },\r\n                          \"actions\": [\r\n                            {\r\n                              \"actionGroupId\": \"[parameters('actionGroupId')]\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    ]\r\n                  },\r\n                  \"parameters\": {\r\n                    \"alertNamePrefix\": {\r\n                      \"value\": \"[parameters('alertNamePrefix')]\"\r\n                    },\r\n                    \"alertDescription\": {\r\n                      \"value\": \"[parameters('alertDescription')]\"\r\n                    },\r\n                    \"alertSeverity\": {\r\n                      \"value\": \"[parameters('alertSeverity')]\"\r\n                    },\r\n                    \"isEnabled\": {\r\n                      \"value\": \"[parameters('isEnabled')]\"\r\n                    },\r\n                    \"metricName\": {\r\n                      \"value\": \"[parameters('metricName')]\"\r\n                    },\r\n                    \"operator\": {\r\n                      \"value\": \"[parameters('operator')]\"\r\n                    },\r\n                    \"threshold\": {\r\n                      \"value\": \"[parameters('threshold')]\"\r\n                    },\r\n                    \"timeAggregation\": {\r\n                      \"value\": \"[parameters('timeAggregation')]\"\r\n                    },\r\n                    \"windowSize\": {\r\n                      \"value\": \"[parameters('windowSize')]\"\r\n                    },\r\n                    \"evaluationFrequency\": {\r\n                      \"value\": \"[parameters('evaluationFrequency')]\"\r\n                    },\r\n                    \"actionGroupId\": {\r\n                      \"value\": \"[parameters('actionGroupId')]\"\r\n                    },\r\n                    \"resourceType\": {\r\n                      \"value\": \"[parameters('resourceType')]\"\r\n                    },\r\n                    \"targetResourceName\": {\r\n                      \"value\": \"[field('name')]\"\r\n                    }\r\n                  }\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testSandipsh.draft\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"testSandipsh.draft\"\r\n    },\r\n    {\r\n      \"properties\": {\r\n        \"displayName\": \"testtest\",\r\n        \"policyType\": \"Custom\",\r\n        \"description\": \"testtest\",\r\n        \"parameters\": {\r\n          \"tagName\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The name for the tag\",\r\n              \"description\": \"The name for the tag.\"\r\n            },\r\n            \"allowedValues\": []\r\n          },\r\n          \"tagValue\": {\r\n            \"type\": \"String\",\r\n            \"metadata\": {\r\n              \"displayName\": \"The value for the tag\",\r\n              \"description\": \"The value for the tag\"\r\n            },\r\n            \"allowedValues\": []\r\n          }\r\n        },\r\n        \"policyRule\": {\r\n          \"if\": {\r\n            \"not\": {\r\n              \"field\": \"[concat('tags.',parameters('tagName'))]\",\r\n              \"equals\": \"[parameters('tagValue')]\"\r\n            }\r\n          },\r\n          \"then\": {\r\n            \"effect\": \"audit\"\r\n          }\r\n        }\r\n      },\r\n      \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/testtest\",\r\n      \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n      \"name\": \"testtest\"\r\n    }\r\n  ]\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:17 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:4e309496-25c7-46b1-b772-d7475b684a1f"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14980"
        ],
        "x-ms-correlation-request-id": [
          "45e95bae-2afa-4ac9-bdfc-761e0ecf8ef5"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203217Z:45e95bae-2afa-4ac9-bdfc-761e0ecf8ef5"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0NjMzNj9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "DELETE",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "ba6dc768-4c4f-4410-b275-926cfba97a07"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"properties\": {\r\n    \"displayName\": \"CanCrudPolicySetDefinition Policy Definition $[Auto Test]\",\r\n    \"policyType\": \"Custom\",\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"source\": \"action\",\r\n        \"equals\": \"ResourceProviderTestHost/TestResourceType/TestResourceTypeNestedOne/write\"\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deny\"\r\n      }\r\n    }\r\n  },\r\n  \"id\": \"/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336\",\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"name\": \"azsmnet6336\"\r\n}",
      "ResponseHeaders": {
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:12 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "Transfer-Encoding": [
          "chunked"
        ],
        "Vary": [
          "Accept-Encoding",
          "Accept-Encoding"
        ],
        "x-ms-request-id": [
          "westus2:18c813c1-b99b-4db8-b4ac-72711cd6e14d"
        ],
        "x-ms-ratelimit-remaining-subscription-deletes": [
          "14994"
        ],
        "x-ms-correlation-request-id": [
          "c2c7a781-9a9b-4d95-8985-e3f4fa16812d"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203212Z:c2c7a781-9a9b-4d95-8985-e3f4fa16812d"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 200
    },
    {
      "RequestUri": "/subscriptions/d0610b27-9663-4c05-89f8-5b4be01e86a5/providers/Microsoft.Authorization/policyDefinitions/azsmnet6336?api-version=2018-03-01",
      "EncodedRequestUri": "L3N1YnNjcmlwdGlvbnMvZDA2MTBiMjctOTY2My00YzA1LTg5ZjgtNWI0YmUwMWU4NmE1L3Byb3ZpZGVycy9NaWNyb3NvZnQuQXV0aG9yaXphdGlvbi9wb2xpY3lEZWZpbml0aW9ucy9henNtbmV0NjMzNj9hcGktdmVyc2lvbj0yMDE4LTAzLTAx",
      "RequestMethod": "GET",
      "RequestBody": "",
      "RequestHeaders": {
        "x-ms-client-request-id": [
          "28b83325-7df2-432d-8808-fbfb589d3745"
        ],
        "accept-language": [
          "en-US"
        ],
        "User-Agent": [
          "FxVersion/4.6.25211.01",
          "Microsoft.Azure.Management.ResourceManager.PolicyClient/1.8.0.0"
        ]
      },
      "ResponseBody": "{\r\n  \"error\": {\r\n    \"code\": \"PolicyDefinitionNotFound\",\r\n    \"message\": \"The policy definition 'azsmnet6336' could not be found.\"\r\n  }\r\n}",
      "ResponseHeaders": {
        "Content-Length": [
          "113"
        ],
        "Content-Type": [
          "application/json; charset=utf-8"
        ],
        "Expires": [
          "-1"
        ],
        "Cache-Control": [
          "no-cache"
        ],
        "Date": [
          "Wed, 27 Jun 2018 20:32:12 GMT"
        ],
        "Pragma": [
          "no-cache"
        ],
        "x-ms-request-id": [
          "westus2:58972f10-d643-4e8a-8a69-8c4838b99ec0"
        ],
        "x-ms-ratelimit-remaining-subscription-reads": [
          "14986"
        ],
        "x-ms-correlation-request-id": [
          "eb1cb99f-54f2-4c5f-8382-0e130a275545"
        ],
        "x-ms-routing-request-id": [
          "WESTUS2:20180627T203212Z:eb1cb99f-54f2-4c5f-8382-0e130a275545"
        ],
        "Strict-Transport-Security": [
          "max-age=31536000; includeSubDomains"
        ],
        "X-Content-Type-Options": [
          "nosniff"
        ]
      },
      "StatusCode": 404
    }
  ],
  "Names": {
    "CanCrudPolicySetDefinition": [
      "azsmnet8468",
      "azsmnet3095",
      "azsmnet6336"
    ]
  },
  "Variables": {
    "SubscriptionId": "d0610b27-9663-4c05-89f8-5b4be01e86a5"
  }
}